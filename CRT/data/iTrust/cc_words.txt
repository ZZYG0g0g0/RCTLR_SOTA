package edu ncsu csc itrust dao mysql import java sql Connection import java sql Prepared Statement import java sql Result Set import java sql Exception import edu ncsu csc itrust Util import edu ncsu csc itrust dao Factory import edu ncsu csc itrust exception Exception Access is for all queries related to authorization stands for Database Access Object All Os are intended to be reflections of the database that is one per table in the database most of the time For more complex sets of queries extra Os are added Os can assume that all data has been validated and is correct Os should never have setters or any other parameter to the constructor than a factory All Os should be accessed by Factory see link Factory and every should have a factory for obtaining connections and or accessing other Os author Andy public class Access private Factory factory The typical constructor param factory The link Factory associated with this which is used for obtaining connections etc public Access Factory factory this factory factory Returns the number of minutes it would take for a session to time out This is done by effectively using the database table as a hash table If a row in Global Variables does not exist one is inserted with the default value return An int for the number of minutes throws Exception public int get Session Timeout Mins throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Value Global Variables Name Timeout Result Set rs ps execute Query if rs next return rs get Int Value else insert Default Timeout conn return catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Sets the number of minutes it would take for a session to timeout param mins An int specifying the number of minutes throws Exception public void set Session Timeout Mins int mins throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Global Variables Value Name Timeout ps set Int mins int num Updated ps execute Update if num Updated no value in the table insert Default Timeout conn mins catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps private void insert Default Timeout Connection conn int mins throws Exception Prepared Statement ps null ps conn prepare Statement Global Variables Name Value Timeout ps set Int mins ps execute Update 
package edu ncsu csc itrust action import edu ncsu csc itrust Random Password import edu ncsu csc itrust beans Personnel Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Auth import edu ncsu csc itrust dao mysql Personnel import edu ncsu csc itrust enums Role import edu ncsu csc itrust exception Form Validation Exception import edu ncsu csc itrust exception i Trust Exception import edu ncsu csc itrust validate Add Personnel Validator Used for Add Personnel page add Personnel jsp This just adds an empty creates a random password for them Very similar to link Add Office Visit Action and link Add Patient Action author Andy Meneely public class Add Action private Personnel personnel private Auth auth Sets up the defaults for the class param factory factory for creating the defaults param logged In person currently logged in author Andy Meneely public Add Action Factory factory long logged In this personnel factory get Personnel this auth factory get Auth Adds the new user Event is logged param p bean containing the information for the new user return of the new user throws Form Validation Exception throws i Trust Exception public long add Personnel Bean p throws Form Validation Exception i Trust Exception new Add Personnel Validator validate p long new personnel add Empty Personnel Role p set new personnel edit Personnel p String pwd auth add User new Role Random Password get Random Password p set Password pwd return new 
package edu ncsu csc itrust action import edu ncsu csc itrust Random Password import edu ncsu csc itrust beans Patient Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Patient import edu ncsu csc itrust dao mysql Auth import edu ncsu csc itrust enums Role import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception Form Validation Exception import edu ncsu csc itrust validate Add Patient Validator Used for Add Patient page add Patient jsp This just adds an empty patient creates a random password for that patient Very similar to link Add Office Visit Action author Andy Meneely public class Add Patient Action private Patient patient private Auth auth private long logged In Just the factory and logged in param factory param logged In public Add Patient Action Factory factory long logged In this patient factory get Patient this logged In logged In this auth factory get Auth Creates a new patient returns the new Adds a new user to the table along with a random password return the new of the patient throws Exception throws Form Validation Exception public long add Patient Patient Bean p throws Exception Form Validation Exception new Add Patient Validator validate p long new patient add Empty Patient p set new String pwd auth add User new Role Random Password get Random Password p set Password pwd patient edit Patient p logged In return new 
package edu ncsu csc itrust validate import edu ncsu csc itrust action Add Patient Action import edu ncsu csc itrust beans Patient Bean import edu ncsu csc itrust exception Error List import edu ncsu csc itrust exception Form Validation Exception The validator used by link Add Patient Action Only checks first name last name and email author Andy public class Add Patient Validator extends Bean Validator Patient Bean The default constructor public Add Patient Validator Performs the act of validating the bean in question which varies depending on the type of validator If the validation does not succeed a link Form Validation Exception is thrown param p bean of the type to be validated Override public void validate Patient Bean p throws Form Validation Exception Error List error List new Error List error List add If Not Null check Format First name p get First Name Validation Format false error List add If Not Null check Format Last name p get Last Name Validation Format false error List add If Not Null check Format Email p get Email Validation Format false if error List has Errors throw new Form Validation Exception error List 
package edu ncsu csc itrust validate import edu ncsu csc itrust action Add Patient Action import edu ncsu csc itrust beans Personnel Bean import edu ncsu csc itrust exception Error List import edu ncsu csc itrust exception Form Validation Exception The validator used by link Add Patient Action Only checks first name last name and email author Andy public class Add Personnel Validator extends Bean Validator Personnel Bean The default constructor public Add Personnel Validator Performs the act of validating the bean in question which varies depending on the type of validator If the validation does not succeed a link Form Validation Exception is thrown param p bean of the type to be validated Override public void validate Personnel Bean p throws Form Validation Exception Error List error List new Error List error List add If Not Null check Format First name p get First Name Validation Format false error List add If Not Null check Format Last name p get Last Name Validation Format false error List add If Not Null check Format Email p get Email Validation Format false if error List has Errors throw new Form Validation Exception error List 
package edu ncsu csc itrust action import java util List import edu ncsu csc itrust beans Remote Monitoring Data Bean import edu ncsu csc itrust beans Telemedicine Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Auth import edu ncsu csc itrust dao mysql Remote Monitoring import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception Form Validation Exception import edu ncsu csc itrust exception i Trust Exception import edu ncsu csc itrust validate Remote Monitoring Data Bean Validator Handles adding remote monitoring patient data to the database public class Add Remote Monitoring Data Action private Remote Monitoring Data Bean Validator validator new Remote Monitoring Data Bean Validator private Remote Monitoring rm private Auth auth private long logged In private long patient Constructor param factory The Factory used to create the Os used in this action param logged In The of the person recording the patient s data param patient The of the patient public Add Remote Monitoring Data Action Factory factory long logged In long patient this logged In logged In this rm factory get Remote Monitoring this auth factory get Auth this patient patient public List Telemedicine Bean get Telemedicine Bean long patient throws Exception return rm get Telemedicine Bean patient Adds a patient s telemedicine data to the database param weight param pedometer Reading throws Exception public void add Remote Monitoring Data Remote Monitoring Data Bean rmd Bean throws Exception Form Validation Exception i Trust Exception validator validate rmd Bean String role if logged In patient role self reported else if auth get User Role logged In get User Roles String equals uap role case manager else role patient representative Store in rm store Patient Data patient rmd Bean role logged In returns the patient name return patient name throws Exception throws i Trust Exception public String get Patient Name long pid throws Exception i Trust Exception return auth get User Name pid 
package edu ncsu csc itrust action import edu ncsu csc itrust Random Password import edu ncsu csc itrust beans Personnel Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Auth import edu ncsu csc itrust dao mysql Personnel import edu ncsu csc itrust enums Role import edu ncsu csc itrust exception Form Validation Exception import edu ncsu csc itrust exception i Trust Exception import edu ncsu csc itrust validate Add Personnel Validator Used for Add Personnel page add Personnel jsp This just adds an empty creates a random password for them Very similar to link Add Office Visit Action and link Add Patient Action author Andy Meneely public class Add Action private Personnel personnel private Auth auth Sets up the defaults for the class param factory factory for creating the defaults param logged In person currently logged in author Andy Meneely public Add Action Factory factory long logged In this personnel factory get Personnel this auth factory get Auth Adds the new user Event is logged param p bean containing the information for the new user return of the new user throws Form Validation Exception throws i Trust Exception public long add Personnel Bean p throws Form Validation Exception i Trust Exception new Add Personnel Validator validate p long new personnel add Empty Personnel Role p set new personnel edit Personnel p String pwd auth add User new Role Random Password get Random Password p set Password pwd return new 
package edu ncsu csc itrust dao mysql import java sql Connection import java sql Prepared Statement import java sql Result Set import java sql Exception import java text Parse Exception import java text Simple Date Format import java util Date import java util List import edu ncsu csc itrust Util import edu ncsu csc itrust beans Adverse Event Bean import edu ncsu csc itrust beans loaders Adverse Event Bean Loader import edu ncsu csc itrust dao Factory import edu ncsu csc itrust exception Exception import java sql Timestamp Used for the logging mechanism stands for Database Access Object All Os are intended to be reflections of the database that is one per table in the database most of the time For more complex sets of queries extra Os are added Os can assume that all data has been validated and is correct Os should never have setters or any other parameter to the constructor than a factory All Os should be accessed by Factory see link Factory and every should have a factory for obtaining connections and or accessing other Os author Andy public class Adverse Event private Factory factory private Adverse Event Bean Loader ae Loader The typical constructor param factory The link Factory associated with this which is used for obtaining connections etc public Adverse Event Factory factory this factory factory this ae Loader new Adverse Event Bean Loader Gets all the adverse event reports for a certain user param mid The of the user to be looked up return java util List of Adverse Event Beans throws Exception throws Exception public List Adverse Event Bean get Reports For long mid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Adverse Events Patient ps set Long mid Result Set rs ps execute Query List Adverse Event Bean ae List this ae Loader load List rs return ae List catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Adds a message to the database param m Bean bean representing the message to be added throws Exception throws Exception public void add Report Adverse Event Bean ae Bean long hcpmid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Adverse Events Patient Pres Immu Code Comment Prescriber Status ps set String ae Bean get ps set String ae Bean get Drug ps set String ae Bean get Code ps set String ae Bean get Description ps set Long hcpmid ps set String Active ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps public long get int id throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Adverse Events id ps set Int id Result Set rs ps execute Query long hcp if rs next hcp rs get Long Prescriber return hcp catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps public Adverse Event Bean get Report int id throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Adverse Events id ps set Int id Result Set rs ps execute Query List Adverse Event Bean ae List ae Loader load List rs return ae List get catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps public long remove Report int id throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Adverse Events Status id String removed removed ps set String removed ps set Int id ps execute Update long a Util get Last Insert conn return a catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps public List Adverse Event Bean get Unremoved Adverse Events By Code String code throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement adverseevents code status ps set String code ps set String Active Result Set rs rs ps execute Query return ae Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps public String get Name For Code String code throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Pres Immu adverseevents code ps set String code Result Set rs rs ps execute Query if rs next return rs get String Pres Immu return Name not Found catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps public List Adverse Event Bean get Perscriptions String start String end throws Parse Exception Exception Connection conn null Prepared Statement ps null try Simple Date Format fmt new Simple Date Format dd yyy Date beginning fmt parse start Date ending fmt parse end conn factory get Connection Codes Code Adverse Events Code ps conn prepare Statement Adverse Events Codes Adverse Events Time Logged Adverse Events Time Logged Codes Code Adverse Events Code Adverse Events Code Adverse Events Time Logged ps set Timestamp new Timestamp beginning get Time ps set Timestamp new Timestamp ending get Time Result Set rs ps execute Query List Adverse Event Bean ae List ae Loader load List rs return ae List catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps public List Adverse Event Bean get Immunizations String start String end throws Parse Exception Exception Connection conn null Prepared Statement ps null try Simple Date Format fmt new Simple Date Format dd yyy Date beginning fmt parse start Date ending fmt parse end conn factory get Connection Codes Code Adverse Events Code ps conn prepare Statement Adverse Events Codes Adverse Events Time Logged Adverse Events Time Logged Codes Code Adverse Events Code Adverse Events Code Adverse Events Time Logged ps set Timestamp new Timestamp beginning get Time ps set Timestamp new Timestamp ending get Time Result Set rs ps execute Query List Adverse Event Bean ae List ae Loader load List rs return ae List catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps 
package edu ncsu csc itrust dao mysql import java sql Connection import java sql Prepared Statement import java sql Result Set import java sql Exception import java util List import edu ncsu csc itrust Util import edu ncsu csc itrust beans Allergy Bean import edu ncsu csc itrust beans loaders Allergy Bean Loader import edu ncsu csc itrust dao Factory import edu ncsu csc itrust exception Exception stands for Database Access Object All Os are intended to be reflections of the database that is one per table in the database most of the time For more complex sets of queries extra Os are added Os can assume that all data has been validated and is correct Os should never have setters or any other parameter to the constructor than a factory All Os should be accessed by Factory see link Factory and every should have a factory for obtaining connections and or accessing other Os author Andy public class Allergy private Factory factory private Allergy Bean Loader allergy Bean Loader new Allergy Bean Loader The typical constructor param factory The link Factory associated with this which is used for obtaining connections etc public Allergy Factory factory this factory factory Returns a list of patient s allergies param pid long for the of the patient we are looking up return java util List of Allergy Beans associated with this patient throws Exception public List Allergy Bean get Allergies long pid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Allergies Patient First Found ps set Long pid Result Set rs ps execute Query return allergy Bean Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Adds an allergy to this patient s list param pid The of the patient whose allergy we are adding param description The name of the allergen throws Exception public void add Allergy long pid String description throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Allergies Patient Description ps set Long pid ps set String description ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps 
taglib prefix itrust uri tags tld page error Page auth exception Handler jsp page import edu ncsu csc itrust beans Personnel Bean page import edu ncsu csc itrust Bean Builder page import edu ncsu csc itrust exception Form Validation Exception page import edu ncsu csc itrust action Add Action page import edu ncsu csc itrust enums Role include file global jsp page Title i Trust Add include file header jsp boolean form Is Filled request get Parameter form Is Filled null request get Parameter form Is Filled equals true if form Is Filled This page is not actually a page it just adds a user and forwards Personnel Bean p new Bean Builder Personnel Bean build request get Parameter Map new Personnel Bean p set Role Role try long new new Add Action prod logged In long Value add p session set Attribute mid Long to String new String fullname String password password p get Password fullname p get Full Name logging Action log Event Transaction Type logged In long Value new div align center span class i Trust Message New String Escape Utils escape Html fullname successfully added span br br table class f Table tr th colspan New Information th tr tr td class sub Header Vertical td td String Escape Utils escape Html new td tr tr td class sub Header Vertical Temporary Password td td String Escape Utils escape Html password td tr table br Please get this information to b String Escape Utils escape Html fullname b p a href i Trust auth staff edit Personnel jsp Continue to personnel information a p div catch Form Validation Exception e div align center span class i Trust Error String Escape Utils escape Html e get Message span div div align center p style width text align left Please enter in the name of the new with a valid email address If the user does not have an email address use the hospital s email address insert pre defined email to recover the password p form action add jsp method post input type hidden name form Is Filled value true br table class f Table tr th colspan Information th tr tr td class sub Header Vertical First name td td input type text name first Name td tr tr td class sub Header Vertical Last Name td td input type text name last Name tr tr td class sub Header Vertical Email td td input type text name email td tr td class sub Header Vertical Specialty td td select name specialty option value general physician General Physician option option value heart surgeon Heart Surgeon option option value ob gyn option option value pediatrician Pediatrician option option value surgeon Surgeon option tr table br input type submit style font size pt font weight bold value Add personnel br form div include file footer jsp 
page error Page auth exception Handler jsp page import edu ncsu csc itrust dao Factory page import edu ncsu csc itrust beans Procedure Bean page import edu ncsu csc itrust action Update Code List Action page import edu ncsu csc itrust exception Form Validation Exception page import edu ncsu csc itrust Html Encoder page import java net Encoder page import java util List include file global jsp page Title i Trust Maintain Codes include file header jsp String header Message Viewing Current Procedure Codes Update Code List Action cpt Updater new Update Code List Action prod logged In long Value String attribute null if request get Parameter add null request get Parameter update null try if null request get Parameter attribute attribute new String immunization Procedure Bean proc new Procedure Bean request get Parameter code request get Parameter description attribute header Message request get Parameter add null cpt Updater add Code proc cpt Updater update Information proc if header Message contains Error if null request get Parameter attribute if request get Parameter add null logging Action log Event Transaction Type logged In request get Parameter code else logging Action log Event Transaction Type logged In request get Parameter code else if request get Parameter add null logging Action log Event Transaction Type logged In request get Parameter code else if request get Parameter update null logging Action log Event Transaction Type logged In request get Parameter code catch Form Validation Exception e div align center span class i Trust Error String Escape Utils escape Html e get Message span div header Message Validation Errors else logging Action log Event Transaction Type logged In logging Action log Event Transaction Type logged In String header Color header Message index Of Error ffcccc script type text javascript function fill Update code document get Element By Id code value code document get Element By Id description value unescape document get Element By Id code value document get Element By Id old Descrip value unescape document get Element By Id code value if immunization document get Element By Id code value document get Element By Id attribute checked checked else document get Element By Id attribute checked script div align center br span class i Trust Message String Escape Utils escape Html header Message span br br form name main Form action edit Procedure Codes jsp method post input type hidden id update name update value input type hidden id old Descrip name old Descrip value table class f Table align center tr td colspan Update Procedure Code List td tr tr class sub Header td Code td td Description td td Immunization td tr tr td input type text name code id code size maxlength td td input type text name description id description size maxlength td td input type checkbox name attribute id attribute value yes td tr table input type submit name add value Add Code input type submit name update value Update Code br br table class f Table align center tr th colspan Current Procedure Codes th tr tr class sub Header td Code td td Description td td Immunization td tr List Procedure Bean code List prod get Codes get All Codes String temp Code String temp Descrip String escaped Descrip String temp Class for Procedure Bean code Entry code List temp Code code Entry get Code temp Descrip code Entry get Description temp Class code Entry get Attribute escaped Descrip Encoder encode temp Descrip replace All tr td String Escape Utils escape Html temp Code td td a href javascript void onclick fill Update temp Code Html Encoder encode temp Descrip a input type hidden id String Escape Utils escape Html temp Code name String Escape Utils escape Html temp Code value escaped Descrip input type hidden id String Escape Utils escape Html temp Code name String Escape Utils escape Html temp Code value temp Class td td String Escape Utils escape Html immunization equals code Entry get Attribute Yes No td tr table form div br include file footer jsp 
page import java net Encoder page import java util List page import edu ncsu csc itrust dao Factory page import edu ncsu csc itrust beans Diagnosis Bean page import edu ncsu csc itrust action Update Code List Action page import edu ncsu csc itrust exception Form Validation Exception page error Page auth exception Handler jsp include file global jsp page Title i Trust Maintain Codes include file header jsp String header Message Viewing Current Codes Update Code List Action icd Updater new Update Code List Action prod logged In long Value if request get Parameter add null request get Parameter update null try Diagnosis Bean diag new Diagnosis Bean request get Parameter code request get Parameter description request get Parameter classification header Message request get Parameter add null icd Updater add Code diag icd Updater update Information diag if header Message contains Error if request get Parameter add null logging Action log Event Transaction Type logged In request get Parameter code else if request get Parameter update null logging Action log Event Transaction Type logged In request get Parameter code catch Form Validation Exception e div align center span class i Trust Error String Escape Utils escape Html e get Message span div header Message Validation Errors else logging Action log Event Transaction Type logged In String header Color header Message index Of Error ffcccc div align center form name main Form method post input type hidden id update name update value input type hidden id old Descrip name old Descrip value script type text javascript function fill Update code document get Element By Id code value code document get Element By Id description value unescape document get Element By Id code value if yes document get Element By Id code value document get Element By Id classification checked checked else document get Element By Id classification checked script br span class i Trust Message String Escape Utils escape Html header Message span br br table class f Table align center tr th colspan Update Code List th tr tr class sub Header th Code th th Chronic th th Description th tr tr td input type text name code id code size maxlength td td input type checkbox name classification id classification value yes td td input type text name description id description size maxlength td tr table br input type submit name add value Add Code input type submit name update value Update Code br br table class f Table align center tr th colspan Current Codes th tr tr class sub Header th Code th th Chronic th th Description th tr List Diagnosis Bean code List prod get Codes get All Codes String temp Code String temp Descrip String temp Class String escaped Descrip for Diagnosis Bean code Entry code List temp Code code Entry get Code temp Descrip code Entry get Description temp Class code Entry get Classification escaped Descrip Encoder encode temp Descrip replace All tr td align center String Escape Utils escape Html temp Code td td align center String Escape Utils escape Html temp Class td td align center a href javascript void onclick fill Update String Escape Utils escape Html temp Code String Escape Utils escape Html temp Descrip a input type hidden id String Escape Utils escape Html temp Code name String Escape Utils escape Html temp Code value escaped Descrip input type hidden id String Escape Utils escape Html temp Code name String Escape Utils escape Html temp Code value temp Class td tr table form div br include file footer jsp 
page error Page auth exception Handler jsp page import java util List page import edu ncsu csc itrust dao Factory page import edu ncsu csc itrust beans Cbean page import edu ncsu csc itrust action Update Lab Proc List Action page import edu ncsu csc itrust action Update List Action page import edu ncsu csc itrust exception Form Validation Exception include file global jsp page Title i Trust Maintain Codes include file header jsp String header Message Viewing Current Codes Update Lab Proc List Action icd Updater new Update Lab Proc List Action prod logged In long Value Update List Action icd Updater new Update List Action prod logged In long Value if request get Parameter add null request get Parameter update null try Cbean diag new Cbean diag set Lab Procedure Code request get Parameter code diag set Component request get Parameter comp diag set Kind Of Property request get Parameter kop diag set Time Aspect request get Parameter time diag set System request get Parameter system diag set Scale Type request get Parameter scale diag set Method Type request get Parameter method header Message request get Parameter add null icd Updater add diag icd Updater update Information diag if header Message contains Error if request get Parameter add null logging Action log Event Transaction Type logged In request get Parameter code else if request get Parameter update null logging Action log Event Transaction Type logged In request get Parameter code catch Form Validation Exception e div align center span class i Trust Error String Escape Utils escape Html e get Message span div header Message Validation Errors else logging Action log Event Transaction Type logged In String header Color header Message index Of Error ffcccc div align center form name main Form method post input type hidden id update name update value input type hidden id old Descrip name old Descrip value script type text javascript function fill Update comp document get Element By Id code value comp function fill Update comp document get Element By Id comp value comp function fill Update comp document get Element By Id kop value comp function fill Update comp document get Element By Id time value comp function fill Update comp document get Element By Id system value comp function fill Update comp document get Element By Id scale value comp function fill Update comp document get Element By Id method value comp script br span class i Trust Message String Escape Utils escape Html header Message span br br table class f Table align center tr th colspan Update Code List th tr tr class sub Header th colspan Code th tr tr td align center colspan input type text name code id code size maxlength td tr tr class sub Header th Component th th Kind Of Property th th Time Aspect th tr tr td input type text name comp id comp size maxlength td td input type text name kop id kop size maxlength td td input type text name time id time size maxlength td tr tr class sub Header th System th th Scale Type th th Method Type th tr tr td input type text name system id system size maxlength td td input type text name scale id scale size maxlength td td input type text name method id method size maxlength td tr table span style font size px When updating please enter original information in fields you do not want to change span br br input type submit name add value Add Code input type submit name update value Update Code br br table class f Table align center tr th colspan Current Codes th tr tr class sub Header td Code td td Component td td Kind Of Property td td Time Aspect td td System td td Scale Type td td Method Type td tr List Cbean code List prod get get All String temp Code String tempcomp String tempkop String temptime String tempsystem String tempscale String tempmethod for Cbean code Entry code List temp Code code Entry get Lab Procedure Code tempcomp code Entry get Component tempkop code Entry get Kind Of Property temptime code Entry get Time Aspect tempsystem code Entry get System tempscale code Entry get Scale Type tempmethod code Entry get Method Type tr td a href javascript void onclick fill Update String Escape Utils escape Html temp Code String Escape Utils escape Html temp Code a td a href javascript void onclick fill Update String Escape Utils escape Html tempcomp String Escape Utils escape Html tempcomp a td a href javascript void onclick fill Update String Escape Utils escape Html tempkop String Escape Utils escape Html tempkop a td a href javascript void onclick fill Update String Escape Utils escape Html temptime String Escape Utils escape Html temptime a td a href javascript void onclick fill Update String Escape Utils escape Html tempsystem String Escape Utils escape Html tempsystem a td nowrap a href javascript void onclick fill Update String Escape Utils escape Html tempscale String Escape Utils escape Html tempscale a td nowrap a href javascript void onclick fill Update String Escape Utils escape Html tempmethod String Escape Utils escape Html tempmethod a tr table form div br include file footer jsp 
page import java net Encoder page import java net Decoder page import java util List page import edu ncsu csc itrust action Drug Interaction Action page import edu ncsu csc itrust exception i Trust Exception page import edu ncsu csc itrust exception Form Validation Exception page import edu ncsu csc itrust beans Medication Bean include file global jsp page Title i Trust Edit Code Interactions include file header jsp String header Message Select Codes with Interaction String drug String drug if request get Parameter drug null request get Parameter drug null drug request get Parameter drug split s drug drug replace drug request get Parameter drug split s drug drug replace if request get Parameter add null try Drug Interaction Action interaction new Drug Interaction Action prod logged In long Value header Message interaction report Interaction drug drug request get Parameter description if header Message equals Interaction recorded successfully logging Action log Event Transaction Type logged In n Drug drug n Drug drug catch i Trust Exception e div align center span class i Trust Error String Escape Utils escape Html e get Message span div catch Form Validation Exception e div align center span class i Trust Error String Escape Utils escape Html e get Message span div String header Color header Message index Of Error ffcccc br div align center form name main Form method post span class i Trust Message String Escape Utils escape Html header Message span br br table cellpadding tr td select name drug List Medication Bean med List prod get Codes get All Codes String temp Code String temp Descrip String escaped Descrip for Medication Bean med Entry med List temp Code med Entry get Code temp Descrip med Entry get Description escaped Descrip Encoder encode temp Descrip replace All option temp Code length temp Code temp Code substring temp Code length temp Code substring String Escape Utils escape Html temp Descrip option select td td select name drug for Medication Bean med Entry med List temp Code med Entry get Code temp Descrip med Entry get Description escaped Descrip Encoder encode temp Descrip replace All option temp Code length temp Code temp Code substring temp Code length temp Code substring String Escape Utils escape Html temp Descrip option select td tr table b Description b input type text id description name description size maxlength br br input type submit name add value Add Interaction input type button onclick location href i Trust auth admin edit Codes jsp value Back name back id back form div br include file footer jsp 
page import java net Encoder page import java net Decoder page import java util List page import edu ncsu csc itrust beans Medication Bean page import edu ncsu csc itrust beans Drug Interaction Bean page import edu ncsu csc itrust action Update Code List Action page import edu ncsu csc itrust action Drug Interaction Action page import edu ncsu csc itrust exception Form Validation Exception page import edu ncsu csc itrust exception i Trust Exception include file global jsp page Title i Trust Maintain Codes include file header jsp Update Code List Action nd Updater new Update Code List Action prod logged In long Value Drug Interaction Action interaction Action new Drug Interaction Action prod logged In long Value String header Message Viewing Current Codes String code request get Parameter code null request get Parameter code trim String code request get Parameter code null request get Parameter code trim String code code code if request get Parameter add null request get Parameter update null request get Parameter delete null request get Parameter delete null request get Parameter import null try if request get Parameter add null request get Parameter update null Medication Bean med new Medication Bean code request get Parameter description header Message request get Parameter add null nd Updater add Code med nd Updater update Information med if header Message contains Error if request get Parameter add null logging Action log Event Transaction Type logged In code else if request get Parameter update null logging Action log Event Transaction Type logged In code else if request get Parameter delete null was code To Delete interaction Action delete Interaction code request get Parameter code To Delete trim header Message Interaction deleted successfully logging Action log Event Transaction Type logged In n Drug code n Drug request get Parameter code To Delete else if request get Parameter delete null Medication Bean med new Medication Bean code request get Parameter description header Message request get Parameter delete null nd Updater remove Code med nd Updater update Information med if header Message contains Error if request get Parameter delete null logging Action log Event Transaction Type logged In code else if request get Parameter import null response send Redirect import Codes jsp forward edit Codes jsp else header Message Interaction does not exist catch Form Validation Exception e div align center span class i Trust Error String Escape Utils escape Html e get Message span div header Message Validation Errors catch i Trust Exception e div align center span class i Trust Error String Escape Utils escape Html e get Message span div header Message Validation Errors else logging Action log Event Transaction Type logged In String header Color header Message index Of Error ffcccc br div align center form name main Form method post input type hidden id code To Delete name code To Delete value input type hidden id update name update value input type hidden id old Descrip name old Descrip value script type text javascript function fill Update code document get Element By Id code value code substring document get Element By Id code value code substring document get Element By Id description value unescape document get Element By Id code value document get Element By Id old Descrip value unescape document get Element By Id code value document get Element By Id interactions inner document get Element By Id int Desc inner drugs document get Element By Id code value split n descs document get Element By Id code value split n for d in drugs if d drugs length break int Link document create Element a int Link href javascript void int Link id drug Interaction d if d add Int Desc drugs d descs d if document all int Link attach Event onclick add Int Desc Strip newline off end of drug code drugs d drugs d substring drugs d length else int Link set Attribute onclick add Int Desc drugs d descs d var int Text drugs d if document get Element By Id int Text value document get Element By Id int Text value undefined int Text int Text unescape document get Element By Id drugs d value int Text int Text substring int Text substring int Link Text document create Text Node int Text int Link append Child int Link Text document get Element By Id interactions append Child int Link document get Element By Id interactions append Child document create Element br document get Element By Id interactions append Child document create Element br document get Element By Id interactions append Child document create Element br if drugs length document get Element By Id interactions inner No Interactions if document get Element By Id delete style null document get Element By Id delete style visibility hidden document get Element By Id int Desc style visibility hidden function add Int Desc link event src Element id link link substring Get number after drug Interaction link Number eval link add Int Desc drugs link Number descs link Number function add Int Desc code desc document get Element By Id int Desc inner desc document get Element By Id delete style visibility document get Element By Id int Desc style visibility document get Element By Id code To Delete value code script span class i Trust Message String Escape Utils escape Html header Message span br br table class f Table align left tr th colspan Current Drug Codes th tr tr class sub Header th Code th th Description th tr List Medication Bean med List prod get Codes get All Codes List Drug Interaction Bean interaction List String temp Code String temp Descrip String escaped Descrip String int Drugs String String int Descs String for Medication Bean med Entry med List temp Code med Entry get Code temp Descrip med Entry get Description escaped Descrip Encoder encode temp Descrip replace All interaction List interaction Action get Interactions temp Code int Drugs String int Descs String for Drug Interaction Bean b interaction List if temp Code equals b get First Drug int Drugs String b get Second Drug n if temp Code equals b get Second Drug int Drugs String b get First Drug n int Descs String b get Description n int Drugs String Encoder encode int Drugs String replace All int Descs String Encoder encode int Descs String replace All tr td temp Code length temp Code temp Code substring temp Code length temp Code substring td td a href javascript void onclick fill Update String Escape Utils escape Html temp Code String Escape Utils escape Html temp Descrip a input type hidden id String Escape Utils escape Html temp Code name String Escape Utils escape Html temp Code value String Escape Utils escape Html escaped Descrip input type hidden id String Escape Utils escape Html temp Code name String Escape Utils escape Html temp Code value String Escape Utils escape Html int Drugs String input type hidden id String Escape Utils escape Html temp Code name String Escape Utils escape Html temp Code value String Escape Utils escape Html int Descs String td tr table table class f Table align center width tr th colspan Update or Add Code th tr tr class sub Header th Code th th Description th tr tr td style padding right px input type text id code name code size maxlength input type text id code name code size maxlength td td input type text id description name description size maxlength td tr tr class sub Header th Interaction th th Description th tr tr td style padding right px vertical align top id interactions No Interactions td td div id int Desc style height px width px overflow y scroll visibility hidden div td tr tr td input type button id edit Int name edit Int value Add Interaction onclick location href edit Interactions jsp td td input type submit value Delete Interaction name delete id delete style visibility hidden td tr table br div style padding left px input type submit name add value Add Drug input type submit name update value Update Drug input type submit name delete value Delete Drug input type submit name import id import value Import Drugs div form br br div br include file footer jsp 
page error Page auth exception Handler jsp page import java net Encoder page import java util List page import edu ncsu csc itrust page import edu ncsu csc itrust dao Factory page import edu ncsu csc itrust beans Hospital Bean page import edu ncsu csc itrust action Update Hospital List Action page import edu ncsu csc itrust exception Form Validation Exception include file global jsp page Title i Trust Maintain Hospital Listing and Assignments include file header jsp String header Message Current Hospital Listing Update Hospital List Action hosp Updater new Update Hospital List Action Factory get Production Instance logged In if request get Parameter add null request get Parameter update null Hospital Bean hosp new Bean Builder Hospital Bean build request get Parameter Map new Hospital Bean try header Message request get Parameter add null hosp Updater add Hospital hosp hosp Updater update Information hosp if header Message contains Error if request get Parameter add null logging Action log Event Transaction Type logged In hosp get Hospital if request get Parameter update null logging Action log Event Transaction Type logged In hosp get Hospital catch Form Validation Exception e div align center span class i Trust Error String Escape Utils escape Html e get Message span div header Message Validation Errors else logging Action log Event Transaction Type logged In String header Color header Message index Of Error ffcccc div align center form name main Form method post input type hidden id update name update value input type hidden id old Name name old Name value script type text javascript function fill Update id document get Element By Id hospital value id document get Element By Id hospital Name value unescape document get Element By Id id value document get Element By Id old Descrip value unescape document get Element By Id id value script h Hospital Listing h span class i Trust Message String Escape Utils escape Html header Message span br br table class f Table align center tr th colspan Update Hospital List th tr tr class sub Header th Hospital th th Hospital Name th tr tr td input type text name hospital id hospital size maxlength td td input type text name hospital Name id hospital Name size maxlength td tr table br input type submit name add value Add Hospital input type submit name update value Update Hospital Information br br table class f Table align center tr th colspan Current Hospitals th tr tr class sub Header th Hospital th th Hospital Name th tr List Hospital Bean hosp List Factory get Production Instance get Hospitals get All Hospitals String temp String temp Name String escaped Name for Hospital Bean hosp Entry hosp List temp hosp Entry get Hospital temp Name hosp Entry get Hospital Name escaped Name Encoder encode temp Name replace All tr td String Escape Utils escape Html temp td td a href javascript void onclick fill Update String Escape Utils escape Html temp String Escape Utils escape Html temp Name a input type hidden id String Escape Utils escape Html temp name String Escape Utils escape Html temp value String Escape Utils escape Html escaped Name td tr table form div br include file footer jsp 
page import edu ncsu csc itrust action Change Session Timeout Action page error Page auth exception Handler jsp page import edu ncsu csc itrust exception Form Validation Exception include file global jsp page Title i Trust Change Session Timeout include file header jsp Change Session Timeout Action action new Change Session Timeout Action prod if true equals request get Parameter form Is Filled try action change Session Timeout request get Parameter minutes span Session Timeout Changed Changes will take place on re authentication span catch Form Validation Exception e e print page Context get Out br br form action session Timeout jsp method post input type hidden name form Is Filled value true Change the timeout to input name minutes value String Escape Utils escape Html action get Session Timeout size minutes minimum br br input type submit value Change form br br The global session timeout is the interval of time that an account can remain inactive without having to re authenticate br br include file footer jsp 
include file global jsp page import java util List page import edu ncsu csc itrust action Search Users Action page import edu ncsu csc itrust beans Patient Bean page Title i Trust Please Select a Patient include file header jsp String uid pid request get Parameter session set Attribute pid uid pid if null uid pid equals uid pid response send Redirect request get Parameter forward String first Name request get Parameter String last Name request get Parameter if first Name null first Name if last Name null last Name include file util get User Frame jsp form id main Form action get Patient jsp method post table tr td b Patient b td td style width px border px solid Gray input name forward type hidden value String Escape Utils escape Html request get Parameter forward input name type hidden value input name type text readonly value Select a Patient td td input type button onclick get User value Find User td tr tr td align center colspan input type submit id select Patient Button value Select Patient td tr table form br table tr tr form id user Search Form action get Patient jsp forward String Escape Utils escape Html request get Parameter forward method post tr td b First Name b td td style width px border px solid Gray input name type text value String Escape Utils escape Html first Name td td b Last Name b td td style width px border px solid Gray input name type text value String Escape Utils escape Html last Name td td align center colspan input type submit value User Search td tr form table div id User Search if equals first Name equals last Name Search Users Action search Action new Search Users Action prod logged In long Value out println Searching for users named String Escape Utils escape Html first Name String Escape Utils escape Html last Name br List Patient Bean patients search Action search For Patients With Name first Name last Name span class search Results Found String Escape Utils escape Html patients size Records span table class fancy Table style width tr th width td th width First Name td th width Last Name td tr int index for Patient Bean p patients form id select Patient String Escape Utils escape Html String value Of patients size action get Patient jsp forward String Escape Utils escape Html request get Parameter forward method post input type hidden name value String Escape Utils escape Html p get tr index class alt td input type submit width value String Escape Utils escape Html p get td td String Escape Utils escape Html p get First Name td td String Escape Utils escape Html p get Last Name td tr form index table div include file footer jsp 
page import edu ncsu csc itrust beans Medication Bean taglib prefix itrust uri tags tld page error Page auth exception Handler jsp page import edu ncsu csc itrust dao Factory page import edu ncsu csc itrust beans Diagnosis Bean page import edu ncsu csc itrust action Emergency Report Action page import org apache commons lang String Escape Utils page import edu ncsu csc itrust beans Prescription Bean page import edu ncsu csc itrust beans Allergy Bean page import edu ncsu csc itrust beans Procedure Bean page import edu ncsu csc itrust dao mysql Report Request page import edu ncsu csc itrust beans Patient Bean page import edu ncsu csc itrust dao mysql Patient page import edu ncsu csc itrust dao mysql Personnel page import edu ncsu csc itrust beans Personnel Bean page import edu ncsu csc itrust beans Email page import edu ncsu csc itrust Email Util page import java util List page import java util Array List page import java util Date page import java lang Number Format Exception page import java lang Integer page import edu ncsu csc itrust beans Medication Bean include file global jsp page Title i Trust Report String pid String null boolean print null request get Parameter print request get Parameter print equals true if print Require a Patient first pid String String session get Attribute pid if null pid String pid String length response send Redirect i Trust auth get Patient jsp forward hcp er emergency Report jsp return else session set Attribute print Pid pid String else pid String String session get Attribute print Pid if null pid String pid String length response send Redirect i Trust auth get Patient jsp forward hcp er emergency Report jsp return session remove Attribute print Pid If the patient id does n t check out then kick em out to the exception handler Emergency Report Action action new Emergency Report Action prod logged In long Value pid String Now take care of updating information if print include file print header jsp else include file header jsp if print Generate a report to the hcp s of this patient possibly change this to use messages and a different display format on hcp s home screen Report Request make Report new Report Request prod Patient patients new Patient prod Patient Bean patient patients get Patient action get Pid Personnel hcps new Personnel prod List Personnel Bean peeps hcps get All Personnel List String emails new Array List String for Personnel Bean p peeps if patients check Declared patient get p get make Report add Report Request p get patient get new Date emails add p get Email Email my Email new Email my Email set Body Patient patient get Full Name s medical record was viewed by an my Email set Subject Patient records viewed my Email set To List emails my Email set From noreply itrust com Email Util emailer new Email Util prod emailer send Email my Email logging Action log Event Transaction Type logged In Long parse Long pid String form action emergency Report jsp method post input type hidden name print id print value true input type submit value Print form ul li Name String Escape Utils escape Html action get Patient Name li li Age String Escape Utils escape Html action get Patient Age li li Gender String Escape Utils escape Html action get Patient Gender li li Emergency Contact String Escape Utils escape Html action get Patient Emergency Contact li li Allergies if action get Allergies size strong No allergies on record strong else ul for Allergy Bean bean action get Allergies String bean Desc Medication Bean Cbean prod get Codes get Code bean get Description if Cbean null bean Desc bean get Description else bean Desc Cbean get Description out print li String Escape Utils escape Html bean Desc String Escape Utils escape Html bean get First Found Str li ul li li Blood Type String Escape Utils escape Html action get Blood Type li li Diagnoses if action get Warning Diagnoses size strong No critical diagnoses on record strong else ul for Diagnosis Bean bean action get Warning Diagnoses out print li String Escape Utils escape Html bean get Code String Escape Utils escape Html bean get Description li ul li li Prescriptions if action get Current Prescriptions size strong No current prescriptions on record strong else ul for Prescription Bean bean action get Current Prescriptions out print li String Escape Utils escape Html bean get Medication get Code String Escape Utils escape Html bean get Medication get Description li ul li li Immunizations if action get Immunizations size strong no immunizations on record strong else ul for Procedure Bean bean action get Immunizations if null bean get Attribute bean get Attribute equals immunization out print li String Escape Utils escape Html bean get Description String Escape Utils escape Html bean get Code li ul li include file footer jsp 
taglib prefix itrust uri tags tld page error Page auth exception Handler jsp page import edu ncsu csc itrust action Add Patient Action page import edu ncsu csc itrust Bean Builder page import edu ncsu csc itrust beans Patient Bean page import edu ncsu csc itrust exception Form Validation Exception page import jsp Stub Stub auth hcp Uap add Patient include file global jsp page Title i Trust Add Patient include file header jsp Stub auth hcp Uap add Patient saha new Stub auth hcp Uap add Patient saha enteradd Patient boolean form Is Filled request get Parameter form Is Filled null request get Parameter form Is Filled equals true if form Is Filled This page is not actually a page it just adds a user and forwards Patient Bean p new Bean Builder Patient Bean build request get Parameter Map new Patient Bean try long new new Add Patient Action prod logged In long Value add Patient p session set Attribute pid Long to String new String fullname String password password p get Password fullname p get Full Name logging Action log Event Transaction Type logged In long Value new saha exitadd Patient div align center span class i Trust Message New patient String Escape Utils escape Html fullname successfully added span br table class f Table tr th colspan New Patient Information th tr tr td class sub Header Vertical td td String Escape Utils escape Html new td tr tr td class sub Header Vertical Temporary Password td td String Escape Utils escape Html password td tr table br Please get this information to b String Escape Utils escape Html fullname b p a href i Trust auth hcp uap edit Patient jsp Continue to patient information a p div catch Form Validation Exception e div align center span class i Trust Error String Escape Utils escape Html e get Message span div saha exitadd Patient div align center form action add Patient jsp method post input type hidden name form Is Filled value true br br div style width text align left Please enter in the name of the new patient with a valid email address If the user does not have an email address use the hospital s email address insert pre defined email to recover the password div br br table class f Table tr th colspan Patient Information th tr tr td class sub Header Vertical First name td td input type text name first Name td tr tr td class sub Header Vertical Last Name td td input type text name last Name tr tr td class sub Header Vertical Email td td input type text name email td tr table br input type submit style font size pt font weight bold value Add patient form br div include file footer jsp 
taglib uri tags tld prefix itrust page error Page auth exception Handler jsp page import java util List page import edu ncsu csc itrust action Chronic Disease Risk Action page import edu ncsu csc itrust risk Risk Checker page import edu ncsu csc itrust risk factors Patient Risk Factor include file global jsp page Title i Trust Risk Factors for Chronic Diseases include file header jsp itrust patient Nav this Title Risk Factors try Require a Patient first String pid String String session get Attribute pid if pid String null pid String length response send Redirect i Trust auth get Patient jsp forward hcp uap chronic Disease Risks jsp return else session remove Attribute pid Chronic Disease Risk Action action new Chronic Disease Risk Action prod logged In long Value pid String long pid action get Patient br table class f Table align center tr th colspan Disease Risk Factors th tr List Risk Checker diseases action get Diseases At Risk logging Action log Event Transaction Type logged In pid if diseases size for Risk Checker disease diseases tr td colspan class sub Header Vertical String Escape Utils escape Html disease get Name td tr tr td style padding left px List Patient Risk Factor factors disease get Patient Risk Factors for Patient Risk Factor factor factors String Escape Utils escape Html factor get Description br td tr catch Exception e tr td colspan align center No Data td tr table br br br itrust patient Nav this Title Risk Factors include file footer jsp 
taglib uri tags tld prefix itrust page error Page auth exception Handler jsp page import java util List page import java text Decimal Format page import edu ncsu csc itrust dao Factory page import edu ncsu csc itrust action Edit Health History Action page import edu ncsu csc itrust beans Health Record page import edu ncsu csc itrust Bean Builder page import edu ncsu csc itrust beans forms Health Record Form page import edu ncsu csc itrust exception Form Validation Exception page import edu ncsu csc itrust beans Personnel Bean page import edu ncsu csc itrust dao mysql Personnel include file global jsp page Title i Trust Edit Basic Health Record include file header jsp itrust patient Nav this Title Basic Health History Require a Patient first String pid String String session get Attribute pid if pid String null pid String length response send Redirect i Trust auth get Patient jsp forward hcp uap edit Basic Health jsp return else session remove Attribute pid Edit Health History Action action new Edit Health History Action prod logged In long Value pid String long pid action get Pid String patient Name action get Patient Name String confirm if true equals request get Parameter form Is Filled try confirm action add Health Record pid new Bean Builder Health Record Form build request get Parameter Map new Health Record Form logging Action log Event Transaction Type logged In long Value pid catch Form Validation Exception e div align center span class i Trust Error e print page Context get Out span div br List Health Record records action get All Health Records pid Health Record most Recent records size records get new Health Record for the default values script type text javascript function show Add Row document get Element By Id add Row style display inline document get Element By Id add Row Button style display none document forms height focus script if equals confirm div align center span class i Trust Message String Escape Utils escape Html confirm span div else logging Action log Event Transaction Type logged In long Value pid br div align center table align center class f Table tr th colspan Basic Health History th tr tr class sub Header td Height br a href i Trust auth hcp uap health Data Chart jsp data Type Height id view Height Chart View Chart a td td Weight br a href i Trust auth hcp uap health Data Chart jsp data Type Weight id view Weight Chart View Chart a td td br a href i Trust auth hcp uap health Data Chart jsp data Type id view Bmi Chart View Chart a td td Smokes td td Blood Pressure td td td td td td Triglycerides td td Total Cholesterol td td Last Recorded td td By Personnel td tr weight in pounds height in inches height in inches for Health Record hr records Decimal Format df new Decimal Format String bmi String Invalid height value of if hr get Height bmi String df format hr get Weight hr get Height hr get Height tr td align center String Escape Utils escape Html hr get Height in td td align center String Escape Utils escape Html hr get Weight lbs td td align center String Escape Utils escape Html bmi String td td align center String Escape Utils escape Html hr is Smoker td td align center String Escape Utils escape Html hr get Blood Pressure mm Hg td td align center String Escape Utils escape Html hr get Cholesterol mg d td td align center String Escape Utils escape Html hr get Cholesterol mg d td td align center String Escape Utils escape Html hr get Cholesterol Tri mg d td td align center String Escape Utils escape Html hr get Total Cholesterol mg d td td align center String Escape Utils escape Html hr get Date Recorded td Personnel Bean p prod get Personnel get Personnel hr get Personnel td align center String Escape Utils escape Html p get Full Name td tr table br a href javascript show Add Row id add Row Button style text decoration none input id add Row Button type button value Add Record on Click show Add Row a div br div id add Row style display none align center form action edit Basic Health jsp id edit Health name edit Health method post input type hidden name form Is Filled value true table class f Table align center tr th colspan style background color silver Record Information th tr tr td class sub Header Height in td td input name height value String Escape Utils escape Html most Recent get Height style width px type text maxlength td tr tr td class sub Header Weight lbs td td input name weight value String Escape Utils escape Html most Recent get Weight style width px type text maxlength td tr tr td class sub Header Smoker td td select name is Smoker id is Smoker style font size px option value Please Select a Smoking Status option option value Current every day smoker option option value Current some day smoker option option value Former smoker option option value Never smoker option option value Smoker current status unknown option option value Unknown if ever smoked option select td tr tr td class sub Header Blood Pressure mm Hg td td input name blood Pressure value String Escape Utils escape Html most Recent get Blood Pressure style width px maxlength type text input name blood Pressure value String Escape Utils escape Html most Recent get Blood Pressure style width px maxlength type text td tr tr td class sub Header Cholesterol mg d td td table tr td style text align right td td input name cholesterol value String Escape Utils escape Html most Recent get Cholesterol style width px maxlength type text td tr tr td style text align right td td input name cholesterol value String Escape Utils escape Html most Recent get Cholesterol style width px maxlength type text td tr tr td style text align right Tri td td input name cholesterol Tri value String Escape Utils escape Html most Recent get Cholesterol Tri style width px maxlength type text td tr table td tr table br input type submit value Add Record form div br br br itrust patient Nav this Title Basic Health History include file footer jsp 
taglib prefix itrust uri tags tld page error Page auth exception Handler jsp page import java util List page import java util Map page import java text Simple Date Format page import java util Date page import edu ncsu csc itrust Email Util page import edu ncsu csc itrust beans Office Visit Bean page import edu ncsu csc itrust beans Lab Procedure Bean page import edu ncsu csc itrust beans Cbean page import edu ncsu csc itrust dao Factory page import edu ncsu csc itrust beans Diagnosis Bean page import edu ncsu csc itrust beans Medication Bean page import edu ncsu csc itrust beans Override Reason Bean page import edu ncsu csc itrust beans Procedure Bean page import edu ncsu csc itrust action Edit Office Visit Action page import edu ncsu csc itrust action Add Office Visit Action page import edu ncsu csc itrust beans forms Edit Office Visit Form page import edu ncsu csc itrust exception i Trust Exception page import edu ncsu csc itrust beans Hospital Bean page import edu ncsu csc itrust Bean Builder page import edu ncsu csc itrust exception Form Validation Exception page import edu ncsu csc itrust beans Personnel Bean page import edu ncsu csc itrust dao mysql Personnel page import edu ncsu csc itrust beans Prescription Bean include file global jsp page Title i Trust Document Office Visit include file header jsp boolean create Visit false String submitted Form Name request get Parameter form Name String ov String request get Parameter ov String pid String String session get Attribute pid if pid String null pid String length response send Redirect i Trust auth get Patient jsp forward hcp uap edit Office Visit jsp ov ov String return Edit Office Visit Action ovaction null if ov String null ov String length ov String equals submitted Form Name must be main Form or null ovaction new Edit Office Visit Action prod logged In pid String create Visit true else ovaction new Edit Office Visit Action prod logged In pid String ov String String confirm String warning if main Form equals submitted Form Name Office Visit Bean visit ovaction get Office Visit Edit Office Visit Form form new Bean Builder Edit Office Visit Form build request get Parameter Map new Edit Office Visit Form form set Hcp visit get Hcp form set Patient visit get Patient try confirm ovaction update Information form ov String ovaction get Ov if create Visit ovaction log Office Visit Event Transaction Type create Visit false else ovaction log Office Visit Event Transaction Type catch Form Validation Exception e e print page Context get Out confirm Input not valid else if create Visit ovaction log Office Visit Event Transaction Type String disable Subforms String create Visit disabled true Office Visit Bean ovbean ovaction get Office Visit List Hospital Bean hcp Hospitals ovaction get Hospitals if equals confirm if false equals request get Parameter check Presc span class i Trust Message Operation Canceled span else if success equals confirm span class i Trust Message Information Successfully Updated span else span class i Trust Error String Escape Utils escape Html confirm span script type text javascript function remove type value document get Element By Id type value value document forms submit function set Var var med document get Element By Id add Med var med Dindex med options selected Index var med Dtxt med options med Dindex value var med Dostxt document get Element By Id dosage value var med Starttxt document get Element By Id start Date value var med Endtxt document get Element By Id end Date value var med Insttxt document get Element By Id instructions value document get Element By Id test Med value med Dtxt document get Element By Id med Dos value med Dostxt document get Element By Id med Start value med Starttxt document get Element By Id med End value med Endtxt document get Element By Id med Inst value med Insttxt document forms submit function pres Cont document get Element By Id check Presc value true document forms submit function pres Canc var med document get Element By Id add Med var med Dindex med options selected Index var med Dtxt med options med Dindex value var med Dostxt document get Element By Id dosage value var med Starttxt document get Element By Id start Date value var med Endtxt document get Element By Id end Date value var med Insttxt document get Element By Id instructions value document get Element By Id test Med value document get Element By Id med Dos value document get Element By Id med Start value document get Element By Id med End value document get Element By Id med Inst value document get Element By Id check Presc value false document forms submit script form action edit Office Visit jsp method post id main Form old input type hidden name form Is Filled value true input type hidden name ov value String Escape Utils escape Html ovaction get Ov input type hidden id check Presc name check Presc value input type hidden id test Med name test Med value String Escape Utils escape Html request get Parameter test Med input type hidden id med Dos name med Dos value String Escape Utils escape Html request get Parameter med Dos input type hidden id med Start name med Start value String Escape Utils escape Html request get Parameter med Start input type hidden id med End name med End value String Escape Utils escape Html request get Parameter med End input type hidden id med Inst name med Inst value String Escape Utils escape Html request get Parameter med Inst form String local Html Menu div align center style margin bottom em a href general General a a href prescriptions Prescriptions a a href labprocedures Lab Procedures a a href patient specific instructions Patient Specific Instructions a a href diagnoses Diagnoses a a href procedures Procedures a a href immunizations Immunizations a a href referrals Referrals a div local Html Menu br div align center id general form action edit Office Visit jsp method post id main Form input type hidden name form Is Filled value true input type hidden name form Name value main Form input type hidden name ov value String Escape Utils escape Html ovaction get Ov table class f Table align center tr th colspan a href class top Link Top a Office Visit th tr tr td class sub Header Vertical Patient td td String Escape Utils escape Html prod get Auth get User Name ovbean get Patient td tr tr td class sub Header Vertical Date of Visit td td input name visit Date value String Escape Utils escape Html ovbean get Visit Date Str input type button value Select Date onclick display Date Picker visit Date td tr tr td class sub Header Vertical Hospital td td select name hospital option value option for Hospital Bean hos hcp Hospitals option value String Escape Utils escape Html hos get Hospital String Escape Utils escape Html hos get Hospital equals ovbean get Hospital selected selected String Escape Utils escape Html hos get Hospital Name option select td tr tr td class sub Header Vertical Notes td td textarea rows style width em height em font family sans serif name notes String Escape Utils escape Html ovbean get Notes textarea td tr tr td colspan align center if create Visit input type submit name update id update value Create else input type submit name update id update value Update td tr table form div br br a name prescriptions a include file edit Prescription jsp br br a name labprocedures a include file edit Lab Procedure jsp br br a name patient specific instructions a include file edit Patient Instructions jsp br br a name diagnoses a include file edit Diagnosis jsp br br a name procedures a include file edit Procedure jsp br br a name immunizations a include file edit Immunization jsp br br a name referrals a include file edit Referral jsp br local Html Menu br br br div align center itrust patient Nav div br include file footer jsp 
taglib uri tags tld prefix itrust page error Page auth exception Handler jsp page import java util List page import edu ncsu csc itrust action View Prescription Records Action page import edu ncsu csc itrust beans Prescription Bean page import edu ncsu csc itrust beans Patient Bean include file global jsp page Title i Trust Get Prescription Report include file header jsp itrust patient Nav this Title Prescriptions div align center h Prescription Report h String pid String String session get Attribute pid if pid String null pid String length response send Redirect i Trust auth get Patient jsp forward hcp uap get Prescription Report jsp return long pid Long parse Long pid String View Prescription Records Action action new View Prescription Records Action Factory get Production Instance logged In Patient Bean patient action get Patient pid List Prescription Bean prescriptions action get Prescriptions For Patient pid logging Action log Event Transaction Type logged In pid if prescriptions size i No prescriptions found i br br br else table class f Table tr th Code th th Description th th Duration th th Prescribing th tr for Prescription Bean prescription prescriptions tr td String Escape Utils escape Html prescription get Medication get Code Formatted td td String Escape Utils escape Html prescription get Medication get Description td td String Escape Utils escape Html prescription get Start Date Str to String Escape Utils escape Html prescription get End Date Str td td String Escape Utils escape Html action get Prescribing Doctor prescription get Full Name td tr table div br br itrust patient Nav this Title Prescriptions include file footer jsp 
taglib prefix itrust uri tags tld page error Page auth exception Handler jsp page import edu ncsu csc itrust action Lab Proc Action page import edu ncsu csc itrust beans Lab Procedure Bean page import edu ncsu csc itrust exception Form Validation Exception include file global jsp page Title i Trust Update Lab Procedure include file header jsp String header Message Lab Procedure Bean lbean null long request String lpid request get Parameter if lpid null lpid equals try request Long parse Long lpid lbean prod get Lab Procedure get Lab Procedure request catch Exception e e print Stack Trace Lab Proc Action action new Lab Proc Action prod logged In long Value boolean form Is Filled request get Parameter form Is Filled null request get Parameter form Is Filled equals true if form Is Filled This page is not actually a page it just adds a user and forwards lbean set Status request get Parameter Status lbean set Results request get Parameter Results lbean set Commentary request get Parameter Commentary try action update Procedure lbean Lab Procedure Bean bean prod get Lab Procedure get Lab Procedure request logging Action log Event Transaction Type logged In long Value bean get Pid Procedure lpid br div align center span class i Trust Message Information Updated Successfully span div br catch Form Validation Exception e br div align center span class i Trust Error String Escape Utils escape Html e get Message span div br if request get Parameter message null span class i Trust Message style font size px String Escape Utils escape Html request get Parameter message span br div align center table class f Table tr th colspan Laboratory Procedures th tr tr class sub Header th Patient th th Lab Code th th Rights th th Status th th Commentary th th Results th th Office Visit th th Updated Date th tr Lab Procedure Bean bean prod get Lab Procedure get Lab Procedure request logging Action log Event Transaction Type logged In long Value bean get Pid Procedure lpid tr td String Escape Utils escape Html bean get Pid td td String Escape Utils escape Html bean get Loinc td td String Escape Utils escape Html bean get Rights td td String Escape Utils escape Html bean get Status td td String Escape Utils escape Html bean get Commentary td td String Escape Utils escape Html bean get Results td td String Escape Utils escape Html bean get Ov td td String Escape Utils escape Html bean get Timestamp td tr table form action update Lab Proc jsp String Escape Utils escape Html lpid message Updated Laboratory Procedure method post input type hidden name form Is Filled value true br br String Escape Utils escape Html header Message br table class f Table tr th colspan Update Information th tr tr td class sub Header Vertical Status td td select name Status option value Lab Procedure Bean In Transit String Escape Utils escape Html lbean In Transit option option value Lab Procedure Bean Received String Escape Utils escape Html lbean Received option option value Lab Procedure Bean Testing String Escape Utils escape Html lbean Testing option option value Lab Procedure Bean Pending String Escape Utils escape Html lbean Pending option option value Lab Procedure Bean Completed String Escape Utils escape Html lbean Completed option select td tr tr td class sub Header Vertical Commentary td td textarea name Commentary textarea tr tr td class sub Header Vertical Results td td textarea name Results textarea td tr table br input type submit style font size pt font weight bold value Update div form br include file footer jsp 
taglib uri tags tld prefix itrust page error Page auth exception Handler jsp page import java util Array List page import java util List page import edu ncsu csc itrust beans Report Request Bean page import edu ncsu csc itrust action View My Report Requests Action page import edu ncsu csc itrust beans Personnel Bean page import edu ncsu csc itrust beans Patient Bean page import edu ncsu csc itrust dao mysql Patient page import edu ncsu csc itrust dao mysql Personnel include file global jsp page Title i Trust View My Report Requests include file header jsp Patient patient new Patient prod Personnel personnel new Personnel prod View My Report Requests Action action new View My Report Requests Action prod logged In long Value String pid String String session get Attribute pid if request get Parameter add null try long patient Long parse Long pid String long id action add Report Request patient logging Action log Event Transaction Type logged In long Value patient Report id span Report Request Accepted span catch Exception e span String Escape Utils escape Html e get Message span else session remove Attribute pid List Report Request Bean list action get All Report Requests For Requester br br input type hidden name add id add table class f Table align center tr th colspan Report Requests th tr tr class sub Header td td td Patient td td Requested Date td td Viewed Date td td Status td td Action td tr List Patient Bean patients new Array List Patient Bean Patient Bean patient Personnel Bean personnel int index for Report Request Bean bean list patient patient get Patient bean get Patient patients add patient tr td String Escape Utils escape Html bean get td td String Escape Utils escape Html patient get Full Name td td String Escape Utils escape Html bean get Requested Date String td td String Escape Utils escape Html bean get Viewed Date String td td String Escape Utils escape Html bean get Status td td a href view Report jsp patient String Escape Utils escape Html index request String Escape Utils escape Html bean get View a td tr index session set Attribute patients patients table br a href i Trust auth get Patient jsp forward hcp uap view My Report Requests jsp add Add a new Report Request a include file footer jsp 
taglib uri tags tld prefix itrust page error Page auth exception Handler jsp page import java util List page import edu ncsu csc itrust beans Report Request Bean page import edu ncsu csc itrust dao mysql Personnel page import edu ncsu csc itrust action View My Report Requests Action page import edu ncsu csc itrust action View My Records Action page import edu ncsu csc itrust action View Report Action page import edu ncsu csc itrust beans Patient Bean page import edu ncsu csc itrust beans Personnel Bean page import edu ncsu csc itrust beans Office Visit Bean page import edu ncsu csc itrust beans Health Record page import edu ncsu csc itrust beans Allergy Bean page import edu ncsu csc itrust beans Family Member Bean page import edu ncsu csc itrust beans Diagnosis Bean page import edu ncsu csc itrust beans Procedure Bean page import edu ncsu csc itrust beans Prescription Bean page import edu ncsu csc itrust beans Medication Bean page import java text Number Format page import java text Decimal Format page import edu ncsu csc itrust Localization include file global jsp page Title i Trust Comprehensive Patient Report include file header jsp long logged In request get User Principal null Long value Of request get User Principal get Name Personnel personnel new Personnel prod View My Report Requests Action r Action new View My Report Requests Action prod logged In long Value int patient Index Integer parse Int request get Parameter patient List Patient Bean patients List Patient Bean session get Attribute patients session remove Attribute patients String pid String patients get patient Index get String rr String request get Parameter request long patient int request Report Request Bean report Request try if pid String null pid String equals throw new Exception Error patient is null if rr String null rr String equals throw new Exception Error request is null patient Long parse Long pid String request Integer parse Int rr String report Request r Action get Report Request request r Action set Viewed request report Request r Action get Report Request request View My Records Action action new View My Records Action prod patient View Report Action view Action new View Report Action prod logged In long Value Patient Bean patient action get Patient List Office Visit Bean office Visits action get All Office Visits List Health Record records action get All Health Records List Allergy Bean allergies action get Allergies List Patient Bean represented action get Represented List Patient Bean representing action get Representing List Family Member Bean family action get Family List Diagnosis Bean diagnoses view Action get Diagnoses patient List Procedure Bean procedures view Action get Procedures patient List Prescription Bean prescriptions view Action get Prescriptions patient List Personnel Bean hcps view Action get Declared Ps patient logging Action log Event Transaction Type logged In long Value patient h Comprehensive Patient Report for String Escape Utils escape Html patient get Full Name h div align center table tr td valign top table class f Table tr th colspan Patient Information th tr tr td class sub Header Vertical Name td td String Escape Utils escape Html patient get Full Name td tr tr td class sub Header Vertical Address td td String Escape Utils escape Html patient get Street Address br equals patient get Street Address patient get Street Address br String Escape Utils escape Html patient get Street Address br td tr tr td class sub Header Vertical Phone td td String Escape Utils escape Html patient get Phone td tr tr td class sub Header Vertical Email td td String Escape Utils escape Html patient get Email td tr table td td width px nbsp td td table class f Table tr th colspan Insurance Information th tr tr td class sub Header Vertical Name td td String Escape Utils escape Html patient get Ic Name String Escape Utils escape Html patient get Ic td tr tr td class sub Header Vertical Address td td String Escape Utils escape Html patient get Ic Address br equals patient get Ic Address patient get Ic Address br String Escape Utils escape Html patient get Ic Address br td tr tr td class sub Header Vertical Phone td td String Escape Utils escape Html patient get Ic Phone td tr table td tr table br table class f Table tr th colspan Health Records th tr tr class sub Header td Height td td Weight td td Smokes td td Blood Pressure td td td td td td Triglycerides td td Total Cholesterol td td Last Recorded td td By Personnel td tr Personnel Bean personnel for Health Record hr records personnel personnel get Personnel hr get Personnel tr td align center String Escape Utils escape Html hr get Height in td td align center String Escape Utils escape Html hr get Weight lbs td td align center String Escape Utils escape Html hr is Smoker td td align center String Escape Utils escape Html hr get Blood Pressure mm Hg td td align center String Escape Utils escape Html hr get Cholesterol mg d td td align center String Escape Utils escape Html hr get Cholesterol mg d td td align center String Escape Utils escape Html hr get Cholesterol Tri mg d td td align center String Escape Utils escape Html hr get Total Cholesterol mg d td td align center String Escape Utils escape Html hr get Date Recorded td td align center String Escape Utils escape Html personnel get Full Name td tr table br table class f Table tr th colspan Diagnoses th tr tr class sub Header td Visit td td Code td td Description td tr if diagnoses size tr td colspan style text align center No diagnoses on record td tr else Number Format number Formatter Number Format get Instance Localization instance get Current Locale Decimal Format number Formatter set Maximum Fraction Digits Decimal Format number Formatter set Minimum Fraction Digits for Diagnosis Bean diagnosis diagnoses tr td style text align center String Escape Utils escape Html diagnosis get Ov Diagnosis td td style text align center String Escape Utils escape Html number Formatter format Float parse Float diagnosis get Code td td style text align center String Escape Utils escape Html diagnosis get Description td tr table br table class f Table tr th colspan Designated Ps th tr tr class sub Header td Name td tr if hcps size tr td colspan style text align center No designated Ps on record td tr else for Personnel Bean hcp hcps tr td style text align center String Escape Utils escape Html hcp get Full Name td tr table br table class f Table tr th colspan Allergies th tr tr class sub Header td Allergy Description td td First Found td tr if allergies size tr td colspan style text align center No Allergies on record td tr else for Allergy Bean allergy allergies tr td style text align center String Escape Utils escape Html allergy get Description td td style text align center String Escape Utils escape Html allergy get First Found Str td tr table br table class f Table tr th colspan Procedures th tr tr class sub Header td Visit td td Code td td Description td tr if procedures size tr td colspan style text align center No procedures on record td tr else for Procedure Bean procedure procedures tr td style text align center String Escape Utils escape Html procedure get Ov Procedure td td style text align center String Escape Utils escape Html procedure get Code td td style text align center String Escape Utils escape Html procedure get Description td tr table br table class f Table tr th colspan Prescriptions th tr tr class sub Header th Visit th th Code th th Start Date th th End Date th th Dosage th th Instructions th tr if prescriptions size tr td colspan style text align center No prescriptions on record td tr else for Prescription Bean prescription prescriptions tr td style text align center String Escape Utils escape Html prescription get Visit td td style text align center String Escape Utils escape Html prescription get Medication get Code td td style text align center String Escape Utils escape Html prescription get Start Date Str td td style text align center String Escape Utils escape Html prescription get End Date Str td td style text align center String Escape Utils escape Html prescription get Dosage td td style text align center String Escape Utils escape Html prescription get Instructions td tr table br table class f Table tr th colspan Office Visits th tr tr class sub Header th Visit Date th th th th Hospital th th Notes th tr if office Visits size tr td colspan style text align center No office visits on record td tr else for Office Visit Bean ov office Visits personnel personnel get Personnel ov get Hcp tr td style text align center String Escape Utils escape Html ov get Visit Date Str td td style text align center String Escape Utils escape Html personnel get Full Name td td style text align center String Escape Utils escape Html ov get Hospital td td style text align center String Escape Utils escape Html ov get Notes td tr table br table class f Table tr th colspan Known Relatives th tr tr class sub Header th Name th th Relation th tr if family size tr td colspan style text align center No Relations on record td tr else for Family Member Bean member family tr td String Escape Utils escape Html member get Full Name td td String Escape Utils escape Html member get Relation td tr table br table class f Table tr th Patients String Escape Utils escape Html patient get First Name is representing th tr tr class sub Header th Patient th tr if represented size tr td String Escape Utils escape Html patient get First Name is not representing any patients td tr else for Patient Bean p represented tr td align center String Escape Utils escape Html p get Full Name td tr table br table class f Table tr th Patients Representing String Escape Utils escape Html patient get First Name th tr tr class sub Header th Patient th tr if representing size tr td String Escape Utils escape Html patient get First Name is not represented by any patients td tr else for Patient Bean p representing tr td align center String Escape Utils escape Html p get Full Name td tr table br br catch Exception ex ex get Class ex get Cause String Escape Utils escape Html ex get Message include file footer jsp 
taglib prefix itrust uri tags tld page error Page auth exception Handler jsp page import edu ncsu csc itrust enums Role page import edu ncsu csc itrust beans Personnel Bean page import edu ncsu csc itrust Bean Builder page import edu ncsu csc itrust exception Form Validation Exception page import edu ncsu csc itrust action Add Action include file global jsp page Title i Trust Add include file header jsp boolean form Is Filled request get Parameter form Is Filled null request get Parameter form Is Filled equals true if form Is Filled This page is not actually a page it just adds a user and forwards Personnel Bean p new Bean Builder Personnel Bean build request get Parameter Map new Personnel Bean p set Role Role try long new new Add Action Factory get Production Instance logged In add p session set Attribute mid Long to String new String fullname String password password p get Password fullname p get Full Name logging Action log Event Transaction Type logged In long Value new div align center span class i Trust Message New String Escape Utils escape Html fullname succesfully added span br br table class f Table tr th colspan New Information th tr tr td class sub Header Vertical td td String Escape Utils escape Html new td tr tr td class sub Header Vertical Temporary Password td td String Escape Utils escape Html password td tr table br Please get this information to b String Escape Utils escape Html fullname b p a href i Trust auth staff edit Personnel jsp Continue to personnel information a p div catch Form Validation Exception e div align center span class i Trust Error String Escape Utils escape Html e get Message span div div align center form action add jsp method post input type hidden name form Is Filled value true br br div style width text align left Please enter in the name of the new with a valid email address If the user does not have an email address use the hospital s email address insert pre defined email to recover the password div br br table class f Table tr th colspan Information th tr tr td class sub Header Vertical First name td td input type text name first Name td tr tr td class sub Header Vertical Last Name td td input type text name last Name tr tr td class sub Header Vertical Email td td input type text name email td tr table br input type submit style font size pt font weight bold value Add personnel form br div include file footer jsp 
taglib uri tags tld prefix itrust page error Page auth exception Handler jsp page import edu ncsu csc itrust action Edit Monitoring List Action page import edu ncsu csc itrust beans Telemedicine Bean include file global jsp page Title i Trust Edit Patient List include file header jsp Require a Patient first String pid String String session get Attribute pid String add Or Remove Add if pid String null pid String length false equals request get Parameter confirm Action response send Redirect i Trust auth get Patient jsp forward hcp edit Patient List jsp return Edit Monitoring List Action action new Edit Monitoring List Action prod logged In long Value long pid Long parse Long pid String String patient Name action get Patient Name pid if action is Patient In List pid add Or Remove Remove String confirm boolean conf bool false if true equals request get Parameter confirm Action if request get Parameter f Submit equals Update Permissions String check Boxes new String request get Parameter blood Pressure request get Parameter glucose request get Parameter height request get Parameter weight request get Parameter pedometer boolean permissions new boolean for int i i i permissions i check Boxes i null check Boxes i equals on Telemedicine Bean t Bean new Telemedicine Bean t Bean set Systolic Blood Pressure Allowed permissions t Bean set Diastolic Blood Pressure Allowed permissions t Bean set Glucose Level Allowed permissions t Bean set Height Allowed permissions t Bean set Weight Allowed permissions t Bean set Pedometer Reading Allowed permissions conf bool action remove From List pid boolean conf bool action add To List pid t Bean if conf bool conf bool confirm patient Name s Permissions Changed logging Action log Event Transaction Type logged In pid session remove Attribute pid else if request get Parameter f Submit contains Telemedicine Permissions form action edit Patient List jsp method post input type hidden name confirm Action value true input h Please indicate which data String Escape Utils escape Html patient Name should be allowed to enter h input type checkbox name blood Pressure Blood Pressure br input type checkbox name glucose Glucose Level br input type checkbox name height Height br input type checkbox name weight Weight br input type checkbox name pedometer Pedometer br input type submit name f Submit value Update Permissions form else if add Or Remove equals Add String check Boxes new String request get Parameter blood Pressure request get Parameter glucose request get Parameter height request get Parameter weight request get Parameter pedometer boolean permissions new boolean for int i i i permissions i check Boxes i null check Boxes i equals on Telemedicine Bean t Bean new Telemedicine Bean t Bean set Systolic Blood Pressure Allowed permissions t Bean set Diastolic Blood Pressure Allowed permissions t Bean set Glucose Level Allowed permissions t Bean set Height Allowed permissions t Bean set Weight Allowed permissions t Bean set Pedometer Reading Allowed permissions conf bool action add To List pid t Bean if conf bool confirm Patient patient Name Added logging Action log Event Transaction Type logged In pid else conf bool action remove From List pid if conf bool confirm Patient patient Name Removed logging Action log Event Transaction Type logged In pid session remove Attribute pid if equals confirm div align center span class i Trust Message String Escape Utils escape Html confirm span div else if request get Parameter f Submit null request get Parameter f Submit contains Change br form action edit Patient List jsp method post input type hidden name confirm Action value true input if add Or Remove equals Add h Please indicate which data String Escape Utils escape Html patient Name should be allowed to enter h input type checkbox name blood Pressure Blood Pressure br input type checkbox name glucose Glucose Level br input type checkbox name height Height br input type checkbox name weight Weight br input type checkbox name pedometer Pedometer br input type submit name f Submit value add Or Remove String Escape Utils escape Html patient Name if add Or Remove equals Add input type submit name f Submit value Change String Escape Utils escape Html patient Name s Telemedicine Permissions input type submit name f Submit value Choose Different Patient on Click javascript different Patient form script type text javascript function different Patient document get Elements By Name confirm Action value false document forms submit script br br br include file footer jsp 
page error Page auth exception Handler jsp page import edu ncsu csc itrust dao mysql Patient page import edu ncsu csc itrust beans Lab Procedure Bean page import edu ncsu csc itrust action View My Report Requests Action page import edu ncsu csc itrust beans Patient Bean page import edu ncsu csc itrust action Lab Proc Action page import edu ncsu csc itrust beans Report Request Bean page import java util List include file global jsp page Title i Trust Home include file header jsp View My Report Requests Action report Action new View My Report Requests Action Factory get Production Instance logged In List Report Request Bean reports report Action get All Report Requests For Requester Lab Proc Action lp Action new Lab Proc Action Factory get Production Instance logged In List Lab Procedure Bean lab Procedures lp Action get Lab Proc For Next Month logging Action log Event Transaction Type logged In long Value include file auth hcp notification Area jsp table cellpadding cellspacing tr td h Announcements h i New features in i Trust i td tr tr td ul li No more typing in a date We now have a calendar popup that makes entering dates incredibly easy li ul td tr tr td h Comprehensive Report History h td tr tr td ul if reports size for Report Request Bean report reports li String Escape Utils escape Html report Action get Long Status report get li else i No Report Requests i ul td tr tr td h Lab Procedures Completed in the Last Month h td tr tr td a href Lab Proc jsp View All Lab Procedures here a br td tr tr td ul if lab Procedures size for Lab Procedure Bean bean lab Procedures Patient Bean patient new Patient Factory get Production Instance get Patient bean get Pid li Lab Procedure String Escape Utils escape Html bean get Loinc for patient String Escape Utils escape Html patient get Full Name br Results if bean get Results equals i none i else String Escape Utils escape Html bean get Results else i No Recent Lab Procedures i li ul td tr table include file footer jsp 
taglib uri tags tld prefix itrust page error Page auth exception Handler jsp page import java util List page import edu ncsu csc itrust beans Remote Monitoring Data Bean page import edu ncsu csc itrust action View My Remote Monitoring List Action page import edu ncsu csc itrust dao mysql Patient page import edu ncsu csc itrust dao mysql Personnel include file global jsp page Title i Trust Monitor Patients include file header jsp logging Action log Event Transaction Type logged In long Value Viewed monitored patients session remove Attribute patient List View My Remote Monitoring List Action action new View My Remote Monitoring List Action prod logged In long Value List Remote Monitoring Data Bean data action get Patients Data session set Attribute patient List data Patient pat prod get Patient Personnel pers prod get Personnel page import java sql Time br br table class f Table align center tr th colspan Patient Physiologic Statistics th tr tr class sub Header th Patient th th width Date th th Systolic Blood Pressure th th Diastolic Blood Pressure th th Glucose Level th th Reporter th tr String highlight String reporter Name int index for Remote Monitoring Data Bean bean data if bean get Reporter highlight ff tr bgcolor String Escape Utils escape Html highlight td a href i Trust auth hcp view Additional Info jsp patient String Escape Utils escape Html index String Escape Utils escape Html action get Patient Name bean get Patient bean get Patient a td td b No Information Provided b td td b b td td b b td td b b td td b b td tr else highlight int sys bean get Systolic Blood Pressure int dias bean get Diastolic Blood Pressure int glu Lvl bean get Glucose Level if glu Lvl dias sys Keep track if the table is empty if bean get Time null highlight ff else if bean get Systolic Blood Pressure bean get Systolic Blood Pressure bean get Systolic Blood Pressure bean get Diastolic Blood Pressure bean get Diastolic Blood Pressure bean get Diastolic Blood Pressure bean get Glucose Level bean get Glucose Level bean get Glucose Level highlight ffff reporter Name auth get User Name bean get Reporter else reporter Name auth get User Name bean get Reporter reporter Name auth get User Name bean get Reporter tr bgcolor String Escape Utils escape Html highlight td a href i Trust auth hcp view Additional Info jsp patient String Escape Utils escape Html index String Escape Utils escape Html action get Patient Name bean get Patient bean get Patient a td td String Escape Utils escape Html bean get Time td td String Escape Utils escape Html sys sys td td String Escape Utils escape Html dias dias td td String Escape Utils escape Html glu Lvl glu Lvl td td String Escape Utils escape Html reporter Name td tr index if index tr bgcolor ff td b No Information Provided b td td b b td td b b td td b b td td b b td td b b td tr table br br table class f Table align center tr th colspan Patient External Statistics th tr tr class sub Header th Patient th th width Date th th Height th th Weight th th Pedometer Reading th th Reporter th tr index for Remote Monitoring Data Bean bean data if bean get Reporter highlight ff tr bgcolor String Escape Utils escape Html highlight td a href i Trust auth hcp view Additional Info jsp patient String Escape Utils escape Html index String Escape Utils escape Html action get Patient Name bean get Patient bean get Patient a td td b No Information Provided b td td b b td td b b td td b b td td b b td tr else highlight reporter Name float height bean get Height float weight bean get Weight int pedo Reading bean get Pedometer Reading Check for highlighting due to change from immediately previous weight record if bean get Weight Remote Monitoring Data Bean prev Temp null List Remote Monitoring Data Bean weight Bean List action get Patient Data By Type bean get Patient weight for Remote Monitoring Data Bean cur Temp weight Bean List if prev Temp null prev Temp cur Temp continue if bean equals prev Temp break if prev Temp get Time before bean get Time bean get Time before cur Temp get Time bean get Time equals cur Temp get Time break else prev Temp cur Temp if prev Temp null Math abs prev Temp get Weight bean get Weight bean get Weight highlight ffff else if bean get Pedometer Reading bean get Height Reading else if pedo Reading height highlight ff if weight pedo Reading height reporter Name auth get User Name bean get Reporter tr bgcolor String Escape Utils escape Html highlight td a href i Trust auth hcp view Additional Info jsp patient String Escape Utils escape Html index String Escape Utils escape Html action get Patient Name bean get Patient bean get Patient a td td String Escape Utils escape Html bean get Time td td String Escape Utils escape Html height height td td String Escape Utils escape Html weight weight td td String Escape Utils escape Html pedo Reading pedo Reading td td String Escape Utils escape Html reporter Name td tr index if index tr bgcolor ff td b No Information Provided b td td b b td td b b td td b b td td b b td td b b td tr table br include file footer jsp 
page error Page auth exception Handler jsp page import edu ncsu csc itrust action Send Message Action page import edu ncsu csc itrust beans Message Bean page import java util List include file global jsp page Title i Trust Reply include file header jsp Send Message Action action new Send Message Action prod logged In Message Bean original null if session get Attribute message null original Message Bean session get Attribute message session set Attribute original original session remove Attribute message else if request get Parameter message Body null if session get Attribute original null original Message Bean session get Attribute original Message Bean message New new Message Bean message New set Body request get Parameter message Body message New set From logged In message New set To original get From message New set Subject request get Parameter subject message New set Read message New set Parent Message Id original get Message Id action send Message message New logging Action log Event Transaction Type message New get From message New get To response send Redirect message Inbox jsp else response send Redirect message Inbox jsp h Reply h h to a message from String Escape Utils escape Html action get Patient Name original get From h form id main Form method post action reply jsp span Subject span input type text name subject size value String Escape Utils escape Html original get Subject br br span Message span br textarea name message Body cols rows textarea br br input type submit value Send name send Message form br br include file footer jsp 
page error Page auth exception Handler jsp page import edu ncsu csc itrust action Send Message Action page import edu ncsu csc itrust beans Message Bean page import edu ncsu csc itrust dao mysql Patient page import edu ncsu csc itrust exception i Trust Exception page import edu ncsu csc itrust exception Form Validation Exception include file global jsp page Title i Trust Send a Message include file header jsp Send Message Action action new Send Message Action prod logged In long Value Patient patient prod get Patient long patient if session get Attribute pid null String pid String String session get Attribute pid patient Long parse Long pid String try action get Patient Name patient catch i Trust Exception ite patient session remove Attribute pid else if patient response send Redirect i Trust auth get Patient jsp forward hcp send Message jsp else if request get Parameter message Body null String body request get Parameter message Body Message Bean message new Message Bean message set Body request get Parameter message Body message set Subject request get Parameter subject message set Read message set From logged In message set To patient try action send Message message session remove Attribute pid logging Action log Event Transaction Type message get From message get To response send Redirect message Outbox jsp catch Form Validation Exception e div align center span class i Trust Error String Escape Utils escape Html e get Message span div div align left h Send a Message h h to String Escape Utils escape Html action get Patient Name patient a href i Trust auth get Patient jsp forward hcp send Message jsp someone else a h form id main Form method post action send Message jsp span Subject span input type text name subject size br br span Message span br textarea name message Body cols rows textarea br br input type submit value Send name send Message form br br div include file footer jsp 
taglib uri tags tld prefix itrust page error Page auth exception Handler jsp page import java util List page import java util Date page import java text Simple Date Format page import edu ncsu csc itrust beans Remote Monitoring Data Bean page import edu ncsu csc itrust beans Patient Bean page import edu ncsu csc itrust action View My Remote Monitoring List Action page import edu ncsu csc itrust dao mysql Patient include file global jsp page Title i Trust View Additional Info include file header jsp int patient Index if request get Parameter patient null String patient request get Parameter patient session set Attribute patient patient patient Index Integer parse Int patient else String patient String session get Attribute patient patient Index Integer parse Int patient List Remote Monitoring Data Bean patient List List Remote Monitoring Data Bean session get Attribute patient List Remote Monitoring Data Bean rmdb patient List get patient Index Patient pat prod get Patient long patient rmdb get Patient Patient Bean p pat get Patient patient logging Action log Event Transaction Type logged In long Value patient View My Remote Monitoring List Action list Action new View My Remote Monitoring List Action prod logged In long Value String start Date new Simple Date Format dd yyyy format new Date String end Date new Simple Date Format dd yyyy format new Date if date equals request get Parameter sort By start Date request get Parameter start Date end Date request get Parameter end Date br table class f Table align center tr th colspan Patient Details th tr tr td class sub Header Vertical Name td td String Escape Utils escape Html p get Full Name td tr tr td class sub Header Vertical Phone td td String Escape Utils escape Html p get Phone td tr table br List Patient Bean patient Representatives pat get Representing patient br table class f Table align center tr th colspan Patient s Representatives th tr if patient Representatives is Empty tr td This patient has no representatives td tr for Patient Bean pat patient Representatives tr td class sub Header Vertical Name td td String Escape Utils escape Html pat get Full Name td td class sub Header Vertical Phone td td String Escape Utils escape Html pat get Phone td tr table br br table class f Table align center tr th colspan Patient Glucose Statistics th tr tr class sub Header th width Date th th Systolic Blood Pressure th th Diastolic Blood Pressure th th Glucose Level th th Reporter th tr List Remote Monitoring Data Bean patient Physiologic Stats list Action get Patient Data By Date patient start Date end Date if patient Physiologic Stats is Empty tr bgcolor ff td b No Information Provided b td td b b td td b b td td b b td td b b td tr String highlight String reporter Name for Remote Monitoring Data Bean stats patient Physiologic Stats highlight int sys stats get Systolic Blood Pressure int dias stats get Diastolic Blood Pressure int glu Lvl stats get Glucose Level if glu Lvl dias sys Highlighting only partially implemented here commented out if sys sys sys dias dias dias glu Lvl glu Lvl glu Lvl highlight ffff reporter Name auth get User Name stats get Reporter tr bgcolor String Escape Utils escape Html highlight td String Escape Utils escape Html stats get Time td td String Escape Utils escape Html sys sys td td String Escape Utils escape Html dias dias td td String Escape Utils escape Html glu Lvl glu Lvl td td String Escape Utils escape Html reporter Name td tr table br br table class f Table align center tr th colspan Patient Weight Pedometer Statistics th tr tr class sub Header th width Date th th Height th th Weight th th Pedometer Reading th th Reporter th tr List Remote Monitoring Data Bean patient External Stats list Action get Patient Data By Date patient start Date end Date if patient External Stats is Empty tr bgcolor ff td b No Information Provided b td td b b td td b b td td b b td td b b td tr highlight reporter Name for Remote Monitoring Data Bean stats patient External Stats highlight float height stats get Height float weight stats get Weight int pedo Reading stats get Pedometer Reading if stats get Weight Remote Monitoring Data Bean prev Temp null List Remote Monitoring Data Bean weight Bean List list Action get Patient Data By Type stats get Patient weight for Remote Monitoring Data Bean cur Temp weight Bean List if prev Temp null prev Temp cur Temp continue if stats equals prev Temp break if prev Temp get Time before stats get Time stats get Time before cur Temp get Time stats get Time equals cur Temp get Time break else prev Temp cur Temp Highlighting only partially implemented here commented out if prev Temp null Math abs prev Temp get Weight stats get Weight stats get Weight highlight ffff if height weight pedo Reading reporter Name auth get User Name stats get Reporter tr bgcolor String Escape Utils escape Html highlight td String Escape Utils escape Html stats get Time td td String Escape Utils escape Html height height td td String Escape Utils escape Html weight weight td td String Escape Utils escape Html pedo Reading pedo Reading td td String Escape Utils escape Html reporter Name td tr table br else form action view Additional Info jsp id datebuttons style display inline method post input type hidden name sort By value date input div align center table class f Table align center tr class sub Header td Start Date td td input name start Date value String Escape Utils escape Html start Date size input type button value Select Date onclick display Date Picker start Date td td End Date td td input name end Date value String Escape Utils escape Html end Date input type button value Select Date onclick display Date Picker end Date td tr table br input type submit name submit value Get Records onclick javascript sort By div form script type text javascript function sort By document get Elements By Name sort By value date document forms submit click script include file footer jsp 
page error Page auth exception Handler jsp page import java util List page import edu ncsu csc itrust action View My Messages Action page import edu ncsu csc itrust beans Message Bean page import edu ncsu csc itrust dao Factory include file global jsp page Title i Trust View My Messages include file header jsp div align center h My Messages h logging Action log Event Transaction Type logged In long Value View My Messages Action action new View My Messages Action prod logged In long Value List Message Bean messages action get All My Messages session set Attribute messages messages if messages size table class f Table tr th Sender th th Message th th Received th th th tr int index for Message Bean message messages tr td String Escape Utils escape Html action get Name message get From td td String Escape Utils escape Html message get Body td td String Escape Utils escape Html message get Sent Date td td a href reply jsp msg String Escape Utils escape Html index Reply a td tr index table else div i You have no messages i div br div include file footer jsp 
taglib uri tags tld prefix itrust page error Page auth exception Handler jsp page import java util List page import edu ncsu csc itrust action View Prescription Renewal Needs Action page import edu ncsu csc itrust beans Patient Bean page import edu ncsu csc itrust beans Prescription Bean page import edu ncsu csc itrust beans Personnel Bean page import edu ncsu csc itrust dao mysql Patient page import edu ncsu csc itrust dao mysql Personnel include file global jsp page Title i Trust My Patients with Potential Prescription Renewal Needs include file header jsp Personnel Bean self new Personnel prod get Personnel logged In View Prescription Renewal Needs Action exp Action new View Prescription Renewal Needs Action prod logged In long Value List Personnel Bean personnel List prod get Personnel get All Personnel session set Attribute personnel List personnel List div align center br table class f Table List Patient Bean patients exp Action get Renewal Needs Patients patients new Patient prod get All Patients Temporary test if patients size tr td colspan i No patients have renewal needs i td tr else tr th colspan String Escape Utils escape Html self get Full Name th tr tr class sub Header td Patient Name td td Phone Number td td Email Address td tr for Patient Bean patient patients logging Action log Event Transaction Type logged In patient get Personnel Bean doctor exp Action get Prescribing Doctor prescription tr td a href send Email Notification jsp mid String Escape Utils escape Html patient get String Escape Utils escape Html patient get Full Name a td td String Escape Utils escape Html patient get Phone td td String Escape Utils escape Html patient get Email td tr table br div include file footer jsp 
page error Page auth exception Handler jsp page import java util List page import edu ncsu csc itrust action Get Visit Reminders Action page import edu ncsu csc itrust action Get Visit Reminders Action Reminder Type page import edu ncsu csc itrust beans Visit Flag page import edu ncsu csc itrust beans forms Visit Reminder Return Form page import edu ncsu csc itrust beans Personnel Bean page import edu ncsu csc itrust dao mysql Personnel include file global jsp page Title i Trust Visit Reminders include file header jsp logging Action log Event Transaction Type logged In long Value Get Visit Reminders Action action new Get Visit Reminders Action prod logged In long Value div align center h Patients Needing Visits h form action visit Reminders jsp method post id reminder Form input type hidden id form Is Filled value true select id Reminder Type name Reminder Type for Reminder Type rt Reminder Type values option String Escape Utils escape Html rt get Type Name equals request get Parameter Reminder Type selected value rt get Type Name String Escape Utils escape Html rt get Type Name option select br br input type submit id get Reminders name get Reminders value Get Reminders form br if Get Reminders equals request get Parameter get Reminders List Visit Reminder Return Form reminders action get Visit Reminders Reminder Type get Reminder Type request get Parameter Reminder Type for Visit Reminder Return Form reminder reminders table class f Table tr th colspan Patient Information th tr tr td class sub Header Vertical Name td td a href send Email Notification jsp mid String Escape Utils escape Html reminder get Patient String Escape Utils escape Html reminder get First Name reminder get Last Name a td tr tr td class sub Header Vertical Phone Number td td String Escape Utils escape Html reminder get Phone Number td tr tr td class sub Header Vertical Reasons td td for Visit Flag vf reminder get Visit Flags String Escape Utils escape Html vf get Type nbsp nbsp String Escape Utils escape Html vf get Value br td tr table This is the original Table format which has the first and last name on separate lines In favor of making the link to send an email to a patient more friendly ve changed this to the above table which puts both names together table class f Table tr th colspan Patient Information th tr tr td class sub Header Vertical Last Name td td a href send Email Notification jsp mid String Escape Utils escape Html reminder get Patient String Escape Utils escape Html reminder get Last Name a td tr tr td class sub Header Vertical First Name td td String Escape Utils escape Html reminder get First Name td tr tr td class sub Header Vertical Phone Number td td String Escape Utils escape Html reminder get Phone Number td tr tr td class sub Header Vertical Reasons td td for Visit Flag vf reminder get Visit Flags String Escape Utils escape Html vf get Type nbsp nbsp String Escape Utils escape Html vf get Value br td tr table br div include file footer jsp 
page import edu ncsu csc itrust exception Form Validation Exception page import edu ncsu csc itrust action Add Remote Monitoring Data Action page import edu ncsu csc itrust action Edit Representatives Action page import edu ncsu csc itrust beans Patient Bean page import edu ncsu csc itrust beans Telemedicine Bean page import edu ncsu csc itrust beans Remote Monitoring Data Bean page import edu ncsu csc itrust exception i Trust Exception page import java util List taglib prefix itrust uri tags tld page error Page auth exception Handler jsp include file global jsp page Title i Trust Report Status include file header jsp Require a Patient first long patient boolean representative Reporting false String reporting For String request get Parameter reporting For if reporting For null reporting For length reporting For equals null patient logged In long Value If self reporting else patient Long parse Long reporting For representative Reporting true Add Remote Monitoring Data Action action new Add Remote Monitoring Data Action prod logged In long Value patient List Telemedicine Bean t Beans action get Telemedicine Bean patient Default to allow none if t Beans size Telemedicine Bean b new Telemedicine Bean b set Systolic Blood Pressure Allowed false b set Diastolic Blood Pressure Allowed false b set Glucose Level Allowed false b set Height Allowed false b set Weight Allowed false b set Pedometer Reading Allowed false t Beans add b Update information boolean form Is Filled request get Parameter form Is Filled null request get Parameter form Is Filled equals true if form Is Filled try boolean glucose Submitted request get Parameter glucose Level null equals request get Parameter glucose Level boolean systolic Submitted request get Parameter systolic Blood Pressure null equals request get Parameter systolic Blood Pressure boolean diastolic Submitted request get Parameter diastolic Blood Pressure null equals request get Parameter diastolic Blood Pressure boolean height Submitted request get Parameter height null equals request get Parameter height boolean weight Submitted request get Parameter weight null equals request get Parameter weight boolean pedometer Submitted request get Parameter pedometer Reading null equals request get Parameter pedometer Reading if diastolic Submitted systolic Submitted div align center span class i Trust Error Systolic and Diastolic Blood Pressure must be submitted together span div else int glucose Level glucose Submitted Integer parse Int request get Parameter glucose Level int systolic systolic Submitted Integer parse Int request get Parameter systolic Blood Pressure int diastolic diastolic Submitted Integer parse Int request get Parameter diastolic Blood Pressure float height height Submitted Float parse Float request get Parameter height float weight weight Submitted Float parse Float request get Parameter weight int pedometer pedometer Submitted Integer parse Int request get Parameter pedometer Reading Remote Monitoring Data Bean rmd Bean new Remote Monitoring Data Bean rmd Bean set Glucose Level glucose Level rmd Bean set Systolic Blood Pressure systolic rmd Bean set Diastolic Blood Pressure diastolic rmd Bean set Height height rmd Bean set Weight weight rmd Bean set Pedometer Reading pedometer action add Remote Monitoring Data rmd Bean logging Action log Event Transaction Type logged In patient div align center span class i Trust Message Information Successfully Added span div catch Form Validation Exception e form Is Filled false div align center span class i Trust Error String Escape Utils escape Html e get Message span div catch Number Format Exception e form Is Filled false div align center span class i Trust Error Invalid entry String Escape Utils escape Html e get Message Please enter a whole number span div catch i Trust Exception e form Is Filled false div align center span class i Trust Error Invalid entry String Escape Utils escape Html e get Message span div if form Is Filled If conflict exists with multiple Ps allow the input boolean report Blood Pressure false boolean report Glucose false boolean report Height false boolean report Weight false boolean report Pedometer false for Telemedicine Bean tb t Beans if tb is Systolic Blood Pressure Allowed tb is Diastolic Blood Pressure Allowed report Blood Pressure true if tb is Glucose Level Allowed report Glucose true if tb is Height Allowed report Height true if tb is Weight Allowed report Weight true if tb is Pedometer Reading Allowed report Pedometer true form action add Telemedicine Data jsp method post input type hidden name form Is Filled value true input type hidden name reporting For value String Escape Utils escape Html String request get Parameter reporting For br table cellspacing align center cellpadding tr th String Escape Utils escape Html patient logged In long Value Self Reporting Report for action get Patient Name patient th tr if report Blood Pressure report Glucose report Height report Weight report Pedometer tr td valign top table class f Table align center style width px if report Blood Pressure tr td class sub Header Vertical Systolic Blood Pressure td td input name systolic Blood Pressure value type text td tr tr td class sub Header Vertical Diastolic Blood Pressure td td input name diastolic Blood Pressure value type text td tr if report Glucose tr td class sub Header Vertical Glucose Level td td input name glucose Level value type text td tr if report Height tr td class sub Header Vertical Height td td input name height value type text td tr if report Weight tr td class sub Header Vertical Weight td td input name weight value type text td tr if report Pedometer tr td class sub Header Vertical Pedometer Reading td td input name pedometer Reading value type text td tr table td td width px nbsp td td valign top td tr table br div align center if report Blood Pressure report Glucose report Height report Weight report Pedometer br input type submit name action style font weight bold value Report else You are not authorized to report any telemedicine data br input type submit name action style font weight bold value Report disabled br br br if representative Reporting table class f Table align center th Patient Representative Reporting th Edit Representatives Action reps Action new Edit Representatives Action prod Long to String patient List Patient Bean patients reps Action get Represented patient if patients size tr class sub Header th No Patients Represented th tr else tr class sub Header th Patient th tr for Patient Bean p patients tr td a href onclick javascript document get Elements By Name form Is Filled value false document get Elements By Name reporting For value String Escape Utils escape Html p get document forms submit String Escape Utils escape Html p get Full Name a td tr table div form br br include file footer jsp 
page import edu ncsu csc itrust dao Factory page import edu ncsu csc itrust beans Patient Bean page import edu ncsu csc itrust action Edit Patient Action page import edu ncsu csc itrust Bean Builder page import edu ncsu csc itrust exception Form Validation Exception page import edu ncsu csc itrust action Set Security Question Action page import edu ncsu csc itrust beans Security page import org apache commons validator Credit Card Validator taglib prefix itrust uri tags tld page error Page auth exception Handler jsp include file global jsp page Title i Trust Edit Patient include file header jsp If the patient id does n t check out then kick em out to the exception handler Edit Patient Action action new Edit Patient Action prod logged In long Value logged In long Value Set Security Question Action saction new Set Security Question Action prod logged In long Value long pid action get Pid Now take care of updating information boolean form Is Filled request get Parameter form Is Filled null request get Parameter form Is Filled equals true Patient Bean p Security s if form Is Filled p new Bean Builder Patient Bean build request get Parameter Map new Patient Bean s new Bean Builder Security build request get Parameter Map new Security try action update Information p saction update Information s logging Action log Event Transaction Type logged In logged In div align center span class i Trust Message Information Successfully Updated span div catch Form Validation Exception e div align center span class i Trust Error String Escape Utils escape Html e get Message span div p action get Patient else p action get Patient s saction retrieve Information logging Action log Event Transaction Type logged In pid form action edit My Demographics jsp method post input type hidden name form Is Filled value true input type hidden name pid value String Escape Utils escape Html pid br table cellspacing align center cellpadding tr td valign top table class f Table align center style width px tr th colspan Patient Information th tr tr td class sub Header Vertical First Name td td input name first Name value String Escape Utils escape Html p get First Name type text td tr tr td class sub Header Vertical Last Name td td input name last Name value String Escape Utils escape Html p get Last Name type text td tr tr td class sub Header Vertical Email td td input name email value String Escape Utils escape Html p get Email type text td tr tr td class sub Header Vertical Address td td input name street Address value String Escape Utils escape Html p get Street Address type text br input name street Address value String Escape Utils escape Html p get Street Address type text td tr tr td class sub Header Vertical City td td input name city value String Escape Utils escape Html p get City type text td tr tr td class sub Header Vertical State td td itrust state name state value String Escape Utils escape Html p get State td tr tr td class sub Header Vertical Zip td td input name zip value String Escape Utils escape Html p get Zip maxlength type text size input name zip value String Escape Utils escape Html p get Zip maxlength type text size td tr tr td class sub Header Vertical Phone td td input name phone value String Escape Utils escape Html p get Phone type text size maxlength input name phone value String Escape Utils escape Html p get Phone type text size maxlength input name phone value String Escape Utils escape Html p get Phone type text size maxlength td tr tr td class sub Header Vertical Mother td td input name Mother value String Escape Utils escape Html p get Mother maxlength type text td tr tr td class sub Header Vertical Father td td input name Father value String Escape Utils escape Html p get Father maxlength type text td tr tr td class sub Header Vertical Credit Card Type td td select name credit Card Type option value Select option option value String Escape Utils escape Html p get Credit Card Type equals selected Mastercard option option value String Escape Utils escape Html p get Credit Card Type equals selected Visa option option value String Escape Utils escape Html p get Credit Card Type equals selected Discover option option value String Escape Utils escape Html p get Credit Card Type equals selected American Express option select td tr tr td class sub Header Vertical Credit Card Number td td input name credit Card Number value String Escape Utils escape Html p get Credit Card Number maxlength type text td tr table td td width px nbsp td td valign top table class f Table align center style width px tr th colspan Insurance Information th tr tr td class sub Header Vertical Name td td input name ic Name value String Escape Utils escape Html p get Ic Name type text td tr tr td class sub Header Vertical Address td td input name ic Address value String Escape Utils escape Html p get Ic Address type text br input name ic Address value String Escape Utils escape Html p get Ic Address type text td tr tr td class sub Header Vertical City td td input name ic City value String Escape Utils escape Html p get Ic City type text td tr tr td class sub Header Vertical State td td itrust state name ic State value String Escape Utils escape Html p get Ic State td tr tr td class sub Header Vertical Zip td td input name ic Zip value String Escape Utils escape Html p get Ic Zip maxlength type text size input name ic Zip value String Escape Utils escape Html p get Ic Zip maxlength type text size td tr tr td class sub Header Vertical Phone td td input name ic Phone value String Escape Utils escape Html p get Ic Phone type text size maxlength input name ic Phone value String Escape Utils escape Html p get Ic Phone type text size maxlength input name ic Phone value String Escape Utils escape Html p get Ic Phone type text size maxlength td tr tr td class sub Header Vertical Insurance td td input name ic value String Escape Utils escape Html p get Ic type text td tr table td tr tr height px td colspan nbsp td tr tr td valign top table class f Table align center style width px tr th colspan Authentication Information th tr tr td class sub Header Vertical Security Question td td input name question value String Escape Utils escape Html s get Question type text td tr tr td class sub Header Vertical Security Answer td td input name answer value String Escape Utils escape Html s get Answer type password td tr tr td class sub Header Vertical Confirm Security Answer td td input name confirm Answer value String Escape Utils escape Html s get Answer type password td tr table td td width px nbsp td td valign top table class f Table align center style width px tr th colspan Emergency Contact th tr tr td class sub Header Vertical Name td td input name emergency Name value String Escape Utils escape Html p get Emergency Name type text td tr tr td class sub Header Vertical Phone td td input name emergency Phone value String Escape Utils escape Html p get Emergency Phone type text size maxlength input name emergency Phone value String Escape Utils escape Html p get Emergency Phone type text size maxlength input name emergency Phone value String Escape Utils escape Html p get Emergency Phone type text size maxlength td tr table td tr table br div align center input type submit name action style font size pt font weight bold value Edit Patient Record br br Note in order to set your password use the Reset Password link at the login page div form include file footer jsp 
page import edu ncsu csc itrust beans Office Visit Bean page import edu ncsu csc itrust beans Lab Procedure Bean page import edu ncsu csc itrust beans Transaction Bean page import edu ncsu csc itrust dao mysql Lab Procedure page import edu ncsu csc itrust dao mysql Patient page import edu ncsu csc itrust dao mysql Transaction page import edu ncsu csc itrust dao mysql Personnel page import edu ncsu csc itrust action View My Records Action page import edu ncsu csc itrust action View My Report Requests Action page import edu ncsu csc itrust beans Patient Bean page import edu ncsu csc itrust beans Personnel Bean page import edu ncsu csc itrust beans Report Request Bean page import java util Hashtable page import java sql Timestamp page import java util Date page import java util List page import java util Array List page import java util Linked List include file global jsp page Title i Trust Patient Home include file header jsp session remove Attribute personnel List View My Records Action survey Action new View My Records Action prod logged In long Value List Office Visit Bean sur List prod get Office Visit get Office Visits With No Survey logged In long Value Patient Bean patient new Patient prod get Patient logged In long Value List Report Request Bean reports survey Action get Report Requests View My Report Requests Action report Action new View My Report Requests Action prod logged In long Value Lab Procedure lp new Lab Procedure prod List Lab Procedure Bean lab Procedures lp get Lab Procedures For Patient For Next Month logged In long Value List Patient Bean represented new Patient prod get Represented logged In long Value Transaction trans new Transaction prod Personnel personnel new Personnel prod Create an Array List and index to hide Ds from user List Personnel Bean personnel List new Array List Personnel Bean int personnel counter logging Action log Event Transaction Type logged In long Value if request get Parameter rep null request get Parameter rep equals div align center span class i Trust Message String Escape Utils escape Html Adverse Event Successfully Reported span div div id Content align left include file auth patient notification Area jsp include file auth patient activity Feed jsp div include file footer jsp 
page import edu ncsu csc itrust dao Factory page import edu ncsu csc itrust beans Diagnosis Bean page import edu ncsu csc itrust beans Medication Bean page import edu ncsu csc itrust beans Lab Procedure Bean page import edu ncsu csc itrust action My Diagnosis Action page import edu ncsu csc itrust beans Diagnosis Bean page import edu ncsu csc itrust dao mysql page import edu ncsu csc itrust beans Personnel Bean page import edu ncsu csc itrust beans Prescription Bean page import edu ncsu csc itrust dao mysql Personnel page import java util List page import java util Array List include file global jsp page Title i Trust My Diagnoses include file header jsp logging Action log Event Transaction Type logged In long Value logged In long Value session remove Attribute personnel List String icdcode request get Parameter icd loinc Factory get Production Instance get My Diagnosis Action action new My Diagnosis Action prod logged In long Value List Diagnosis Bean diagnoses action get Diagnoses input type hidden name form Is Filled value true div align center h Diagnoses h table class f Table tr th Diagnosis th tr for Diagnosis Bean d diagnoses tr td a href my Diagnoses jsp icd String Escape Utils escape Html d get Code String Escape Utils escape Html d get Formatted Description a td tr table div br if icdcode null icdcode equals List Diagnosis Bean hcps action get By Diagnosis icdcode logging Action log Event Transaction Type logged In long Value Find Ps with experience with a diagnosis div align center h Ps having experience with diagnosis String Escape Utils escape Html icdcode h table class f Table tr th th th Number of Patients th th List of Prescriptions th th List of Lab Procedures th th Average Office Visit Satisfaction th th Average Treatment Satisfaction th tr if hcps size List Personnel Bean personnel List new Array List Personnel Bean int index for Diagnosis Bean bean hcps tr td a href i Trust auth view Personnel jsp personnel String Escape Utils escape Html index String Escape Utils escape Html bean get Name a td td String Escape Utils escape Html bean get Num Patients td td if bean get Med List is Empty out print no prescriptions else for Prescription Bean p action get Prescriptions By And bean get icdcode a href view Prescription Information jsp visit String Escape Utils escape Html p get Visit pres String Escape Utils escape Html p get Id String Escape Utils escape Html p get Medication get Code p get Medication get Description prescribed a br td td if bean get Lab List is Empty out print no lab procedures ordered else for Lab Procedure Bean p bean get Lab List String Escape Utils escape Html p get Loinc loinc get Procedures p get Loinc get get Component procedure ordered br td td String Escape Utils escape Html bean get Visit Satisfaction td td String Escape Utils escape Html bean get Treatment Satisfaction td tr Personnel Bean personnel new Personnel prod get Personnel bean get personnel List add personnel index session set Attribute personnel List personnel List else tr td colspan align center No Data td tr table div include file footer jsp 
page import edu ncsu csc itrust action Report Adverse Event Action page import edu ncsu csc itrust beans Adverse Event Bean page import edu ncsu csc itrust beans Patient Bean page import edu ncsu csc itrust beans Link Bean page import edu ncsu csc itrust Bean Builder page import edu ncsu csc itrust beans Personnel Bean page import java util List page import java util Array List taglib uri tags tld prefix itrust page error Page auth exception Handler jsp include file global jsp page Title i Trust Report Adverse Event include file header jsp Report Adverse Event Action action if request get Parameter Comment null session get Attribute null List Link Bean link List new Array List Link Bean link List List Link Bean session get Attribute beanlist List Adverse Event Bean adverse List new Array List Adverse Event Bean boolean bad false for Link Bean l Bean link List if l Bean is Checked action new Report Adverse Event Action l Bean get Prescriber prod logged In long Value Adverse Event Bean ae Bean new Adverse Event Bean ae Bean set logged In ae Bean set Description request get Parameter Comment ae Bean set Drug l Bean get Drug ae Bean set Code l Bean get Code ae Bean set Prescriber l Bean get Prescriber adverse List add ae Bean String msg try action add Report ae Bean logging Action log Event Transaction Type logged In long Value catch Exception e msg e get Message if msg equals bad true div align center span class i Trust Error String Escape Utils escape Html msg span div action new Report Adverse Event Action prod logged In long Value action send Mails adverse List if bad response send Redirect home jsp rep if request get Parameter Comment null session get Attribute null action new Report Adverse Event Action session get Attribute prod logged In long Value Adverse Event Bean ae Bean new Adverse Event Bean ae Bean set logged In ae Bean set Description request get Parameter Comment ae Bean set Drug session get Attribute pres ae Bean set Code session get Attribute code ae Bean new Bean Builder Adverse Event Bean build request get Parameter Map new Adverse Event Bean action add Report ae Bean action send Mail ae Bean logging Action log Event Transaction Type logged In long Value response send Redirect home jsp rep if request get Parameter Comment null request get Parameter null action new Report Adverse Event Action request get Parameter prod logged In long Value session set Attribute request get Parameter session set Attribute pres request get Parameter pres session set Attribute code request get Parameter code div align center form id main Form method get action report Adverse Event jsp h Report an Adverse Event h textarea name Comment cols rows textarea br br input type submit value Save name add Report form div include file footer jsp 
page import edu ncsu csc itrust action Send Message Action page import edu ncsu csc itrust beans Message Bean page import edu ncsu csc itrust beans Patient Bean page import edu ncsu csc itrust beans Personnel Bean page import edu ncsu csc itrust exception Form Validation Exception page import java util List taglib uri tags tld prefix itrust page error Page auth exception Handler jsp include file global jsp page Title i Trust Send a Message include file header jsp Send Message Action action new Send Message Action prod logged In long Value int index int dlhcp Index int representee Index int rep Index if request get Parameter send Message null request get Parameter send Message equals Send try Message Bean message new Message Bean message set From logged In long Value message set To Personnel Bean session get Attribute dlhcp get message set Body request get Parameter message Body message set Subject request get Parameter subject message set Read action send Message message session remove Attribute dlhcp logging Action log Event Transaction Type message get From message get To response send Redirect message Outbox jsp catch Form Validation Exception e div align center span class i Trust Error String Escape Utils escape Html e get Message span div if request get Parameter select null request get Parameter select equals Select if request get Parameter dlhcp null request get Parameter dlhcp equals dlhcp Index Integer parse Int request get Parameter dlhcp else if request get Parameter select Rep null request get Parameter select Rep equals Select if request get Parameter representee null request get Parameter representee equals representee Index Integer parse Int request get Parameter representee if request get Parameter rep null request get Parameter rep equals rep Index Integer parse Int request get Parameter rep else if request get Parameter select Rep null request get Parameter select Rep equals Select if request get Parameter representee null request get Parameter representee equals representee Index Integer parse Int request get Parameter representee div align left form id main Form method get action send Message jsp h Send a Message h if dlhcp Index representee Index List Personnel Bean dlhcps action get My Ps List Patient Bean representees action get My Representees session set Attribute dlhcps dlhcps session set Attribute representees representees h To One of My Ps h if dlhcps size select name dlhcp option value option index for Personnel Bean dlhcp dlhcps option value index String Escape Utils escape Html dlhcp get Full Name option index select input type submit value Select name select else i You have n t declared any Ps i h On Behalf of One of My Representees h if representees size select name representee option value option index for Patient Bean representee representees option value index String Escape Utils escape Html representee get Full Name option index select input type submit value Select name select Rep else i No other patients have declared you as a representative i else if dlhcp Index List Personnel Bean dlhcps List Personnel Bean session get Attribute dlhcps Personnel Bean dlhcp dlhcps get dlhcp Index session set Attribute dlhcp dlhcp h To String Escape Utils escape Html dlhcp get Full Name h span Subject span input type text name subject size br br span Message span br textarea name message Body cols rows textarea br br input type submit value Send name send Message else if rep Index List Personnel Bean rep Ps List Personnel Bean session get Attribute rep Ps Personnel Bean dlhcp rep Ps get rep Index session set Attribute dlhcp dlhcp List Patient Bean representees List Patient Bean session get Attribute representees Patient Bean representee representees get representee Index h To String Escape Utils escape Html dlhcp get Full Name on Behalf of String Escape Utils escape Html representee get Full Name h span Subject span input type text name subject size br br span Message span br textarea name message Body cols rows textarea br br input type submit value Send name send Message else if representee Index List Patient Bean representees List Patient Bean session get Attribute representees Patient Bean representee representees get representee Index List Personnel Bean rep Ps action get Ps For representee get session set Attribute rep Ps rep Ps h To One of String Escape Utils escape Html representee get Full Name s Ps h input type hidden name representee value String Escape Utils escape Html representee Index if rep Ps size select name rep option value option index for Personnel Bean rep rep Ps option value index String Escape Utils escape Html rep get Full Name option index select input type submit value Select name select Rep else i String Escape Utils escape Html representee get Full Name has not declared any Ps i form div include file footer jsp 
page language java content Type text html charset page Encoding page import edu ncsu csc itrust beans Survey Bean page import edu ncsu csc itrust action Survey Action page import edu ncsu csc itrust Bean Builder page import edu ncsu csc itrust exception i Trust Exception page error Page auth exception Handler jsp taglib uri tags tld prefix itrust include file global jsp page Title i Trust Patient Survey include file header jsp Survey Action action new Survey Action prod logged In long Value Survey Bean survey Bean null long visit get office visit from previous String visit Str request get Parameter ov String visit Date Str request get Parameter ov Date if visit Str null visit Str equals try visit Long parse Long visit Str catch Exception e e print Stack Trace boolean form Is Filled request get Parameter form Is Filled null request get Parameter form Is Filled equals true if form Is Filled survey Bean new Bean Builder Survey Bean build request get Parameter Map new Survey Bean survey Bean set Visit visit String waiting Minutes request get Parameter waiting Minutes String if waiting Minutes null waiting Minutes equals survey Bean set Waiting Room Minutes Integer parse Int waiting Minutes String exam Minutes request get Parameter exam Minutes String if exam Minutes null exam Minutes equals survey Bean set Exam Room Minutes Integer parse Int exam Minutes update satisfaction number in bean if request get Parameter Satradios null if request get Parameter Satradios equals sat Radio survey Bean set Visit Satisfaction if request get Parameter Satradios equals sat Radio survey Bean set Visit Satisfaction if request get Parameter Satradios equals sat Radio survey Bean set Visit Satisfaction if request get Parameter Satradios equals sat Radio survey Bean set Visit Satisfaction if request get Parameter Satradios equals sat Radio survey Bean set Visit Satisfaction update treatment number in bean if request get Parameter Treradios null if request get Parameter Treradios equals tre Radio survey Bean set Treatment Satisfaction if request get Parameter Treradios equals tre Radio survey Bean set Treatment Satisfaction if request get Parameter Treradios equals tre Radio survey Bean set Treatment Satisfaction if request get Parameter Treradios equals tre Radio survey Bean set Treatment Satisfaction if request get Parameter Treradios equals tre Radio survey Bean set Treatment Satisfaction try add survey data action add Survey survey Bean visit logging Action log Event Transaction Type logged In long Value action get Patient visit Office visit for completed survey is visit Str response send Redirect view My Records jsp message Survey Successfully Submitted catch Exception e span String Escape Utils escape Html e get Message span else if visit Date Str contains throw new i Trust Exception Illegal parameter for ov Date div id Header h i Trust Patient Survey for Office Visit on String Escape Utils escape Html visit Date Str h div div id Content form action survey jsp method post name main Form input type hidden name form Is Filled value true input type hidden name ov value String Escape Utils escape Html visit Str h How long did you have to wait during your visit h table tr td In the waiting room td td input type text name waiting Minutes String maxlength size td td minutes td tr tr td In the examination room br before seeing your physician td td input type text name exam Minutes String maxlength size td td minutes td tr table h How satisfied were you with your office visit h table tr td tr td input align left type radio name Satradios value sat Radio Very Satisfied br td tr tr td input align left type radio name Satradios value sat Radio Satisfied br td tr tr td input align left type radio name Satradios value sat Radio Moderately Satisfied br td tr tr td input align left type radio name Satradios value sat Radio Somewhat Unhappy br td tr tr td input align left type radio name Satradios value sat Radio Very Unhappy br td tr table h How satisfied were you with the treatment or information you received h table tr td tr td input align left type radio name Treradios value tre Radio Very Satisfied br td tr tr td input align left type radio name Treradios value tre Radio Satisfied br td tr tr td input align left type radio name Treradios value tre Radio Moderately Satisfied br td tr tr td input align left type radio name Treradios value tre Radio Somewhat Unhappy br td tr tr td input align left type radio name Treradios value tre Radio Very Unhappy br td tr table br br input type submit style font size pt font weight bold value Submit Survey form div include file footer jsp 
page import edu ncsu csc itrust action View My Access Log Action page import java util List page import edu ncsu csc itrust beans Transaction Bean page import edu ncsu csc itrust exception Form Validation Exception page import edu ncsu csc itrust beans Personnel Bean page import edu ncsu csc itrust dao mysql Personnel page import edu ncsu csc itrust beans Patient Bean page import edu ncsu csc itrust dao mysql Patient page error Page auth exception Handler jsp page import java util Array List page import edu ncsu csc itrust action Get User Name Action include file global jsp page Title i Trust View My Access Log include file header jsp session remove Attribute personnel List View My Access Log Action action new View My Access Log Action Factory get Production Instance logged In List Transaction Bean accesses stores entries in the access log String mid stores the mid of the user whose log is being fetched mid request get Parameter log try to get the id from a request if mid null mid logged In if no mid was set in the request default to the logged in user session set Attribute current Log mid used to check when the user has been changed for log views String log Sess String session get Attribute current Log if log Sess null log Sess equals mid If the requested user is different than the last log reset date filter accesses action get Accesses null null mid false else otherwise run the action with the requested dates try accesses action get Accesses request get Parameter start Date request get Parameter end Date mid role equals request get Parameter sort By catch Form Validation Exception e e print page Context get Out accesses action get Accesses null null mid false session set Attribute current Log mid set the currently viewed so it can be seen later in the session List Patient Bean patient Relatives action get Represented logged In get list of medical dependents for user String log User new Get User Name Action Factory get Production Instance get User Name mid get the name of the user whose logs you re viewing h Viewing Log For log User h br table class f Table align center tr th a href on Click javascript sort By date Date a th th Accessor th th a href on Click javascript sort By role Role a th th Description th tr boolean has Data false List Personnel Bean personnel List new Array List Personnel Bean int index logging Action log Event Transaction Type logged In for Transaction Bean t accesses Personnel Bean hcp new Personnel Factory get Production Instance get Personnel t get Logged In if hcp null has Data true tr td String Escape Utils escape Html t get Time Logged td td a href i Trust auth view Personnel jsp personnel String Escape Utils escape Html index String Escape Utils escape Html hcp get Full Name a td td String Escape Utils escape Html t get Role td td String Escape Utils escape Html t get Transaction Type get Description td tr Personnel Bean personnel new Personnel prod get Personnel t get Logged In personnel List add personnel index else if Personal Health Representative equals t get Role Patient Bean p new Patient Factory get Production Instance get Patient t get Logged In tr td String Escape Utils escape Html t get Time Logged td td String Escape Utils escape Html p get Full Name td td String Escape Utils escape Html t get Role td td String Escape Utils escape Html t get Added Info String Escape Utils escape Html t get Transaction Type get Code td tr session set Attribute personnel List personnel List if has Data tr td colspan align center No Data td tr String start Date action get Default Start accesses String end Date action get Default End accesses if role equals request get Parameter sort By start Date request get Parameter start Date end Date request get Parameter end Date table br br form action view Access Log jsp id log Selection Form method post input type hidden name sort By value input div align center table class f Table align center tr class sub Header td View log for td td select name log id log Select Menu option value logged In String Escape Utils escape Html user Name option for Patient Bean represented patient Relatives if mid equals represented get option selected selected value String Escape Utils escape Html represented get String Escape Utils escape Html represented get Full Name option else option value String Escape Utils escape Html represented get String Escape Utils escape Html represented get Full Name option select td tr tr class sub Header td Start Date td td input name start Date value String Escape Utils escape Html start Date size input type button value Select Date onclick display Date Picker start Date td td End Date td td input name end Date value String Escape Utils escape Html end Date input type button value Select Date onclick display Date Picker end Date td tr table br input type submit name submit value Filter Records div form script type text javascript function sort By date Or Role document get Elements By Name sort By value date Or Role document forms submit click script include file footer jsp 
taglib uri tags tld prefix itrust page error Page auth exception Handler jsp page import java util List page import edu ncsu csc itrust action View Expired Prescriptions Action page import edu ncsu csc itrust beans Patient Bean page import edu ncsu csc itrust beans Prescription Bean page import edu ncsu csc itrust beans Personnel Bean page import edu ncsu csc itrust dao mysql Patient include file global jsp page Title i Trust Get My Expired Prescription Reports include file header jsp logging Action log Event Transaction Type logged In long Value logged In long Value Patient Bean patient new Patient prod get Patient logged In long Value View Expired Prescriptions Action exp Action new View Expired Prescriptions Action prod logged In long Value List Personnel Bean personnel List prod get Personnel get All Personnel session set Attribute personnel List personnel List div align center br table class f Table List Prescription Bean prescriptions exp Action get Prescriptions For Patient logged In long Value if prescriptions size tr td colspan i No prescriptions found i td tr else tr th colspan String Escape Utils escape Html patient get Full Name th tr tr class sub Header td Code td td Description td td Duration td td Prescribing td tr for Prescription Bean prescription prescriptions Personnel Bean doctor exp Action get Prescribing Doctor prescription tr td a href view Prescription Information jsp visit String Escape Utils escape Html prescription get Visit pres String Escape Utils escape Html prescription get Id String Escape Utils escape Html prescription get Medication get Code Formatted a td td String Escape Utils escape Html prescription get Medication get Description td td String Escape Utils escape Html prescription get Start Date Str to String Escape Utils escape Html prescription get End Date Str td td a href view jsp index String Escape Utils escape Html doctor get Index In personnel List String Escape Utils escape Html doctor get Full Name a td tr table br div include file footer jsp 
taglib uri tags tld prefix itrust page error Page auth exception Handler jsp page import java util List page import java util Array List page import edu ncsu csc itrust dao Factory page import edu ncsu csc itrust beans Patient Bean page import edu ncsu csc itrust beans Visit Bean page import edu ncsu csc itrust beans Office Visit Bean page import edu ncsu csc itrust action View Visited Ps Action page import edu ncsu csc itrust beans Personnel Bean page import edu ncsu csc itrust dao mysql Patient page import edu ncsu csc itrust exception i Trust Exception include file global jsp page Title Information include file header jsp script type text javascript function remove form document get Element By Id remove value document get Element By Id form submit script int index Integer parse Int request get Parameter index Personnel Bean my List Personnel Bean session get Attribute personnel List get index logging Action log Event Transaction Type logged In long Value div align center table class f Table tr th colspan String Escape Utils escape Html my get Full Name th tr tr td Specialty td td String Escape Utils escape Html my get Specialty null my get Specialty td tr tr td Address td td String Escape Utils escape Html my get Street Address br String Escape Utils escape Html my get Street Address br String Escape Utils escape Html my get City equals my get City String Escape Utils escape Html my get State my get Zip td tr tr td Phone td td String Escape Utils escape Html my get Phone equals my get Phone td tr tr td Email td td String Escape Utils escape Html my get Email td tr table div include file footer jsp 
page import edu ncsu csc itrust action View My Messages Action page import edu ncsu csc itrust beans Message Bean page import edu ncsu csc itrust dao Factory page import java util List taglib uri tags tld prefix itrust page error Page auth exception Handler jsp include file global jsp page Title i Trust View My Messages include file header jsp div align center h My Messages h logging Action log Event Transaction Type logged In View My Messages Action action new View My Messages Action prod logged In long Value List Message Bean messages action get All My Messages session set Attribute messages messages if messages size table class f Table tr th Sender th th Message th th Received th th nbsp th tr int index for Message Bean message messages tr td String Escape Utils escape Html action get Personnel Name message get From td td String Escape Utils escape Html message get Body td td String Escape Utils escape Html message get Sent Date td td a href reply jsp msg String Escape Utils escape Html index Reply a td tr index table else div i You have no messages i div br br div include file footer jsp 
taglib uri tags tld prefix itrust page error Page auth exception Handler jsp page import java util Array List page import java util List page import java text Date Format page import java util Date page import edu ncsu csc itrust action Edit Action page import edu ncsu csc itrust beans Patient Bean page import edu ncsu csc itrust beans Personnel Bean page import edu ncsu csc itrust beans Allergy Bean page import edu ncsu csc itrust beans Family Member Bean page import edu ncsu csc itrust beans Health Record page import edu ncsu csc itrust beans Office Visit Bean page import edu ncsu csc itrust beans Procedure Bean page import edu ncsu csc itrust action View My Records Action page import edu ncsu csc itrust dao mysql Patient page import edu ncsu csc itrust dao mysql Personnel include file global jsp page Title i Trust View My Records include file header jsp session remove Attribute personnel List Long original Logged In logged In String representee request get Parameter rep boolean is Representing false if representee null equals representee int representee Index Integer parse Int representee List Patient Bean representees List Patient Bean session get Attribute representees if representees null logged In new Long representees get representee Index get session remove Attribute representees is Representing true logged In new Long action represent Patient representee span You are currently viewing your representee s records span br Patient Bean patient new Patient prod get Patient logged In long Value Date Format df Date Format get Date Instance View My Records Action action new View My Records Action prod logged In long Value patient action get Patient List Health Record records action get All Health Records List Office Visit Bean office Visits action get All Office Visits List Family Member Bean family action get Family History List Allergy Bean allergies action get Allergies List Patient Bean represented action get Represented logging Action log Event Transaction Type original Logged In patient get if request get Parameter message null div class i Trust Message style font size px align center String Escape Utils escape Html request get Parameter message div br table align center tr td div style float left margin right px table class f Table border align center tr th colspan Patient Information th tr tr td class sub Header Vertical Name td td String Escape Utils escape Html patient get Full Name td tr tr td class sub Header Vertical Address td td String Escape Utils escape Html patient get Street Address br equals patient get Street Address patient get Street Address br String Escape Utils escape Html patient get Street Address br td tr tr td class sub Header Vertical Phone td td String Escape Utils escape Html patient get Phone td tr tr td class sub Header Vertical Email td td String Escape Utils escape Html patient get Email td tr tr th colspan Insurance Information th tr tr td class sub Header Vertical Provider Name td td String Escape Utils escape Html patient get Ic Name td tr tr td class sub Header Vertical Address td td String Escape Utils escape Html patient get Ic Address br equals patient get Ic Address patient get Ic Address br String Escape Utils escape Html patient get Ic Address br td tr tr td class sub Header Vertical Phone td td String Escape Utils escape Html patient get Ic Phone td tr table div div style float left margin left px table class f Table border align center tr th Office Visits th th Survey th tr for Office Visit Bean ov office Visits tr td a href view Office Visit jsp ov String Escape Utils escape Html ov get Visit is Representing rep logged In long Value String Escape Utils escape Html df format ov get Visit Date a td if action is Survey Completed ov get Visit td nbsp td else td a href survey jsp ov String Escape Utils escape Html ov get Visit ov Date String Escape Utils escape Html df format ov get Visit Date Complete Visit Survey a td tr tr td colspan align center a href view Prescription Records jsp String Escape Utils escape Html is Representing rep logged In long Value Get Prescriptions a td tr table div td tr table br br table class f Table align center tr th colspan Family Medical History th tr tr class sub Header td Name td td Relation td td High Blood Pressure td td High Cholesterol td td Diabetes td td Cancer td td Heart Disease td td Smoker td td Cause of Death td tr if family size tr td colspan style text align center No Relations on record td tr else for Family Member Bean member family tr td String Escape Utils escape Html member get Full Name td td String Escape Utils escape Html member get Relation td td align center action does Family Member Have High member x td td align center action does Family Member Have High Cholesterol member x td td align center action does Family Member Have Diabetes member x td td align center action does Family Member Have Cancer member x td td align center action does Family Member Have Heart Disease member x td td align center action is Family Member Smoker member x td td String Escape Utils escape Html action get Family Member member td tr table br br table align center tr td div style float left margin right px table class f Table align center tr th colspan Allergies th tr tr class sub Header td Allergy Description td td First Found td tr if allergies size tr td colspan No Allergies on record td tr else for Allergy Bean allergy allergies tr td String Escape Utils escape Html allergy get Description td td String Escape Utils escape Html df format allergy get First Found td tr table div div style float left margin left px table class f Table tr th Patients String Escape Utils escape Html patient get First Name Represents th tr tr class sub Header td Patient td tr if represented size tr td String Escape Utils escape Html patient get First Name is not representing any patients td tr else int index for Patient Bean p represented tr td if is Representing String Escape Utils escape Html p get Full Name else a href view My Records jsp rep String Escape Utils escape Html index String Escape Utils escape Html p get Full Name a td tr index if is Representing session set Attribute representees represented table div td tr table br br table class f Table align center tr th colspan Basic Health History th tr tr class sub Header td Height td td Weight td td Smokes td td Blood Pressure td td td td td td Triglycerides td td Total Cholesterol td td Last Recorded td td By Personnel td tr if records size List Personnel Bean personnel List new Array List Personnel Bean int index for Health Record hr records tr td String Escape Utils escape Html hr get Height in td td String Escape Utils escape Html hr get Weight lbs td td String Escape Utils escape Html hr is Smoker td td String Escape Utils escape Html hr get Blood Pressure mm Hg td td String Escape Utils escape Html hr get Cholesterol mg d td td String Escape Utils escape Html hr get Cholesterol mg d td td String Escape Utils escape Html hr get Cholesterol Tri mg d td td String Escape Utils escape Html hr get Total Cholesterol mg d td td String Escape Utils escape Html df format hr get Date Recorded td Personnel Bean personnel new Personnel prod get Personnel hr get Personnel if personnel null personnel List add personnel td if personnel null a href i Trust auth view Personnel jsp personnel String Escape Utils escape Html index String Escape Utils escape Html personnel get Full Name a td tr index session set Attribute personnel List personnel List else tr td colspan align center No Data td tr table br br table class f Table align center tr th colspan Immunizations th tr tr class sub Header td Code th td Description th td Date Received th td Adverse Event th tr boolean has No Data true for Office Visit Bean ov office Visits List Procedure Bean ov Procs action get Procedures ov get Visit for Procedure Bean proc ov Procs if null proc get Attribute proc get Attribute equals immunization has No Data false tr td String Escape Utils escape Html proc get Code td td String Escape Utils escape Html proc get Description td td String Escape Utils escape Html proc get Date td td Date date new Date date set Year date get Year if proc get Date after date a href report Adverse Event jsp pres String Escape Utils escape Html proc get Description String Escape Utils escape Html ov get Hcp code String Escape Utils escape Html proc get Code Report a td tr if has No Data tr td colspan align center No Data td tr table br include file footer jsp 
taglib uri tags tld prefix itrust page error Page auth exception Handler jsp page import java util List page import edu ncsu csc itrust action View Prescription Records Action page import edu ncsu csc itrust beans Patient Bean page import edu ncsu csc itrust beans Link Bean page import edu ncsu csc itrust beans Prescription Bean page import edu ncsu csc itrust exception Form Validation Exception page import java util Array List page import java util Date page import edu ncsu csc itrust dao mysql Patient include file global jsp page Title i Trust Get My Prescription Report include file header jsp List Link Bean Link List new Array List Link Bean Patient Bean patient new Patient prod get Patient logged In long Value View Prescription Records Action action new View Prescription Records Action prod logged In long Value List Patient Bean representees action get Representees boolean show Mine false boolean show Other false boolean ad Event false boolean show Adverse Button false if request get Parameter mine null request get Parameter mine equals View Current show Mine true if request get Parameter other null request get Parameter other equals View show Other true if request get Parameter representee null request get Parameter representee equals show Other false if request get Parameter adevent null request get Parameter adevent equals Report Adverse Events ad Event true int check new int boolean one Checked false for int i i i if null request get Parameter checking i request get Parameter checking i to Lower Case equals y check i one Checked true List Link Bean l List Link Bean session get Attribute beanlist int i for Link Bean b l if check i b set Checked true else b set Checked false i session set Attribute beanlist l if one Checked response send Redirect report Adverse Event jsp prescriptions yes else div align center span class i Trust Error String Escape Utils escape Html Must report on at least one prescription span div div align center form action view Prescription Records jsp method post table tr td span style font size px font weight bold View My Own Prescriptions span td td input type submit name mine value View Current input td tr tr td span style font size px font weight bold View Other s Prescriptions span td if representees size td select name representee option value option int index for Patient Bean representee representees option value index String Escape Utils escape Html representee get Full Name option index select input type submit name other value View input td else td i You are not anyone s representative i td tr table form br table class f Table if show Mine List Prescription Bean prescriptions action get Prescriptions For Patient logged In long Value logging Action log Event Transaction Type logged In logged In if prescriptions size tr td colspan i No prescriptions found i td tr else tr th colspan String Escape Utils escape Html patient get Full Name th tr tr class sub Header td Code td td Description td td Duration td td Prescribing td td Report Adverse Event td tr int a show Adverse Button true for Prescription Bean prescription prescriptions Date date new Date date set Year date get Year if prescription get End Date after date tr td a href view Prescription Information jsp visit String Escape Utils escape Html prescription get Visit pres String Escape Utils escape Html prescription get Id String Escape Utils escape Html prescription get Medication get Code Formatted a td td String Escape Utils escape Html prescription get Medication get Description td td String Escape Utils escape Html prescription get Start Date Str to String Escape Utils escape Html prescription get End Date Str td td String Escape Utils escape Html action get Prescribing Doctor prescription get Full Name td Link Bean Lbean new Link Bean Lbean set Prescriber action get Prescribing Doctor prescription get Lbean set Drug prescription get Medication get Description Lbean set Code prescription get Medication get Code Link List add Lbean td form action view Prescription Records jsp method post input name checking String Escape Utils escape Html a type text value size maxlength input td a tr else if show Other Patient Bean representee representees get Integer parse Int request get Parameter representee logging Action log Event Transaction Type logged In representee get tr th colspan String Escape Utils escape Html representee get Full Name th tr List Prescription Bean prescriptions action get Prescriptions For Patient representee get if prescriptions size tr td colspan i No prescriptions found i td tr else tr class sub Header td Code td td Description td td Duration td td Prescribing td tr for Prescription Bean prescription prescriptions tr td String Escape Utils escape Html prescription get Medication get Code Formatted td td String Escape Utils escape Html prescription get Medication get Description td td String Escape Utils escape Html prescription get Start Date Str to String Escape Utils escape Html prescription get End Date Str td td String Escape Utils escape Html action get Prescribing Doctor prescription get Full Name td tr table br if show Mine show Adverse Button session set Attribute beanlist Link List input type submit name adevent value Report Adverse Events input form div include file footer jsp 
taglib uri tags tld prefix itrust page error Page auth exception Handler jsp page import java util List page import java util Array List page import edu ncsu csc itrust dao Factory page import edu ncsu csc itrust beans Patient Bean page import edu ncsu csc itrust beans Visit Bean page import edu ncsu csc itrust beans Office Visit Bean page import edu ncsu csc itrust action View Visited Ps Action page import edu ncsu csc itrust beans Personnel Bean page import edu ncsu csc itrust dao mysql Patient page import edu ncsu csc itrust exception i Trust Exception include file global jsp page Title i Trust My Providers include file header jsp script type text javascript function remove form document get Element By Id remove value document get Element By Id form submit function hcp checkbox index form if document get Elements By Name doctor index checked else document get Element By Id remove value document get Element By Id form submit script Patient Bean patient new Patient prod get Patient logged In long Value String designate Ps request get Parameter Values doctor String filter Name request get Parameter filter name String filter Specialty request get Parameter filter specialty String filter Zip request get Parameter filter zip String remove request get Parameter remove boolean filtered false View Visited Ps Action action new View Visited Ps Action Factory get Production Instance logged In long Value String confirm try Remove designated if one was selected if remove null remove equals confirm action undeclare remove long hcpid action get Named remove get logging Action log Event Transaction Type logged In hcpid Undeclared remove Set designated Ps if one was selected else if designate Ps null designate Ps equals for String designate designate Ps confirm action declare designate logging Action log Event Transaction Type logged In Declared designate this should be modified to log the added s it logs their name however at the moment Otherwise just view the designated Ps else logging Action log Event Transaction Type logged In catch i Trust Exception ie span String Escape Utils escape Html ie get Message span if equals confirm span String Escape Utils escape Html confirm span List Visit Bean hcplist action filter List filter Name filter Specialty filter Zip br div align center h Provider list for String Escape Utils escape Html patient get Full Name h br form name main Form id main Form action view Visited Ps jsp method post on Submit return false target top input type hidden id remove name remove value table id hcp table class f Table style text align center tr th Name th th Specialty th th Address th th Date of Office Visit th th Designated th tr int i for Visit Bean vb hcplist tr td String Escape Utils escape Html vb get Name td td String Escape Utils escape Html vb get Specialty td td String Escape Utils escape Html vb get Addr td td String Escape Utils escape Html vb get Date td td input name doctor value String Escape Utils escape Html vb get Name type checkbox String Escape Utils escape Html vb is Designated checked checked on Click hcp checkbox String Escape Utils escape Html i String Escape Utils escape Html vb get Name main Form td tr i tr td colspan style color text align right font weight bold font size px Select checkbox to update designated td tr table form div br br form id search Form action view Visited Ps jsp method post div align center table class f Table style border none border tr th colspan Search Ps th tr tr style text align left td class sub Header Vertical Last Name td td input type text name filter name size maxlength td tr tr style text align left td class sub Header Vertical Specialty td td input type text name filter specialty size maxlength td tr tr style text align left td class sub Header Vertical Zip Code td td input type text name filter zip size maxlength td tr table br input type submit name update filter value Search div form include file footer jsp 
page error Page auth exception Handler jsp page import java util List page import java util Date page import java text Simple Date Format page import edu ncsu csc itrust action Monitor Adverse Event Action page import edu ncsu csc itrust beans Adverse Event Bean page import edu ncsu csc itrust exception Form Validation Exception page import edu ncsu csc itrust exception Exception page import edu ncsu csc itrust exception i Trust Exception include file global jsp page Title i Trust Adverse Event Details include file header jsp Monitor Adverse Event Action action new Monitor Adverse Event Action prod logged In long Value if request get Parameter remove null try action remove Integer parse Int request get Parameter id div align center span class i Trust Message Report successfully removed span div logging Action log Event Transaction Type logged In long Value Removed event Integer parse Int request get Parameter id catch Exception e div align center span class i Trust Error String Escape Utils escape Html e get Message span div catch i Trust Exception e div align center span class i Trust Error String Escape Utils escape Html e get Message span div catch Number Format Exception e div align center span class i Trust Error Invalid Adverse Event String Escape Utils escape Html e get Message span div else if request get Parameter more Info null try action send Email Long parse Long request get Parameter patient would like to know more about your experience with this medication logging Action log Event Transaction Type logged In long Value Requested more information on Adverse Event Integer parse Int request get Parameter id div align center span class i Trust Message Request sent span div catch Exception e div align center span class i Trust Error String Escape Utils escape Html e get Message span div catch Number Format Exception e div align center span class i Trust Error Invalid Adverse Event String Escape Utils escape Html e get Message span div else List Adverse Event Bean events List Adverse Event Bean session get Attribute events int num String reporter try num Integer parse Int request get Parameter event Number reporter action get Name Long parse Long events get num get logging Action log Event Transaction Type logged In long Value Viewed event num catch Number Format Exception e div align center span class i Trust Error String Escape Utils escape Html e get Message span div String drug events get num get Drug events get num get Code String date events get num get Date String description events get num get Description form action adverse Event Details jsp input type hidden name id value String Escape Utils escape Html events get num get Id input type hidden name patient value String Escape Utils escape Html Long parse Long events get num get b Reporter b div String Escape Utils escape Html reporter div br b String Escape Utils escape Html session get Attribute prescription Immunization b div String Escape Utils escape Html drug div br b Date b div String Escape Utils escape Html date div br b Description b div style width String Escape Utils escape Html description div br br input type submit value Remove Event name remove input type submit value Request More Information name more Info form session remove Attribute events session remove Attribute prescription Immunization include file footer jsp 
page error Page auth exception Handler jsp page import java util List page import java util Date page import java text Simple Date Format page import edu ncsu csc itrust action Monitor Adverse Event Action page import edu ncsu csc itrust beans Adverse Event Bean page import edu ncsu csc itrust exception Form Validation Exception include file global jsp page Title i Trust Monitor Adverse Events include file header jsp script function show Bar Chart id id id substring id index Of button window open barchart jsp id id barchart width height resizable yes script Monitor Adverse Event Action action new Monitor Adverse Event Action prod logged In long Value List Adverse Event Bean events null String prescription Immunization if request get Parameter prescriptions null try events action get Reports true request get Parameter start Date request get Parameter end Date prescription Immunization Prescription logging Action log Event Transaction Type logged In Prescription catch Form Validation Exception e div align center span class i Trust Error String Escape Utils escape Html e get Message span div else if request get Parameter immunizations null try events action get Reports false request get Parameter start Date request get Parameter end Date prescription Immunization Immunization logging Action log Event Transaction Type logged In Immunization catch Form Validation Exception e div align center span class i Trust Error String Escape Utils escape Html e get Message span div if prescription Immunization session set Attribute events events session set Attribute prescription Immunization prescription Immunization form action adverse Event Details jsp method post input type hidden name event Number value table class f Table align center tr class header th String Escape Utils escape Html prescription Immunization th th Reporter th th Date th th Details th th String Escape Utils escape Html prescription Immunization Reports By Month th tr int i int code Count String current Code if events size current Code events get get Code else tr td colspan align center No adverse events reported td tr for Adverse Event Bean event events if removed equals event get Status tr td if current Code equals event get Code code Count else script document get Element By Id chart String Escape Utils escape Html current Code row Span String Escape Utils escape Html code Count script code Count current Code event get Code String Escape Utils escape Html event get Drug String Escape Utils escape Html event get Code td try td String Escape Utils escape Html action get Name Long parse Long event get td catch Number Format Exception e td Invalid Patient td td String Escape Utils escape Html event get Date td td a href adverse Event Details jsp event Number String Escape Utils escape Html i Get Details a td if code Count td id chart String Escape Utils escape Html current Code rowspan a href adverse Event Chart jsp code String Escape Utils escape Html current Code View Chart a td tr i table script document get Element By Id chart String Escape Utils escape Html current Code row Span code Count script form else String start Date new Simple Date Format dd yyyy format new Date String end Date new Simple Date Format dd yyyy format new Date form action monitor Adverse Events jsp method post table class f Table align center tr class sub Header td Start Date td td input name start Date value String Escape Utils escape Html start Date size input type button value Select Date td td End Date td td input name end Date value String Escape Utils escape Html end Date size input type button value Select Date td tr table br br div align center input type submit value Prescriptions name prescriptions input type submit value Immunizations name immunizations div br form include file footer jsp 
page language java content Type text html charset page Encoding page import edu ncsu csc itrust beans Survey Result Bean page import edu ncsu csc itrust beans Hospital Bean page import edu ncsu csc itrust action View Survey Result Action page import edu ncsu csc itrust Bean Builder page import edu ncsu csc itrust exception Form Validation Exception page import edu ncsu csc itrust dao mysql Hospitals page import edu ncsu csc itrust beans Personnel Bean page import edu ncsu csc itrust dao mysql Personnel page import java util Array List page import java util List taglib prefix itrust uri tags tld page error Page auth exception Handler jsp include file global jsp page Title i Trust Survey Results login Message session remove Attribute personnel List include file header jsp div align center h Search Survey Results h View Survey Result Action action new View Survey Result Action prod logged In long Value Hospitals hospital new Hospitals prod List Hospital Bean hcp Hospitals hospital get All Hospitals Survey Result Bean bean null String zip Code String hospital String specialty List Survey Result Bean result List null boolean form Is Filled request get Parameter form Is Filled null request get Parameter form Is Filled equals true if form Is Filled bean new Bean Builder Survey Result Bean build request get Parameter Map new Survey Result Bean try set data to be sent from input text box and drop down box zip Code request get Parameter hcp Zip hospital request get Parameter hcp Hospital specialty request get Parameter hcp Specialty do not submit if zip is not filled in if zip Code equals zip Code null hospital equals hospital null span Data for both Zip Code and Hospital is not allowed Please choose either Zip or Hospital span else if zip Code equals zip Code null bean set Pzip zip Code bean set Pspecialty specialty result List action get Survey Results For Zip bean logging Action log Event Transaction Type logged In long Value searched results by zip code else if hospital equals hospital null bean set Phospital hospital bean set Pspecialty specialty result List action get Survey Results For Hospital bean logging Action log Event Transaction Type logged In long Value searched results by Hospital else span You must enter either a zip code or a hospital span catch Form Validation Exception e e print page Context get Out form action survey Results jsp method post input type hidden name form Is Filled value true br div style width text align left This search allows you to search for a based on a zip code or hospital To search you must enter either a zip code a hospital but not both br Note Search by zip code returns all Ps that have zip codes with a match of the first digits br br div table tr td Zip Code td td input type text name hcp Zip maxlength size value String Escape Utils escape Html zip Code td td td td Hospital td td select name hcp Hospital option value option for Hospital Bean hos hcp Hospitals option value hos get Hospital if hos get Hospital equals hospital selected selected String Escape Utils escape Html hos get Hospital option select td tr tr td colspan align center Specialty optional td tr tr td colspan align center select name hcp Specialty option value String Escape Utils escape Html Survey Result Bean if specialty equals Survey Result Bean selected selected Any Specialty option option value Survey Result Bean if specialty equals Survey Result Bean selected selected String Escape Utils escape Html Survey Result Bean option option value Survey Result Bean if specialty equals Survey Result Bean selected selected String Escape Utils escape Html Survey Result Bean option option value Survey Result Bean if specialty equals Survey Result Bean selected selected String Escape Utils escape Html Survey Result Bean option option value Survey Result Bean if specialty equals Survey Result Bean selected selected String Escape Utils escape Html Survey Result Bean option option value Survey Result Bean if specialty equals Survey Result Bean selected selected String Escape Utils escape Html Survey Result Bean option select td tr tr tr td colspan align center input type submit style font size pt font weight bold value Search td tr table form if result List null br h Survey Results h if result List size span class i Trust Error No Ps were found that meet your search criteria Please change your search criteria and search again span else table class f Table tr th colspan Search Results th tr tr class sub Header th Doctor s Name th th Address th th Address th th City th th State th th Zip th th Specialty th th Hospital th th Waiting Room br Minutes th th Exam Room br Minutes th th Visit br Satisfaction th th Treatment br Satisfaction th th Percent br Results th tr List Personnel Bean personnel List new Array List Personnel Bean int index for Survey Result Bean survey Result result List tr td align center a href i Trust auth view Personnel jsp personnel String Escape Utils escape Html index String Escape Utils escape Html survey Result get First Name String Escape Utils escape Html survey Result get Last Name a td td align center String Escape Utils escape Html survey Result get Paddress td td align center String Escape Utils escape Html survey Result get Paddress td td align center String Escape Utils escape Html survey Result get Pcity td td align center String Escape Utils escape Html survey Result get Pstate td td align center String Escape Utils escape Html survey Result get Pzip td td align center String Escape Utils escape Html survey Result get Pspecialty td td align center String Escape Utils escape Html survey Result get Phospital td td align center String format f survey Result get Avg Waiting Room Minutes td td align center String format f survey Result get Avg Exam Room Minutes td td align center String format f survey Result get Avg Visit Satisfaction td td align center String format f survey Result get Avg Treatment Satisfaction td td align center String format f survey Result get Percent Satisfaction Results td tr Personnel Bean personnel new Personnel prod get Personnel survey Result get personnel List add personnel index session set Attribute personnel List personnel List table table tr td i The search results show the the averages for each and include i ol li Number of minutes patients typically wait in a waiting room li Average number of minutes patients wait in the examination room prior to seeing a physician li Average office visit satisfaction li Average satisfaction with treatment information li Percent of office visits for which satisfaction information is available ol td tr table br div include file footer jsp 
page import edu ncsu csc itrust enums Transaction Type page import edu ncsu csc itrust beans Operational Profile page import java text Number Format include file global jsp page Title i Trust Tester Home include file header jsp div style text align center h Operational Profile h try Operational Profile op prod get Transaction get Operational Profile logging Action log Event Transaction Type logged In Number Format formatter Number Format get Percent Instance table class fancy Table align center border cellpadding cellspacing tr th Operation th th colspan Total th th colspan Patients Only th th colspan Personnel Only th tr int i for Transaction Type type Transaction Type values tr i class alt td align left String Escape Utils escape Html type get Description td td align center String Escape Utils escape Html op get Total Count get type td td align center String Escape Utils escape Html formatter format double op get Total Count get type op get Num Total Transactions td td align center String Escape Utils escape Html op get Patient Count get type td td align center String Escape Utils escape Html formatter format double op get Patient Count get type op get Num Patient Transactions td td align center String Escape Utils escape Html op get Personnel Count get type td double personnel Percent if op get Num Personnel Transactions personnel Percent double op get Personnel Count get type op get Num Personnel Transactions td align center String Escape Utils escape Html formatter format personnel Percent td tr tr td b Totals b td td colspan align center String Escape Utils escape Html op get Num Total Transactions td td colspan align center String Escape Utils escape Html op get Num Patient Transactions td td colspan align center String Escape Utils escape Html op get Num Personnel Transactions td tr table div catch Exception e span Exception Occurred span br String Escape Utils escape Html e get Message e print Stack Trace include file footer jsp 
page import java util List page import edu ncsu csc itrust beans Patient Bean page import edu ncsu csc itrust beans Remote Monitoring Data Bean page import edu ncsu csc itrust beans Telemedicine Bean page import edu ncsu csc itrust exception Form Validation Exception page import edu ncsu csc itrust action Add Remote Monitoring Data Action page import edu ncsu csc itrust exception i Trust Exception taglib prefix itrust uri tags tld page error Page auth exception Handler jsp include file global jsp page Title i Trust Report Status include file header jsp String switch String if request get Parameter switch null switch String request get Parameter switch String patient String if request get Parameter patient null patient String request get Parameter patient String pid String if switch String equals true pid String else if patient String equals int patient Index Integer parse Int patient String List Long patients List Long session get Attribute patients pid String patients get patient Index session remove Attribute patients session remove Attribute patient session set Attribute pid pid String else pid String String session get Attribute pid if pid String null pid String length response send Redirect uap get Patient Monitor List jsp forward add Telemedicine Data jsp return Add Remote Monitoring Data Action action new Add Remote Monitoring Data Action prod logged In long Value Long parse Long pid String List Telemedicine Bean t Beans action get Telemedicine Bean Long parse Long pid String Default to allow none if t Beans size Telemedicine Bean b new Telemedicine Bean b set Systolic Blood Pressure Allowed false b set Diastolic Blood Pressure Allowed false b set Glucose Level Allowed false b set Height Allowed false b set Weight Allowed false b set Pedometer Reading Allowed false t Beans add b Update information boolean form Is Filled request get Parameter form Is Filled null request get Parameter form Is Filled equals true if form Is Filled try boolean glucose Submitted request get Parameter glucose Level null equals request get Parameter glucose Level boolean systolic Submitted request get Parameter systolic Blood Pressure null equals request get Parameter systolic Blood Pressure boolean diastolic Submitted request get Parameter diastolic Blood Pressure null equals request get Parameter diastolic Blood Pressure boolean height Submitted request get Parameter height null equals request get Parameter height boolean weight Submitted request get Parameter weight null equals request get Parameter weight boolean pedometer Submitted request get Parameter pedometer Reading null equals request get Parameter pedometer Reading if diastolic Submitted systolic Submitted div align center span class i Trust Error Systolic and Diastolic Blood Pressure must be submitted together span div else int glucose Level glucose Submitted Integer parse Int request get Parameter glucose Level int systolic systolic Submitted Integer parse Int request get Parameter systolic Blood Pressure int diastolic diastolic Submitted Integer parse Int request get Parameter diastolic Blood Pressure float height height Submitted Float parse Float request get Parameter height f float weight weight Submitted Float parse Float request get Parameter weight f int pedometer pedometer Submitted Integer parse Int request get Parameter pedometer Reading Remote Monitoring Data Bean rmd Bean new Remote Monitoring Data Bean rmd Bean set Glucose Level glucose Level rmd Bean set Systolic Blood Pressure systolic rmd Bean set Diastolic Blood Pressure diastolic rmd Bean set Height height rmd Bean set Weight weight rmd Bean set Pedometer Reading pedometer action add Remote Monitoring Data rmd Bean logging Action log Event Transaction Type logged In Long parse Long pid String div align center span class i Trust Message Information Successfully Added span div session remove Attribute pid catch Form Validation Exception e form Is Filled false div align center span class i Trust Error String Escape Utils escape Html e get Message span div catch Number Format Exception e form Is Filled false div align center span class i Trust Error Invalid entry String Escape Utils escape Html e get Message Please enter a whole number span div catch i Trust Exception e form Is Filled false div align center span class i Trust Error Invalid entry String Escape Utils escape Html e get Message span div if form Is Filled If conflict exists with multiple Ps allow the input boolean report Blood Pressure false boolean report Glucose false boolean report Height false boolean report Weight false boolean report Pedometer false for Telemedicine Bean tb t Beans if tb is Systolic Blood Pressure Allowed tb is Diastolic Blood Pressure Allowed report Blood Pressure true if tb is Glucose Level Allowed report Glucose true if tb is Height Allowed report Height true if tb is Weight Allowed report Weight true if tb is Pedometer Reading Allowed report Pedometer true form action add Telemedicine Data jsp method post input type hidden name form Is Filled value true br table cellspacing align center cellpadding tr if report Blood Pressure report Glucose report Height report Weight report Pedometer td valign top table class f Table align center style width px if report Blood Pressure tr td class sub Header Vertical Systolic Blood Pressure td td input name systolic Blood Pressure value type text td tr tr td class sub Header Vertical Diastolic Blood Pressure td td input name diastolic Blood Pressure value type text td tr if report Glucose tr td class sub Header Vertical Glucose Level td td input name glucose Level value type text td tr if report Height tr td class sub Header Vertical Height td td input name height value type text td tr if report Weight tr td class sub Header Vertical Weight td td input name weight value type text td tr if report Pedometer tr td class sub Header Vertical Pedometer Reading td td input name pedometer Reading value type text td tr table td td width px nbsp td td valign top td tr table br div align center if report Blood Pressure report Glucose report Height report Weight report Pedometer input type submit name action style font weight bold value Report else You are not authorized to report any telemedicine data for this patient br input type submit name action style font weight bold value Report disabled br br div form include file footer jsp 
taglib uri tags tld prefix itrust page error Page auth exception Handler jsp page import java util Array List page import java util List page import edu ncsu csc itrust beans Remote Monitoring Data Bean page import edu ncsu csc itrust beans Telemedicine Bean page import edu ncsu csc itrust action View My Remote Monitoring List Action page import edu ncsu csc itrust action Add Remote Monitoring Data Action include file global jsp page Title i Trust View Monitored Patients logging Action log Event Transaction Type logged In long Value Viewed monitored patients include file header jsp View My Remote Monitoring List Action action new View My Remote Monitoring List Action prod logged In long Value List Remote Monitoring Data Bean data action get Patient Data Without Logging br form action get Patient Monitor List jsp method post name myform table class f Table align center tr th colspan Patients th tr tr class sub Header th Patient th tr List Long patients new Array List Long int index List Telemedicine Bean t Beans boolean is Monitored false Add Remote Monitoring Data Action rmd Action new Add Remote Monitoring Data Action prod logged In long Value for Remote Monitoring Data Bean bean data if patients contains bean get Patient t Beans rmd Action get Telemedicine Bean bean get Patient is Monitored false for Telemedicine Bean tb t Beans if tb is Diastolic Blood Pressure Allowed tb is Glucose Level Allowed tb is Height Allowed tb is Pedometer Reading Allowed tb is Systolic Blood Pressure Allowed tb is Weight Allowed is Monitored true break if is Monitored patients add bean get Patient tr td a href request get Parameter forward patient String Escape Utils escape Html index String Escape Utils escape Html action get Patient Name bean get Patient a td tr index session set Attribute patients patients table form br br include file footer jsp 
package edu ncsu csc itrust dao mysql import java sql Connection import java sql Prepared Statement import java sql Result Set import java sql Exception import edu ncsu csc itrust Util import edu ncsu csc itrust Random Password import edu ncsu csc itrust dao Factory import edu ncsu csc itrust enums Role import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception i Trust Exception Auth is for anything that has to do with authentication Most methods access the users table stands for Database Access Object All Os are intended to be reflections of the database that is one per table in the database most of the time For more complex sets of queries extra Os are added Os can assume that all data has been validated and is correct Os should never have setters or any other parameter to the constructor than a factory All Os should be accessed by Factory see link Factory and every should have a factory for obtaining connections and or accessing other Os author Andy public class Auth public static final long min private Factory factory The typical constructor param factory The link Factory associated with this which is used for obtaining connections etc public Auth Factory factory this factory factory Add a particular user to the system Does not add user specific information e g Patient or Initially sets security question to a random set of characters so that nobody should be able to guess its value param mid The user s as a Long param role The role of the user as a Role enum link Role param password The password for the new user return string representing the newly added randomly generated password throws Exception public String add User Long mid Role role String password throws Exception Connection conn null Prepared Statement pstmt null try conn factory get Connection pstmt conn prepare Statement Users s Question s Answer pstmt set Long mid pstmt set String password pstmt set String role to String pstmt set String Enter the random password given in your account email String pwd Random Password get Random Password pstmt set String pwd pstmt execute Update return pwd catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn pstmt Reset the security question and answer for a particular user param question The security question as a string param answer The security answer as a string param mid The of the user as a long throws Exception public void set Security Question Answer String question String answer long mid throws Exception Connection conn null Prepared Statement pstmt null try conn factory get Connection pstmt conn prepare Statement Users s Question s Answer pstmt set String question pstmt set String answer pstmt set Long mid pstmt execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn pstmt Returns the user name of a user from just the param mid The of the user to get the name of return The user s name as a String throws Exception throws i Trust Exception public String get User Name long mid throws Exception i Trust Exception Role role get User Role mid switch role case case case case case case return factory get Personnel get Name mid case return factory get Patient get Name mid case return String value Of mid default throw new i Trust Exception Role role not supported Returns the role of a particular param mid The of the user to look up return The link Role of the user as an enum throws Exception throws i Trust Exception public Role get User Role long mid throws Exception i Trust Exception Connection conn null Prepared Statement pstmt null try conn factory get Connection pstmt conn prepare Statement role Users pstmt set Long mid Result Set rs rs pstmt execute Query if rs next return Role parse rs get String role else throw new i Trust Exception User does not exist catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn pstmt Change the password of a particular user param mid The of the user whose password we are changing param password The new password throws Exception public void reset Password long mid String password throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Users password ps set String password ps set Long mid ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Return the security question for a particular user param mid The of the user we are looking up return The security question of the user we are looking up throws i Trust Exception public String get Security Question long mid throws i Trust Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement s Question Users ps set Long mid Result Set r ps execute Query if r next return r get String s Question else throw new i Trust Exception No security question set for mid catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Return the security answer of a particular user param mid The of the user we are looking up return The security answer as a String throws i Trust Exception public String get Security Answer long mid throws i Trust Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement s Answer Users ps set Long mid Result Set r ps execute Query if r next return r get String s Answer else throw new i Trust Exception No security answer set for mid catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Record a login failure which blacklists the ip Address Uses the database table like a hash table where the key is the user s address If the user s address is not in the table a row with is added param ip Addr The address of the user as a String throws Exception public void record Login Failure String ip Addr throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Login Failures Failure Count Failure Count last Failure Address prepare Statement Login Failures ps set String ip Addr ps set Int failures ps set Date Calendar get Instance get Time int num Updated ps execute Update if num Updated if there was n t an empty row to begin with insert Login Failure Row ip Addr conn now they have a row a strike against em catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Record a reset password failure which blacklists the ip Address Uses the database table like a hash table where the key is the user s address If the user s address is not in the table a row with is added param ip Addr The address of the user as a String throws Exception public void record Reset Password Failure String ip Addr throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Reset Password Failures failurecount failurecount ipaddress ps set String ip Addr int num Updated ps execute Update if num Updated if there was n t an empty row to begin with insert Reset Password Row ip Addr conn now they have a row a strike against catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Return the number of failures from resetting a password given an address param ip Addr An address for the associated attempt as a String return An int representing the number of failures throws Exception public int get Reset Password Failures String ip Addr throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Reset Password Failures ps set String ip Addr Result Set rs ps execute Query if rs next if we re more than minutes out clear the failure count if System current Time Millis rs get Timestamp last Failure get Time update Reset Failures To Zero ip Addr conn return else return rs get Int failure Count else insert Reset Password Row ip Addr conn return catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Return the number of failures from login failures a password given an address param ip Addr The address for this attempt as a String return An int representing the number of failures which have occured throws Exception public int get Login Failures String ip Addr throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Login Failures ps set String ip Addr Result Set rs ps execute Query if rs next if we re more than minutes out clear the failure count if System current Time Millis rs get Timestamp last Failure get Time update Failures To Zero ip Addr conn return else return rs get Int failure Count else insert Login Failure Row ip Addr conn return catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps private void insert Login Failure Row String ip Addr int failure Count Connection conn throws Exception Exception Prepared Statement ps conn prepare Statement Login Failures Address failure Count ps set String ip Addr ps set Int failure Count ps execute Update private void insert Reset Password Row String ip Addr int failure Count Connection conn throws Exception Exception Prepared Statement ps conn prepare Statement Reset Password Failures Address failure Count ps set String ip Addr ps set Int failure Count ps execute Update private void update Failures To Zero String ip Addr Connection conn throws Exception Exception Prepared Statement ps conn prepare Statement Login Failures failure Count Address ps set String ip Addr ps execute Update public void reset Login Failures To Zero String ip Addr throws Exception Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Login Failures failure Count Address ps set String ip Addr ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps private void update Reset Failures To Zero String ip Addr Connection conn throws Exception Exception Prepared Statement ps conn prepare Statement Reset Password Failures failure Count Address ps set String ip Addr ps execute Update Check that a user actually exists param mid return throws Exception public boolean check User Exists long mid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Users ps set Long mid Result Set rs ps execute Query return rs next catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps 
package edu ncsu csc itrust action import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Access import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception Form Validation Exception Used to change the session timeout session Timeout jsp Note that a change to this timeout only gets reflected on new sessions author Andy Meneely public class Change Session Timeout Action private Access access Sets up defualts param factory author Andy Meneely public Change Session Timeout Action Factory factory this access factory get Access Changes the session timeout the complicated logic of this is somewhat regrettably in the link Access param minute String Pass the number of minutes in the form of a string greater than throws Form Validation Exception throws Exception author Andy Meneely public void change Session Timeout String minute String throws Form Validation Exception Exception try Integer minutes Integer value Of minute String if minutes throw new Form Validation Exception Must be a number greater than access set Session Timeout Mins minutes catch Number Format Exception e throw new Form Validation Exception That is not a number Returns the current session timeout in minutes as reflected in the database return the number of minutes it would take for an inactive session to timeout throws Exception author Andy Meneely public int get Session Timeout throws Exception return access get Session Timeout Mins 
package edu ncsu csc itrust action import java util List import edu ncsu csc itrust action base Patient Base Action import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Auth import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception No Health Records Exception import edu ncsu csc itrust exception i Trust Exception import edu ncsu csc itrust risk Chronic Disease Mediator import edu ncsu csc itrust risk Risk Checker Used for chronic Disease Risks jsp Passes most of the logic off to link Chronic Disease Mediator and the various subclasses of link Risk Checker author Andy Meneely public class Chronic Disease Risk Action extends Patient Base Action private Auth auth private Chronic Disease Mediator disease Mediator param factory param logged In param pid String The patient to be validated and used throws i Trust Exception throws Exception throws No Health Records Exception This is thrown if a patient is added without any health records to be checked Try to avoid having this exception be thrown in a normal flow of events author Andy Meneely public Chronic Disease Risk Action Factory factory long logged In String pid String throws i Trust Exception Exception No Health Records Exception super factory pid String this auth factory get Auth this disease Mediator new Chronic Disease Mediator factory pid Returns the of the patient to be checked return patient whose risk we are checking author Andy Meneely public long get Patient return pid Gives the full name of the patient return Full name of the patient who we are checking throws Exception throws i Trust Exception author Andy Meneely public String get User Name throws Exception i Trust Exception return auth get User Name pid Returns the risks for which this patient is at risk for All logic has been passed to link Chronic Disease Mediator and the subclasses of link Risk Checker return List of risks throws i Trust Exception throws Exception author Andy Meneely public List Risk Checker get Diseases At Risk throws i Trust Exception Exception return disease Mediator get Disease At Risk 
package edu ncsu csc itrust dao mysql import java sql Connection import java sql Prepared Statement import java sql Result Set import java sql Exception import java util List import edu ncsu csc itrust Util import edu ncsu csc itrust beans Procedure Bean import edu ncsu csc itrust beans loaders Procedure Bean Loader import edu ncsu csc itrust dao Factory import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception i Trust Exception Used for managing codes stands for Database Access Object All Os are intended to be reflections of the database that is one per table in the database most of the time For more complex sets of queries extra Os are added Os can assume that all data has been validated and is correct Os should never have setters or any other parameter to the constructor than a factory All Os should be accessed by Factory see link Factory and every should have a factory for obtaining connections and or accessing other Os The code set accurately describes medical surgical and diagnostic services and is designed to communicate uniform information about medical services and procedures among physicians coders patients accreditation organizations and payers for administrative financial and analytical purposes see http www ama assn org ama pub physician resources solutions managing your practice coding billing insurance cpt about cpt shtml author Andy public class Codes private Factory factory private Procedure Bean Loader procedure Bean Loader new Procedure Bean Loader The typical constructor param factory The link Factory associated with this which is used for obtaining connections etc public Codes Factory factory this factory factory Returns a list of all codes return java util List of Procedure Beans for the codes throws Exception public List Procedure Bean get All Codes throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Codes Result Set rs ps execute Query return procedure Bean Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Returns a list of all immunization codes return java util List of all Immunization related codes throws Exception public List Procedure Bean get Immunization Codes throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement select from cptcodes where attribute immunization order by code Result Set rs ps execute Query return procedure Bean Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Returns a list of all non immunization codes return java util List of all Immunization related codes throws Exception public List Procedure Bean get Procedure Codes throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement select from cptcodes where attribute is order by code Result Set rs ps execute Query return procedure Bean Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Returns a particular procedure description for a code param code The string representation of the code return The textual description of the code throws Exception public Procedure Bean get Code String code throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Codes Code ps set String code Result Set rs ps execute Query if rs next return procedure Bean Loader load Single rs return null catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Adds a new code returns that it was added successfully param proc Procedure Bean representing the new code information return boolean for whether the operation was successful throws Exception throws i Trust Exception public boolean add Code Procedure Bean proc throws Exception i Trust Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Codes Code Description Attribute ps set String proc get Code ps set String proc get Description ps set String proc get Attribute return ps execute Update catch Exception e e print Stack Trace if e get Error Code throw new i Trust Exception Error Code already exists throw new Exception e finally Util close Connection conn ps Change the procedure description for a particular code param proc Procedure Bean representing the new code information return boolean for whether the operation was successful throws Exception public int update Code Procedure Bean proc throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Codes Description Attribute Code ps set String proc get Description ps set String proc get Attribute ps set String proc get Code return ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps 
package edu ncsu csc itrust action import java util List import edu ncsu csc itrust beans Personnel Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Auth import edu ncsu csc itrust dao mysql Patient import edu ncsu csc itrust enums Role import edu ncsu csc itrust exception i Trust Exception Used by the patient to declare Ps as designated in edit Ps jsp author Andy Meneely public class Declare Action private Patient patient private Auth auth private long logged In Sets up defaults param factory The factory to be used for generating the Os for this action param logged In This patient author Andy Meneely public Declare Action Factory factory long logged In this logged In logged In this patient factory get Patient this auth factory get Auth Lists the declared Ps for this current patient return Returns a list of the declared Ps throws i Trust Exception author Andy Meneely public List Personnel Bean get Declared throws i Trust Exception return patient get Declared Ps logged In Validate an s and declare them if possible param hcp Str The of an to declare return status message throws i Trust Exception author Andy Meneely public String declare String hcp Str throws i Trust Exception try long hcp Long value Of hcp Str if auth get User Role hcp Role throw new i Trust Exception This user is not a licensed healthcare professional boolean confirm patient declare logged In hcp if confirm return successfully declared else return not declared catch Number Format Exception e throw new i Trust Exception s not a number Validate an s and undeclare them if possible param input The of an to undeclare return throws i Trust Exception author Andy Meneely public String undeclare String input throws i Trust Exception try long hcp Long value Of input boolean confirm patient undeclare logged In hcp if confirm return successfully undeclared else return not undeclared catch Number Format Exception e throw new i Trust Exception s not a number 
package edu ncsu csc itrust validate import edu ncsu csc itrust beans Diagnosis Bean import edu ncsu csc itrust exception Error List import edu ncsu csc itrust exception Form Validation Exception Validates an code author Andy public class Diagnosis Bean Validator extends Bean Validator Diagnosis Bean The default constructor public Diagnosis Bean Validator Performs the act of validating the bean in question which varies depending on the type of validator If the validation does not succeed a link Form Validation Exception is thrown param p bean of the type to be validated Override public void validate Diagnosis Bean d throws Form Validation Exception Error List error List new Error List error List add If Not Null check Format Code d get Code Validation Format false error List add If Not Null check Format Description d get Description Validation Format false if error List has Errors throw new Form Validation Exception error List 
package edu ncsu csc itrust action import java util List import edu ncsu csc itrust beans Drug Interaction Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Drug Interaction import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception Form Validation Exception import edu ncsu csc itrust exception i Trust Exception import edu ncsu csc itrust validate Drug Interaction Validator Used by Edit Drug Interaction jsp to edit and get information about drug interactions public class Drug Interaction Action private Drug Interaction drug private Drug Interaction Validator validator long logged In Sets up defaults param factory The factory to be used for generating the Os for this action public Drug Interaction Action Factory factory long logged In this drug factory get Drug Interaction this validator new Drug Interaction Validator this logged In logged In Method to report an interaction param first Drug param second Drug param description return public String report Interaction String first Drug String second Drug String description throws i Trust Exception Form Validation Exception if first Drug equals second Drug return Interactions can only be recorded between two different drugs Drug Interaction Bean drug Int new Drug Interaction Bean drug Int set First Drug first Drug drug Int set Second Drug second Drug drug Int set Description description try validator validate drug Int if drug report Interaction first Drug second Drug description return Interaction recorded successfully else return Interaction could not be added catch Exception e e print Stack Trace return e get Message Method to delete an interaction param first Drug param second Drug return public String delete Interaction String first Drug String second Drug throws i Trust Exception Form Validation Exception Drug Interaction Bean drug Int new Drug Interaction Bean drug Int set First Drug first Drug drug Int set Second Drug second Drug drug Int set Description blank try validator validate drug Int if drug delete Interaction first Drug second Drug return Interaction deleted successfully else return Interaction could not be deleted catch Exception e e print Stack Trace throw new i Trust Exception e get Message Method to return a list of drug interactions for a given drug param drug Code The Code of the drug return public List Drug Interaction Bean get Interactions String drug Code throws i Trust Exception try return drug get Interactions drug Code catch Exception e throw new i Trust Exception e get Message 
package edu ncsu csc itrust dao mysql import java sql Connection import java sql Prepared Statement import java sql Result Set import java sql Exception import java util List import edu ncsu csc itrust Util import edu ncsu csc itrust beans Drug Interaction Bean import edu ncsu csc itrust beans loaders Drug Interaction Bean Loader import edu ncsu csc itrust dao Factory import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception i Trust Exception Used for managing drug interactions stands for Database Access Object All Os are intended to be reflections of the database that is one per table in the database most of the time For more complex sets of queries extra Os are added Os can assume that all data has been validated and is correct Os should never have setters or any other parameter to the constructor than a factory All Os should be accessed by Factory see link Factory and every should have a factory for obtaining connections and or accessing other Os see http www fda gov Drugs Information On Drugs ucm htm author Andy public class Drug Interaction private Factory factory private Drug Interaction Bean Loader interaction Loader The typical constructor param factory The link Factory associated with this which is used for obtaining connections etc public Drug Interaction Factory factory this factory factory interaction Loader new Drug Interaction Bean Loader Returns a list of all drug interactions for the input drug name return java util List of Drug Interaction Beans throws Exception public List Drug Interaction Bean get Interactions String drug Code throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement druginteractions First Drug Second Drug ps set String drug Code ps set String drug Code Result Set rs ps execute Query return interaction Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Adds a new drug interaction returns whether or not the addition was successful If the code already exists an i Trust Exception is thrown param first Drug The name of the first drug in an interaction param second Drug The name of the second drug in an interaction param description Explanation of the drug interaction return boolean indicating success or failure throws Exception throws i Trust Exception public boolean report Interaction String first Drug String second Drug String description throws Exception i Trust Exception if first Drug equals second Drug throw new i Trust Exception Drug can not interact with itself List Drug Interaction Bean current Ints Drug get Interactions second Drug for Drug Interaction Bean dib current Ints Drug if dib get Second Drug equals first Drug throw new i Trust Exception Error Interaction between these drugs already exists Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement druginteractions First Drug Second Drug Description ps set String first Drug ps set String second Drug ps set String description return ps execute Update catch Exception e e print Stack Trace if e get Error Code throw new i Trust Exception Error Interaction between these drugs already exists throw new Exception e finally Util close Connection conn ps Remove an interaction from the database param first Drug The name of the first patient param second Drug The name of the second patient return true if removed successfully false if not in list public boolean delete Interaction String first Drug String second Drug throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement druginteractions First Drug Second Drug First Drug Second Drug ps set String first Drug ps set String first Drug ps set String second Drug ps set String second Drug if ps execute Update return false return true catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps 
package edu ncsu csc itrust action import java util List import edu ncsu csc itrust action base Patient Base Action import edu ncsu csc itrust beans Health Record import edu ncsu csc itrust beans forms Health Record Form import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Auth import edu ncsu csc itrust dao mysql Health Records import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception Form Validation Exception import edu ncsu csc itrust exception i Trust Exception import edu ncsu csc itrust validate Health Record Form Validator Edits the health history of a patient used by edit Basic Health jsp author laurenhayward public class Edit Health History Action extends Patient Base Action private Health Records hr private Auth auth private long logged In private Health Record Form Validator validator new Health Record Form Validator The patient is validated by the superclass param factory The Factory which will be used to generate the Os used for this action param logged In The user authorizing this action param pid String The patient or other user who is being edited throws i Trust Exception public Edit Health History Action Factory factory long logged In String pid String throws i Trust Exception super factory pid String this hr factory get Health Records this auth factory get Auth this logged In logged In returns the patient name return patient name throws Exception throws i Trust Exception public String get Patient Name throws Exception i Trust Exception return auth get User Name pid Adds a health record for the given patient param pid The patient record who is being edited param hr The filled out health record form to be added return message Information Recorded or exception s message throws Form Validation Exception public String add Health Record long pid Health Record Form hr throws Form Validation Exception i Trust Exception validator validate hr Health Record record transfer Form pid hr hr add record return Information Recorded Moves the information from the form to a Health Record param pid Patient of interest param form Form to be translated return a Health Record containing all the information in the form throws Form Validation Exception private Health Record transfer Form long pid Health Record Form form throws Form Validation Exception Health Record record new Health Record record set Patient pid record set Personnel logged In record set Blood Pressure Integer value Of form get Blood Pressure record set Blood Pressure Integer value Of form get Blood Pressure record set Cholesterol Integer value Of form get Cholesterol record set Cholesterol Integer value Of form get Cholesterol record set Cholesterol Tri Integer value Of form get Cholesterol Tri if record get Total Cholesterol record get Total Cholesterol throw new Form Validation Exception Total cholesterol must be in record set Height Double value Of form get Height record set Weight Double value Of form get Weight record set Smoker Integer value Of form get Is Smoker return record Returns a list of all Health Records for the given patient param pid The of the patient to look up return list of Health Records throws i Trust Exception public List Health Record get All Health Records long pid throws i Trust Exception return hr get All Health Records pid 
package edu ncsu csc itrust action import java util List import edu ncsu csc itrust beans Remote Monitoring Data Bean import edu ncsu csc itrust beans Telemedicine Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Auth import edu ncsu csc itrust dao mysql Remote Monitoring import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception i Trust Exception Handles changes adds and removes to the monitoring list for a certain public class Edit Monitoring List Action private Remote Monitoring rm private Auth auth private long logged In Constructor param factory The Factory used to create the Os used in this action param logged In The of the editing their monitoring list public Edit Monitoring List Action Factory factory long logged In this logged In logged In this rm factory get Remote Monitoring this auth factory get Auth Adds a patient to the current s remote monitoring list param patient the patient param permissions Array indicating what data the patient is allowed to enter Ordered by Systolic Blood Pressure Diastolic Blood Pressure Glucose Level Weight Pedometer Reading return true if added successfully False if already in list throws Exception public boolean add To List long patient Telemedicine Bean t Bean throws Exception return rm add Patient To List patient logged In t Bean Removes a patient from the current s remote monitoring list param patient the patient return true if removed successfully False if not in list throws Exception public boolean remove From List long patient throws Exception return rm remove Patient From List patient logged In Returns whether a patient is in an s list already param patient the patient return true if in false otherwise throws Exception public boolean is Patient In List long patient throws Exception List Remote Monitoring Data Bean dataset rm get Patients Data logged In for Remote Monitoring Data Bean d dataset if d get Patient patient return true return false returns the patient name return patient name throws Exception throws i Trust Exception public String get Patient Name long pid throws Exception i Trust Exception return auth get User Name pid 
package edu ncsu csc itrust action import java util Arrays import java util List import edu ncsu csc itrust action base Edit Office Visit Base Action import edu ncsu csc itrust beans Email import edu ncsu csc itrust beans Hospital Bean import edu ncsu csc itrust beans Office Visit Bean import edu ncsu csc itrust beans Patient Bean import edu ncsu csc itrust beans forms Edit Office Visit Form import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Hospitals import edu ncsu csc itrust dao mysql Office Visit import edu ncsu csc itrust dao mysql Patient import edu ncsu csc itrust dao mysql Personnel import edu ncsu csc itrust enums Transaction Type import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception Form Validation Exception import edu ncsu csc itrust exception i Trust Exception import edu ncsu csc itrust validate Edit Office Visit Validator Edits the office visits of a patient Used by edit Office Visit jsp This exists in two states saved and unsaved If unsaved data can not be saved to sub actions if this is attempted exceptions will be raised Once it is saved however the sub actions can be saved author laurenhayward author student public class Edit Office Visit Action extends Edit Office Visit Base Action private Edit Office Visit Validator validator new Edit Office Visit Validator private Personnel personnel private Hospitals hospital private Office Visit ov private Patient pat private Edit Prescriptions Action prescriptions Action private Edit Procedures Action procedures Action private Edit Immunizations Action immunizations Action private Edit Diagnoses Action diagnoses Action private Edit Lab Procedures Action lab Procedures Action private Edit Patient Instructions Action patient Instructions Action private Edit Referrals Action referrals Action private Event Logging Action logging Action private long logged In Patient id and office visit id validated by super class param factory The Factory to be used in creating the Os for this action param logged In The of the user who is authorizing this action param pid String The patient who this action is performed on param ov String The of the office visit in play throws i Trust Exception public Edit Office Visit Action Factory factory long logged In String pid String String ov String throws i Trust Exception super factory logged In pid String ov String pid Long parse Long pid String ov factory get Office Visit this personnel factory get Personnel this hospital factory get Hospitals this pat factory get Patient this prescriptions Action new Edit Prescriptions Action factory logged In pid String ov String this procedures Action new Edit Procedures Action factory logged In pid String ov String this immunizations Action new Edit Immunizations Action factory logged In pid String ov String this diagnoses Action new Edit Diagnoses Action factory logged In pid String ov String this lab Procedures Action new Edit Lab Procedures Action factory logged In pid String ov String this patient Instructions Action new Edit Patient Instructions Action factory logged In pid String ov String this referrals Action new Edit Referrals Action factory logged In pid String ov String this logging Action new Event Logging Action factory this logged In logged In Create an Office Visit Action that is not yet associated with an actual office visit When update is called it will be saved Until then any attempt to save prescriptions procedures lab procedures immunizations or diagnoses will raise an exception param factory param logged In param pid String throws i Trust Exception public Edit Office Visit Action Factory factory long logged In String pid String throws i Trust Exception super factory logged In pid String pid Long parse Long pid String ov factory get Office Visit this personnel factory get Personnel this hospital factory get Hospitals this pat factory get Patient this prescriptions Action new Edit Prescriptions Action factory logged In pid String this procedures Action new Edit Procedures Action factory logged In pid String this immunizations Action new Edit Immunizations Action factory logged In pid String this diagnoses Action new Edit Diagnoses Action factory logged In pid String this lab Procedures Action new Edit Lab Procedures Action factory logged In pid String this patient Instructions Action new Edit Patient Instructions Action factory logged In pid String this referrals Action new Edit Referrals Action factory logged In pid String this logging Action new Event Logging Action factory this logged In logged In Used to update the sub actions once a office visit is saved Until this is called attempting to save sub actions will raise an exception throws i Trust Exception private void reinitialize Sub Actions throws i Trust Exception if is Unsaved throw new i Trust Exception Can not initalize Edit Office Visit sub actions No ov is present Factory factory get Factory String pid String get Pid String ov String get Ov prescriptions Action new Edit Prescriptions Action factory logged In pid String ov String procedures Action new Edit Procedures Action factory logged In pid String ov String immunizations Action new Edit Immunizations Action factory logged In pid String ov String diagnoses Action new Edit Diagnoses Action factory logged In pid String ov String lab Procedures Action new Edit Lab Procedures Action factory logged In pid String ov String patient Instructions Action new Edit Patient Instructions Action factory logged In pid String ov String referrals Action new Edit Referrals Action factory logged In pid String ov String Returns the office visit bean for the office visit return the Office Visit Bean of the office visit throws i Trust Exception public Office Visit Bean get Office Visit throws i Trust Exception return get Bean return The Edit Prescriptions Action sub action associated with this office visit throws i Trust Exception public Edit Prescriptions Action prescriptions throws i Trust Exception return prescriptions Action return The Edit Procedures Action sub action associated with this office visit throws i Trust Exception public Edit Procedures Action procedures throws i Trust Exception return procedures Action return The Edit Immunizations Action sub action associated with this office visit throws i Trust Exception public Edit Immunizations Action immunizations throws i Trust Exception return immunizations Action return The Edit Diagnoses Action sub action associated with this office visit throws i Trust Exception public Edit Diagnoses Action diagnoses throws i Trust Exception return diagnoses Action return The Edit Lab Procedures Action sub action associated with this office visit throws i Trust Exception public Edit Lab Procedures Action lab Procedures throws i Trust Exception return lab Procedures Action public Edit Patient Instructions Action patient Instructions throws i Trust Exception return patient Instructions Action public Edit Referrals Action referrals throws i Trust Exception return referrals Action This is a list of all hospitals ordered by the office visit s hcp param hcp return throws i Trust Exception public List Hospital Bean get Hospitals throws i Trust Exception List Hospital Bean hcps Hospitals personnel get Hospitals get Hcpid List Hospital Bean all Hospitals hospital get All Hospitals return combine Lists hcps Hospitals all Hospitals Combines two lists of hospitals param hcps Hospitals hospitals the is assigned to param all Hospitals all hospitals return the combined list private List Hospital Bean combine Lists List Hospital Bean hcps Hospitals List Hospital Bean all Hospitals for Hospital Bean hos all Hospitals if hcps Hospitals contains hos hcps Hospitals add hos return hcps Hospitals Updates the office visit with information from the form passed in If the office visit has not yet been saved calling this method will save it as well as make the sub actions able to be saved param form information to update return success or exception s message throws Form Validation Exception public String update Information Edit Office Visit Form form throws Form Validation Exception String confirm try update Ov form confirm success return confirm catch i Trust Exception e e print Stack Trace return e get Message Helper that logs an office visit event The associated patient id id and office visit id are automatically included param trans Transaction type for the log throws Exception public void log Office Visit Event Transaction Type trans throws Exception logging Action log Event trans logged In get Pid Office visit get Ov Sends e mail regarding the prescribed dangerous drug param hcp the prescription is made by param pat of the patient prescription is for param problem The allergy and or interaction that is the problem return the sent e mail throws Exception public Email make Email App long hcp String pat String problem throws Exception i Trust Exception Patient Bean p pat get Patient Long parse Long pat String hcp Name personnel get Name hcp Email email new Email email set From no reply itrust com email set To List Arrays as List p get Email email set Subject has prescribed you a potentially dangerous medication email set Body String format s has prescribed a medication that you are allergic to or that has a known interaction with a drug you are currently taking s hcp Name problem return email Updates the office visit param form form with all the information throws Exception throws Form Validation Exception private void update Ov Edit Office Visit Form form throws Exception Form Validation Exception i Trust Exception validator validate form Office Visit Bean ov get Bean ov set Notes form get Notes ov set Visit Date Str form get Visit Date ov set Hcp Long value Of form get Hcp ov set Patient Long value Of form get Patient ov set Hospital form get Hospital update Bean ov return The Office Visit Bean associated with this office visit or if it has not been saved a default Office Visit Bean with the id and patient id filled in throws Exception private Office Visit Bean get Bean throws Exception if is Unsaved Office Visit Bean b new Office Visit Bean b set Hcp get Hcpid b set Patient get Pid return b else return ov get Office Visit ov Update the office visit with the given data If the office visit has not yet been saved this will save it and reinitialize the sub actions param bean The data with which to update the office visit throws Exception throws i Trust Exception private void update Bean Office Visit Bean bean throws Exception i Trust Exception if is Unsaved bean get ov ov add bean reinitialize Sub Actions else ov update bean 
package edu ncsu csc itrust action import java util Array List import java util List import edu ncsu csc itrust action base Patient Base Action import edu ncsu csc itrust beans Email import edu ncsu csc itrust beans Patient Bean import edu ncsu csc itrust beans Patient History Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Patient import edu ncsu csc itrust dao mysql Personnel import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception Form Validation Exception import edu ncsu csc itrust exception i Trust Exception import edu ncsu csc itrust validate Patient Validator import edu ncsu csc itrust Email Util Edits a patient Used by edit Patient jsp author laurenhayward public class Edit Patient Action extends Patient Base Action private Patient Validator validator new Patient Validator private Patient patient private Personnel personnel private long logged In private Email Util emailutil The super class validates the patient id param factory The Factory used to create the Os for this action param logged In The of the user who is authorizing this action param pid String The of the patient being edited throws i Trust Exception public Edit Patient Action Factory factory long logged In String pid String throws i Trust Exception super factory pid String this patient factory get Patient this personnel factory get Personnel this logged In logged In emailutil new Email Util factory Takes the information out of the Patient Bean param and updates the patient s information param p the new patient information throws i Trust Exception throws Form Validation Exception public void update Information Patient Bean p throws i Trust Exception Form Validation Exception p set pid for security reasons validator validate p patient edit Patient p logged In emailutil send Email make Email Returns a Patient Bean for the patient return the Patient Bean throws Exception public Patient Bean get Patient throws Exception return patient get Patient this get Pid Creates and e mail to inform the patient that their information has been updated return the email with the notice throws Exception private Email make Email throws Exception Email email new Email List Patient Bean reps patient get Representing pid Patient Bean pb patient get Patient pid List String to Addrs new Array List String to Addrs add pb get Email for Patient Bean r reps to Addrs add r get Email email set From no reply itrust com email set To List to Addrs patient and personal representative email set Subject String format Patient Information Updated email set Body Dear pb get Full Name n t Your patient record information has been updated Please login to i Trust to see who has viewed your records return email public void edit Message Filter String filter throws i Trust Exception Form Validation Exception Patient Bean b this get Patient b set Message Filter filter this update Information b public boolean has History throws Exception return patient has History this get Pid public List Patient History Bean get History throws Exception return patient get Patient History this get Pid public String get Employee Name long mid throws Exception i Trust Exception return personnel get Name mid 
package edu ncsu csc itrust action import edu ncsu csc itrust action base Personnel Base Action import edu ncsu csc itrust beans Personnel Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Auth import edu ncsu csc itrust dao mysql Personnel import edu ncsu csc itrust enums Role import edu ncsu csc itrust exception Form Validation Exception import edu ncsu csc itrust exception i Trust Exception import edu ncsu csc itrust validate Personnel Validator Edits the designated personnel Used by admin edit Personnel jsp staff edit My Demographics jsp edit Personnel jsp author laurenhayward public class Edit Personnel Action extends Personnel Base Action private Personnel personnel private Auth auth private Personnel Validator validator new Personnel Validator Super class validates the patient id param factory The Factory used to create the Os for this action param logged In The of the user editing this personnel param pid String The of the user being edited throws i Trust Exception public Edit Personnel Action Factory factory long logged In String pid String throws i Trust Exception super factory pid String this auth factory get Auth long pidlong Long parse Long pid String Role editor auth get User Role logged In Role editing auth get User Role pidlong if editor editing pidlong logged In throw new i Trust Exception You can only edit your own demographics else if editor Role editing Role editor Role editing Role editor Role editing Role throw new i Trust Exception You are not authorized to edit this record this personnel factory get Personnel Takes information from the personnel Form param and updates the patient param personnel Form Personnel Bean with new information throws i Trust Exception throws Form Validation Exception public void update Information Personnel Bean personnel Form throws i Trust Exception Form Validation Exception personnel Form set pid validator validate personnel Form personnel edit Personnel personnel Form public void edit Message Filter String filter throws i Trust Exception Form Validation Exception Personnel Bean b personnel get Personnel this get Pid b set Message Filter filter this update Information b 
package edu ncsu csc itrust action import java util Array List import java util List import edu ncsu csc itrust Email Util import edu ncsu csc itrust action base Patient Base Action import edu ncsu csc itrust beans Personnel Bean import edu ncsu csc itrust beans Allergy Bean import edu ncsu csc itrust beans Diagnosis Bean import edu ncsu csc itrust beans Email import edu ncsu csc itrust beans Family Member Bean import edu ncsu csc itrust beans Health Record import edu ncsu csc itrust beans Office Visit Bean import edu ncsu csc itrust beans Patient Bean import edu ncsu csc itrust beans Procedure Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Allergy import edu ncsu csc itrust dao mysql Family import edu ncsu csc itrust dao mysql Health Records import edu ncsu csc itrust dao mysql Codes import edu ncsu csc itrust dao mysql Office Visit import edu ncsu csc itrust dao mysql Patient import edu ncsu csc itrust dao mysql Procedures import edu ncsu csc itrust dao mysql Personnel import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception Form Validation Exception import edu ncsu csc itrust exception No Health Records Exception import edu ncsu csc itrust exception i Trust Exception import edu ncsu csc itrust risk Chronic Disease Mediator import edu ncsu csc itrust risk Risk Checker Edits the patient health record for a given patient Used by edit jsp author laurenhayward public class Edit Action extends Patient Base Action private Factory factory private Patient patient private Allergy allergy private Family family private Health Records hr private Office Visit ov private Codes icd private Procedures proc private Chronic Disease Mediator disease Mediator private Personnel personnel private Personnel Bean private Patient Bean patient private Email Util emailutil Super class validates the patient id param factory The Factory to be used in creating Os for this action param logged In The of the currently logged in user who is authorizing this action param pid String The of the patient whose personal health records are being added throws i Trust Exception throws Exception throws No Health Records Exception public Edit Action Factory factory long logged In String pid String throws i Trust Exception Exception super factory pid String this patient factory get Patient this allergy factory get Allergy this family factory get Family this hr factory get Health Records this ov factory get Office Visit this icd factory get Codes this personnel factory get Personnel this personnel get Personnel logged In this patient patient get Patient pid this proc factory get Procedures emailutil new Email Util factory this factory factory Adds an allergy to the patient s records param pid param description return Allergy Added exception message a list of invalid fields or only if description is null throws Exception throws i Trust Exception public String update Allergies long pid String description throws Form Validation Exception Exception Allergy Bean bean new Allergy Bean bean set Description description Allergy Bean Validator abv new Allergy Bean Validator abv validate bean Removed for new option medication selector allergy add Allergy pid description emailutil send Email make Email return Allergy Added Returns a Patient Bean for the patient return Patient Bean throws i Trust Exception public Patient Bean get Patient throws i Trust Exception return patient get Patient pid Returns a list of Allergy Beans for the patient return list of Allergy Beans throws i Trust Exception public List Allergy Bean get Allergies throws i Trust Exception return allergy get Allergies pid Returns a list of Family Member Beans for the patient return list of Family Member Beans throws i Trust Exception public List Family Member Bean get Family throws i Trust Exception List Family Member Bean fam new Array List Family Member Bean List Family Member Bean parents null parents family get Parents pid fam add All parents fam add All family get Siblings pid fam add All family get Children pid if parents null List Family Member Bean grandparents new Array List Family Member Bean for Family Member Bean parent parents grandparents add All family get Parents parent get Mid fam add All grandparents for Family Member Bean gp grandparents gp set Relation Grandparent return fam Returns a list of Health Records for the patient return throws i Trust Exception public List Health Record get All Health Records throws i Trust Exception List Health Record all Health Records hr get All Health Records pid return all Health Records Returns a list of Office Visit Beans return throws i Trust Exception public List Office Visit Bean get All Office Visits throws i Trust Exception return ov get All Office Visits pid Returns a complete Office Visit Bean given a visit return throws i Trust Exception public Office Visit Bean get Complete Office Visit long visit throws i Trust Exception return ov get Office Visit visit public List Procedure Bean get Procedures long visit throws Exception return proc get List visit Returns a list of diseases for which the patient is at risk return list of Risk Checkers throws i Trust Exception throws Exception public List Risk Checker get Diseases At Risk throws No Health Records Exception i Trust Exception Exception this disease Mediator new Chronic Disease Mediator factory pid return disease Mediator get Disease At Risk Checks to see if a particular family member has high blood pressure param member the family member to check return true if the family member has high blood pressure False if there are no records or the family member does not have high blood pressure throws i Trust Exception public boolean does Family Member Have High Family Member Bean member throws i Trust Exception List Health Record records hr get All Health Records member get Mid if records size return false for Health Record record records if record get Blood Pressure Systolic record get Blood Pressure Diastolic return true return false Checks to see if a particular family member has high cholesterol param member the family member to check return true if the family member has high cholesterol False if there are no records or the family member does not throws i Trust Exception public boolean does Family Member Have High Cholesterol Family Member Bean member throws i Trust Exception List Health Record records hr get All Health Records member get Mid if records size return false for Health Record record records if record get Cholesterol record get Cholesterol return true return false Checks to see if a particular family member has diabetes param member the family member to check return true if the family member has diabetes False if there are no records or the family member does not throws i Trust Exception public boolean does Family Member Have Diabetes Family Member Bean member throws i Trust Exception List Diagnosis Bean diagnoses patient get Diagnoses member get Mid if diagnoses size return false for Diagnosis Bean diag diagnoses if diag get Code starts With return true return false Checks to see if a particular family member has cancer param member the family member to check return true if the family member has cancer False if there are no records or the family member does not throws i Trust Exception public boolean does Family Member Have Cancer Family Member Bean member throws i Trust Exception List Diagnosis Bean diagnoses patient get Diagnoses member get Mid if diagnoses size return false for Diagnosis Bean diag diagnoses if diag get Code starts With return true return false Checks to see if a particular family member has heart disease param member the family member to check return true if the family member has heart disease False if there are no records or the family member does not throws i Trust Exception public boolean does Family Member Have Heart Disease Family Member Bean member throws i Trust Exception List Diagnosis Bean diagnoses patient get Diagnoses member get Mid if diagnoses size return false for Diagnosis Bean diag diagnoses if diag get Code starts With return true return false Checks to see if a particular family member smokes param member the family member to check return true if the family member smokes False if there are no records or the family member does not throws i Trust Exception public boolean is Family Member Smoker Family Member Bean member throws i Trust Exception List Health Record records hr get All Health Records member get Mid if records size return false for Health Record record records if record is Smoker return true return false Checks to see if the family member is dead and returns their cause of death if so param member the family member to check return the cause of death if there is one otherwise null throws i Trust Exception public String get Family Member Family Member Bean member throws i Trust Exception Patient Bean patient patient get Patient member get Mid if patient get Cause Of Death null return Diagnosis Bean diag icd get Code patient get Cause Of Death if diag null return return diag get Description Creates a fake e mail to notify the user that their records have been altered return the e mail to be sent throws Exception private Email make Email throws Exception Email email new Email List Patient Bean reps patient get Representing patient get List String to Addrs new Array List String to Addrs add patient get Email for Patient Bean r reps to Addrs add r get Email email set From no reply itrust com email set To List to Addrs patient and personal representative email set Subject String format Your medical records have been altered email set Body Health care professional get Full Name has altered your medical records She is not on your list of designated health care professionals return email 
package edu ncsu csc itrust action import java util List import edu ncsu csc itrust action base Patient Base Action import edu ncsu csc itrust beans Patient Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Auth import edu ncsu csc itrust dao mysql Patient import edu ncsu csc itrust enums Role import edu ncsu csc itrust exception i Trust Exception Edits a patient s personal representatives Used by hcp edit Representatives jsp author laurenhayward public class Edit Representatives Action extends Patient Base Action private Patient patient private Auth auth Super class validates the patient mid param factory The Factory used in creating the Os for this action param logged In The of the patient editing his her representatives param pid String The of the representative in question throws i Trust Exception public Edit Representatives Action Factory factory long logged In String pid String throws i Trust Exception super factory pid String this patient factory get Patient this auth factory get Auth Return a list of patients that pid represents param pid The id of the personnel we are looking up representees for return a list of Patient Beans throws i Trust Exception public List Patient Bean get Represented long pid throws i Trust Exception return patient get Represented pid Makes the patient pid represent the input mid parameter param pid String the mid of the person who will be represented the representee return a message throws i Trust Exception public String add Representative String pid String throws i Trust Exception try long representee Long value Of pid String if auth get User Role representee Role throw new i Trust Exception This user is not a patient else if super pid representee throw new i Trust Exception This user can not represent themselves boolean confirm patient add Representative pid representee if confirm return Patient represented else return No change made catch Number Format Exception e return not a number Makes the patient pid no longer represent the input mid param param input the mid of the person be represented representee return a message throws i Trust Exception public String remove Representative String input throws i Trust Exception try long representee Long value Of input boolean confirm patient remove Representative pid representee if confirm return Patient represented else return No change made catch Number Format Exception e return not a number 
package edu ncsu csc itrust import edu ncsu csc itrust beans Email import edu ncsu csc itrust dao Factory import edu ncsu csc itrust exception Exception Sends email to users Since we do n t want to train spammers in this just inserts into a database If we put this into an actual system we would replace this class with stuff from javax mail author Andy public class Email Util private Factory factory public Email Util Factory factory this factory factory Sending emails even to a throwaway account is a waste of bandwidth and looks very suspicious If you want to know how to send emails from Java just Google it on your own time public void send Email Email email throws Exception factory get Fake Email send Email Record email 
package edu ncsu csc itrust action import java util Array List import java util List import java util Calendar import edu ncsu csc itrust action base Patient Base Action import edu ncsu csc itrust beans Allergy Bean import edu ncsu csc itrust beans Diagnosis Bean import edu ncsu csc itrust beans Email import edu ncsu csc itrust beans Patient Bean import edu ncsu csc itrust beans Prescription Bean import edu ncsu csc itrust beans Office Visit Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Allergy import edu ncsu csc itrust dao mysql Patient import edu ncsu csc itrust dao mysql Office Visit import edu ncsu csc itrust enums Prescription Alerts import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception i Trust Exception import edu ncsu csc itrust Email Util import edu ncsu csc itrust beans Procedure Bean Creates a new Emergency Report Used by emergency Report jsp author laurenhayward public class Emergency Report Action extends Patient Base Action private Patient patient private Allergy allergy private Office Visit ov private Patient Bean pb private Email Util emailutil The super class handles validating the pid Logs viewing of the report param factory The Factory used in creating the Os for this action param logged In The of the user who is looking at the emergency report param pid String The of the patient whose report is being generated throws i Trust Exception public Emergency Report Action Factory factory long logged In String pid String throws i Trust Exception super factory pid String this patient factory get Patient this allergy factory get Allergy this ov factory get Office Visit emailutil new Email Util factory pb patient get Patient this pid emailutil send Email make Email Returns the patient s name return patient s full name public String get Patient Name return pb get First Name pb get Last Name Returns the patient s age return patient s age public String get Patient Age return Integer to String pb get Age Returns the patient s gender return patient s gender public String get Patient Gender return pb get Gender to String Returns the patient s emergency contact return patient s emergency contact public String get Patient Emergency Contact return pb get Emergency Name pb get Emergency Phone Returns the patient s blood type return the patient s blood type public String get Blood Type return pb get Blood Type Returns a list of allergies for the given patient return a list of Allergy Beans throws i Trust Exception public List Allergy Bean get Allergies throws i Trust Exception return allergy get Allergies this pid Returns a list of prescriptions the patient is currently taking return a list of Prescription Beans for which the patient is currently taking throws i Trust Exception public List Prescription Bean get Current Prescriptions throws i Trust Exception List Prescription Bean all Prescriptions patient get Current Prescriptions this pid Array List Prescription Bean warning List new Array List Prescription Bean for int i i all Prescriptions size i if Prescription Alerts is Alert all Prescriptions get i get Medication get Code warning List add all Prescriptions get i return warning List Returns a list of diagnoses that are in the range indicated by the Diagnosis Range enum return list of Diagnosis Beans throws i Trust Exception public List Diagnosis Bean get Warning Diagnoses throws i Trust Exception try boolean dup false List Diagnosis Bean all Diagnoses patient get Diagnoses this pid Array List Diagnosis Bean warning List new Array List Diagnosis Bean for Diagnosis Bean bean all Diagnoses Office Visit Bean ovb ov get Office Visit bean get Visit if ovb null continue if yes equals bean get Classification ovb get Visit Date get Time Calendar get Instance get Time In Millis for Diagnosis Bean wbean warning List if bean get Description equals wbean get Description dup true if dup warning List add bean return warning List catch Exception dbe throw new i Trust Exception dbe get Message Returns a list of prescriptions the patient is currently taking return a list of Prescription Beans for which the patient is currently taking throws i Trust Exception public List Procedure Bean get Immunizations throws i Trust Exception List Procedure Bean all Immunizations patient get Immunization Procedures this pid return all Immunizations Creates a fake e mail to notify the user that an emergency report has been created and viewed return the e mail to be sent throws Exception private Email make Email throws Exception Email email new Email List Patient Bean reps patient get Representing pb get List String to Addrs new Array List String to Addrs add pb get Email for Patient Bean r reps to Addrs add r get Email email set From no reply itrust com email set To List to Addrs patient and personal representative email set Subject String format Emergency Report Viewed Notification email set Body Dear pb get Full Name n An emergency report has been generated Please login to i Trust to see who has viewed your records return email 
package edu ncsu csc itrust dao mysql import java sql Connection import java sql Prepared Statement import java sql Result Set import java sql Exception import java util List import edu ncsu csc itrust Util import edu ncsu csc itrust beans Family Member Bean import edu ncsu csc itrust beans loaders Family Bean Loader import edu ncsu csc itrust dao Factory import edu ncsu csc itrust exception Exception Used for queries related to families stands for Database Access Object All Os are intended to be reflections of the database that is one per table in the database most of the time For more complex sets of queries extra Os are added Os can assume that all data has been validated and is correct Os should never have setters or any other parameter to the constructor than a factory All Os should be accessed by Factory see link Factory and every should have a factory for obtaining connections and or accessing other Os author Andy public class Family private Factory factory private Family Bean Loader family Bean Loader The typical constructor param factory The link Factory associated with this which is used for obtaining connections etc public Family Factory factory this factory factory Return the information of the mother and father of this patient param pid this patient return throws Exception public List Family Member Bean get Parents long pid throws Exception return get Family Members pid Parent p First Name First Name p Last Name Last Name p as Patients p Patients p p p Mother p p Father p false Return a list of patients who share at least one parent and that parent is not with this patient param pid this patient return java util list of Family Member Beans throws Exception public List Family Member Bean get Siblings long pid throws Exception return get Family Members pid Sibling p First Name First Name p Last Name Last Name p as Patients p Patients p p p p p Mother p Mother p Mother p Father p Father p Father false Return a list of patients whose mother or father is this patient param pid this patient return java util List of Family Member Beans throws Exception public List Family Member Bean get Children long pid throws Exception return get Family Members pid Child First Name Last Name Patients Mother or Father true Private helper method since all three are alike param pid param relation param query param second Param add the pid as the second parameter the rd query was a little different return java util List of Family Member Beans throws Exception private List Family Member Bean get Family Members long pid String relation String query boolean second Param throws Exception Connection conn null Prepared Statement ps null family Bean Loader new Family Bean Loader relation try conn factory get Connection ps conn prepare Statement query ps set Long pid if second Param ps set Long pid Result Set rs ps execute Query return family Bean Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps 
package edu ncsu csc itrust action import edu ncsu csc itrust dao Factory import edu ncsu csc itrust exception i Trust Exception Handles Getting the person s name associated with a certain mid Used by get User jsp author laurenhayward public class Get User Name Action private Factory factory Set up defaults param factory The Factory used for creating the Os for this action public Get User Name Action Factory factory this factory factory Returns the person s name that matches the input param param input The to look up return the person s name throws Exception throws i Trust Exception public String get User Name String input throws i Trust Exception try long mid Long value Of input return factory get Auth get User Name mid catch Number Format Exception e throw new i Trust Exception not in correct form 
package edu ncsu csc itrust action import java util Array List import java util Date import java util Hash Map import java util List import java util Calendar import edu ncsu csc itrust beans forms Visit Reminder Return Form import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Visit Reminders import edu ncsu csc itrust dao mysql Patient import edu ncsu csc itrust beans Procedure Bean import edu ncsu csc itrust exception Form Validation Exception import edu ncsu csc itrust exception i Trust Exception import edu ncsu csc itrust beans Visit Flag import edu ncsu csc itrust beans Patient Bean import edu ncsu csc itrust enums Gender Gets the Visit Reminders for a given patient Used by visit Reminders jsp author laurenhayward public class Get Visit Reminders Action Reminder Type enumeration public static enum Reminder Type Diagnosed Care Needers Flu Shot Needers Immunization Needers private String type Name private Reminder Type String type Name this type Name type Name private static final Hash Map String Reminder Type map new Hash Map String Reminder Type static for Reminder Type rt Reminder Type values map put rt get Type Name rt Gets the Reminder Type for the name passed as a param param name return the Reminder Type associated with the name public static Reminder Type get Reminder Type String name return map get name Returns the type name as a string return public String get Type Name return type Name Begin Get Visit Reminders Action code private Visit Reminders visit Reminder private Patient patient private long logged In Set up defaults param factory The Factory used to create the Os used in this action param logged In of the person who is logged in throws i Trust Exception public Get Visit Reminders Action Factory factory long logged In throws i Trust Exception this logged In logged In visit Reminder factory get Visit Reminders patient factory get Patient Returns a list of Visit Reminder Return Forms for the type passed in as a param param type the Reminder Type return the list of Visit Reminder Return Forms throws i Trust Exception throws Form Validation Exception public List Visit Reminder Return Form get Visit Reminders Reminder Type type throws i Trust Exception Form Validation Exception if null type throw new i Trust Exception Reminder Type switch type case return visit Reminder get Diagnosed Visit Needers logged In return strip Dupes visit Reminder get Diagnosed Visit Needers logged In case return visit Reminder get Flu Shot Delinquents logged In case return get Immunization Needers logged In default throw new i Trust Exception Reminder Type Gets a list of anyone who need immunizations param mid the whose patients are being checked return a list of all the people who need immunizations done in a visit reminder throws i Trust Exception private List Visit Reminder Return Form get Immunization Needers long mid throws i Trust Exception List Visit Reminder Return Form form List List Visit Reminder Return Form need List new Array List Visit Reminder Return Form String reason Get list of patients that designate this form List visit Reminder get Patients mid for Visit Reminder Return Form r form List reason check Immunizations r get Patient if reason length need List add r r add Visit Flag new Visit Flag Visit Flag reason return need List Checks a patient to see what immunizations they need param pid patient to be checked return patient list of those lacking immunizations according to the schedule private String check Immunizations long pid throws i Trust Exception String reason List Procedure Bean procs patient get Procedures pid Patient Bean patient patient get Patient pid long patient Age patient get Age In Weeks Date patient patient get Date Of Birth Gender gen patient get Gender int hep long hep Time int rota long rota Time int diptet long deptet Time int haemoflu long haemoflu Time long haemoflu Time First int pneumo long pneumo Time long pneumoflu Time First int polio long polio Time int measles long measles Time int varicella long varicella Time int hep long hep Time int hpv long hpv Time for Procedure Bean proc procs String cpt proc get Code Hep if cpt equals hep hep Time proc get Date get Time Rotavirus else if cpt equals rota rota Time proc get Date get Time Diptheria Tetanus Pertussis else if cpt equals diptet deptet Time proc get Date get Time Haemophilus influenza else if cpt equals if haemoflu haemoflu Time First proc get Date get Time haemoflu haemoflu Time proc get Date get Time Pneumococcal else if cpt equals if pneumo pneumoflu Time First proc get Date get Time pneumo pneumo Time proc get Date get Time Poliovirus else if cpt equals polio polio Time proc get Date get Time Measles Mumps Rubella else if cpt equals measles measles Time proc get Date get Time Varicella else if cpt equals varicella varicella Time proc get Date get Time Hep else if cpt equals hep hep Time proc get Date get Time Human Papillomaavirus else if cpt equals hpv hpv Time proc get Date get Time if hep reason test Hep hep patient hep Time if rota reason test Rota Virus rota patient rota Time if diptet reason test Dip Tet diptet patient deptet Time if haemoflu reason test Haemo Flu haemoflu patient haemoflu Time haemoflu Time First if pneumo reason test Pneumo pneumo patient pneumo Time pneumoflu Time First if polio reason test Polio polio patient polio Time if measles reason test Measles measles patient measles Time if varicella reason test Varicella varicella patient varicella Time if hep reason test Hep hep patient hep Time if hpv gen get Name equals Female reason test hpv patient hpv Time if reason length return reason substring reason length return reason Checks to see if a patient needs the immunization param count how many immunizations she has already had param patient Age how old the patient is in weeks param time date of the last procedure return the reason the immunization should be given including required immunization age public static String test int count Date patient long time String reason long weeks Calendar get Instance get Time In Millis time new Date if count if older Than patient reason Human Papillomavirus years else if count if older Than patient weeks reason Human Papillomavirus years months else if count if older Than patient weeks reason Human Papillomavirus years months return reason Checks to see if a patient needs the Hepatits immunization param count which immunization they are on param patient Age how old the patient is param time what the current date is return when the immunization should be given public static String test Hep int count Date patient long time String reason long weeks Calendar get Instance get Time In Millis time if count if older Than patient reason Hepatits months else if count if older Than patient weeks reason Hepatits months return reason Checks to see if a patient needs the Varicella immunization param count which immunization they are on param patient Age how old the patient is param time what the current date is return when the immunization should be given public static String test Varicella int count Date patient long time String reason long weeks Calendar get Instance get Time In Millis time if count if older Than patient reason Varicella months else if count if older Than patient weeks reason Varicella years return reason Checks to see if a patient needs the Measles Mumps and Rubekka immunization param count which immunization they are on param patient Age how old the patient is param time what the current date is return when the immunization should be given public static String test Measles int count Date patient long time String reason long weeks Calendar get Instance get Time In Millis time if count if older Than patient reason Measles Mumps Rubekka months else if count if older Than patient weeks reason Measles Mumps Rubekka years return reason Checks to see if a patient needs the Polio immunization param count which immunization they are on param patient Age how old the patient is param time what the current date is return when the immunization should be given public static String test Polio int count Date patient long time String reason long weeks Calendar get Instance get Time In Millis time if count if older Than patient reason Poliovirus weeks else if count if older Than patient weeks reason Poliovirus months else if count if older Than patient reason Poliovirus months return reason Checks to see if a patient needs the Pneumococcal immunization param count which immunization they are on param patient Age how old the patient is param time what the current date is return when the immunization should be given public static String test Pneumo int count Date patient long time long first Dose Time String reason Date first Dose new Date first Dose Time long weeks Calendar get Instance get Time In Millis time long age First patient Age first Dose Time if count if older Than patient reason Pneumococcal weeks else if count if older Than patient first Dose After patient first Dose weeks reason Pneumococcal months else if older Than patient first Dose After patient first Dose first Dose After patient first Dose weeks reason Pneumococcal months else if count if older Than patient weeks first Dose After patient first Dose reason Pneumococcal months else if count if older Than patient weeks first Dose After patient first Dose reason Pneumococcal months return reason Checks to see if a patient needs the Haemophilus Infulenzae immunization param count which immunization they are on param patient Age how old the patient is param time what the current date is return when the immunization should be given public static String test Haemo Flu int count Date patient long time long first Dose Time String reason long weeks Calendar get Instance get Time In Millis time Date first Dose new Date first Dose Time long age First patient Age first Dose Time if count if older Than patient reason Haemophilus influenzae weeks else if count if older Than patient first Dose After patient first Dose weeks reason Haemophilus influenzae months else if older Than patient first Dose After patient first Dose first Dose After patient first Dose weeks reason Haemophilus influenzae months else if count if older Than patient weeks first Dose After patient first Dose reason Haemophilus influenzae months return reason Checks to see if a patient needs the Diphtheria Tetanus Pertussis immunization param count which immunization they are on param patient Age how old the patient is param time what the current date is return when the immunization should be given public static String test Dip Tet int count Date patient long time String reason long weeks Calendar get Instance get Time In Millis time if count if older Than patient reason Diphtheria Tetanus Pertussis weeks else if count if older Than patient weeks reason Diphtheria Tetanus Pertussis months else if count if older Than patient weeks reason Diphtheria Tetanus Pertussis months else if count if older Than patient weeks reason Diphtheria Tetanus Pertussis weeks else if count if older Than patient weeks reason Diphtheria Tetanus Pertussis years else if count if older Than patient weeks reason Diphtheria Tetanus Pertussis years return reason Checks to see if a patient needs the Rotavirus immunization param count which immunization they are on param patient Age how old the patient is param time what the current date is return when the immunization should be given public static String test Rota Virus int count Date patient long time String reason long weeks Calendar get Instance get Time In Millis time if count if older Than patient reason Rotavirus weeks else if count if older Than patient weeks reason Rotavirus months else if count if older Than patient weeks reason Rotavirus months return reason Checks to see if a patient needs the Hepatitis immunization param count which immunization they are on param patient Age how old the patient is param time what the current date is return when the immunization should be given public static String test Hep int count Date patient long time String reason long weeks Calendar get Instance get Time In Millis time if count if older Than patient reason Hepatitis birth else if count if older Than patient weeks reason Hepatitis month else if count if older Than patient weeks reason Hepatitis months return reason private static boolean older Than Date patient int years int months int weeks return end Before patient new Date years months weeks private static boolean first Dose After Date patient Date age First int years int months int weeks return end Before patient age First years months weeks private static boolean end Before Date start Time Date end Time int years int months int weeks Calendar cal Calendar get Instance cal set Time start Time cal add Calendar years cal add Calendar months cal add Calendar weeks start Time cal get Time return start Time compare To end Time start Time before end Time 
taglib uri tags tld prefix itrust page error Page auth exception Handler jsp page import java util Array List page import java util List page import edu ncsu csc itrust beans Patient Bean page import edu ncsu csc itrust beans Patient Visit Bean page import edu ncsu csc itrust action View Patient Office Visit History Action include file global jsp page Title i Trust View All Patients include file header jsp View Patient Office Visit History Action action new View Patient Office Visit History Action prod logged In long Value List Patient Visit Bean patient Visits action get Patients logging Action log Event Transaction Type logged In br form action view Report jsp method post name myform table class f Table align center thead tr th colspan Past Patients th tr tr class sub Header th Patient th th Address th th Last Visit th tr thead tbody List Patient Bean patients new Array List Patient Bean int index for Patient Visit Bean bean patient Visits patients add bean get Patient tr td a href edit jsp patient String Escape Utils escape Html index String Escape Utils escape Html bean get Patient Name a td td String Escape Utils escape Html bean get Address bean get Address td td String Escape Utils escape Html bean get Last Date bean get Last Date bean get Last Date td tr index session set Attribute patients patients tbody table form br br include file footer jsp 
package edu ncsu csc itrust dao mysql import java sql Connection import java sql Prepared Statement import java sql Result Set import java sql Exception import java util List import edu ncsu csc itrust Util import edu ncsu csc itrust beans Health Record import edu ncsu csc itrust beans loaders Health Records Bean Loader import edu ncsu csc itrust dao Factory import edu ncsu csc itrust exception Exception Used for all health records where a whole history is kept stands for Database Access Object All Os are intended to be reflections of the database that is one per table in the database most of the time For more complex sets of queries extra Os are added Os can assume that all data has been validated and is correct Os should never have setters or any other parameter to the constructor than a factory All Os should be accessed by Factory see link Factory and every should have a factory for obtaining connections and or accessing other Os author Andy public class Health Records private Health Records Bean Loader loader new Health Records Bean Loader private Factory factory The typical constructor param factory The link Factory associated with this which is used for obtaining connections etc public Health Records Factory factory this factory factory Returns a list of all health records for a particular patient param mid The of the patient to look up return java util List of Health Records throws Exception public List Health Record get All Health Records long mid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Personal Health Information Patient ps set Long mid Result Set rs rs ps execute Query return loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Adds a health record for a particular patient param record The Health Record object to insert return boolean indicating whether the insert was successful throws Exception public boolean add Health Record record throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Personal Health Information Patient Height Weight Smoker Smoking Status Blood Pressure Blood Pressure Cholesterol Cholesterol Cholesterol Tri loader load Parameters ps record int num Inserted ps execute Update return num Inserted catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps 
package edu ncsu csc itrust risk import static edu ncsu csc itrust enums Ethnicity African American import static edu ncsu csc itrust enums Ethnicity American Indian import static edu ncsu csc itrust enums Ethnicity Hispanic import java util Array List import java util List import edu ncsu csc itrust dao Factory import edu ncsu csc itrust enums Gender import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception No Health Records Exception import edu ncsu csc itrust risk factors Age Factor import edu ncsu csc itrust risk factors Cholesterol Factor import edu ncsu csc itrust risk factors Ethnicity Factor import edu ncsu csc itrust risk factors Family History Factor import edu ncsu csc itrust risk factors Gender Factor import edu ncsu csc itrust risk factors Hypertension Factor import edu ncsu csc itrust risk factors Patient Risk Factor import edu ncsu csc itrust risk factors Prior Diagnosis Factor import edu ncsu csc itrust risk factors Smoking Factor import edu ncsu csc itrust risk factors Weight Factor Checks to see if the given patient is at risk for Heart Disease For details on what each method does see link Risk Checker author Andy public class Heart Disease Risks extends Risk Checker public Heart Disease Risks Factory factory long patient throws Exception No Health Records Exception super factory patient Override public boolean qualifies For Disease return true Override protected List Patient Risk Factor get Disease Risk Factors List Patient Risk Factor factors new Array List Patient Risk Factor factors add new Gender Factor patient Gender Male factors add new Age Factor patient factors add new Ethnicity Factor patient Hispanic African American American Indian factors add new Weight Factor current Health Record factors add new Hypertension Factor current Health Record factors add new Cholesterol Factor current Health Record factors add new Smoking Factor factory patient get factors add new Prior Diagnosis Factor factory patient get factors add new Family History Factor factory patient get return factors Override public String get Name return Heart Disease 
package edu ncsu csc itrust validate import edu ncsu csc itrust action Update Hospital List Action import edu ncsu csc itrust beans Hospital Bean import edu ncsu csc itrust exception Error List import edu ncsu csc itrust exception Form Validation Exception Validates the input for hospital beans link Update Hospital List Action author Andy public class Hospital Bean Validator extends Bean Validator Hospital Bean The default constructor public Hospital Bean Validator Performs the act of validating the bean in question which varies depending on the type of validator If the validation does not succeed a link Form Validation Exception is thrown param p bean of the type to be validated Override public void validate Hospital Bean h throws Form Validation Exception Error List error List new Error List error List add If Not Null check Format Hospital h get Hospital Validation Format false error List add If Not Null check Format Hospital Name h get Hospital Name Validation Format false if error List has Errors throw new Form Validation Exception error List 
package edu ncsu csc itrust dao mysql import java sql Connection import java sql Prepared Statement import java sql Result Set import java sql Exception import java util List import edu ncsu csc itrust Util import edu ncsu csc itrust beans Hospital Bean import edu ncsu csc itrust beans loaders Hospital Bean Loader import edu ncsu csc itrust dao Factory import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception i Trust Exception Used for managing hospitals stands for Database Access Object All Os are intended to be reflections of the database that is one per table in the database most of the time For more complex sets of queries extra Os are added Os can assume that all data has been validated and is correct Os should never have setters or any other parameter to the constructor than a factory All Os should be accessed by Factory see link Factory and every should have a factory for obtaining connections and or accessing other Os author Andy public class Hospitals private Factory factory private Hospital Bean Loader hospital Loader new Hospital Bean Loader The typical constructor param factory The link Factory associated with this which is used for obtaining connections etc public Hospitals Factory factory this factory factory Returns a list of all hospitals sorted alphabetically return java util List of Hospital Beans throws Exception public List Hospital Bean get All Hospitals throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Hospitals Hospital Name Result Set rs ps execute Query return hospital Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Returns a particular hospital given its param id The String of the hospital return Hospital Bean representing this hospital throws Exception public Hospital Bean get Hospital String id throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Hospitals Hospital ps set String id Result Set rs ps execute Query if rs next return hospital Loader load Single rs return null catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Adds a hospital param hosp The Hospital Bean object to insert return boolean indicating whether the insertion was successful throws Exception throws i Trust Exception public boolean add Hospital Hospital Bean hosp throws Exception i Trust Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Hospitals Hospital Hospital Name ps set String hosp get Hospital ps set String hosp get Hospital Name return ps execute Update catch Exception e e print Stack Trace if e get Error Code throw new i Trust Exception Error Hospital already exists throw new Exception e finally Util close Connection conn ps Updates a particular hospital s description Returns the number of rows affected should be param hosp The Hospital Bean to update return An int indicating the number of affected rows throws Exception public int update Hospital Hospital Bean hosp throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Hospitals Hospital Name Hospital ps set String hosp get Hospital Name ps set String hosp get Hospital return ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Assign an to a hospital If they have already been assigned to that hospital then an i Trust Exception is thrown param hcp The s to assign to the hospital param hospital The of the hospital to assign them to return boolean indicating whether the assignment was a success throws Exception throws i Trust Exception public boolean assign Hospital long hcp String hospital throws Exception i Trust Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Assigned Hos Hos ps set Long hcp ps set String hospital return ps execute Update catch Exception e if e get Error Code throw new i Trust Exception hcp already assigned to hospital hospital e print Stack Trace throw new Exception e finally Util close Connection conn ps Unassigns an to a hospital Returns whether or not any changes were made param hcp The of the to remove param hospital The of the hospital being removed from return boolean indicating success throws Exception public boolean remove Hospital Assignment long hcp String hospital throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Assigned Hos Hos ps set Long hcp ps set String hospital return ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Removes all hospital assignments for a particular Returns the number of rows affected param hcp The of the return An int representing the number of hospital assignments removed throws Exception public int remove All Hospital Assignments From long hcp throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Assigned Hos ps set Long hcp return ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Checks to see if the has an assigned hospital param hcp The of the return true If the has an assigned hospital to them return false If the does not have an assigned hospital to them throws Exception public boolean check Has Hospital long hcp throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Assigned Hos ps set Long hcp Result Set rs ps execute Query if rs next return true return false catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps 
package edu ncsu csc itrust dao mysql import java sql Connection import java sql Prepared Statement import java sql Result Set import java sql Exception import java util List import edu ncsu csc itrust Util import edu ncsu csc itrust beans Diagnosis Bean import edu ncsu csc itrust beans loaders Diagnosis Bean Loader import edu ncsu csc itrust dao Factory import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception i Trust Exception Used for managing all codes stands for Database Access Object All Os are intended to be reflections of the database that is one per table in the database most of the time For more complex sets of queries extra Os are added Os can assume that all data has been validated and is correct Os should never have setters or any other parameter to the constructor than a factory All Os should be accessed by Factory see link Factory and every should have a factory for obtaining connections and or accessing other Os The International Statistical Classification of Diseases and Related Health Problems most commonly known by the abbreviation provides codes to classify diseases and a wide variety of signs symptoms abnormal findings complaints social circumstances and external causes of injury or disease see http www cdc gov nchs icd htm author Andy public class Codes private Factory factory private Diagnosis Bean Loader diagnosis Loader new Diagnosis Bean Loader The typical constructor param factory The link Factory associated with this which is used for obtaining connections etc public Codes Factory factory this factory factory Returns all codes sorted by code return java util List of Diagnosis Beans throws Exception public List Diagnosis Bean get All Codes throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Codes Result Set rs ps execute Query return diagnosis Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Returns a particular description for a given code param code The String representation of the code return Diagnosis Bean of the code throws Exception public Diagnosis Bean get Code String code throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Codes Code ps set String code Result Set rs ps execute Query if rs next return diagnosis Loader load Single rs return null catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Adds an code Returns whether or not the change was made param diag The Diagnosis Bean representing the changes return boolean indicating success throws Exception throws i Trust Exception public boolean add Code Diagnosis Bean diag throws Exception i Trust Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Codes Code Description Chronic ps set String diag get Code ps set String diag get Description ps set String diag get Classification return ps execute Update catch Exception e e print Stack Trace if e get Error Code throw new i Trust Exception Error Code already exists throw new Exception e finally Util close Connection conn ps Changes a the description of a particular code param diag Diagnosis Bean representing the changes return boolean indicating the number of updated rows throws Exception public int update Code Diagnosis Bean diag throws Exception int rows Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Codes Description Chronic Code ps set String diag get Description ps set String diag get Classification ps set String diag get Code rows ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps return rows 
package edu ncsu csc itrust dao mysql import java sql Connection import java sql Prepared Statement import java sql Result Set import java sql Exception import java util List import edu ncsu csc itrust Util import edu ncsu csc itrust beans Lab Procedure Bean import edu ncsu csc itrust beans loaders Lab Procedure Bean Loader import edu ncsu csc itrust dao Factory import edu ncsu csc itrust exception Exception for managing lab procedure codes Database Access Object All info coming into a is already validated Just worry about stuff here Note that all Os need to have a Factory with which to access other Os and to get connections Also every must have a constructor with a Factory as a parameter public class Lab Procedure private Factory factory private Lab Procedure Bean Loader lab Procedure Loader The typical constructor param factory The link Factory associated with this which is used for obtaining connections etc public Lab Procedure Factory factory this factory factory lab Procedure Loader new Lab Procedure Bean Loader Get a list of the lab procedures associated with a given patient param id The of the patient as a long return java util List of Lab Procedure Beans throws Exception public List Lab Procedure Bean get Lab Procedures For Patient long id throws Exception Connection conn null Prepared Statement ps null try if id throw new Exception Patient can not be null conn factory get Connection ps conn prepare Statement Lab Procedure Patient Rights Updated Date ps set Long id ps set String Lab Procedure Bean Allow Result Set rs ps execute Query return lab Procedure Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Get lab procedures for a specific office visit but excluding lab procedures which a patient does not have access to param ovid Office visit id return throws Exception public List Lab Procedure Bean get Lab Procedures For Patient long ovid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Lab Procedure Office Visit Rights Updated Date ps set Long ovid ps set String Lab Procedure Bean Allow Result Set rs ps execute Query return lab Procedure Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Gets all the lab procedures for a given patient that occur within the next month param id The of the patient as a long return java util List of Lab Procedure Beans throws Exception public List Lab Procedure Bean get Lab Procedures For Patient For Next Month long id throws Exception Connection conn null Prepared Statement ps null try if id throw new Exception Patient can not be null conn factory get Connection ps conn prepare Statement Lab Procedure Patient Rights Status Date Diff Updated Date Updated Date ps set Long id ps set String Lab Procedure Bean Allow ps set String Lab Procedure Bean Completed Result Set rs ps execute Query return lab Procedure Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Gets an individual lab procedure param id The of the lab procedure return Lab Procedure Bean representing the procedure throws Exception public Lab Procedure Bean get Lab Procedure long id throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Lab Procedure Laboratory Procedure ps set Long id Result Set rs ps execute Query rs next return lab Procedure Loader load Single rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Gets all procedures for Patient param mid patient id return java util List of Lab Procedure Beans throws Exception public List Lab Procedure Bean get All Lab Procedures Date long mid throws Exception Connection conn null Prepared Statement ps null try if mid throw new Exception Patient can not be null conn factory get Connection ps conn prepare Statement Lab Procedure Patient Updated Date ps set Long mid Result Set rs ps execute Query return lab Procedure Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps This gets all the procedures for a particular patient on a particular office visit param mid The of the patient param ovid The Office Visit return java util List of Lab Procedure Beans throws Exception public List Lab Procedure Bean get All Lab Procedures For Doc long mid long ovid throws Exception Connection conn null Prepared Statement ps null try if mid throw new Exception Patient can not be null conn factory get Connection ps conn prepare Statement Lab Procedure Patient Office Visit Updated Date ps set Long mid ps set Long ovid Result Set rs ps execute Query return lab Procedure Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps This gets all the procedures for a particular patient on a particular office visit param ovid The Office Visit return java util List of Lab Procedure Beans throws Exception public List Lab Procedure Bean get All Lab Procedures For Doc long ovid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Lab Procedure Office Visit ps set Long ovid Result Set rs ps execute Query return lab Procedure Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Gets all lab procedures period return java util List of Lab Procedure Beans throws Exception public List Lab Procedure Bean get All Lab Procedures throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Lab Procedure Updated Date Result Set rs ps execute Query return lab Procedure Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Get all lab procedures associated with a particular param mid The s id return throws Exception public List Lab Procedure Bean get Lab Procedures long mid throws Exception Connection conn null Prepared Statement ps null try if mid throw new Exception id can not be null conn factory get Connection ps conn prepare Statement Lab Procedure Lab Procedure Office Visit Office Visits Office Visits Office Visits ps set Long mid Result Set rs ps execute Query return lab Procedure Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Get all lab procedures associated with a particular and Patient param mid The s id return throws Exception public List Lab Procedure Bean get Lab Procedures long mid long pid throws Exception Connection conn null Prepared Statement ps null try if mid throw new Exception id can not be null if pid throw new Exception id can not be null conn factory get Connection ps conn prepare Statement Lab Procedure Lab Procedure Office Visit Office Visits Office Visits Office Visits Office Visits Patient ps set Long mid ps set Long pid Result Set rs ps execute Query return lab Procedure Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Get a count of all pending lab procedures for a particular param mid return throws Exception public int get Pending Count long mid throws Exception Connection conn null Prepared Statement ps null try int count conn factory get Connection ps conn prepare Statement Lab Procedure Status Lab Procedure Office Visit Office Visits Office Visits Office Visits ps set String Lab Procedure Bean Pending ps set Long mid Result Set rs ps execute Query if rs next count rs get Int return count catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Gets the lab procedures for a given that occur within the next month param ovid The Office Visit conducted by the in question return java util List of Lab Procedure Beans throws Exception public List Lab Procedure Bean get Lab Procedures For For Next Month long ovid throws Exception Connection conn null Prepared Statement ps null try if ovid throw new Exception Office Visit can not be null conn factory get Connection ps conn prepare Statement Lab Procedure Office Visit Status Date Diff Updated Date Updated Date ps set Long ovid ps set String Lab Procedure Bean Completed Result Set rs ps execute Query return lab Procedure Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Inserts a lab procedure into the database param b The Lab Procedure Bean to be inserted return long containing the of the newly inserted lab procedure bean throws Exception public long add Lab Procedure Lab Procedure Bean b throws Exception Connection conn null Prepared Statement ps null try if b get Pid throw new Exception Patient can not be null conn factory get Connection ps conn prepare Statement Lab Procedure Patient Laboratory Procedure Code Status Commentary Results Office Visit Rights Lab Tech Priority Code Numerical Results Lower Bound Upper Bound ps set Long b get Pid ps set String b get Loinc ps set String b get Status ps set String b get Commentary ps set String b get Results ps set Long b get Ov ps set String b get Rights ps set Long b get ps set Int b get Priority Code ps set String b get Numerical Result ps set String b get Lower Bound ps set String b get Upper Bound ps execute Update return Util get Last Insert conn catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Updates an existing lab procedure param b The Lab Procedure Bean representing the procedure to be updated throws Exception public void update Lab Procedure Lab Procedure Bean b throws Exception Connection conn null Prepared Statement ps null try if b get Pid throw new Exception Patient can not be null conn factory get Connection ps conn prepare Statement Lab Procedure Status Commentary Results Updated Date Lab Tech Priority Code Numerical Results Lower Bound Upper Bound Laboratory Procedure ps set String b get Status ps set String b get Commentary ps set String b get Results ps set Timestamp new java sql Timestamp System current Time Millis ps set Long b get ps set Int b get Priority Code ps set String b get Numerical Result ps set String b get Lower Bound ps set String b get Upper Bound ps set Long b get Procedure ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Marks a lab procedure as viewed by the patient param b The Lab Procedure Bean representing the procedure to be marked as viewed throws Exception public void mark Viewed Lab Procedure Bean b throws Exception Connection conn null Prepared Statement ps null try if b get Pid throw new Exception Patient can not be null conn factory get Connection ps conn prepare Statement Lab Procedure Viewed By Patient Laboratory Procedure ps set Boolean b is Viewed By Patient ps set Long b get Procedure ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Get the count of unviewed lab procedures for a particular patient param pid return throws Exception public int get Patient Unviewed Count long pid throws Exception Connection conn null Prepared Statement ps null try if pid throw new Exception Patient can not be null int count conn factory get Connection ps conn prepare Statement Lab Procedure Patient Rights Status Viewed By Patient ps set Long pid ps set String Lab Procedure Bean Allow ps set String Lab Procedure Bean Completed Result Set rs ps execute Query if rs next count rs get Int return count catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Gets all the lab procedures that correspond to a particular param id The in question return java util List of Lab Procedure Beans throws Exception public List Lab Procedure Bean get All Lab Procedures long id String loinc throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Lab Procedure Patient Laboratory Procedure Code Status ps set Long id ps set String loinc ps set String Completed Result Set rs ps execute Query return lab Procedure Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Updates the rights of a user on a given lab procedure param b The Lab Procedure Bean in question throws Exception public void update Rights Lab Procedure Bean b throws Exception Connection conn null Prepared Statement ps null try if b get Pid throw new Exception Patient can not be null conn factory get Connection ps conn prepare Statement Lab Procedure Rights Updated Date Laboratory Procedure ps set String b get Rights ps set Timestamp new java sql Timestamp System current Time Millis ps set Long b get Procedure ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Delete a given lab procedure form the database param procedure throws Exception public void remove Lab Procedure long procedure throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement labprocedure Laboratory Procedure ps set Long procedure ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Get a list of the lab procedures in transit associated with a given Lab Tech param id The of the as a long return java util List of Lab Procedure Beans throws Exception public List Lab Procedure Bean get Lab Procedures In Transit For Lab Tech long id throws Exception Connection conn null Prepared Statement ps null try if id throw new Exception Lab Tech can not be null conn factory get Connection ps conn prepare Statement Lab Procedure Lab Tech Status Updated Date ps set Long id ps set String Lab Procedure Bean In Transit Result Set rs ps execute Query return lab Procedure Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Get a list of the lab procedures received for a given Lab Tech param id The of the as a long return java util List of Lab Procedure Beans throws Exception public List Lab Procedure Bean get Lab Procedures Received For Lab Tech long id throws Exception Connection conn null Prepared Statement ps null try if id throw new Exception Lab Tech can not be null conn factory get Connection ps conn prepare Statement Lab Procedure Lab Tech Status Priority Code Updated Date ps set Long id ps set String Lab Procedure Bean Received Result Set rs ps execute Query return lab Procedure Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Get a list of the lab procedures testing for a given Lab Tech param id The of the as a long return java util List of Lab Procedure Beans throws Exception public List Lab Procedure Bean get Lab Procedures Testing For Lab Tech long id throws Exception Connection conn null Prepared Statement ps null try if id throw new Exception Lab Tech can not be null conn factory get Connection ps conn prepare Statement Lab Procedure Lab Tech Status Updated Date ps set Long id ps set String Lab Procedure Bean Testing Result Set rs ps execute Query return lab Procedure Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Get the count of the In Transit and Received lab procedures assigned to a specific lab tech param mid return throws Exception public int get Lab Tech Queue Size long mid throws Exception Connection conn null Prepared Statement ps null try if mid throw new Exception Lab Tech can not be null conn factory get Connection int count ps conn prepare Statement Lab Procedure Lab Tech Status Status ps set Long mid ps set String Lab Procedure Bean In Transit ps set String Lab Procedure Bean Received Result Set rs ps execute Query if rs next count rs get Int return count catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Get the count of the In Transit and Received lab procedures assigned to a specific lab tech grouped by priority param mid return throws Exception public int get Lab Tech Queue Size By Priority long mid throws Exception Connection conn null Prepared Statement ps null int sizes new int try if mid throw new Exception Lab Tech can not be null conn factory get Connection for int i i i int count ps conn prepare Statement Lab Procedure Lab Tech Status Status Priority Code ps set Long mid ps set String Lab Procedure Bean In Transit ps set String Lab Procedure Bean Received ps set Int i Result Set rs ps execute Query if rs next count rs get Int sizes i count return sizes catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps param id param parse Long param parse Long param parse Long throws Exception public void submit Test Results long id String numerical Result String numerical Result Unit String upper String lower throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Lab Procedure Numerical Results Numerical Results Unit Upper Bound Lower Bound Status Updated Date Laboratory Procedure ps set String numerical Result ps set String numerical Result Unit ps set String upper ps set String lower ps set String Pending ps set Timestamp new java sql Timestamp System current Time Millis ps set Long id ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps param parse Long throws Exception public void submit Received long id throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Lab Procedure Status Updated Date Laboratory Procedure ps set String Received ps set Timestamp new java sql Timestamp System current Time Millis ps set Long id ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps param parse Long throws Exception public void set To Testing long id throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Lab Procedure Status Updated Date Laboratory Procedure ps set String Testing ps set Timestamp new java sql Timestamp System current Time Millis ps set Long id ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps public List Lab Procedure Bean get All Lab Procedures long id throws Exception Connection conn null Prepared Statement ps null try if id throw new Exception Patient can not be null conn factory get Connection ps conn prepare Statement Lab Procedure Patient Laboratory Procedure Code ps set Long id Result Set rs ps execute Query return lab Procedure Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps 
package edu ncsu csc itrust action import java util List import java util Array List import edu ncsu csc itrust beans Lab Procedure Bean import edu ncsu csc itrust beans Office Visit Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Lab Procedure import edu ncsu csc itrust dao mysql Office Visit import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception Form Validation Exception import edu ncsu csc itrust validate Lab Procedure Validator Action class for Lab Proc jsp extends Lab Proc Action public class Lab Proc Action extends Lab Proc Action private Lab Procedure lp private Office Visit ov long logged In private Lab Procedure Validator validator Sets up defaults param factory The Factory used to create the Os used in this action param logged In for the logged in public Lab Proc Action Factory factory long logged In super factory logged In lp factory get Lab Procedure ov factory get Office Visit this logged In logged In validator new Lab Procedure Validator This method sorts by and returns the list param id the to sort the list by return List sorted by public List Lab Procedure Bean sort By long id throws Exception return lp get All Lab Procedures id Returns a list of all the lab procedures for the next month return all the lab procedures for the next month public List Lab Procedure Bean get Lab Proc For Next Month throws Exception List Lab Procedure Bean list Lab Proc new Array List Lab Procedure Bean List Office Visit Bean list ov get All Office Visits For logged In for Office Visit Bean ov list if list Lab Proc is Empty true list Lab Proc lp get Lab Procedures For For Next Month ov get else for Lab Procedure Bean lb lp get Lab Procedures For For Next Month ov get list Lab Proc add lb return list Lab Proc Changes the privacy settings param x the of the procedure to change public void change Privacy long x throws Exception Form Validation Exception Lab Procedure Bean pb lp get Lab Procedure x if check Access x if pb get Rights equals Lab Procedure Bean Restrict pb allow else pb restrict validator validate pb lp update Rights pb Checks to see if the logged in is the one who made the procedure Used to generate links for page to edit Office Visit param x the of the to check public boolean check Access long x throws Exception Form Validation Exception Lab Procedure Bean pb lp get Lab Procedure x Office Visit Bean ovbean ov get Office Visit pb get Ov return logged In ovbean get Hcp public int get Pending Count throws Exception return lp get Pending Count logged In public List Lab Procedure Bean view Procedures By throws Exception return lp get Lab Procedures logged In 
package edu ncsu csc itrust action import java util Arrays import java util List import edu ncsu csc itrust Email Util import edu ncsu csc itrust beans Email import edu ncsu csc itrust beans Lab Procedure Bean import edu ncsu csc itrust beans Patient Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Lab Procedure import edu ncsu csc itrust dao mysql Patient import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception Form Validation Exception import edu ncsu csc itrust validate Lab Procedure Validator Class for Lab Proc jsp Handles lab procedures for Ps public class Lab Proc Action private Lab Procedure lp long logged In private Lab Procedure Validator validator private Factory factory Setup param factory The Factory used to create the Os used in this action param logged In who is logged in public Lab Proc Action Factory factory long logged In factory get Transaction lp factory get Lab Procedure this logged In logged In validator new Lab Procedure Validator this factory factory Updates a lab procedure param b the procedure to update throws Exception throws Form Validation Exception public void update Procedure Lab Procedure Bean b throws Exception Form Validation Exception validator validate b need to check if status is what s being changed if new status old status send email if b get Status equals lp get Lab Procedure b get Procedure get Status new Email Util factory send Email make Email b lp update Lab Procedure b Sends an e mail informing the patient that their procedure has been updated param b the procedure that was updated return an e mail to the patient with the notice throws Exception private Email make Email Lab Procedure Bean b throws Exception Patient Bean p new Patient factory get Patient b get Pid Email email new Email email set From no reply itrust com email set To List Arrays as List p get Email email set Subject Lab Procedure Was Updated email set Body String format Dear s n Your Lab Procedure s has a new updated status of s Log on to i Trust to view p get Full Name b get Loinc b get Status return email Returns a list of all the lab procedures for a particular patient param id of the viewing the procedures return a list of all the lab procedures for that throws Exception public List Lab Procedure Bean view Procedures long id throws Exception return lp get All Lab Procedures Date id Returns a list of the lab procedures associated with both the and the given patient param pid The id of the patient return list of lab procedures throws Exception public List Lab Procedure Bean view Patient Procedures long pid throws Exception return lp get Lab Procedures logged In pid 
package edu ncsu csc itrust validate import edu ncsu csc itrust beans Cbean import edu ncsu csc itrust exception Error List import edu ncsu csc itrust exception Form Validation Exception Validator used to validate Cbean public class Bean Validator extends Bean Validator Cbean The default constructor public Bean Validator Performs the act of validating the bean in question which varies depending on the type of validator If the validation does not succeed a link Form Validation Exception is thrown param p bean of the type to be validated Override public void validate Cbean m throws Form Validation Exception Error List error List new Error List if m get Lab Procedure Code null m get Component null m get Kind Of Property null throw new Form Validation Exception You must have a Lab Procedure Code Component and Kind Of Property error List add If Not Null check Format Laboratory Procedure Code m get Lab Procedure Code Validation Format false error List add If Not Null check Format Component m get Component Validation Format false error List add If Not Null check Format Kind Of Property m get Kind Of Property Validation Format false error List add If Not Null check Format Time Aspect m get Time Aspect Validation Format true error List add If Not Null check Format System m get System Validation Format true error List add If Not Null check Format Scale Type m get Scale Type Validation Format true error List add If Not Null check Format Method Type m get Method Type Validation Format true if error List has Errors throw new Form Validation Exception error List 
package edu ncsu csc itrust dao mysql import java sql Connection import java sql Prepared Statement import java sql Result Set import java sql Exception import java util List import edu ncsu csc itrust Util import edu ncsu csc itrust beans Cbean import edu ncsu csc itrust beans loaders Bean Loader import edu ncsu csc itrust dao Factory import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception i Trust Exception stands for Database Access Object All Os are intended to be reflections of the database that is one per table in the database most of the time For more complex sets of queries extra Os are added Os can assume that all data has been validated and is correct Os should never have setters or any other parameter to the constructor than a factory All Os should be accessed by Factory see link Factory and every should have a factory for obtaining connections and or accessing other Os Logical Observation Identifiers Names and Codes is a database and universal standard for identifying medical laboratory observations see http loinc org author Ben Smith public class private Factory factory private Bean Loader Loader The typical constructor param factory The link Factory associated with this which is used for obtaining connections etc public Factory factory this factory factory Loader new Bean Loader Adds a param hosp The Cbean representing the new code to be added throws Exception throws i Trust Exception public void add Cbean hosp throws Exception i Trust Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Laboratory Procedure Code Component Kind Of Property Time Aspect System Scale Type Method Type ps set String hosp get Lab Procedure Code ps set String hosp get Component ps set String hosp get Kind Of Property ps set String hosp get Time Aspect ps set String hosp get System ps set String hosp get Scale Type ps set String hosp get Method Type ps execute Update catch Exception e e print Stack Trace if e get Error Code throw new i Trust Exception Error already exists throw new Exception e finally Util close Connection conn ps Returns all Cs associated with Laboratory Procedure Code param visit The code of the Laboratory Procedure Code as a String return java util List of Beans matching the Laboratory Procedure Code throws Exception public List Cbean get Procedures String visit throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Select From Where Laboratory Procedure Code ps set String visit Result Set rs ps execute Query return Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Updates the information in param ov throws Exception public int update Cbean ov throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Component Kind Of Property Time Aspect System Scale Type Method Type Laboratory Procedure Code ps set String ov get Component ps set String ov get Kind Of Property ps set String ov get Time Aspect ps set String ov get System ps set String ov get Scale Type ps set String ov get Method Type ps set String ov get Lab Procedure Code return ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Returns all Cs as a list return java util List of Cbeans throws Exception public List Cbean get All throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Result Set rs ps execute Query return Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps 
package edu ncsu csc itrust validate import edu ncsu csc itrust action Update Code List Action import edu ncsu csc itrust beans Medication Bean import edu ncsu csc itrust exception Error List import edu ncsu csc itrust exception Form Validation Exception Validates code beans from link Update Code List Action author Andy public class Medication Bean Validator extends Bean Validator Medication Bean The default constructor public Medication Bean Validator Performs the act of validating the bean in question which varies depending on the type of validator If the validation does not succeed a link Form Validation Exception is thrown param p bean of the type to be validated Override public void validate Medication Bean m throws Form Validation Exception Error List error List new Error List error List add If Not Null check Format Code m get Code Validation Format false error List add If Not Null check Format Description m get Description Validation Format false if error List has Errors throw new Form Validation Exception error List 
package edu ncsu csc itrust dao mysql import java sql Connection import java sql Prepared Statement import java sql Result Set import java sql Exception import java util List import edu ncsu csc itrust Util import edu ncsu csc itrust beans Message Bean import edu ncsu csc itrust beans loaders Message Bean Loader import edu ncsu csc itrust dao Factory import edu ncsu csc itrust exception Exception Used for the logging mechanism stands for Database Access Object All Os are intended to be reflections of the database that is one per table in the database most of the time For more complex sets of queries extra Os are added Os can assume that all data has been validated and is correct Os should never have setters or any other parameter to the constructor than a factory All Os should be accessed by Factory see link Factory and every should have a factory for obtaining connections and or accessing other Os author Andy public class Message private Factory factory private Message Bean Loader mb Loader The typical constructor param factory The link Factory associated with this which is used for obtaining connections etc public Message Factory factory this factory factory this mb Loader new Message Bean Loader Gets all the messages for a certain user param mid The of the user to be looked up return java util List of Message Beans throws Exception public List Message Bean get Messages For long mid throws Exception Connection conn null Prepared Statement ps null conn factory get Connection ps conn prepare Statement message to id sent date ps set Long mid Result Set rs ps execute Query List Message Bean mb List this mb Loader load List rs Util close Connection conn ps return mb List Gets all the messages for a certain user sorted by ascending time param mid The of the user to be looked up return java util List of Message Beans throws Exception public List Message Bean get Messages Time Ascending long mid throws Exception Connection conn null Prepared Statement ps null conn factory get Connection ps conn prepare Statement message to id sent date ps set Long mid Result Set rs ps execute Query List Message Bean mb List this mb Loader load List rs Util close Connection conn ps return mb List Gets all the messages for a certain user sorted by name ascending param mid The of the user to be looked up return java util List of Message Beans throws Exception public List Message Bean get Messages Name Ascending long mid throws Exception Connection conn null Prepared Statement ps null Result Set rs conn factory get Connection if mid ps conn prepare Statement message message patients message from id patients mid message to id patients last Name patients first Name message sent date ps set Long mid rs ps execute Query else ps conn prepare Statement message message personnel message from id personnel mid message to id personnel last Name personnel first Name message sent date ps set Long mid rs ps execute Query List Message Bean mb List this mb Loader load List rs Util close Connection conn ps return mb List Gets all the messages for a certain user sorted by name descending param mid The of the user to be looked up return java util List of Message Beans throws Exception public List Message Bean get Messages Name Descending long mid throws Exception Connection conn null Prepared Statement ps null Result Set rs conn factory get Connection if mid ps conn prepare Statement message message patients message from id patients mid message to id patients last Name patients first Name message sent date ps set Long mid rs ps execute Query else ps conn prepare Statement message message personnel message from id personnel mid message to id personnel last Name personnel first Name message sent date ps set Long mid rs ps execute Query List Message Bean mb List this mb Loader load List rs Util close Connection conn ps return mb List Gets all the messages from a certain user param mid The of the user to be looked up return java util List of Message Beans throws Exception public List Message Bean get Messages From long mid throws Exception Connection conn null Prepared Statement ps null conn factory get Connection ps conn prepare Statement message from id sent date ps set Long mid Result Set rs ps execute Query List Message Bean mb List this mb Loader load List rs Util close Connection conn ps return mb List Gets all the messages for a certain user sorted by ascending time param mid The of the user to be looked up return java util List of Message Beans throws Exception public List Message Bean get Messages From Time Ascending long mid throws Exception Connection conn null Prepared Statement ps null conn factory get Connection ps conn prepare Statement message from id sent date ps set Long mid Result Set rs ps execute Query List Message Bean mb List this mb Loader load List rs Util close Connection conn ps return mb List Gets all the messages for a certain user sorted by name ascending param mid The of the user to be looked up return java util List of Message Beans throws Exception public List Message Bean get Messages From Name Ascending long mid throws Exception Connection conn null Prepared Statement ps null Result Set rs conn factory get Connection if mid ps conn prepare Statement message message patients message to id patients mid message from id patients last Name patients first Name message sent date ps set Long mid rs ps execute Query else ps conn prepare Statement message message personnel message to id personnel mid message from id personnel last Name personnel first Name message sent date ps set Long mid rs ps execute Query List Message Bean mb List this mb Loader load List rs Util close Connection conn ps return mb List Gets all the messages for a certain user sorted by name descending param mid The of the user to be looked up return java util List of Message Beans throws Exception public List Message Bean get Messages From Name Descending long mid throws Exception Connection conn null Prepared Statement ps null Result Set rs conn factory get Connection if mid ps conn prepare Statement message message patients message to id patients mid message from id patients last Name patients first Name message sent date ps set Long mid rs ps execute Query else ps conn prepare Statement message message personnel message to id personnel mid message from id personnel last Name personnel first Name message sent date ps set Long mid rs ps execute Query List Message Bean mb List this mb Loader load List rs Util close Connection conn ps return mb List Adds a message to the database param m Bean bean representing the message to be added throws Exception public void add Message Message Bean m Bean throws Exception Connection conn null Prepared Statement ps null conn factory get Connection if m Bean get Parent Message Id ps conn prepare Statement message from id to id sent date message subject been read this mb Loader load Parameters ps m Bean else ps conn prepare Statement message from id to id sent date message subject been read parent msg id this mb Loader load Parameters ps m Bean ps execute Update Util close Connection conn ps public void update Read Message Bean m Bean throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement message been read message id ps set Long m Bean get Message Id ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps 
package edu ncsu csc itrust action Used by As to view the reported adverse events import java sql Exception import java text Parse Exception import java util Array List import java util List import edu ncsu csc itrust Email Util import edu ncsu csc itrust beans Adverse Event Bean import edu ncsu csc itrust beans Email import edu ncsu csc itrust beans Message Bean import edu ncsu csc itrust beans Patient Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Adverse Event import edu ncsu csc itrust dao mysql Patient import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception Form Validation Exception import edu ncsu csc itrust exception i Trust Exception public class Monitor Adverse Event Action private long logged In private Email Util emailer private Patient patient private Adverse Event adverse Event private Send Message Action messenger Constructor param factory param logged In public Monitor Adverse Event Action Factory factory long logged In this logged In logged In this patient factory get Patient this emailer new Email Util factory this adverse Event factory get Adverse Event this messenger new Send Message Action factory logged In Returns a list of reports between specified dates param is Prescription Boolean to return prescriptions or immunizations param start The starting date param end The ending date return the list of events throws i Trust Exception throws Form Validation Exception throws Exception throws Parse Exception public List Adverse Event Bean get Reports boolean is Prescription String start String end throws i Trust Exception Form Validation Exception Exception Parse Exception if is Prescription return adverse Event get Perscriptions start end else is Immunization return adverse Event get Immunizations start end Returns the patient s name param the of the patient to return the name for return public String get Name long try return patient get Name catch Exception e return catch i Trust Exception e return Patient no longer exists Sends an e mail to a patient requesting more information param patient The patient to receive the message param message The message return string for testing purposes throws Exception public String send Email long patient String message throws Exception String r Value List String to List new Array List String Patient Bean receiver patient get Patient patient to List add receiver get Email Email mail new Email mail set Body message mail set From logged In mail set To List to List emailer send Email mail r Value mail get From mail get Body return r Value Method used to remove an adverse event report param id the id of the report to be removed throws Exception throws i Trust Exception public void remove int id throws Exception i Trust Exception Form Validation Exception long try Adverse Event Bean ae Bean adverse Event get Report id adverse Event remove Report id adverse Event get id Message Bean m Bean Two new Message Bean Message Bean m Bean One new Message Bean String body An adverse event for ae Bean get Drug perscribed to patient get Name Long parse Long ae Bean get with description ae Bean get Description was removed m Bean One set To Long parse Long ae Bean get m Bean Two set To m Bean One set Subject Subject m Bean Two set Subject Subject m Bean One set Body body m Bean Two set Body body m Bean One set From logged In m Bean Two set From logged In messenger send Message m Bean One messenger send Message m Bean Two catch Exception e throw new Exception e 
package edu ncsu csc itrust action import java io Serializable import java util import edu ncsu csc itrust beans Diagnosis Bean import edu ncsu csc itrust beans Diagnosis Bean import edu ncsu csc itrust beans Office Visit Bean import edu ncsu csc itrust beans Prescription Bean import edu ncsu csc itrust beans Medication Bean import edu ncsu csc itrust beans Survey Bean import edu ncsu csc itrust beans Lab Procedure Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Patient import edu ncsu csc itrust dao mysql Prescriptions import edu ncsu csc itrust dao mysql Office Visit import edu ncsu csc itrust dao mysql Survey import edu ncsu csc itrust dao mysql Personnel import edu ncsu csc itrust dao mysql Lab Procedure import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception i Trust Exception Edits the privacy levels of diagnoses used by my Diagnoses jsp author laurenhayward public class My Diagnosis Action private Office Visit office Visit private Patient patient private Personnel personnel private Survey survey private Lab Procedure labproc private Prescriptions prescriptions private long logged In Set up for defaults param factory The Factory used to create the Os used in this action param logged In The of the user who is looking at their diagnoses throws i Trust Exception public My Diagnosis Action Factory factory long logged In throws i Trust Exception this logged In logged In this patient factory get Patient this office Visit factory get Office Visit this personnel factory get Personnel this survey factory get Survey this labproc factory get Lab Procedure this prescriptions factory get Prescriptions Returns a list of Diagnosis Beans for the patient return the list of Diagnosis Beans throws Exception public List Diagnosis Bean get Diagnoses throws Exception return patient get Diagnoses logged In Returns a list of all the Ps who have a particular diagnosis param icdcode the diagnosis of interest return the list of Ps throws Exception public List Diagnosis Bean get By Diagnosis String icdcode throws Exception int med Match Hash Map Long Diagnosis Bean hcp Hash new Hash Map Long Diagnosis Bean Hash Map Long Long patient Hash new Hash Map Long Long Diagnosis Bean diag null List Office Visit Bean beans office Visit get All Office Visits For Diagnosis icdcode for Office Visit Bean bean beans check for Patient locality based on first digits in if patient get Patient logged In get Zip substring equals personnel get Personnel bean get Hcp get Zip substring continue Check to see if we already have a bean for the associated with this visit if hcp Hash contains Key bean get Hcp diag hcp Hash get bean get Hcp get all prescriptions associated with an office visit List Prescription Bean prescriptions prescriptions get List bean get for Prescription Bean p prescriptions List Medication Bean mlist diag get Med List for Medication Bean b mlist if p get Medication get Description equals b get Description med Match if med Match mlist add p get Medication diag set Med List mlist else med Match Get Lab Procedures List Lab Procedure Bean labprocs diag get Lab List List Lab Procedure Bean lpbeans labproc get All Lab Procedures For Doc bean get Visit for Lab Procedure Bean p lpbeans labprocs add p diag set Lab List labprocs if survey is Survey Completed bean get Visit Survey Bean survey survey get Survey Data bean get Visit diag set Visit Sat survey get Visit Satisfaction diag set Treatment Sat survey get Treatment Satisfaction Check if this patient has been seen multiple times for this diagnosis if patient Hash contains Key bean get Patient patient Hash put bean get Patient bean get Hcp diag inc Num Patients else diag new Diagnosis Bean List Medication Bean mlist new Array List Medication Bean diag set bean get Hcp try diag set Name personnel get Name bean get Hcp catch i Trust Exception e diag set Name null diag inc Num Patients List Prescription Bean prescriptions prescriptions get List bean get for Prescription Bean p prescriptions mlist add p get Medication diag set Med List mlist diag set Lab List labproc get All Lab Procedures For Doc bean get Visit if survey is Survey Completed bean get Visit Survey Bean survey survey get Survey Data bean get Visit diag set Visit Sat survey get Visit Satisfaction diag set Treatment Sat survey get Treatment Satisfaction patient Hash put bean get Patient bean get Hcp hcp Hash put bean get Hcp diag List Diagnosis Bean list new Array List Diagnosis Bean hcp Hash values Collections sort list new Diagnosis Bean Comparator return list Looks up all the prescriptions given by a certain with the same code param hcpid The of the param icdcode The code of the prescription we are looking up return java util List of Prescription Beans made by this of this code throws Exception public List Prescription Bean get Prescriptions By And long hcpid String icdcode throws Exception List Prescription Bean list new Array List Prescription Bean List Office Visit Bean ovs office Visit get All Office Visits For Diagnosis icdcode for int i i ovs size i if ovs get i get Hcp hcpid long ovid ovs get i get List Prescription Bean prescriptions prescriptions get List ovid list add All prescriptions return list Checks to see what has had the most experience with a diagnosis static class Diagnosis Bean Comparator implements Comparator Diagnosis Bean Serializable private static final long serial Version Compares one with another param a the first param b the second return if a has had more patients if b has had more patients otherwise public int compare Diagnosis Bean a Diagnosis Bean b int ret if a get Num Patients b get Num Patients ret else if a get Num Patients b get Num Patients ret return ret 
package edu ncsu csc itrust dao mysql import java sql Connection import java sql Prepared Statement import java sql Result Set import java sql Exception import java util List import edu ncsu csc itrust Util import edu ncsu csc itrust beans Medication Bean import edu ncsu csc itrust beans loaders Medication Bean Loader import edu ncsu csc itrust dao Factory import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception i Trust Exception Used for managing the Codes stands for Database Access Object All Os are intended to be reflections of the database that is one per table in the database most of the time For more complex sets of queries extra Os are added Os can assume that all data has been validated and is correct Os should never have setters or any other parameter to the constructor than a factory All Os should be accessed by Factory see link Factory and every should have a factory for obtaining connections and or accessing other Os The National Drug Code is a universal product identifier used in the United States for drugs intended for human use see http www fda gov Drugs Information On Drugs ucm htm author Andy public class Codes private Factory factory private Medication Bean Loader medication Loader new Medication Bean Loader The typical constructor param factory The link Factory associated with this which is used for obtaining connections etc public Codes Factory factory this factory factory Returns a list of all codes return java util List of Medication Beans throws Exception public List Medication Bean get All Codes throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Codes Result Set rs ps execute Query return medication Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Returns a particular description for a given code param code The code to be looked up return bean representing the Medication that was looked up throws Exception public Medication Bean get Code String code throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Codes Code ps set String code Result Set rs ps execute Query if rs next return medication Loader load Single rs return null catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Adds a new code returns whether or not the change was made If the code already exists an i Trust Exception is thrown param med The medication bean to be added return boolean indicating success or failure throws Exception throws i Trust Exception public boolean add Code Medication Bean med throws Exception i Trust Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Codes Code Description ps set String med get Code ps set String med get Description return ps execute Update catch Exception e e print Stack Trace if e get Error Code throw new i Trust Exception Error Code already exists throw new Exception e finally Util close Connection conn ps Updates a particular code s description param med bean representing the particular medication to be updated return An int representing the number of updated rows throws Exception public int update Code Medication Bean med throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Codes Description Code ps set String med get Description ps set String med get Code return ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Removes a code returns whether or not the change was made param med The medication bean to be removed return boolean indicating success or failure throws Exception throws i Trust Exception public boolean remove Code Medication Bean med throws Exception i Trust Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Codes Code ps set String med get Code return ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps 
package edu ncsu csc itrust dao mysql import java sql Connection import java sql Prepared Statement import java sql Result Set import java sql Exception import java text Simple Date Format import java util Date import java util List import java util Array List import edu ncsu csc itrust Util import edu ncsu csc itrust beans Diagnosis Bean import edu ncsu csc itrust beans Office Visit Bean import edu ncsu csc itrust beans loaders Diagnosis Bean Loader import edu ncsu csc itrust beans loaders Office Visit Loader import edu ncsu csc itrust dao Factory import edu ncsu csc itrust exception Exception Used for doing tasks related to office visits Use this for linking diagnoses to office visits and similar tasks stands for Database Access Object All Os are intended to be reflections of the database that is one per table in the database most of the time For more complex sets of queries extra Os are added Os can assume that all data has been validated and is correct Os should never have setters or any other parameter to the constructor than a factory All Os should be accessed by Factory see link Factory and every should have a factory for obtaining connections and or accessing other Os author Andy public class Office Visit private Factory factory private Office Visit Loader office Visit Loader new Office Visit Loader private Diagnosis Bean Loader diagnosis Loader new Diagnosis Bean Loader true private Prescription Bean Loader prescription Loader new Prescription Bean Loader private Prescription Report Bean Loader prescription Report Bean Loader new Prescription Report Bean Loader private Procedure Bean Loader procedure Bean Loader new Procedure Bean Loader true The typical constructor param factory The link Factory associated with this which is used for obtaining connections etc public Office Visit Factory factory this factory factory Adds an visit and return its param ov The Office Visit Bean to be added return long indicating the unique for the office visit throws Exception public long add Office Visit Bean ov throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Office Visits Visit Date Notes Patient Hospital set Values ps ov ps execute Update return Util get Last Insert conn catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps private void set Values Prepared Statement ps Office Visit Bean ov throws Exception ps set Date new java sql Date ov get Visit Date get Time ps set String ov get Notes ps set Long ov get Hcp ps set Long ov get Patient ps set String ov get Hospital Updates the information in a particular office visit param ov The Office Visit bean representing the changes throws Exception public void update Office Visit Bean ov throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Office Visits Visit Date Notes Patient Hospital set Values ps ov ps set Long ov get ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Returns a particular office visit given an param visit The unique of the office visit return An Office Visit Bean with the specifics for that office visit throws Exception public Office Visit Bean get Office Visit long visit throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Select From Office Visits Where ps set Long visit Result Set rs ps execute Query if rs next return load Full Office Vist rs visit else return null catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps private Office Visit Bean load Full Office Vist Result Set rs long visit throws Exception Exception Office Visit Bean ov new Office Visit Bean visit ov set Visit Date Str new Simple Date Format dd yyyy format new Date rs get Date Visit Date get Time ov set Hcp rs get Long ov set Notes rs get String notes ov set Patient rs get Long Patient ov set Hospital rs get String Hospital return ov Returns whether or not an office visit actually exists param ov The of the office visit to be checked param pid The of the patient associated with this transaction return boolean indicating its existence throws Exception public boolean check Office Visit Exists long ov long pid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Office Visits Patient ps set Long ov ps set Long pid Result Set rs ps execute Query return rs next catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Returns a list of all office visits for a given patient param pid The of the patient in question return java util List of Office Visit Beans throws Exception public List Office Visit Bean get All Office Visits long pid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Office Visits Patient Visit Date ps set Long pid Result Set rs ps execute Query return office Visit Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Returns a list of all office visits for a given patient param mid The of the you are looking up return java util List of Office Visits throws Exception public List Office Visit Bean get All Office Visits For long mid throws Exception Connection conn null Prepared Statement ps null try if mid throw new Exception can not be null conn factory get Connection ps conn prepare Statement Office Visits Visit Date ps set Long mid Result Set rs ps execute Query return office Visit Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Returns a list of all office visits for a given patient param pid The of the patient return java util List of Office Visits throws Exception public List Office Visit Bean get Office Visits With No Survey long pid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Office Visits where id not in select visitid from Survey and Patient Visit Date ps set Long pid Result Set rs ps execute Query return office Visit Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Returns a list of all office visits at a given hospital param hospital the id of the hospital return a list of the Office Visit Beans that hold the office visits throws Exception in the event of a database error public List Office Visit Bean get Office Visits From Hospital String hospital throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement officevisits hospital ps set String hospital Result Set rs ps execute Query return office Visit Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Gets all office visits corresponding to a particular diagnosis param icdcode string represnting the diagnosis to look up return java util List of Office visits throws Exception public List Office Visit Bean get All Office Visits For Diagnosis String icdcode throws Exception List Diagnosis Bean diags null List Office Visit Bean ovs new Array List Office Visit Bean Connection conn null Prepared Statement ps null Result Set rs null try if icdcode null throw new Exception icdcode can not be null conn factory get Connection ps conn prepare Statement ovdiagnosis ovd icdcodes icd ovd Code and icd Code ps set String icdcode ps set String icdcode rs ps execute Query diags diagnosis Loader load List rs rs close ps close ps null rs null for Diagnosis Bean bean diags ps conn prepare Statement officevisits ov ov ps set Int int bean get Visit rs ps execute Query if rs next ovs add load Full Office Vist rs bean get Visit rs close ps close return ovs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Adds an override reason bean to the database param orc The override reason bean to be added return The unique of the newly added bean throws Exception public long add Reason Override Reason Bean orb throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Reaction Override Medication Override Code Override Comment ps set Long orb get Pres ps set String orb get Code ps set String orb get Description ps execute Update return Util get Last Insert conn catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps 
package edu ncsu csc itrust dao mysql import java sql Connection import java sql Prepared Statement import java sql Result Set import java sql Exception import java util Array List import java util List import java util Vector import edu ncsu csc itrust Util import edu ncsu csc itrust beans Diagnosis Bean import edu ncsu csc itrust beans Patient Bean import edu ncsu csc itrust beans Patient History Bean import edu ncsu csc itrust beans Personnel Bean import edu ncsu csc itrust beans Prescription Bean import edu ncsu csc itrust beans Procedure Bean import edu ncsu csc itrust beans loaders Diagnosis Bean Loader import edu ncsu csc itrust beans loaders Patient Loader import edu ncsu csc itrust beans loaders Personnel Loader import edu ncsu csc itrust beans loaders Prescription Bean Loader import edu ncsu csc itrust beans loaders Procedure Bean Loader import edu ncsu csc itrust dao Factory import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception i Trust Exception import edu ncsu csc itrust Date Util Used for managing all static information related to a patient For other information related to all aspects of patient care see the other Os stands for Database Access Object All Os are intended to be reflections of the database that is one per table in the database most of the time For more complex sets of queries extra Os are added Os can assume that all data has been validated and is correct Os should never have setters or any other parameter to the constructor than a factory All Os should be accessed by Factory see link Factory and every should have a factory for obtaining connections and or accessing other Os author Andy public class Patient private Factory factory private Patient Loader patient Loader private Personnel Loader personnel Loader private Diagnosis Bean Loader diagnosis Loader private Prescription Bean Loader prescription Loader private Procedure Bean Loader procedure Loader The typical constructor param factory The link Factory associated with this which is used for obtaining connections etc public Patient Factory factory this factory factory this patient Loader new Patient Loader this personnel Loader new Personnel Loader this diagnosis Loader new Diagnosis Bean Loader true this prescription Loader new Prescription Bean Loader this procedure Loader new Procedure Bean Loader true Returns the name for the given param mid The of the patient in question return String representing the patient s first name and last name throws i Trust Exception throws Exception public String get Name long mid throws i Trust Exception Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement first Name last Name Patients ps set Long mid Result Set rs rs ps execute Query if rs next return rs get String first Name rs get String last Name else throw new i Trust Exception User does not exist catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Returns the role of a particular patient why is this in Patient It should be in Auth param mid The of the patient in question param role String representing the role of the patient return String representing the patient s role throws i Trust Exception throws Exception public String get Role long mid String role throws i Trust Exception Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement role Users Role ps set Long mid ps set String role Result Set rs rs ps execute Query if rs next return rs get String role else throw new i Trust Exception User does not exist with the designated role catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Adds an empty patient to the table returns the new return The of the patient as a long throws Exception public long add Empty Patient throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Patients ps execute Update return Util get Last Insert conn catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Returns the patient s information for a given param mid The of the patient to retrieve return Patient Bean representing the patient throws Exception public Patient Bean get Patient long mid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Patients ps set Long mid Result Set rs ps execute Query if rs next return patient Loader load Single rs else return null catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Updates a patient s information for the given param p The patient bean representing the new information for the patient throws Exception public void edit Patient Patient Bean p long hcpid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Patients first Name last Name email address address city state zip zip phone phone phone e Name e Phone e Phone e Phone i Name i Address i Address i City State i Zip i Zip i Phone i Phone i Phone i Date Of Birth Date Of Death Cause Of Death Mother Father Blood Type Ethnicity Gender Topical Notes Credit Card Type Credit Card Number Message Filter Directions To Home Religion Language Spiritual Practices Alternate Name patient Loader load Parameters ps p ps set Long p get ps execute Update add History p get hcpid catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps public void add History long pid long hcpid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement historypatients null p patients p p mid ps set Long hcpid ps set Long pid ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps public boolean has History long pid throws Exception Connection conn null Prepared Statement ps null boolean has History false try conn factory get Connection ps conn prepare Statement historypatients mid ps set Long pid Result Set rs rs ps execute Query has History rs next catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps return has History public List Patient History Bean get Patient History long mid throws Exception Connection conn null Prepared Statement ps null Array List Patient History Bean p List try conn factory get Connection ps conn prepare Statement History Patients ps set Long mid Result Set rs ps execute Query p List new Array List Patient History Bean while rs next p List add patient Loader load Single History rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps return p List Returns whether or not the patient exists param pid The of the patient in question return boolean indicating whether the patient exists throws Exception public boolean check Patient Exists long pid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Patients ps set Long pid Result Set rs ps execute Query return rs next catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Returns a list of Ps who are declared by the given patient param pid The of the patient in question return java util List of Personnel Beans throws Exception public List Personnel Bean get Declared Ps long pid throws Exception Connection conn null Prepared Statement ps null try if pid throw new Exception pid can not be conn factory get Connection ps conn prepare Statement Declared Personnel Patient Personnel Declared ps set Long pid Result Set rs ps execute Query return personnel Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Declares an for a particular patient param pid The of the patient in question param hcp The s return boolean as to whether the insertion was successful throws Exception throws i Trust Exception public boolean declare long pid long hcp throws Exception i Trust Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Declared Patient ps set Long pid ps set Long hcp return ps execute Update catch Exception e if e get Error Code throw new i Trust Exception hcp has already been declared for patient pid e print Stack Trace throw new Exception e finally Util close Connection conn ps Undeclare an for a given patient param pid The of the patient in question param hcp The of the in question return boolean indicating whether the action was successful throws Exception public boolean undeclare long pid long hcp throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Declared Patient ps set Long pid ps set Long hcp return ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Check if a patient has declared the given param pid The of the patient in question as a long param hcpid The of the in question as a long return throws Exception public boolean check Declared long pid long hcpid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Declared Patient ps set Long pid ps set Long hcpid return ps execute Query next catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Return a list of patients that the given patient represents param pid The of the patient in question return java util List of Patient Beans throws Exception public List Patient Bean get Represented long pid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Patients Representatives Patients Representer Representee Patients ps set Long pid Result Set rs ps execute Query return patient Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Return a list of patients that the given patient is represented by param pid The of the patient in question return java util List of Patient Beans throws Exception public List Patient Bean get Representing long pid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Patients Representatives Patients Representee Representer Patients ps set Long pid Result Set rs ps execute Query return patient Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Check if the given representer represents the representee param representer The of the representer in question param representee The of the representee in question return boolean indicating whether represenation is in place throws Exception public boolean represents long representer long representee throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Representatives Representer Representee ps set Long representer ps set Long representee Result Set rs ps execute Query return rs next catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Assign a representer to the representee param representer The of the representer as a long param representee The of the representee as a long return boolean as to whether the insertion was correct throws Exception throws i Trust Exception public boolean add Representative long representer long representee throws Exception i Trust Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Representatives Representer Representee ps set Long representer ps set Long representee return ps execute Update catch Exception e if e get Error Code throw new i Trust Exception Patient representer already represents patient representee e print Stack Trace throw new Exception e finally Util close Connection conn ps Unassign the representation param representer The of the representer in question param representee The of the representee in question return boolean indicating whether the unassignment was sucessful throws Exception public boolean remove Representative long representer long representee throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Representatives Representer Representee ps set Long representer ps set Long representee return ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Return a list of all diagnoses for a given patient param pid The of the patient in question return java util List of Diagnoses throws Exception public List Diagnosis Bean get Diagnoses long pid throws Exception Connection conn null Prepared Statement ps null try if pid throw new Exception pid can not be conn factory get Connection ps conn prepare Statement Diagnosis ovd Office Visits ov Codes icd ovd Visit ov and icd Code ovd Code and ov Patient ov visit Date ps set Long pid Result Set rs ps execute Query return diagnosis Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Return a list of all procedures for a given patient param pid The of the patient in question return java util List of all the procedures throws Exception public List Procedure Bean get Procedures long pid throws Exception Connection conn null Prepared Statement ps null try if pid throw new Exception pid can not be conn factory get Connection ps conn prepare Statement Select From Procedure ovp Office Visits ov Codes cpt Where ovp Visit ov and cpt code ovp cptcode and ov patient ov visit Date desc ps set Long pid Result Set rs ps execute Query return procedure Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Return a list of all immunization procedures for a given patient param pid The of the patient in question return java util List of the procedures throws Exception public List Procedure Bean get Immunization Procedures long pid throws Exception Connection conn null Prepared Statement ps null try if pid throw new Exception pid can not be conn factory get Connection ps conn prepare Statement Select From Procedure ovp Office Visits ov Codes cpt Where ovp Visit ov and cpt code ovp cptcode and ov patient and cpt attribute immunization ov visit Date desc ps set Long pid Result Set rs ps execute Query return procedure Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Return a list of all prescriptions for a patient param patient The of the patient in question return java util List of prescriptions throws Exception public List Prescription Bean get Prescriptions long patient throws Exception Connection conn null Prepared Statement ps null try if patient throw new Exception pid can not be conn factory get Connection ps conn prepare Statement Select From Medication Codes Office Visits Where Office Visits Patient Medication Visit Office Visits Codes Code Medication Code Office Visits visit Date Medication Code ps set Long patient Result Set rs ps execute Query return prescription Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Return a list of prescriptions which are currently prescribed for a patient param patient The of the patient in question return java util List of prescription beans throws Exception public List Prescription Bean get Current Prescriptions long patient throws Exception Connection conn null Prepared Statement ps null try if patient throw new Exception pid can not be conn factory get Connection ps conn prepare Statement Select From Medication Codes Office Visits Where Office Visits Patient Medication Visit Office Visits Codes Code Medication Code Medication End Date Medication ps set Long patient ps set Date Date Util get Ldate Days Ago From Now Result Set rs ps execute Query return prescription Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Return a list of prescriptions which are expired prescription for a patient param patient The of the patient in question return java util List of prescriptions throws Exception public List Prescription Bean get Expired Prescriptions long patient throws Exception Connection conn null Prepared Statement ps null try if patient throw new Exception pid can not be conn factory get Connection ps conn prepare Statement Select From Medication Codes Office Visits Where Office Visits Patient Medication Visit Office Visits Codes Code Medication Code Medication End Date Medication ps set Long patient ps set Date Date Util get Ldate Days Ago From Now Result Set rs ps execute Query return prescription Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Lists every patient in the database return java util List of Patient Beans representing the patients throws Exception public List Patient Bean get All Patients throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement patients Result Set rs ps execute Query return patient Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Return a list of patients with a special diagnosis history who have the logged in as a and whose medications are going to expire within seven days param hcp The of the logged in return list of patients satisfying the conditions throws Exception public List Patient Bean get Renewal Needs Patients long hcp throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement patients From patients declaredhcp ovdiagnosis officevisits ovmedication Where declared patients declaredhcp Patient ovdiagnosis Visit officevisits officevisits Patient declaredhcp Patient ovdiagnosis Code ovdiagnosis Code ovdiagnosis Code ovdiagnosis Code ovdiagnosis Code ovdiagnosis Code patients From patients declaredhcp ovdiagnosis officevisits ovmedication Where declared patients declaredhcp Patient declaredhcp Patient officevisits Patient officevisits ovmedication Visit ovmedication End Date final final final lastname final firstname ps set Long hcp ps set Float f ps set Float f ps set Float f ps set Float f ps set Float f ps set Float f ps set Long hcp Result Set rs ps execute Query return patient Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Returns all patients with names as in the passed in parameters param first The patient s first name param last The patient s last name return java util List of Patient Beans throws Exception public List Patient Bean search For Patients With Name String first String last throws Exception Connection conn null Prepared Statement ps null if first equals last equals return new Vector Patient Bean try conn factory get Connection ps conn prepare Statement patients first Name last Name ps set String first ps set String last Result Set rs ps execute Query return patient Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps 
package edu ncsu csc itrust validate import edu ncsu csc itrust action Edit Patient Action import edu ncsu csc itrust beans Patient Bean import edu ncsu csc itrust exception Error List import edu ncsu csc itrust exception Form Validation Exception import org apache commons validator Credit Card Validator import java util Date Validates a patient bean from link Edit Patient Action author Andy public class Patient Validator extends Bean Validator Patient Bean The default constructor public Patient Validator Performs the act of validating the bean in question which varies depending on the type of validator If the validation does not succeed a link Form Validation Exception is thrown param p bean of the type to be validated Override public void validate Patient Bean p throws Form Validation Exception Error List error List new Error List error List add If Not Null check Format First name p get First Name Validation Format false error List add If Not Null check Format Last name p get Last Name Validation Format false error List add If Not Null check Format Date of Birth p get Date Of Birth Str Validation Format false error List add If Not Null check Format Date of Death p get Date Of Death Str Validation Format true try if equals p get Date Of Death Str p get Date Of Death null if p get Cause Of Death equals error List add If Not Null Cause of Death can not be specified without Date of Death else if p get Date Of Death before p get Date Of Birth error List add If Not Null Death date can not be before birth date if p get Date Of Death after new Date error List add If Not Null Death date can not be in the future if p get Date Of Birth after new Date error List add If Not Null Birth date can not be in the future catch Null Pointer Exception e ignore this boolean death Cause Null null p get Date Of Death Str p get Date Of Death Str equals error List add If Not Null check Format Cause of Death p get Cause Of Death Validation Format death Cause Null error List add If Not Null check Format Email p get Email Validation Format false error List add If Not Null check Format Street Address p get Street Address Validation Format false error List add If Not Null check Format Street Address p get Street Address Validation Format true error List add If Not Null check Format City p get City Validation Format false error List add If Not Null check Format State p get State Validation Format false error List add If Not Null check Format Zip Code p get Zip Validation Format false error List add If Not Null check Format Phone Number p get Phone Validation Format false error List add If Not Null check Format Emergency Contact Name p get Emergency Name Validation Format false error List add If Not Null check Format Emergency Contact Phone p get Emergency Phone Validation Format false error List add If Not Null check Format Insurance Company Name p get Ic Name Validation Format false error List add If Not Null check Format Insurance Company Address p get Ic Address Validation Format false error List add If Not Null check Format Insurance Company Address p get Ic Address Validation Format true error List add If Not Null check Format Insurance Company City p get Ic City Validation Format false error List add If Not Null check Format Insurance Company State p get Ic State Validation Format false error List add If Not Null check Format Insurance Company Zip p get Ic Zip Validation Format false error List add If Not Null check Format Insurance Company Phone p get Ic Phone Validation Format false error List add If Not Null check Format Insurance Company p get Ic Validation Format false error List add If Not Null check Format Mother p get Mother Validation Format true error List add If Not Null check Format Father p get Father Validation Format true error List add If Not Null check Format Topical Notes p get Topical Notes Validation Format true This block was added for Theme by Tyler Arehart if p get Credit Card Number equals p get Credit Card Type equals String s null Credit Card Validator c int type if p get Credit Card Type equals type Credit Card Validator if p get Credit Card Type equals type Credit Card Validator if p get Credit Card Type equals type Credit Card Validator if p get Credit Card Type equals type Credit Card Validator if type c new Credit Card Validator type if c is Valid p get Credit Card Number s Credit Card Number else s Credit Card Type error List add If Not Null s error List add If Not Null check Format Directions to Home p get Directions To Home Validation Format true error List add If Not Null check Format Religion p get Religion Validation Format true error List add If Not Null check Format Language p get Language Validation Format true error List add If Not Null check Format Spiritual Practices p get Spiritual Practices Validation Format true error List add If Not Null check Format Alternate Name p get Alternate Name Validation Format true if error List has Errors throw new Form Validation Exception error List 
package edu ncsu csc itrust dao mysql import java sql Connection import java sql Prepared Statement import java sql Result Set import java sql Exception import java util Vector import java util List import edu ncsu csc itrust Util import edu ncsu csc itrust beans Hospital Bean import edu ncsu csc itrust beans Personnel Bean import edu ncsu csc itrust beans Prescription Bean import edu ncsu csc itrust beans loaders Hospital Bean Loader import edu ncsu csc itrust beans loaders Personnel Loader import edu ncsu csc itrust dao Factory import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception i Trust Exception import edu ncsu csc itrust enums Role Used for managing information related to personnel Ps Ps Admins stands for Database Access Object All Os are intended to be reflections of the database that is one per table in the database most of the time For more complex sets of queries extra Os are added Os can assume that all data has been validated and is correct Os should never have setters or any other parameter to the constructor than a factory All Os should be accessed by Factory see link Factory and every should have a factory for obtaining connections and or accessing other Os author Andy public class Personnel private Factory factory private Personnel Loader personnel Loader private Hospital Bean Loader hospital Bean Loader The typical constructor param factory The link Factory associated with this which is used for obtaining connections etc public Personnel Factory factory this factory factory personnel Loader new Personnel Loader hospital Bean Loader new Hospital Bean Loader Returns the name for a given param mid The of the personnel in question return String representing the name of the personnel throws i Trust Exception throws Exception public String get Name long mid throws i Trust Exception Exception Connection conn null Prepared Statement pstmt null try conn factory get Connection pstmt conn prepare Statement first Name last Name Personnel pstmt set Long mid Result Set rs rs pstmt execute Query if rs next return rs get String first Name rs get String last Name else throw new i Trust Exception User does not exist catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn pstmt public long get Next Role role throws Exception i Trust Exception Connection conn null Prepared Statement ps null long new long min role get Mid First Digit min min min Do not use as an long max min long next min try conn factory get Connection ps conn prepare Statement users mid Users mid mid ps set Long min ps set Long max Result Set rs ps execute Query if rs next next rs get Long if next min next min return next catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Adds an empty personnel and returns the return long indicating the new param role link Role enum indicating the personnel s specific role throws Exception throws i Trust Exception public long add Empty Personnel Role role throws Exception i Trust Exception Connection conn null Prepared Statement ps null long next get Next role try conn factory get Connection ps conn prepare Statement Personnel Role ps set String next ps set String role name ps execute Update return next catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Retrieves a Personnel Bean with all of the specific information for a given employee param mid The of the personnel in question return Personnel Bean representing the employee throws Exception public Personnel Bean get Personnel long mid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Personnel ps set Long mid Result Set rs ps execute Query if rs next return personnel Loader load Single rs else return null catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Updates the demographics for a personnel param p The personnel bean with the updated information throws Exception public void edit Personnel Personnel Bean p throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Personnel first Name last Name phone phone phone address address city state zip zip zip specialty email Message Filter personnel Loader load Parameters ps p ps set Long p get ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Indicates whether a certain personnel is in the database param pid The of the personnel in question return boolean indicating whether this personnel exists throws Exception public boolean check Personnel Exists long pid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Personnel ps set Long pid Result Set rs ps execute Query return rs next catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Returns all of the hospitals this is associated with param mid The of the personnel in question return java util List of Hospital Beans throws Exception public List Hospital Bean get Hospitals long mid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Assigned Hos hah Hospitals h hah hah Hos h Hospital Hospital Name ps set Long mid Result Set rs ps execute Query return hospital Bean Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Returns all personnel in the database return java util List of personnel throws Exception public List Personnel Bean get All Personnel throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement personnel where role in hcp uap er Result Set rs ps execute Query return personnel Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Returns a list of Ps who work for this param hcpid The of the personnel in question return java util List of Ps throws Exception public List Personnel Bean get Ps For long hcpid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Personnel Relations ps set Long hcpid Result Set rs ps execute Query return personnel Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Given a prescription that has been given this method returns all the information for the doctor who authorized that prescription param prescription The Prescription Bean describing the prescription in question return The Personnel Bean describing the doctor who authorized it throws Exception public Personnel Bean get Prescribing Doctor Prescription Bean prescription throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Personnel Office Visits ps set Long prescription get Visit Result Set rs ps execute Query return personnel Loader load List rs get catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Matches all personnel who have names as in the first and last names passed in param first The first name to be searched for param last The last name to be searched for return java util List of personnel who match these names throws Exception public List Personnel Bean search For Personnel With Name String first String last throws Exception Connection conn null Prepared Statement ps null if first equals last equals return new Vector Personnel Bean try conn factory get Connection ps conn prepare Statement personnel first Name last Name ps set String first ps set String last Result Set rs ps execute Query return personnel Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Returns list of personnel who are Lab Techs return List of personnel beans throws Exception public List Personnel Bean get Lab Techs throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement personnel role lt Result Set rs ps execute Query return personnel Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps 
package edu ncsu csc itrust validate import edu ncsu csc itrust action Edit Personnel Action import edu ncsu csc itrust beans Personnel Bean import edu ncsu csc itrust exception Error List import edu ncsu csc itrust exception Form Validation Exception Validates a personnel bean from link Edit Personnel Action author Andy public class Personnel Validator extends Bean Validator Personnel Bean The default constructor public Personnel Validator Performs the act of validating the bean in question which varies depending on the type of validator If the validation does not succeed a link Form Validation Exception is thrown param p bean of the type to be validated Override public void validate Personnel Bean p throws Form Validation Exception Error List error List new Error List error List add If Not Null check Format First name p get First Name Validation Format false error List add If Not Null check Format Last name p get Last Name Validation Format false error List add If Not Null check Format Street Address p get Street Address Validation Format false error List add If Not Null check Format Street Address p get Street Address Validation Format true error List add If Not Null check Format City p get City Validation Format false error List add If Not Null check Format State p get State Validation Format false error List add If Not Null check Format Zip Code p get Zip Validation Format false error List add If Not Null check Format Phone Number p get Phone Validation Format false error List add If Not Null check Format Email p get Email Validation Format true if error List has Errors throw new Form Validation Exception error List 
package edu ncsu csc itrust validate import edu ncsu csc itrust action Update Code List Action import edu ncsu csc itrust beans Procedure Bean import edu ncsu csc itrust exception Error List import edu ncsu csc itrust exception Form Validation Exception Validates an code from link Update Code List Action author Andy public class Procedure Bean Validator extends Bean Validator Procedure Bean The default constructor public Procedure Bean Validator Performs the act of validating the bean in question which varies depending on the type of validator If the validation does not succeed a link Form Validation Exception is thrown param p bean of the type to be validated Override public void validate Procedure Bean p throws Form Validation Exception Error List error List new Error List error List add If Not Null check Format Code p get Code Validation Format false error List add If Not Null check Format Description p get Description Validation Format false if error List has Errors throw new Form Validation Exception error List 
package edu ncsu csc itrust dao mysql import java sql Connection import java sql Prepared Statement import java sql Result Set import java sql Exception import java util Hash Map import java util List import edu ncsu csc itrust Util import edu ncsu csc itrust beans Referral Bean import edu ncsu csc itrust beans Verbose Referral Bean import edu ncsu csc itrust beans loaders Referral Bean Loader import edu ncsu csc itrust beans loaders Verbose Referral Bean Loader import edu ncsu csc itrust dao Factory import edu ncsu csc itrust enums Sort Direction import edu ncsu csc itrust exception Exception Used to update referrals and fetch lists of referrals sent to and from Ps stands for Database Access Object All Os are intended to be reflections of the database that is one per table in the database most of the time For more complex sets of queries extra Os are added Os can assume that all data has been validated and is correct Os should never have setters or any other parameter to the constructor than a factory All Os should be accessed by Factory see link Factory and every should have a factory for obtaining connections and or accessing other Os public class Referral private Factory factory private Referral Bean Loader referral Loader private Verbose Referral Bean Loader verbose Loader The typical constructor param factory The link Factory associated with this which is used for obtaining connections etc public Referral Factory factory this factory factory referral Loader new Referral Bean Loader verbose Loader new Verbose Referral Bean Loader Get all referrals associated with a particular office visit param ovid The office visit id return list of Referral Beans throws Exception public List Referral Bean get Referrals From long ovid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement referrals ov ps set Long ovid Result Set rs ps execute Query return referral Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Gets a list of all referrals sent from an param mid The s mid return The list of the referrals they sent throws Exception public List Referral Bean get Referrals Sent From long mid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement referrals Sender ps set Long mid Result Set rs ps execute Query return referral Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Get a specific referral param id The id of the referral to retrieve return Referral Bean throws Exception public Referral Bean get Referral long id throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement referrals id ps set Long id Result Set rs ps execute Query if rs next return referral Loader load Single rs else return null catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Set referral message param id The id of the referral to retrieve return Referral Bean throws Exception public boolean set Referral Message long message long referral throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Referral Message message referral ps set Long message ps set Long referral ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps return true Set referral message param id The id of the referral to retrieve return Referral Bean throws Exception public long is Referral Message long message throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Referral Message message ps set Long message Result Set rs ps execute Query if rs next return rs get Long else return catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Gets a list of all referrals sent to an param mid The s mid return The list of the referrals sent to them throws Exception public List Referral Bean get Referrals Sent To long mid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement referrals Receiver ps set Long mid Result Set rs ps execute Query return referral Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Gets a list of all referrals a has received param mid The patients s mid return The list of the referrals they received throws Exception public List Referral Bean get Referrals For Receiving long mid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement referrals Receiver Priority Code ps set Long mid Result Set rs ps execute Query return referral Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Gets a list of all referrals sent to a patient param mid The patients s mid return The list of the referrals they received throws Exception public List Referral Bean get Referrals For Patient long mid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement referrals Patient viewed by patient Priority Code ps set Long mid Result Set rs ps execute Query return referral Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Gets a list of all referrals sent to a patient param mid The patients s mid return The list of the referrals they received that were unread throws Exception public List Referral Bean get Referrals For Receiving Unread long mid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement referrals Receiver viewed by false ps set Long mid Result Set rs ps execute Query return referral Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Gets a list of all referrals sent to a patient param mid The patients s mid return The list of the referrals they received that were unread throws Exception public List Referral Bean get Referrals For Patient Unread long mid throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement referrals Patient viewed by patient false ps set Long mid Result Set rs ps execute Query return referral Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Updates a given referral in the database param r The referral to update throws Exception public void edit Referral Referral Bean r throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement referrals Patient Sender Receiver Referral Details viewed by patient viewed by Priority Code referral Loader load Parameters ps r ps set Long r get Id ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Adds a given referral to the database param r The referral to add throws Exception public long add Referral Referral Bean r throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement referrals Patient Sender Receiver Referral Details viewed by patient viewed by Priority Code Time Stamp ps referral Loader load Parameters ps r ps execute Update return Util get Last Insert conn catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Removes the given referral param id The unique of the referral to be removed throws Exception public void remove Referral long id throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement referrals ps set Long id ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps An abstract class that encapsulates a sorted query of referrals Derived classes provide the user id which all retrieved referrals will contain public abstract class Referral List Query private Factory factory private long userid private Hash Map String String sort Columns Create a new Referral List Query object param factory param userid public Referral List Query Factory factory long userid this factory factory this userid userid initialize lookup map sort Columns new Hash Map String String sort Columns put patient Name patients last Name patients first Name sort Columns put receiver Name preceiver last Name preceiver first Name sort Columns put sender Name psender last Name psender first Name sort Columns put timestamp referrals timestamp sort Columns put priority referrals Priority Code Perform the query param sort Field The pseudo field name in which to sort param dir The direction of the desired sort ascending or descending return list of Verbose Referral Beans throws Exception protected List Verbose Referral Bean doquery String sort Field Sort Direction dir throws Exception String stmt psender first Name psender last Name sender Name preceiver first Name preceiver last Name receiver Name referrals officevisits visit Date patients first Name patients last Name patient Name referrals personnel psender personnel preceiver patients officevisits referrals Sender psender mid referrals Receiver preceiver mid referrals Patient patients mid referrals ovid officevisits id stmt String format s get User Field stmt build Sort sort Field dir Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement stmt ps set Long get User Id Result Set rs ps execute Query return verbose Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Perform the query param sort Field The pseudo field name in which to sort param dir The direction of the desired sort ascending or descending return list of Verbose Referral Beans throws Exception public List Verbose Referral Bean query String sort Field Sort Direction dir throws Exception List Verbose Referral Bean beans doquery sort Field dir return beans Get the name of the user pseudo field which is used to limit the query Only referrals where this field equals a specific user id will be returned This must be overridden by derived classes return The user field as a string protected abstract String get User Field protected long get User Id return userid Builds the sort portion of the query i e the portion param sort Field The pseudo field to sort on param dir The sort direction return string which can be a part of an query protected String build Sort String sort Field Sort Direction dir String sortexp sort Columns get sort Field return String format s s sortexp dir Concrete Referral List Query for accessing an Ps sent referrals public class Sender Referral List Query extends Referral List Query public Sender Referral List Query Factory factory long userid super factory userid Override protected String get User Field return referrals Sender Concrete Referral List Query for accessing an Ps received referrals public class Receiver Referral List Query extends Referral List Query public Receiver Referral List Query Factory factory long userid super factory userid Override protected String get User Field return referrals Receiver Concrete Referral List Query for accessing a patients referrals public class Patient Referral List Query extends Referral List Query public Patient Referral List Query Factory factory long userid super factory userid Override protected String get User Field return referrals Patient Get a referral query for a sending param mid The id return Referral List Query object public Referral List Query get Sender Query long mid return new Sender Referral List Query this factory mid Get a referral query for a receiving param mid The id return Referral List Query object public Referral List Query get Receiver Query long mid return new Receiver Referral List Query this factory mid Get a referral query for a patient param mid The patient id return Referral List Query object public Referral List Query get Patient Query long pid return new Patient Referral List Query this factory pid 
package edu ncsu csc itrust dao mysql import java sql Connection import java util Date import java sql Prepared Statement import java sql Result Set import java sql Exception import java sql Timestamp import java util Array List import java util List import edu ncsu csc itrust Util import edu ncsu csc itrust beans Personnel Bean import edu ncsu csc itrust beans Remote Monitoring Data Bean import edu ncsu csc itrust beans Telemedicine Bean import edu ncsu csc itrust beans loaders Remote Monitoring Data Bean Loader import edu ncsu csc itrust beans loaders Personnel Loader import edu ncsu csc itrust beans loaders Remote Monitoring Lists Bean Loader import edu ncsu csc itrust dao Factory import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception i Trust Exception Used for the keeping track of remote monitoring data stands for Database Access Object All Os are intended to be reflections of the database that is one per table in the database most of the time For more complex sets of queries extra Os are added Os can assume that all data has been validated and is correct Os should never have setters or any other parameter to the constructor than a factory All Os should be accessed by Factory see link Factory and every should have a factory for obtaining connections and or accessing other Os public class Remote Monitoring private Factory factory private Remote Monitoring Data Bean Loader loader new Remote Monitoring Data Bean Loader private Remote Monitoring Lists Bean Loader rm List Loader new Remote Monitoring Lists Bean Loader private Personnel Loader personnel Loader new Personnel Loader The typical constructor param factory The link Factory associated with this which is used for obtaining connections etc public Remote Monitoring Factory factory this factory factory Return remote monitoring list data for a given patient param patient Patient to retrieve data for return List of Telemedicine Beans throws Exception public List Telemedicine Bean get Telemedicine Bean long patient throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Remote Monitoring Lists Patient ps set Long patient Result Set rs ps execute Query return rm List Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Returns patient data for a given return throws Exception public List Remote Monitoring Data Bean get Patients Data long logged In throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Remote Monitoring Lists Patient ps set Long logged In Result Set patient ps execute Query ps conn prepare Statement Remote Monitoring Data timelogged Patient time Logged Result Set data ps execute Query List String patient List new Array List String while patient next patient List add patient get Long Patient List Remote Monitoring Data Bean data List loader load List data int i j Go through all patients and remove any that are n t monitored by this for i i data List size i if patient List contains data List get i get Patient data List remove i i Add values in patient list with no data for today to list boolean its There for i i patient List size i its There false for j j data List size j if data List get j get Patient equals patient List get i its There true break if its There data List add new Remote Monitoring Data Bean Long parse Long patient List get i return data List catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps public List Remote Monitoring Data Bean get Patient Data By Date long patient Date lower Date upper throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement remotemonitoringdata Patient time Logged time Logged time Logged ps set Long patient ps set Timestamp new Timestamp lower get Time add day s worth to include the upper ps set Timestamp new Timestamp upper get Time Result Set rs ps execute Query List Remote Monitoring Data Bean data List loader load List rs return data List catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Get the requested type of data for the specified patient param patient The of the patient param data Type The type of telemedicine data to return return list of beans which all contain information of the requested type throws Exception public List Remote Monitoring Data Bean get Patient Data By Type long patient String data Type throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement remotemonitoringdata Patient data Type time Logged ps set Long patient Result Set rs ps execute Query List Remote Monitoring Data Bean data List loader load List rs return data List catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Store pedometer reading and height weight data for a given patient in the Remote Monitoring Data table param patient The of the patient param height The height of the patient param weight The weight of the patient param pedometer Reading The pedometer reading of the patient param reporter Role The role of the person that reported these monitoring stats param reporter The of the person that reported these monitoring stats throws Exception public void store Patient Data long patient Remote Monitoring Data Bean bean String reporter Role long reporter throws Exception i Trust Exception float height bean get Height float weight bean get Weight int pedometer bean get Pedometer Reading int sbp bean get Systolic Blood Pressure int dbp bean get Diastolic Blood Pressure int glucose bean get Glucose Level if height height if weight weight if pedometer pedometer if sbp sbp if dbp dbp if glucose glucose if get Number Of Daily Entries patient height height throw new i Trust Exception Patient height entries for today can not exceed if get Number Of Daily Entries patient weight weight throw new i Trust Exception Patient weight entries for today can not exceed if get Number Of Daily Entries patient pedometer Reading pedometer throw new i Trust Exception Patient pedometer reading entries for today can not exceed if get Number Of Daily Entries patient glucose Level glucose throw new i Trust Exception Patient glucose level entries for today can not exceed if get Number Of Daily Entries patient systolic Blood Pressure sbp throw new i Trust Exception Patient systolic blood pressure entries for today can not exceed if get Number Of Daily Entries patient diastolic Blood Pressure dbp throw new i Trust Exception Patient diastolic blood pressure entries for today can not exceed if reporter Role equals patient representative validate reporter patient Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Remote Monitoring Data Patient height weight pedometer Reading systolic Blood Pressure diastolic Blood Pressure glucose Level Reporter Role Reporter ps set Long patient ps set Float height ps set Float weight ps set Int pedometer ps set Int sbp ps set Int dbp ps set Int glucose ps set String reporter Role ps set Long reporter ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Private method to get the number of entries for a certain patient for today param patient return the number of entries throws Exception private int get Number Of Daily Entries long patient throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Remote Monitoring Data Patient time Logged ps set Long patient Result Set rs ps execute Query List Remote Monitoring Data Bean patients loader load List rs return patients size catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Private method to get the number of entries for a certain patient and a certain data type for today param patient param data Type return the number of entries throws Exception private int get Number Of Daily Entries long patient String data Type throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Remote Monitoring Data Patient data Type time Logged ps set Long patient ps set Int Result Set rs ps execute Query List Remote Monitoring Data Bean patients loader load List rs return patients size catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps public void validate long representative long patient throws i Trust Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Representatives Representer Representee ps set Long representative ps set Long patient Result Set rs ps execute Query if rs next no rows throw new i Trust Exception Representer is not valid for patient patient catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Show the list of Ps monitoring this patient param patient The of the patient return list of Ps monitoring the provided patient public List Personnel Bean get Monitoring Ps long patient throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Personnel Remote Monitoring Lists Remote Monitoring Lists Patient Remote Monitoring Lists Personnel ps set Long patient Result Set rs ps execute Query return personnel Loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Add a patient to the list of Ps monitoring lists of Patients param patient The of the patient param The of the param t Bean The Telemedicine Bean indicating what telemedicine data the patient is allowed to enter return true if added successfully false if already in list public boolean add Patient To List long patient long Telemedicine Bean t Bean throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Remote Monitoring Lists Patient ps set Long patient ps set Long Result Set rs ps execute Query if rs next return false String permission Systolic Blood Pressure Diastolic Blood Pressure Glucose Level Height Weight Pedometer Reading ps conn prepare Statement Remote Monitoring Lists Patient permission ps set Long patient ps set Long ps set Boolean t Bean is Systolic Blood Pressure Allowed ps set Boolean t Bean is Diastolic Blood Pressure Allowed ps set Boolean t Bean is Glucose Level Allowed ps set Boolean t Bean is Height Allowed ps set Boolean t Bean is Weight Allowed ps set Boolean t Bean is Pedometer Reading Allowed ps execute Update return true catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Remove a patient from the list of Ps monitoring lists of Patients param patient The of the patient param The of the return true if removed successfully false if not in list public boolean remove Patient From List long patient long throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Remote Monitoring Lists Patient ps set Long patient ps set Long if ps execute Update return false return true catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps 
package edu ncsu csc itrust validate import edu ncsu csc itrust action Add Remote Monitoring Data Action import edu ncsu csc itrust beans Remote Monitoring Data Bean import edu ncsu csc itrust exception Error List import edu ncsu csc itrust exception Form Validation Exception Validator used to validate adding new remote monitoring data in link Add Remote Monitoring Data Action public class Remote Monitoring Data Bean Validator extends Bean Validator Remote Monitoring Data Bean The default constructor public Remote Monitoring Data Bean Validator Performs the act of validating the bean in question which varies depending on the type of validator If the validation does not succeed a link Form Validation Exception is thrown param p bean of the type to be validated Override public void validate Remote Monitoring Data Bean m throws Form Validation Exception Error List error List new Error List Skip validation if values were not submitted or if m get Systolic Blood Pressure m get Systolic Blood Pressure error List add If Not Null check Format Systolic Blood Pressure m get Systolic Blood Pressure Validation Format true if m get Diastolic Blood Pressure m get Diastolic Blood Pressure error List add If Not Null check Format Diastolic Blood Pressure m get Diastolic Blood Pressure Validation Format true if m get Glucose Level m get Glucose Level error List add If Not Null check Format Glucose Level m get Glucose Level Validation Format true if m get Pedometer Reading m get Pedometer Reading error List add If Not Null check Format Pedometer Reading m get Pedometer Reading Validation Format true if m get Height m get Height error List add If Not Null check Format Height m get Height Validation Format true if m get Weight m get Weight error List add If Not Null check Format Weight m get Weight Validation Format true if error List has Errors throw new Form Validation Exception error List 
package edu ncsu csc itrust action import java util Array List import java util List import edu ncsu csc itrust Email Util import edu ncsu csc itrust beans Email import edu ncsu csc itrust beans Adverse Event Bean import edu ncsu csc itrust beans Patient Bean import edu ncsu csc itrust beans Personnel Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Adverse Event import edu ncsu csc itrust dao mysql Patient import edu ncsu csc itrust dao mysql Personnel import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception i Trust Exception import edu ncsu csc itrust validate Adverse Event Validator import edu ncsu csc itrust exception Form Validation Exception public class Report Adverse Event Action private long logged In private Email Util emailer private Patient patient private Personnel personnel private Adverse Event adverse Event private long hcp private Adverse Event Validator validator public Report Adverse Event Action String hcp Factory factory long logged In this logged In logged In this patient factory get Patient this personnel factory get Personnel this emailer new Email Util factory this adverse Event factory get Adverse Event this hcp Long parse Long hcp this validator new Adverse Event Validator Constructor used to send e mails only public Report Adverse Event Action Factory factory long logged In this logged In logged In this patient factory get Patient this personnel factory get Personnel this emailer new Email Util factory this adverse Event factory get Adverse Event this validator new Adverse Event Validator Method that sends exactly one e mail to each in the list of Adverse Events param ae List The list of adverse Event Beans that need to be acted upon return List The list of e mails sent for testing purposes public Email send Mails List Adverse Event Bean ae List throws i Trust Exception Form Validation Exception Exception List String Dlist new Array List String String patient for Adverse Event Bean beaner ae List patient beaner get String new Desc Drug beaner get Drug beaner get Code Description beaner get Description beaner set Description new Desc for Adverse Event Bean beano ae List if Dlist contains beano get Prescriber Dlist add beano get Prescriber Email email new Email for String num Dlist String message Patient patient get Name Long parse Long patient patient Has Reported the following adverse event s for Adverse Event Bean beano ae List if beano get Prescriber equals num message message beano get Description String from Email email set From noreply itrust com Patient Bean sender patient get Patient logged In Personnel Bean receiver personnel get Personnel Long parse Long num List String to List new Array List String to List add receiver get Email from Email sender get Email email set To List to List email set From from Email email set Subject String format Adverse Event Report Prescription email set Body message emailer send Email email return email method used to send a single e mail Used in immunizations param ae Bean return Email returns the Email for testing purposes public Email send Mail Adverse Event Bean ae Bean throws i Trust Exception Form Validation Exception Exception Email email new Email String from Email email set From noreply itrust com List String to List new Array List String Patient Bean sender patient get Patient logged In Personnel Bean receiver personnel get Personnel hcp to List add receiver get Email from Email sender get Email email set To List to List email set From from Email email set Subject String format Adverse Event Report Immunization email set Body String format Patient patient get Name Long parse Long ae Bean get ae Bean get Has Reported the following adverse event Drug ae Bean get Drug ae Bean get Code Description ae Bean get Description emailer send Email email return email Method used to add a report to the data base param ae Bean The adverse event to add return a string for testing purposes only throws i Trust Exception throws Form Validation Exception throws Exception public String add Report Adverse Event Bean ae Bean throws i Trust Exception Form Validation Exception Exception try validator validate ae Bean catch Form Validation Exception e e print Stack Trace return e get Message try adverse Event add Report ae Bean hcp catch Exception e throw new i Trust Exception e get Message Old code used to send a single e mail Keep for reference Email email new Email String sender Name String from Email email set From noreply itrust com List String to List new Array List String Patient Bean sender patient get Patient logged In Personnel Bean receiver personnel get Personnel hcp to List add receiver get Email sender Name sender get Full Name from Email sender get Email email set To List to List email set From from Email email set Subject String format Adverse Event Report email set Body String format Patient patient get Name Long parse Long ae Bean get ae Bean get Has Reported the following adverse event s Drug ae Bean get Drug ae Bean get Code Description ae Bean get Description emailer send Email email return 
package edu ncsu csc itrust dao mysql import java sql Connection import java sql Prepared Statement import java sql Result Set import java sql Exception import java util Date import java util List import edu ncsu csc itrust Util import edu ncsu csc itrust beans Report Request Bean import edu ncsu csc itrust beans loaders Report Request Bean Loader import edu ncsu csc itrust dao Factory import edu ncsu csc itrust exception Exception Used for handling data related to report requests stands for Database Access Object All Os are intended to be reflections of the database that is one per table in the database most of the time For more complex sets of queries extra Os are added Os can assume that all data has been validated and is correct Os should never have setters or any other parameter to the constructor than a factory All Os should be accessed by Factory see link Factory and every should have a factory for obtaining connections and or accessing other Os public class Report Request private Factory factory private Report Request Bean Loader loader The typical constructor param factory The link Factory associated with this which is used for obtaining connections etc public Report Request Factory factory this factory factory loader new Report Request Bean Loader Returns a full bean describing a given report request param id The unique of the bean in the database return The bean describing this report request throws Exception public Report Request Bean get Report Request long id throws Exception Connection conn null Prepared Statement ps null try if id throw new Exception can not be null conn factory get Connection ps conn prepare Statement Report Requests ps set Long id Result Set rs ps execute Query rs next return loader load Single rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Returns all report requests associated with a given requester param mid The of the personnel in question return java util List of report requests throws Exception public List Report Request Bean get All Report Requests For Requester long mid throws Exception Connection conn null Prepared Statement ps null try if mid throw new Exception Requester can not be null conn factory get Connection ps conn prepare Statement Report Requests Requester ps set Long mid Result Set rs ps execute Query return loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Returns all of the report requests associated with a specific patient param pid The of the patient in question return java util List of report requests throws Exception public List Report Request Bean get All Report Requests For Patient long pid throws Exception Connection conn null Prepared Statement ps null try if pid throw new Exception Patient can not be null conn factory get Connection ps conn prepare Statement Report Requests Patient ps set Long pid Result Set rs ps execute Query return loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Returns every report request in the database return java util List of report requests throws Exception public List Report Request Bean get All Report Requests throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Report Requests Result Set rs ps execute Query return loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Adds a request for a report param requester The of the requester param patient The of the patient in question param date The date the request was made return long of the unique of the report request throws Exception public long add Report Request long requester long patient Date date throws Exception Connection conn null Prepared Statement ps null try if requester throw new Exception Requester can not be null conn factory get Connection ps conn prepare Statement Report Requests Requester Patient Requested Date Status null Requested ps set Long requester ps set Long patient ps set Timestamp new java sql Timestamp date get Time ps execute Update return Util get Last Insert conn catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Sets the status of a request to Approved param The unique of the report param approver The of the person approving the request param date The date the approval was made throws Exception public void approve Report Request long long approver Date date throws Exception Connection conn null Prepared Statement ps null try if throw new Exception can not be null conn factory get Connection ps conn prepare Statement Report Requests set Approver Approved Date Status Approved where ps set Long approver ps set Timestamp new java sql Timestamp date get Time ps set Long ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Sets the status of a report request to Rejected param The unique of the request in question param approver The of the rejecter in question param date The date the rejection was made param comment comment describing why the request was rejected throws Exception public void reject Report Request long long approver Date date String comment throws Exception Connection conn null Prepared Statement ps null try if throw new Exception can not be null conn factory get Connection ps conn prepare Statement Report Requests set Approver Approved Date Status Rejected comment where ps set Long approver ps set Timestamp new java sql Timestamp date get Time ps set String comment ps set Long ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Sets the status of a report request to Viewed param The unique of the request in question param date The date the request was viewed throws Exception public void set Viewed long Date date throws Exception Connection conn null Prepared Statement ps null try if throw new Exception can not be null conn factory get Connection ps conn prepare Statement Report Requests set Viewed Date Status Viewed where ps set Timestamp new java sql Timestamp date get Time ps set Long ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps 
package edu ncsu csc itrust action import java util Arrays import edu ncsu csc itrust Email Util import edu ncsu csc itrust beans Email import edu ncsu csc itrust beans Patient Bean import edu ncsu csc itrust beans Personnel Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Auth import edu ncsu csc itrust dao mysql Patient import edu ncsu csc itrust dao mysql Personnel import edu ncsu csc itrust enums Role import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception Error List import edu ncsu csc itrust exception Form Validation Exception import edu ncsu csc itrust exception i Trust Exception import edu ncsu csc itrust validate Validation Format Manages resetting the password Used by reset Password jsp author laurenhayward public class Reset Password Action public static final int private Auth auth private Patient patient private Factory factory Set up defaults param factory The Factory used to create the Os used in this action public Reset Password Action Factory factory this auth factory get Auth this patient factory get Patient this factory factory Checks to see if a user exists with the given mid param mid String The user s to check for return if the user does not exist else the mid of the user as a long public long check String mid String try long mid Long value Of mid String if auth check User Exists mid return return mid catch Number Format Exception e return catch Exception e return Checks to see if the number of reset password attempts has been exceeded for the given ip Address param ip Address The Pv or Pv address as a String return true if the the number of reset attempts is greater than or equal to throws Exception public boolean is Maxed Out String ip Address throws Exception return auth get Reset Password Failures ip Address Checks if the given mid matches the given role param mid the mid to be checked param role the role to be checked return true if the mid and role match throws i Trust Exception public String check Role long mid String role throws i Trust Exception try if patient equals role patient get Role mid role equals patient hcp equals role patient get Role mid role equals hcp uap equals role patient get Role mid role equals uap pha equals role patient get Role mid role equals pha er equals role patient get Role mid role equals er lt equals role patient get Role mid role equals lt return role else return null catch Exception e e print Stack Trace catch i Trust Exception e e print Stack Trace throw e return null Checks if the answer param is null param answer the user s security answer return answer if not null else return null public String check Answer Null String answer if answer null equals answer return null else return answer Returns the security question for the mid param param mid of the user return the security question or if Exception thrown throws i Trust Exception public String get Security Question long mid throws i Trust Exception try if null auth get Security Question mid auth get Security Question mid equals throw new i Trust Exception No security question or answer for this user has been set else return auth get Security Question mid catch Exception e e print Stack Trace return Resets the password for the given mid param mid of the user to have their password reset param role what role the user has in i Trust param answer answers to their security question param password their password param confirm Password their password again param ip Addr the ip address the request is coming from return status message throws Form Validation Exception throws Exception throws i Trust Exception public String reset Password long mid String role String answer String password String confirm Password String ip Addr throws Form Validation Exception Exception i Trust Exception Role r auth get User Role mid try Role parse role catch Illegal Argument Exception e return Invalid role if r equals Role return This role can not be changed here if r equals Role parse role return Role mismatch if auth get Reset Password Failures ip Addr return Too many retries try validate Password password confirm Password if answer equals auth get Security Answer mid auth reset Password mid password new Email Util factory send Email make Email App mid role return Password changed else auth record Reset Password Failure ip Addr return Answer did not match catch Exception e return Error in validation of security answer Creates and sends an e mail about the change param mid the user who s password was changed param role what role they have in i Trust return the e mial that is sent throws Exception private Email make Email App long mid String role throws Exception if Role parse role Role Patient Bean p new Patient factory get Patient mid Email email new Email email set From no reply itrust com email set To List Arrays as List p get Email email set Subject Your password has been changed in i Trust email set Body String format Dear s n You have chosen to change your i Trust password for user s p get Full Name mid return email else or admin taken out in reset Password Personnel Bean p new Personnel factory get Personnel mid Email email new Email email set From no reply itrust com email set To List Arrays as List p get Email email set Subject Your password has been changed in i Trust email set Body String format Dear s n You have chosen to change your i Trust password for user s p get Full Name mid return email Checks to make sure the password is correctly entered twice param password the password param confirm Password the password again for confirmation throws Form Validation Exception private void validate Password String password String confirm Password throws Form Validation Exception Error List error List new Error List if password null equals password error List add If Not Null Password can not be empty else if password equals confirm Password error List add If Not Null Passwords do n t match if Validation Format get Regex matcher password matches error List add If Not Null Password must be in the following format Validation Format get Description if error List has Errors throw new Form Validation Exception error List 
package edu ncsu csc itrust risk import java util Array List import java util List import edu ncsu csc itrust beans Health Record import edu ncsu csc itrust beans Patient Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Health Records import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception No Health Records Exception import edu ncsu csc itrust risk factors Patient Risk Factor An abstract class which has a number of utlity methods for checking risks When extending this class use the methods to fill in all of the necessary information Then use is At Risk and get Patient Risk Factors to get the actual risks See the known subclasses for an example author Andy abstract public class Risk Checker private static final int protected Patient Bean patient protected Health Record current Health Record protected Factory factory public Risk Checker Factory factory long patient throws Exception No Health Records Exception this factory factory Health Records hr factory get Health Records List Health Record records hr get All Health Records patient if records size current Health Record records get else throw new No Health Records Exception patient factory get Patient get Patient patient return The name of the disease being checked abstract public String get Name return java util List of the risk factors increasing this patients disease risk abstract protected List Patient Risk Factor get Disease Risk Factors return boolean indicating whether the patient is at increased risk abstract public boolean qualifies For Disease This method exists purely for performance just stop once you hit the threshold br br Also the risk factors should be cached in the Risk Factor implementors in get Patient Risk Factors there should be no double querying return is At Risk public boolean is At Risk if qualifies For Disease int num Risks List Patient Risk Factor disease Risk Factors get Disease Risk Factors for Patient Risk Factor factor disease Risk Factors if factor has Risk Factor num Risks if num Risks return true return false both an else from qualifies or over the threshold return java util List of patient risk factors associated with this disease public List Patient Risk Factor get Patient Risk Factors List Patient Risk Factor patient Risk Factors new Array List Patient Risk Factor List Patient Risk Factor disease Risk Factors get Disease Risk Factors for Patient Risk Factor factor disease Risk Factors if factor has Risk Factor patient Risk Factors add factor return patient Risk Factors 
package edu ncsu csc itrust action import java util List import edu ncsu csc itrust beans Patient Bean import edu ncsu csc itrust beans Personnel Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Patient import edu ncsu csc itrust dao mysql Personnel import edu ncsu csc itrust exception Exception public class Search Users Action private Patient patient private Personnel personnel Set up defaults param factory The Factory used to create the Os used in this action param logged In The of the user who is performing the search public Search Users Action Factory factory long logged In this patient factory get Patient this personnel factory get Personnel Searches for all personnel with the first name and last name specified in the parameter list param first Name The first name to be searched param last Name The last name to be searched return java util List of Personnel Beans for the users who matched public List Personnel Bean search For Personnel With Name String first Name String last Name try if equals first Name first Name if equals last Name last Name return personnel search For Personnel With Name first Name last Name catch Exception e e print Stack Trace return null Search for all patients with first name and last name given in parameters param first Name The first name of the patient being searched param last Name The last name of the patient being searched return java util List of Patient Beans public List Patient Bean search For Patients With Name String first Name String last Name try if equals first Name first Name if equals last Name last Name return patient search For Patients With Name first Name last Name catch Exception e e print Stack Trace return null 
package edu ncsu csc itrust validate import edu ncsu csc itrust action Set Security Question Action import edu ncsu csc itrust beans Security import edu ncsu csc itrust exception Error List import edu ncsu csc itrust exception Form Validation Exception Validates the security question and answer This does n t follow the same format as the others because this validator is used for the various states of reset password link Set Security Question Action author Andy public class Security Validator extends Bean Validator Security Performs the act of validating the bean in question which varies depending on the type of validator If the validation does not succeed a link Form Validation Exception is thrown param p bean of the type to be validated Override public void validate Security bean throws Form Validation Exception Error List error List new Error List if null bean throw new Form Validation Exception Null form if null bean get Confirm Answer throw new Form Validation Exception Confirm answer can not be empty if bean get Answer equals bean get Confirm Answer throw new Form Validation Exception Security answers do not match error List add If Not Null check Format Security Question bean get Question Validation Format false error List add If Not Null check Format Security Answer bean get Answer Validation Format false if error List has Errors throw new Form Validation Exception error List 
package edu ncsu csc itrust action import java sql Exception import java util Array List import java util List import edu ncsu csc itrust Email Util import edu ncsu csc itrust beans Email import edu ncsu csc itrust beans Message Bean import edu ncsu csc itrust beans Patient Bean import edu ncsu csc itrust beans Personnel Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Message import edu ncsu csc itrust dao mysql Patient import edu ncsu csc itrust dao mysql Personnel import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception Form Validation Exception import edu ncsu csc itrust exception i Trust Exception import edu ncsu csc itrust validate Mail Validator import edu ncsu csc itrust validate Message Validator Class for Send Message jsp public class Send Message Action private long logged In private Email Util emailer private Patient patient private Personnel personnel private Message message private Mail Validator email Val private Message Validator mess Val Sets up defaults param factory The Factory used to create the Os used in this action param logged In The of the user sending the message public Send Message Action Factory factory long logged In this logged In logged In this patient factory get Patient this personnel factory get Personnel this emailer new Email Util factory this message factory get Message this email Val new Mail Validator this mess Val new Message Validator Sends a message param m Bean message to be sent throws i Trust Exception throws Exception public void send Message Message Bean m Bean throws i Trust Exception Exception Form Validation Exception mess Val validate m Bean email Val validate m Bean message add Message m Bean Email email new Email String sender Name String from Email email set From noreply itrust com List String to List new Array List String if m Bean get From m Bean get To Personnel Bean sender personnel get Personnel logged In Personnel Bean receiver personnel get Personnel m Bean get To to List add receiver get Email sender Name sender get Full Name from Email sender get Email else if m Bean get From Personnel Bean sender personnel get Personnel logged In if m Bean get To Personnel Bean receiver personnel get Personnel m Bean get To to List add receiver get Email else Patient Bean receiver patient get Patient m Bean get To to List add receiver get Email sender Name sender get Full Name from Email sender get Email else Patient Bean sender patient get Patient logged In if m Bean get To Personnel Bean receiver personnel get Personnel m Bean get To to List add receiver get Email else Patient Bean receiver patient get Patient m Bean get To to List add receiver get Email sender Name sender get Full Name from Email sender get Email email set To List to List email set From from Email email set Subject String format new message from s sender Name email set Body String format You have received a new message from s in i Trust To view it log in to i Trust and go to View My Messages sender Name emailer send Email email Returns the patient s name param mid Id of the patient return the name of the patient throws i Trust Exception public String get Patient Name long mid throws i Trust Exception return patient get Name mid Returns the personnel s name param mid Id of the personnel return the name of the personnel throws i Trust Exception public String get Personnel Name long mid throws i Trust Exception return personnel get Name mid Returns a list of the patients that the logged in represents return list of the patients that the logged in represents throws i Trust Exception public List Patient Bean get My Representees throws i Trust Exception List Patient Bean representees new Array List Patient Bean try representees patient get Represented logged In catch Exception e e print Stack Trace return representees Returns the designated Ps for the logged in patient return designated Ps for the logged in patient throws i Trust Exception public List Personnel Bean get My Ps throws i Trust Exception return get Ps For logged In Returns the designated Ps for the given patient return designated Ps for the given patient throws i Trust Exception public List Personnel Bean get Ps For long pid throws i Trust Exception List Personnel Bean dlhcps new Array List Personnel Bean try dlhcps patient get Declared Ps pid catch Exception e e print Stack Trace return dlhcps 
package edu ncsu csc itrust server import javax servlet http Http Session import javax servlet http Http Session Event import javax servlet http Http Session Listener import edu ncsu csc itrust dao Factory import edu ncsu csc itrust exception Exception listener which will time the user out after a pre specified time limit public class Session Timeout Listener implements Http Session Listener private Factory factory The default constructor public Session Timeout Listener this factory Factory get Production Instance The specialized constructor which takes a particular Factory to be used when checking for the pre specified timeout limit param factory The Factory to be used public Session Timeout Listener Factory factory this factory factory Called when the Http Session is created this method pulls the pre specified limit from the database and sets it as a property of the Http Session param arg The Http Session Even which just occurred public void session Created Http Session Event arg Http Session session arg get Session int mins try mins factory get Access get Session Timeout Mins catch Exception e System err println Unable to set session timeout defaulting to minutes e print Stack Trace if mins mins session set Max Inactive Interval mins Must be declared for compliance with the interface Not implemented public void session Destroyed Http Session Event arg nothing to do here 
package edu ncsu csc itrust action import edu ncsu csc itrust beans Security import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Auth import edu ncsu csc itrust exception i Trust Exception import edu ncsu csc itrust validate Security Validator Handles setting and retrieving the security questions answers for users Used by patient edit My Demographics jsp staff edit My Demographics jsp staff edit Personnell jsp author laurenhayward public class Set Security Question Action private Auth auth private long logged In Sets up defaults param factory The Factory used to create the Os used in this action param r Logged In The of the user who is setting their security question throws i Trust Exception public Set Security Question Action Factory factory long r Logged In throws i Trust Exception this auth factory get Auth logged In check r Logged In Updates information in the database from the information held in the Security bean passed as a param param a Security Question Bean that holds new information throws Exception public void update Information Security a throws Exception Security Validator sqav new Security Validator sqav validate a auth set Security Question Answer a get Question a get Answer logged In Returns a Security bean holding the security info for the currently logged in user return Security for logged In Mid throws i Trust Exception public Security retrieve Information throws i Trust Exception Security to Ret new Security to Ret set Answer auth get Security Answer logged In to Ret set Question auth get Security Question logged In return to Ret Checks to make sure the exists in i Trust param mid to check return returns the if the user is valid otherwise throws an exception throws i Trust Exception private long check long mid throws i Trust Exception if auth check User Exists mid throw new i Trust Exception mid is not a user return mid 
package edu ncsu csc itrust action import java util Calendar import edu ncsu csc itrust beans Survey Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Office Visit import edu ncsu csc itrust dao mysql Survey import edu ncsu csc itrust exception Exception This class is used to add patient survey data to the database The office visit is linked with the survey Once the survey is added the transaction is logged public class Survey Action private Survey survey private Office Visit ov long logged In Sets up defaults param factory The Factory used to create the Os used in this action param logged In The of the user taking the survey public Survey Action Factory factory long logged In survey factory get Survey ov factory get Office Visit this logged In logged In Pass the Office Vist Bean along with Survey Bean param survey Bean contains data to be added to database param visit The Office Visit corresponding to this Survey throws Exception public void add Survey Survey Bean survey Bean long visit throws Exception survey Bean set Visit visit now set visit in the survey bean survey add Completed Survey survey Bean Calendar get Instance get Time public long get Patient long ov throws Number Format Exception Exception return ov get Office Visit ov get Patient 
package edu ncsu csc itrust dao mysql import java sql Connection import java sql Prepared Statement import java sql Result Set import java sql Exception import java util Date import edu ncsu csc itrust Util import edu ncsu csc itrust beans Survey Bean import edu ncsu csc itrust beans loaders Survey Loader import edu ncsu csc itrust dao Factory import edu ncsu csc itrust exception Exception for handling all Survey data stands for Database Access Object All Os are intended to be reflections of the database that is one per table in the database most of the time For more complex sets of queries extra Os are added Os can assume that all data has been validated and is correct Os should never have setters or any other parameter to the constructor than a factory All Os should be accessed by Factory see link Factory and every should have a factory for obtaining connections and or accessing other Os public class Survey private Factory factory private Survey Loader survey Loader The typical constructor param factory The link Factory associated with this which is used for obtaining connections etc public Survey Factory factory this factory factory this survey Loader new Survey Loader Insert survey data into database param survey Bean The Bean representing the user s responses which will be inserted param date The date the survey was completed public void add Completed Survey Survey Bean survey Bean Date date throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Survey Visit Survey Date ps set Long survey Bean get Visit ps set Timestamp new java sql Timestamp date get Time ps execute Update if survey Bean get Waiting Room Minutes ps conn prepare Statement update Survey set Waiting Room Minutes where Visit ps set Float survey Bean get Waiting Room Minutes ps set Long survey Bean get Visit ps execute Update if survey Bean get Exam Room Minutes ps conn prepare Statement update Survey set Exam Room Minutes where Visit ps set Float survey Bean get Exam Room Minutes ps set Long survey Bean get Visit ps execute Update if survey Bean get Visit Satisfaction ps conn prepare Statement update Survey set Visit Satisfaction where Visit ps set Float survey Bean get Visit Satisfaction ps set Long survey Bean get Visit ps execute Update if survey Bean get Treatment Satisfaction ps conn prepare Statement update Survey set Treatment Satisfaction where Visit ps set Float survey Bean get Treatment Satisfaction ps set Long survey Bean get Visit ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Gets survey data from the database by the office visit id Creates an instance of an Survey Bean with data and returns it param id The unique of the survey in question return bean containing the Survey Bean throws Exception public Survey Bean get Survey Data long id throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Survey Visit ps set Long id Result Set rs ps execute Query rs next return survey Loader load Single rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Has this survey been completed param visit The unique of the office visit we are wondering about return boolean indicating whether this survey is completed throws Exception public boolean is Survey Completed long visit throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement count Survey Visit ps set Long visit Result Set rs ps execute Query rs next return rs get Int false true catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps 
package edu ncsu csc itrust dao mysql import java sql Connection import java sql Prepared Statement import java sql Exception import java util List import edu ncsu csc itrust Util import edu ncsu csc itrust beans Survey Result Bean import edu ncsu csc itrust beans loaders Survey Result Bean Loader import edu ncsu csc itrust dao Factory import edu ncsu csc itrust exception Exception for handling all Survey results stands for Database Access Object All Os are intended to be reflections of the database that is one per table in the database most of the time For more complex sets of queries extra Os are added Os can assume that all data has been validated and is correct Os should never have setters or any other parameter to the constructor than a factory All Os should be accessed by Factory see link Factory and every should have a factory for obtaining connections and or accessing other Os public class Survey Result private Factory factory private Survey Result Bean Loader loader The typical constructor param factory The link Factory associated with this which is used for obtaining connections etc public Survey Result Factory factory this factory factory this loader new Survey Result Bean Loader Returns all the survey results in the database that correspond to a particular zip code param zip The zipcode we are interested in as a String param specialty The specialty we are interested in as a String return java util List of Survey Result Beans throws Exception public List Survey Result Bean get Survey Results For Zip String zip String specialty throws Exception Connection conn null Prepared Statement ps null String Buffer sql new String Buffer sql append select p mid p firstname p lastname p address p address p city p state p zip p specialty sql append na hospital sql append avg s Waiting Room Minutes Avg Waiting Room Minutes sql append avg s Exam Room Minutes Avg Exam Room Minutes sql append avg s Visit Satisfaction Avg Visit Satisfaction sql append avg s Treatment Satisfaction Avg Treatment Satisfation sql append count sql append select count from personnel p officevisits v sql append where v hcpid p mid sql append and substr p zip sql append and p mid p mid Percent Satisfaction Results sql append from ovsurvey s personnel p officevisits v sql append where s visitid v id sql append and v hcpid p mid sql append and substr p zip if specialty equals Survey Result Bean sql append and specialty sql append group by p mid p firstname p lastname p address p address p city p state p zip hospital if specialty equals Survey Result Bean sql append p specialty sql append order by p mid try conn factory get Connection ps conn prepare Statement sql to String ps set String zip substring ps set String zip substring if specialty equals Survey Result Bean ps set String specialty return loader load List ps execute Query catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Returns all the survey data associated with a given hospital and a certain specialty param hospital The unique of the i Trust hospital we are querying about param specialty string representing the specialty we are interested in return java util List of Survey Result Beans throws Exception public List Survey Result Bean get Survey Results For Hospital String hospital String specialty throws Exception Connection conn null Prepared Statement ps null String Buffer sql new String Buffer sql append select p mid p firstname p lastname p address p address p city p state p zip p specialty sql append h hosid hospital sql append avg s Waiting Room Minutes Avg Waiting Room Minutes sql append avg s Exam Room Minutes Avg Exam Room Minutes sql append avg s Visit Satisfaction Avg Visit Satisfaction sql append avg s Treatment Satisfaction Avg Treatment Satisfation sql append count sql append select count from personnel p officevisits v Assigned Hos h sql append where v hcpid p mid sql append and v hcpid h hcpid sql append and h hosid sql append and p mid p mid Percent Satisfaction Results sql append from ovsurvey s personnel p officevisits v Assigned Hos h sql append where s visitid v id sql append and v hcpid p mid sql append and v hcpid h hcpid sql append and h hosid if specialty equals Survey Result Bean sql append and p specialty sql append group by p mid p firstname p lastname p address p address p city p state p zip hospital if specialty equals Survey Result Bean sql append p specialty sql append order by p mid try conn factory get Connection ps conn prepare Statement sql to String ps set String hospital ps set String hospital if specialty equals Survey Result Bean ps set String specialty return loader load List ps execute Query catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps 
package edu ncsu csc itrust dao mysql import java sql Connection import java sql Prepared Statement import java sql Result Set import java sql Exception import java sql Timestamp import java util List import edu ncsu csc itrust Util import edu ncsu csc itrust beans Operational Profile import edu ncsu csc itrust beans Transaction Bean import edu ncsu csc itrust beans loaders Operational Profile Loader import edu ncsu csc itrust beans loaders Transaction Bean Loader import edu ncsu csc itrust dao Factory import edu ncsu csc itrust enums Transaction Type import edu ncsu csc itrust exception Exception Used for the logging mechanism stands for Database Access Object All Os are intended to be reflections of the database that is one per table in the database most of the time For more complex sets of queries extra Os are added Os can assume that all data has been validated and is correct Os should never have setters or any other parameter to the constructor than a factory All Os should be accessed by Factory see link Factory and every should have a factory for obtaining connections and or accessing other Os author Andy public class Transaction private Factory factory private Transaction Bean Loader loader new Transaction Bean Loader private Operational Profile Loader operational Profile Loader new Operational Profile Loader The typical constructor param factory The link Factory associated with this which is used for obtaining connections etc public Transaction Factory factory this factory factory Returns the whole transaction log return throws Exception public List Transaction Bean get All Transactions throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Transaction Log time Logged Result Set rs ps execute Query return loader load List rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Log a transaction just giving it the person who is logged in and the type param type The link Transaction Type enum representing the type this transaction is param logged In The of the user who is logged in throws Exception public void log Transaction Transaction Type type long logged In throws Exception log Transaction type logged In Log a transaction with all of the info The meaning of secondary and added Info changes depending on the transaction type param type The link Transaction Type enum representing the type this transaction is param logged In The of the user who is logged in param secondary Typically the of the user who is being acted upon param added Info note about a subtransaction or specifics of this transaction for posterity throws Exception public void log Transaction Transaction Type type long logged In long secondary String added Info throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Transaction Log logged In secondary transaction Code added Info ps set Long logged In ps set Long secondary ps set Int type get Code ps set String added Info ps execute Update catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Return a list of all transactions in which an accessed the given patient s record param patient The of the patient in question return java util List of transactions throws Exception public List Transaction Bean get All Record Accesses long patient long dlhcp boolean get By Role throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Transaction Log secondary transaction Code Transaction Type patient Viewable Str logged In time Logged ps set Long patient ps set Long dlhcp Result Set rs ps execute Query List Transaction Bean tb List loader load List rs tb List add And Sort Roles tb List patient get By Role return tb List catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps The Most Thorough Fetch param mid of the logged in user param dlhcp of the user s param start Index to start pulling entries from param range Number of entries to retrieve return List of range Transaction Beans affecting the user starting from the start th entry throws Exception public List Transaction Bean get Transactions Affecting long mid long dlhcp java util Date start int range throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Transaction Log time Logged secondary transaction Code Transaction Type patient Viewable Str logged In transaction Code logged In transaction Code exclude if as specified in Transaction Type dlhcp Hidden Str time Logged ps set String mid ps set String mid ps set Int Transaction Type get Code ps set Timestamp new Timestamp start get Time ps set Long dlhcp ps set Int range Result Set rs ps execute Query List Transaction Bean tb List loader load List rs return tb List catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Return a list of all transactions in which an accessed the given patient s record within the dates param patient The of the patient in question param lower The starting date as a java util Date param upper The ending date as a java util Date return java util List of transactions throws Exception public List Transaction Bean get Record Accesses long patient long dlhcp java util Date lower java util Date upper boolean get By Role throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Transaction Log secondary transaction Code Transaction Type patient Viewable Str time Logged time Logged logged In time Logged ps set Long patient ps set Timestamp new Timestamp lower get Time add day s worth to include the upper ps set Timestamp new Timestamp upper get Time ps set Long dlhcp Result Set rs ps execute Query List Transaction Bean tb List loader load List rs tb List add And Sort Roles tb List patient get By Role return tb List catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Returns the operation profile return The Operational Profile as a bean throws Exception public Operational Profile get Operational Profile throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection ps conn prepare Statement Transaction Code count transaction as Total Count count if logged In transaction null as Patient Count count if logged In transaction null as Personnel Count Transaction Log transaction Code transaction Code Result Set rs ps execute Query return operational Profile Loader load Single rs catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps param tb List param patient param sort By Role return throws Exception private List Transaction Bean add And Sort Roles List Transaction Bean tb List long patient boolean sort By Role throws Exception Connection conn null Prepared Statement ps null try conn factory get Connection for Transaction Bean t tb List ps conn prepare Statement Role Users ps set Long t get Logged In Result Set rs ps execute Query String role if rs next role rs get String Role if role equals er role Emergency Responder else if role equals uap role else if role equals hcp role ps conn prepare Statement Patient Declared ps set Long t get Logged In Result Set rs ps execute Query while rs next if rs get Long Patient patient role break else if role equals patient role Patient ps conn prepare Statement representee Representatives representer ps set Long t get Logged In Result Set rs ps execute Query while rs next if rs get Long representee patient role Personal Health Representative break t set Role role if sort By Role Transaction Bean array new Transaction Bean tb List size array tb List get Transaction Bean t for int i i tb List size i t tb List get i String role t get Role int j while array j null role compare To Ignore Case array j get Role j for int k i k j k array k array k array j t int size tb List size for int i i size i tb List set i array i return tb List catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps 
package edu ncsu csc itrust risk import java util Array List import java util List import edu ncsu csc itrust dao Factory import edu ncsu csc itrust enums Ethnicity import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception No Health Records Exception import edu ncsu csc itrust risk factors Childhood Infection Factor import edu ncsu csc itrust risk factors Ethnicity Factor import edu ncsu csc itrust risk factors Family History Factor import edu ncsu csc itrust risk factors Patient Risk Factor Checks to see if the given patient is at risk for Type Diabetes For details on what each method does see link Risk Checker author Andy public class Type Diabetes Risks extends Risk Checker public Type Diabetes Risks Factory factory long patient throws Exception No Health Records Exception super factory patient Override public boolean qualifies For Disease return patient get Age Override protected List Patient Risk Factor get Disease Risk Factors List Patient Risk Factor factors new Array List Patient Risk Factor factors add new Ethnicity Factor patient Ethnicity Caucasian factors add new Family History Factor factory patient get factors add new Childhood Infection Factor factory patient get return factors Override public String get Name return Type Diabetes 
package edu ncsu csc itrust risk import static edu ncsu csc itrust enums Ethnicity African American import static edu ncsu csc itrust enums Ethnicity American Indian import static edu ncsu csc itrust enums Ethnicity Asian import static edu ncsu csc itrust enums Ethnicity Hispanic import java util Array List import java util List import edu ncsu csc itrust dao Factory import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception No Health Records Exception import edu ncsu csc itrust risk factors Age Factor import edu ncsu csc itrust risk factors Cholesterol Factor import edu ncsu csc itrust risk factors Ethnicity Factor import edu ncsu csc itrust risk factors Family History Factor import edu ncsu csc itrust risk factors Hypertension Factor import edu ncsu csc itrust risk factors Patient Risk Factor import edu ncsu csc itrust risk factors Prior Diagnosis Factor import edu ncsu csc itrust risk factors Weight Factor Checks to see if the given patient is at risk for Type Diabetes For details on what each method does see link Risk Checker author Andy public class Type Diabetes Risks extends Risk Checker public Type Diabetes Risks Factory factory long patient throws Exception No Health Records Exception super factory patient Override public boolean qualifies For Disease return patient get Age Override protected List Patient Risk Factor get Disease Risk Factors List Patient Risk Factor factors new Array List Patient Risk Factor factors add new Age Factor patient factors add new Ethnicity Factor patient Hispanic African American American Indian Asian factors add new Weight Factor current Health Record factors add new Hypertension Factor current Health Record factors add new Cholesterol Factor current Health Record factors add new Prior Diagnosis Factor factory patient get factors add new Family History Factor factory patient get return factors Override public String get Name return Type Diabetes 
package edu ncsu csc itrust action import edu ncsu csc itrust beans Procedure Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Codes import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception Form Validation Exception import edu ncsu csc itrust exception i Trust Exception import edu ncsu csc itrust validate Procedure Bean Validator Updates the Code Medical Procedures List Used by edit Procedure Codes jsp The code set accurately describes medical surgical and diagnostic services and is designed to communicate uniform information about medical services and procedures among physicians coders patients accreditation organizations and payers for administrative financial and analytical purposes see http www ama assn org ama pub physician resources solutions managing your practice coding billing insurance cpt about cpt shtml author laurenhayward public class Update Code List Action private Codes cpt private Procedure Bean Validator validator new Procedure Bean Validator param factory The Factory used to create the Os used in this action param logged In The of the administrator who is updating the Ts public Update Code List Action Factory factory long logged In this cpt factory get Codes Adds a new cpt code med procedure param proc Procedure Bean that holds the new cpt code return status message throws Form Validation Exception public String add Code Procedure Bean proc throws Form Validation Exception validator validate proc try if cpt add Code proc return Success proc get Code proc get Description added else return The database has become corrupt Please contact the system administrator for assistance catch Exception e e print Stack Trace return e get Message catch i Trust Exception e return e get Message Updates a procedure with new information from the Procedure Bean param proc Procedure Bean with new information but same code return Status message throws Form Validation Exception public String update Information Procedure Bean proc throws Form Validation Exception validator validate proc try int rows update Code proc if rows return Error Code not found To edit an actual code change the description and add a new code with the old description else return Success rows row s updated catch Exception e e print Stack Trace return e get Message Updates the cpt code param proc the code to be updated return updated code throws Exception private int update Code Procedure Bean proc throws Exception return cpt update Code proc 
package edu ncsu csc itrust action import edu ncsu csc itrust beans Hospital Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Hospitals import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception Form Validation Exception import edu ncsu csc itrust exception i Trust Exception import edu ncsu csc itrust validate Hospital Bean Validator Handles updating the list of hospitals Used by hospital Listing jsp author laurenhayward public class Update Hospital List Action private Hospitals hosp Set up param factory The Factory used to create the Os used in this action param performer The of the person updating the hospitals public Update Hospital List Action Factory factory long performer this hosp factory get Hospitals Adds a hosptial using the Hospital Bean passed as a param param hosp the new hospital listing return Status message throws Form Validation Exception public String add Hospital Hospital Bean hosp throws Form Validation Exception new Hospital Bean Validator validate hosp try if hosp add Hospital hosp return Success hosp get Hospital hosp get Hospital Name added else return The database has become corrupt Please contact the system administrator for assistance catch Exception e e print Stack Trace return e get Message catch i Trust Exception e return e get Message Updates a hospital based on the hospital id using new information from the Hospital Bean passed as a param param hosp the new hospital information with the same hospital id return Status message throws Form Validation Exception public String update Information Hospital Bean hosp throws Form Validation Exception new Hospital Bean Validator validate hosp try int rows return rows update Hospital hosp Error Hospital not found Success rows row s updated catch Exception e e print Stack Trace return e get Message Updates hospital param hosp new information return id for the updated hospital throws Exception private int update Hospital Hospital Bean hosp throws Exception return hosp update Hospital hosp 
package edu ncsu csc itrust action import edu ncsu csc itrust beans Diagnosis Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Codes import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception Form Validation Exception import edu ncsu csc itrust exception i Trust Exception import edu ncsu csc itrust validate Diagnosis Bean Validator Handles updating the Code Diagnosis List Used by edit Codes jsp The International Statistical Classification of Diseases and Related Health Problems most commonly known by the abbreviation provides codes to classify diseases and a wide variety of signs symptoms abnormal findings complaints social circumstances and external causes of injury or disease see http www cdc gov nchs icd htm author laurenhayward public class Update Code List Action private Codes icd private Diagnosis Bean Validator validator new Diagnosis Bean Validator Set up param factory The Factory used to create the Os used in this action param performer The of the person udpating the Ds public Update Code List Action Factory factory long performer icd factory get Codes Adds a new code diagnosis based on the Diagnosis Bean passed as a param param diagn The new diagnosis code return Status message throws Form Validation Exception public String add Code Diagnosis Bean diagn throws Form Validation Exception validator validate diagn try if icd add Code diagn return Success diagn get Code diagn get Description added else return The database has become corrupt Please contact the system administrator for assistance catch Exception e e print Stack Trace return e get Message catch i Trust Exception e return e get Message Updates a diagnosis with new information from the Diagnosis Bean passed as a param param diagn new information to update but same code return Status message throws Form Validation Exception public String update Information Diagnosis Bean diagn throws Form Validation Exception validator validate diagn try int rows icd update Code diagn if rows return Error Code not found else return Success rows row s updated catch Exception e e print Stack Trace return e get Message 
package edu ncsu csc itrust action import java util List import edu ncsu csc itrust beans Cbean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception Form Validation Exception import edu ncsu csc itrust exception i Trust Exception import edu ncsu csc itrust validate Bean Validator Handles updating the Used Logical Observation Identifiers Names and Codes is a database and universal standard for identifying medical laboratory observations see http loinc org public class Update List Action private l private Bean Validator validator new Bean Validator Sets up defaults param factory The Factory used to create the Os used in this action param performer The of the person updating the Cs public Update List Action Factory factory long performer l factory get Adds a new param diagn New return Status message throws Form Validation Exception public String add Cbean diagn throws Form Validation Exception i Trust Exception validator validate diagn List Cbean lblist l get All boolean correct false for int i i lblist size i if lblist get i get Lab Procedure Code equals diagn get Lab Procedure Code correct true i lblist size if correct throw new Form Validation Exception Error Code already exists l add diagn return Success diagn get Lab Procedure Code added Updates a param diagn new information to update but same code return Status message throws Form Validation Exception public String update Information Cbean diagn throws Form Validation Exception validator validate diagn try int rows l update diagn if rows return Error Code not found else return Success diagn get Lab Procedure Code updated catch Exception e e print Stack Trace return e get Message 
package edu ncsu csc itrust action import edu ncsu csc itrust beans Medication Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Codes import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception Form Validation Exception import edu ncsu csc itrust exception i Trust Exception import edu ncsu csc itrust validate Medication Bean Validator Handles updating the Code Prescription List Used by edit Codes jsp The National Drug Code is a universal product identifier used in the United States for drugs intended for human use see http www fda gov Drugs Information On Drugs ucm htm author laurenhayward public class Update Code List Action private Codes nd private Medication Bean Validator validator new Medication Bean Validator Set up defaults param factory The Factory used to create the Os used in this action param performer The of the user updating the lists public Update Code List Action Factory factory long performer nd factory get Codes Adds a new Code prescription to the list param med The new Code to be added return Status message throws Form Validation Exception public String add Code Medication Bean med throws Form Validation Exception validator validate med try if nd add Code med return Success med get Code med get Description added else return The database has become corrupt Please contact the system administrator for assistance catch Exception e e print Stack Trace return e get Message catch i Trust Exception e return e get Message Updates the Code with new information from the Medication Bean param med the Medication Bean that holds new information but the same code return status message throws Form Validation Exception public String update Information Medication Bean med throws Form Validation Exception validator validate med try int rows update Code med if rows return Error Code not found else return Success rows row s updated catch Exception e e print Stack Trace return e get Message Medication information should already be validated param med return throws Exception private int update Code Medication Bean med throws Exception return nd update Code med Removes a Code prescription from the list param med The Code to be removed return Status message throws Exception public String remove Code Medication Bean med throws Exception try if nd get Code med get Code null return Drug does not exist or already has been removed from the database catch Exception e e print Stack Trace return e get Message try if nd remove Code med return Success med get Code med get Description removed else return The database has become corrupt Please contact the system administrator for assistance catch Exception e e print Stack Trace return e get Message catch i Trust Exception e return e get Message 
page import java net Encoder page import edu ncsu csc itrust dao Factory page import edu ncsu csc itrust action Get User Name Action page import org apache commons lang String Escape Utils page import edu ncsu csc itrust exception i Trust Exception html head title i Trust Find User title style type text css get User Body background color White border solid px f margin px color f white space nowrap width px height px overflow hidden get User Title width text align center background color b color White font weight bold font size pt padding px px px px get User Title Close float right display block position absolute top px left px get User Close Link font size px color Red get User Close Link hover text decoration none color White get User Search Button color White font weight bold width px background color b border solid px f get User Search Button hover background color e get User Name font size pt color Black font weight bold get User Correct border px solid ff background color eeffee color aa font weight bold get User Correct hover border px solid ee background color bbffbb get User Incorrect border px solid ff background color ffeeee color aa font weight bold get User Incorrect hover border px solid ee background color ffbbbb result Table tr td padding px px px px style head body class get User Body div class get User Title i Trust User Search div class get User Title Close a class get User Close Link href javascript void onclick parent get User Close Close a div div form method post String mid request get Parameter mid String param request get Parameter s if mid null mid trim try String user Name new Get User Name Action Factory get Production Instance get User Name mid String action if param null action parent set User param mid user Name table align center tr td style text align center white space nowrap Found User span class get User Name br String Escape Utils escape Html user Name span br br Please confirm that this is the user you wish to select br br style line height px input type button name correct value This user is correct class get User Correct onclick String Escape Utils escape Html action input type submit name incorrect value Find another user class get User Incorrect nbsp nbsp nbsp td tr table catch i Trust Exception e response send Redirect get User jsp s param error Encoder encode e get Message else table align center tr td colspan style text align center padding bottom px b Please enter a User to search for b td tr tr td style text align right font weight bold color black User td td input name mid maxlength type text autocomplete off td tr tr td colspan style text align center padding top px input type submit value Search for User class get User Search Button td tr if mid tr td colspan style text align center font weight bold color Red Please enter an td tr else if request get Parameter error null tr td colspan style text align center font weight bold color Red String Escape Utils escape Html request get Parameter error td tr table form body html 
page import edu ncsu csc itrust action Reset Password Action page import edu ncsu csc itrust exception Form Validation Exception page import edu ncsu csc itrust exception i Trust Exception include file global jsp page Title i Trust Reset Password include file header jsp h Reset Password h Reset Password Action action new Reset Password Action prod if action is Maxed Out request get Remote Addr response send Redirect i Trust auth forward error Too many attempts long mid action check request get Parameter mid String role null try role action check Role mid request get Parameter role catch i Trust Exception e span User does not exist with this role and mid span form action i Trust util reset Password jsp method post table if mid role null tr td colspan b Please enter your Role and b td tr tr td Role td td select name role option value patient Patient option option value hcp option option value uap option option value er option option value pha option option value lt option select td tr tr td td td input type maxlength name mid td tr tr td colspan align center input type submit value Submit td tr else String answer action check Answer Null request get Parameter answer if answer null try tr td colspan b String Escape Utils escape Html action get Security Question mid b td tr tr td Answer td td input type password maxlength name answer input type hidden name mid value String Escape Utils escape Html mid input type hidden name role value String Escape Utils escape Html role td tr tr td New Password td td input type password maxlength name password td tr tr td Confirm td td input type password maxlength name confirm Password td tr tr td colspan align center input type submit value Submit td tr catch i Trust Exception e tr td font color red This user has not set a security question answer font td tr else String password request get Parameter password String confirm Password request get Parameter confirm Password String confirm try confirm action reset Password mid role answer password confirm Password request get Remote Addr if confirm contains Password changed logging Action log Event Transaction Type mid mid catch Form Validation Exception e e print page Context get Out tr td a href reset Password jsp h Please try again h a td tr tr td String Escape Utils escape Html confirm td tr table form include file footer jsp 
package edu ncsu csc itrust action import java util Array List import java util List import edu ncsu csc itrust Email Util import edu ncsu csc itrust beans Email import edu ncsu csc itrust beans Patient Bean import edu ncsu csc itrust beans Personnel Bean import edu ncsu csc itrust beans Prescription Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Patient import edu ncsu csc itrust dao mysql Personnel import edu ncsu csc itrust exception i Trust Exception Handles retrieving beans for view Prescription Records jsp author laurenhayward public class View Expired Prescriptions Action private Patient patient private Personnel personnel private Email Util emailer private long logged In Set up defaults param factory The Factory used to create the Os used in this action param logged In The of the person viewing the expired prescriptions public View Expired Prescriptions Action Factory factory long logged In this emailer new Email Util factory this patient factory get Patient this personnel factory get Personnel this logged In logged In Gets a Patient Bean from an param patient of the patient return Patient Bean for the given throws i Trust Exception public Patient Bean get Patient long patient throws i Trust Exception return patient get Patient patient Gets the logged in person s representees return list of Patient Beans holding the representees throws i Trust Exception public List Patient Bean get Representees throws i Trust Exception return patient get Represented logged In Returns the prescribing for a prescription param prescription item in question return who prescribed the prescription throws i Trust Exception public Personnel Bean get Prescribing Doctor Prescription Bean prescription throws i Trust Exception return personnel get Prescribing Doctor prescription Returns all the prescriptions for a given patient param patient patient in question return list of all the prescriptions for that patient throws i Trust Exception public List Prescription Bean get Prescriptions For Patient long patient throws i Trust Exception Patient Bean patient patient get Patient patient if logged In patient return patient get Expired Prescriptions patient List String to List new Array List String to List add patient get Email List Patient Bean representatives patient get Representing patient for Patient Bean representative representatives if logged In representative get return patient get Expired Prescriptions patient to List add representative get Email List Personnel Bean dlhcps patient get Declared Ps patient for Personnel Bean dlhcp dlhcps if logged In dlhcp get return patient get Expired Prescriptions patient List Personnel Bean uaps personnel get Ps For dlhcp get for Personnel Bean uap uaps if logged In uap get return patient get Prescriptions patient Email email new Email email set To List to List email set From noreply itrust com email set Subject Undesignated Personnel Have Accessed Your Prescription Records email set Body An undesignated or has accessed your prescription records For more information please log in to i Trust emailer send Email email return patient get Prescriptions patient 
package edu ncsu csc itrust action import java text Parse Exception import java text Simple Date Format import java util Date import java util List import edu ncsu csc itrust beans Patient Bean import edu ncsu csc itrust beans Personnel Bean import edu ncsu csc itrust beans Transaction Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Patient import edu ncsu csc itrust dao mysql Transaction import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception Form Validation Exception import edu ncsu csc itrust exception i Trust Exception Handles retrieving the log of record accesses for a given user Used by view Access Log jsp author laurenhayward public class View My Access Log Action private Transaction trans private Patient patient private long logged In Set up param factory The Factory used to create the Os used in this action param logged In The of the person retrieving the logs public View My Access Log Action Factory factory long logged In this logged In logged In this trans factory get Transaction this patient factory get Patient Returns a list of Transaction Beans between the two dates passed as params param lower Date the first date param upper Date the second date return list of Transaction Beans throws Exception throws Form Validation Exception public List Transaction Bean get Accesses String lower Date String upper Date String log boolean get By Role throws i Trust Exception Exception Form Validation Exception List Transaction Bean accesses stores the log entries List Personnel Bean dlhcps get the medical dependents for a signed in user If the selected user is not the signed in user or one of the dependents then the user does n t have access to the log List Patient Bean patient Relatives get Represented logged In long mid logged In try mid Long parse Long log catch Exception e dlhcps patient get Declared Ps mid boolean mid In Scope false for Patient Bean pb patient Relatives if pb get mid mid In Scope true if mid logged In mid In Scope the selected user in the form is out of scope and ca n t be shown to the user throw new Form Validation Exception Log to View user has either or s Get one if exists so it can be filtered from results long dlhcp if dlhcps is Empty dlhcp dlhcps get get if lower Date null upper Date null return trans get All Record Accesses mid dlhcp get By Role try Date lower new Simple Date Format dd yyyy parse lower Date Date upper new Simple Date Format dd yyyy parse upper Date if lower after upper throw new Form Validation Exception Start date must be before end date accesses trans get Record Accesses mid dlhcp lower upper get By Role catch Parse Exception e throw new Form Validation Exception Enter dates in dd yyyy return accesses Returns the date of the first Transaction in the list passed as a param if the list is not empty otherwise returns today s date param accesses java util List of Transaction Beans for the accesses return String representing the date of the first transaction public String get Default Start List Transaction Bean accesses String start Date if accesses size start Date new Simple Date Format dd yyyy format new Date accesses get accesses size get Time Logged get Time else start Date new Simple Date Format dd yyyy format new Date return start Date Returns the date of the last Transaction in the list passed as a param if the list is not empty otherwise returns today s date param accesses java util List of Transaction Beans storing the access return String representation of the date of the last transaction public String get Default End List Transaction Bean accesses String end Date if accesses size end Date new Simple Date Format dd yyyy format new Date accesses get get Time Logged get Time else end Date new Simple Date Format dd yyyy format new Date return end Date Return a list of patients that pid represents param pid The id of the personnel we are looking up representees for return a list of Patient Beans throws i Trust Exception public List Patient Bean get Represented long pid throws i Trust Exception return patient get Represented pid 
package edu ncsu csc itrust action import java sql Exception import java text Date Format import java text Parse Exception import java text Simple Date Format import java util Array List import java util Calendar import java util Date import java util List import edu ncsu csc itrust beans Message Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Message import edu ncsu csc itrust dao mysql Patient import edu ncsu csc itrust dao mysql Personnel import edu ncsu csc itrust dao mysql Referral import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception i Trust Exception Action class for View My Messages jsp public class View My Messages Action private long logged In private Patient patient private Personnel personnel private Message message private Referral referral Set up defaults param factory The Factory used to create the Os used in this action param logged In The of the user who is viewing their messages public View My Messages Action Factory factory long logged In this logged In logged In this patient factory get Patient this personnel factory get Personnel this message factory get Message this referral factory get Referral Gets all the messages for the logged in user return a list of all the user s messages throws Exception public List Message Bean get All My Messages throws Exception return message get Messages For logged In Gets all the messages for the logged in user and sorts by ascending time return a list of all the user s messages throws Exception public List Message Bean get All My Messages Time Ascending throws Exception return message get Messages Time Ascending logged In Gets all the messages for the logged in user and sorts names in ascending order return a list of all the user s messages throws Exception public List Message Bean get All My Messages Name Ascending throws Exception return message get Messages Name Ascending logged In Gets all the messages for the logged in user and sorts name in descending order return a list of all the user s messages throws Exception public List Message Bean get All My Messages Name Descending throws Exception return message get Messages Name Descending logged In Gets all the sent messages for the logged in user return a list of all the user s sent messages throws Exception public List Message Bean get All My Sent Messages throws Exception return message get Messages From logged In Gets all the messages for the logged in user and sorts by ascending time return a list of all the user s messages throws Exception public List Message Bean get All My Sent Messages Time Ascending throws Exception return message get Messages From Time Ascending logged In Gets all the messages for the logged in user and sorts names in ascending order return a list of all the user s messages throws Exception public List Message Bean get All My Sent Messages Name Ascending throws Exception return message get Messages From Name Ascending logged In Gets all the messages for the logged in user and sorts name in descending order return a list of all the user s messages throws Exception public List Message Bean get All My Sent Messages Name Descending throws Exception return message get Messages From Name Descending logged In public String validate And Create Filter String filter String f filter split Date Format format new Simple Date Format dd yyyy Date s null Date en null try if f equals s format parse f if f equals en format parse f if s null en null en before s return Error The end date can not be before the start date catch Exception e return Error date was not formatted correctly please enter dates as for int i i f length i f i f i replace f i f i replace f i f i replace String nf f f f f f f return nf Gets a list of messages for a user based on their filter criteria param messages List of all of a user s Message Beans param filter String containing a user s filter criteria return a List of Message Beans that meet the criteria of the filter throws i Trust Exception throws Parse Exception public List Message Bean filter Messages List Message Bean messages String filter throws i Trust Exception Parse Exception List Message Bean filtered new Array List Message Bean String f filter split for Message Bean m messages Check the sender filter field Exclude if this Message Bean does not match the requested sender if one is specified if f equals if this get Name m get From equals Ignore Case f continue Check the subject filter field Exclude if this Message Bean does not match the requested subject if one is specified if f equals if m get Subject equals Ignore Case f continue Check the body of the message for certain words Exclude if this Message Bean if it does not contain those words in the message body if f equals if m get Subject to Lower Case contains f to Lower Case m get Body to Lower Case contains f to Lower Case continue Check the body of the message for certain words Exclude if this Message Bean if it does contain those words in the message body if f equals if m get Subject to Lower Case contains f to Lower Case m get Body to Lower Case contains f to Lower Case continue Check the start date filter field Exclude if this Message Bean was not sent after this date if f equals Date Format format new Simple Date Format dd yyyy Date s format parse f if s after m get Sent Date continue Check the end date filter field Exclude if this Message Bean was not sent before this date if f equals Date Format format new Simple Date Format dd yyyy Date s format parse f Calendar c Calendar get Instance c set Time s c add Calendar s c get Time if s before m get Sent Date continue If the message has not been eliminated by any of the filter fields add it to the new list of messages filtered add m return filtered Gets a patient s name from their param mid the of the patient return the patient s name throws i Trust Exception public String get Name long mid throws i Trust Exception if mid return patient get Name mid else return personnel get Name mid Gets a personnel s name from their param mid the of the personnel return the personnel s name throws i Trust Exception public String get Personnel Name long mid throws i Trust Exception return personnel get Name mid Set the state of the Message Bean to read after it is read by a user param m Bean Message Bean to be read public void set Read Message Bean m Bean try message update Read m Bean catch Exception e Auto generated catch block e print Stack Trace Get the number of unread messages that the current user has return The number of unread messages throws Exception public int get Unread Count throws Exception List Message Bean messages get All My Messages int count for Message Bean mb messages if mb get Read count return count public long linked To Referral long id throws Exception return referral is Referral Message id 
package edu ncsu csc itrust action import java util Array List import java util List import edu ncsu csc itrust beans Allergy Bean import edu ncsu csc itrust beans Diagnosis Bean import edu ncsu csc itrust beans Email import edu ncsu csc itrust beans Family Member Bean import edu ncsu csc itrust beans Health Record import edu ncsu csc itrust beans Lab Procedure Bean import edu ncsu csc itrust beans Office Visit Bean import edu ncsu csc itrust beans Patient Bean import edu ncsu csc itrust beans Personnel Bean import edu ncsu csc itrust beans Procedure Bean import edu ncsu csc itrust beans Report Request Bean import edu ncsu csc itrust beans Cbean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Allergy import edu ncsu csc itrust dao mysql Fake Email import edu ncsu csc itrust dao mysql Family import edu ncsu csc itrust dao mysql Health Records import edu ncsu csc itrust dao mysql Lab Procedure import edu ncsu csc itrust dao mysql Office Visit import edu ncsu csc itrust dao mysql Patient import edu ncsu csc itrust dao mysql Personnel import edu ncsu csc itrust dao mysql Procedures import edu ncsu csc itrust dao mysql Report Request import edu ncsu csc itrust dao mysql Survey import edu ncsu csc itrust dao mysql Codes import edu ncsu csc itrust dao mysql import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception i Trust Exception Handles patients viewing their own records Used by view My Records jsp author laurenhayward public class View My Records Action private Patient patient private Personnel personnel private Allergy allergy private Family family private Health Records hr private Office Visit ov private Survey survey private Lab Procedure lab private Fake Email email private Codes icd private Report Request report Request private Procedures proc private loinc private long logged In Set up param factory The Factory used to create the Os used in this action param logged In The of the person viewing the records public View My Records Action Factory factory long logged In this patient factory get Patient this personnel factory get Personnel this allergy factory get Allergy this family factory get Family this hr factory get Health Records this ov factory get Office Visit this survey factory get Survey this lab factory get Lab Procedure this email factory get Fake Email this report Request factory get Report Request this icd factory get Codes this proc factory get Procedures this loinc factory get this logged In logged In public List Cbean get Procedure Name String lab Code throws Exception return loinc get Procedures lab Code Takes the patient s representee as a param and returns it as a long if the patient represents the input param param input the patient s representee mid return representee s mid as a long throws i Trust Exception public long represent Patient String input throws i Trust Exception try long reppee Long value Of input if patient represents logged In reppee logged In reppee return reppee else throw new i Trust Exception You do not represent patient reppee catch Number Format Exception e throw new i Trust Exception is not a number Returns a Patient Bean for the currently logged in patient return Patient Bean for the currently logged in patient throws i Trust Exception public Patient Bean get Patient throws i Trust Exception return patient get Patient logged In Returns a Patient Bean for the specified param mid id of the requested bean return Patient Bean for the specified throws i Trust Exception public Patient Bean get Patient long mid throws i Trust Exception return patient get Patient mid Returns a Personnel Bean for the requested param mid id of the requested bean return a Personnel Bean for the requested throws i Trust Exception public Personnel Bean get Personnel long mid throws i Trust Exception return personnel get Personnel mid Returns a Patient Bean for the currently logged in patient return Patient Bean for the currently logged in patient throws i Trust Exception public List Email get Email History throws i Trust Exception return email get Emails By Person get Patient get Email Returns a list of Allergy Beans for the currently logged in patient return a list of Allergy Beans for the currently logged in patient throws i Trust Exception public List Allergy Bean get Allergies throws i Trust Exception return allergy get Allergies logged In Returns a list of Parents Siblings and Children of the currently logged in patient return list of Family Member Beans public List Family Member Bean get Family throws i Trust Exception List Family Member Bean fam new Array List Family Member Bean List Family Member Bean parents null try parents family get Parents logged In fam add All parents fam add All family get Siblings logged In fam add All family get Children logged In catch Exception e throw new i Trust Exception e get Message if parents null List Family Member Bean grandparents new Array List Family Member Bean for Family Member Bean parent parents try grandparents add All family get Parents parent get Mid catch Exception e throw new i Trust Exception e get Message fam add All grandparents for Family Member Bean gp grandparents gp set Relation Grandparent return fam Returns a list of Parents Siblings and Grand Parents of the currently logged in patient return list of Family Member Beans public List Family Member Bean get Family History throws i Trust Exception List Family Member Bean fam new Array List Family Member Bean List Family Member Bean parents null try parents family get Parents logged In fam add All parents fam add All family get Siblings logged In catch Exception e throw new i Trust Exception e get Message if parents null List Family Member Bean grandparents new Array List Family Member Bean for Family Member Bean parent parents try grandparents add All family get Parents parent get Mid catch Exception e throw new i Trust Exception e get Message fam add All grandparents for Family Member Bean gp grandparents gp set Relation Grandparent return fam Returns a list of Health Records for the currently logged in patient return a list of Health Records for the currently logged in patient throws i Trust Exception public List Health Record get All Health Records throws i Trust Exception return hr get All Health Records logged In Returns a list of Health Records for the specified family member return a list of Health Records for the specified family member throws i Trust Exception public List Health Record get Family Health Records long mid throws i Trust Exception return hr get All Health Records mid Returns a list of Office Visit Beans for all office visits for the currently logged in patient return a list of Office Visit Beans for all office visits for the currently logged in patient throws i Trust Exception public List Office Visit Bean get All Office Visits throws i Trust Exception return ov get All Office Visits logged In Returns a complete Office Visit Bean given a visit return a complete Office Visit Bean given a visit throws i Trust Exception public Office Visit Bean get Complete Office Visit long visit throws i Trust Exception return ov get Office Visit visit public List Procedure Bean get Procedures long visit throws Exception return proc get List visit Returns a list of Patient Beans of all patients the currently logged in patient represents return a list of Patient Beans of all patients the currently logged in patient represents throws i Trust Exception public List Patient Bean get Represented throws i Trust Exception return patient get Represented logged In Returns a list of Patient Beans of all patients the currently logged in patient represents return a list of Patient Beans of all patients the currently logged in patient represents throws i Trust Exception public List Patient Bean get Representing throws i Trust Exception return patient get Representing logged In Has a survey been created for this office visit param visit of the office visit in question return true if the survey has been completed otherwise false throws i Trust Exception public boolean is Survey Completed long visit throws i Trust Exception return survey is Survey Completed visit Returns a list of lab procedures return a list of lab procedures for the logged in patient throws Exception public List Lab Procedure Bean get Labs throws i Trust Exception return lab get Lab Procedures For Patient logged In public List Lab Procedure Bean get Specific Labs long id String loinc throws Exception return lab get All Lab Procedures id loinc public void set Viewed List Lab Procedure Bean procs throws Exception for Lab Procedure Bean b procs b set Viewed By Patient true lab mark Viewed b Returns all the report requests for the logged in patient return the report requests for the logged in patient throws i Trust Exception public List Report Request Bean get Report Requests throws i Trust Exception return report Request get All Report Requests For Patient logged In Checks to see if family members have high blood pressure param member the family member in question return true if the family member has the risk factor otherwise false throws i Trust Exception public boolean does Family Member Have High Family Member Bean member throws i Trust Exception List Health Record records hr get All Health Records member get Mid if records size return false for Health Record record records if record get Blood Pressure Systolic record get Blood Pressure Diastolic return true return false Checks to see if family members have high cholesterol param member the family member in question return true if the family member has the risk factor otherwise false throws i Trust Exception public boolean does Family Member Have High Cholesterol Family Member Bean member throws i Trust Exception List Health Record records hr get All Health Records member get Mid if records size return false for Health Record record records if record get Cholesterol record get Cholesterol return true return false Checks to see if family members have diabetes param member the family member in question return true if the family member has the risk factor otherwise false throws i Trust Exception public boolean does Family Member Have Diabetes Family Member Bean member throws i Trust Exception List Diagnosis Bean diagnoses patient get Diagnoses member get Mid if diagnoses size return false for Diagnosis Bean diag diagnoses if diag get Code starts With return true return false Checks to see if family members have cancer param member the family member in question return true if the family member has the risk factor otherwise false throws i Trust Exception public boolean does Family Member Have Cancer Family Member Bean member throws i Trust Exception List Diagnosis Bean diagnoses patient get Diagnoses member get Mid if diagnoses size return false for Diagnosis Bean diag diagnoses if diag get Code starts With return true return false Checks to see if family members have heart disease param member the family member in question return true if the family member has the risk factor otherwise false throws i Trust Exception public boolean does Family Member Have Heart Disease Family Member Bean member throws i Trust Exception List Diagnosis Bean diagnoses patient get Diagnoses member get Mid if diagnoses size return false for Diagnosis Bean diag diagnoses if diag get Code starts With return true return false Checks to see if family members smoke param member the family member in question return true if the family member has the risk factor otherwise false throws i Trust Exception public boolean is Family Member Smoker Family Member Bean member throws i Trust Exception List Health Record records hr get All Health Records member get Mid if records size return false for Health Record record records if record is Smoker return true return false Checks to see if family member is dead and if so what their cause of death was param member the family member in question return the cause of death for the family member throws i Trust Exception public String get Family Member Family Member Bean member throws i Trust Exception Patient Bean patient patient get Patient member get Mid if patient get Cause Of Death null return Diagnosis Bean diag icd get Code patient get Cause Of Death if diag null return return diag get Description 
package edu ncsu csc itrust action import java text Parse Exception import java text Simple Date Format import java util Date import java util List import edu ncsu csc itrust beans Remote Monitoring Data Bean import edu ncsu csc itrust beans Personnel Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Auth import edu ncsu csc itrust dao mysql Remote Monitoring import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception Form Validation Exception import edu ncsu csc itrust exception i Trust Exception Handles retrieving the patient data for a certain as used by view Telemedicine Data jsp public class View My Remote Monitoring List Action private Remote Monitoring rm private Auth auth private long logged In Constructor param factory The Factory used to create the Os used in this action param logged In The of the retrieving the patient data public View My Remote Monitoring List Action Factory factory long logged In this logged In logged In this rm factory get Remote Monitoring this auth factory get Auth Returns a list of Remote Monitoring Data Beans for the logged in return list of Transaction Beans throws Exception throws Form Validation Exception public List Remote Monitoring Data Bean get Patients Data throws Exception return rm get Patients Data logged In Returns a list of Remote Monitoring Data Beans for the logged in return list of Transaction Beans throws Exception throws Form Validation Exception public List Remote Monitoring Data Bean get Patient Data By Date long patient String start Date String end Date throws Exception Form Validation Exception Date lower Date upper try lower new Simple Date Format dd yyyy parse start Date upper new Simple Date Format dd yyyy parse end Date if lower after upper throw new Form Validation Exception Start date must be before end date catch Parse Exception e throw new Form Validation Exception Enter dates in dd yyyy return rm get Patient Data By Date patient lower upper Returns a list of Remote Monitoring Data Beans for the logged in based on a certain data type param patient param data Type return list of Transaction Beans throws Exception throws Form Validation Exception public List Remote Monitoring Data Bean get Patient Data By Type long patient String data Type throws Exception Form Validation Exception String types weight systolic Blood Pressure diastolic Blood Pressure glucose Level pedometer Reading boolean valid false for String d Type types if d Type equals data Type valid true break if valid throw new Form Validation Exception Input must be a valid telemedicine data type return rm get Patient Data By Type patient data Type public List Remote Monitoring Data Bean get Patient Data Without Logging throws Exception return rm get Patients Data logged In returns the patient name return patient name throws Exception throws i Trust Exception public String get Patient Name long pid throws Exception i Trust Exception return auth get User Name pid Useful to figure out who is monitoring a given patient return list of Ps monitoring this patient throws Exception throws i Trust Exception public List Personnel Bean get Monitoring Ps throws Exception i Trust Exception return rm get Monitoring Ps logged In 
package edu ncsu csc itrust action import java util Calendar import java util List import edu ncsu csc itrust beans Personnel Bean import edu ncsu csc itrust beans Report Request Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Personnel import edu ncsu csc itrust dao mysql Report Request import edu ncsu csc itrust exception i Trust Exception Action class for View My Reports jsp Allows the user to see all their reports public class View My Report Requests Action private long logged In private Report Request report Request private Personnel personnel private Factory factory Set up param factory The Factory used to create the Os used in this action param logged In The of the person viewing their report requests public View My Report Requests Action Factory factory long logged In this logged In logged In this report Request factory get Report Request this personnel factory get Personnel this factory factory Returns all the reports for the currently logged in return list of all reports for the logged in throws i Trust Exception public List Report Request Bean get All Report Requests For Requester throws i Trust Exception return report Request get All Report Requests For Requester logged In Returns a list of all reports return list of all reports throws i Trust Exception public List Report Request Bean get All Report Requests throws i Trust Exception return report Request get All Report Requests Adds a report request to the list param patient of the patient that the report request is for return throws i Trust Exception public long add Report Request long patient throws i Trust Exception long id report Request add Report Request logged In patient Calendar get Instance get Time return id Approves a report request from the list mail is sent when the request is approved param id of the request throws i Trust Exception public void approve Report Request long throws i Trust Exception Report Request Bean rr report Request get Report Request report Request approve Report Request logged In Calendar get Instance get Time new Email Util factory send Email make Email App logged In rr get Requester rr get Patient Sends e mail regarding the approved request param admin admin who approved the request param hcp the request is for param pid of the patient the report is about return the sent e mail throws Exception private Email make Email App long admin long hcp long pid throws Exception Patient Bean p new Patient factory get Patient pid Email email new Email email set From no reply itrust com email set To List Arrays as List p get Email email set Subject Report has been generated in i Trust email set Body String format Dear s n The i Trust Health Care Provider s submitted a request to view your full medical records The i Trust administrator s approved a one time viewing of this report You will be notified when the chooses to view it p get Full Name hcp admin return email Rejects a request from the list param id of the rejected request param comment why the request was rejected throws i Trust Exception public void reject Report Request long String comment throws i Trust Exception report Request reject Report Request logged In Calendar get Instance get Time comment Returns the requested report param id of the requested report return the requested report throws i Trust Exception public Report Request Bean get Report Request int throws i Trust Exception return report Request get Report Request Sets the viewed status of the report If the report is viewed the must request a new one to see it again param id of the report throws i Trust Exception public void set Viewed int throws i Trust Exception Report Request Bean rr report Request get Report Request report Request set Viewed Calendar get Instance get Time new Email Util factory send Email make Email View rr get Approver rr get Requester rr get Patient Sends e mail regarding the request to the patient param admin admin who approved the request param hcp the request is for param pid of the patient the report is about return the sent e mail throws Exception private Email make Email View long admin long hcp long pid throws Exception Patient Bean p new Patient factory get Patient pid Email email new Email email set From no reply itrust com email set To List Arrays as List p get Email email set Subject Report has been generated in i Trust email set Body String format Dear s n The i Trust Health Care Provider s has chosen to view your full medical report which was approved by an i Trust administrator s This report was only viewable one time and is no longer available p get Full Name hcp admin return email Gets the status of the request param id id of the request return the request s status throws i Trust Exception public String get Long Status long id throws i Trust Exception String Builder s new String Builder Report Request Bean r report Request get Report Request id if r get Status equals Report Request Bean Requested Personnel Bean p personnel get Personnel r get Requester s append String format Request was requested on s by s r get Requested Date String p get Full Name if r get Status equals Report Request Bean Viewed Personnel Bean p personnel get Personnel r get Requester String full Name Unknown if p null full Name p get Full Name s append String format Request was requested on s by s r get Requested Date String p get Full Name s append removed br because it caused unit test to fail and seems to have no purpose s append String format and viewed on s by s r get Viewed Date String full Name return s to String 
package edu ncsu csc itrust action import java util Array List import java util Iterator import java util List import java util Scanner import edu ncsu csc itrust beans Office Visit Bean import edu ncsu csc itrust beans Patient Bean import edu ncsu csc itrust beans Patient Visit Bean import edu ncsu csc itrust beans Personnel Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Office Visit import edu ncsu csc itrust dao mysql Patient import edu ncsu csc itrust dao mysql Personnel import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception i Trust Exception Action class for View Patient Office Visit History jsp public class View Patient Office Visit History Action private long logged In private Patient patient private Personnel personnel private Office Visit officevisit private Array List Patient Visit Bean visits Set up defaults param factory The Factory used to create the Os used in this action param logged In The of the person viewing the office visits public View Patient Office Visit History Action Factory factory long logged In this logged In logged In this personnel factory get Personnel officevisit factory get Office Visit this patient factory get Patient visits new Array List Patient Visit Bean Adds all the office visits for the logged in to a list throws i Trust Exception private void process Office Visits throws i Trust Exception try List Office Visit Bean ovlist officevisit get All Office Visits For logged In Iterator Office Visit Bean it ovlist iterator Office Visit Bean ov Patient Visit Bean visit Bean while it has Next visit Bean new Patient Visit Bean ov it next Patient Bean pb pb patient get Patient ov get Patient visit Bean set Patient pb visit Bean set Patient Name pb get Full Name String date ov get Visit Date Str Scanner sc new Scanner date sc use Delimiter String month sc next String day sc next String year sc next visit Bean set Last Date month visit Bean set Last Date day visit Bean set Last Date year visit Bean set Last Date year month date visit Bean set Address pb get Street Address pb get Street Address visit Bean set Address pb get City pb get State pb get Zip boolean b Patient In List pb date if b false visits add visit Bean catch Exception dbe throw new i Trust Exception dbe get Message Checks to see if a patient is in the list of visits param pb patient to check param date date of the visit return True if the patient is in the list of visits private boolean Patient In List Patient Bean pb String date Iterator Patient Visit Bean it visits iterator Patient Visit Bean visit Bean while it has Next visit Bean it next if visit Bean get Patient Name equals pb get Full Name if visit Bean get Last Date compare To date visit Bean set Last Date date return true return false Get the list of patients an has had office visits with return the list of patients an has had office visits with throws Exception public List Patient Visit Bean get Patients throws Exception try process Office Visits catch i Trust Exception ie return visits Returns a Personnel Bean for the logged in return Personnel Bean for the logged in throws i Trust Exception public Personnel Bean get Personnel throws i Trust Exception return personnel get Personnel logged In 
package edu ncsu csc itrust action import java util Array List import java util List import edu ncsu csc itrust Email Util import edu ncsu csc itrust beans Email import edu ncsu csc itrust beans Patient Bean import edu ncsu csc itrust beans Personnel Bean import edu ncsu csc itrust beans Prescription Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Patient import edu ncsu csc itrust dao mysql Personnel import edu ncsu csc itrust exception i Trust Exception import edu ncsu csc itrust Messages Handles retrieving beans for view Prescription Records jsp author laurenhayward public class View Prescription Records Action private Patient patient private Personnel personnel private Email Util emailer private long logged In Set up defaults param factory The Factory used to create the Os used in this action param logged In The of the person viewing prescription records public View Prescription Records Action Factory factory long logged In this emailer new Email Util factory this patient factory get Patient this personnel factory get Personnel this logged In logged In Gets a Patient Bean from an param patient of the patient return Patient Bean for the given throws i Trust Exception public Patient Bean get Patient long patient throws i Trust Exception return patient get Patient patient Gets the logged in person s representees return list of Patient Beans holding the representees throws i Trust Exception public List Patient Bean get Representees throws i Trust Exception return patient get Represented logged In Returns the prescribing for a prescription param prescription item in question return who prescribed the prescription throws i Trust Exception public Personnel Bean get Prescribing Doctor Prescription Bean prescription throws i Trust Exception return personnel get Prescribing Doctor prescription Returns all the prescriptions for a given patient param patient patient in question return list of all the prescriptions for that patient throws i Trust Exception public List Prescription Bean get Prescriptions For Patient long patient throws i Trust Exception Patient Bean patient patient get Patient patient if logged In patient return patient get Prescriptions patient List String to List new Array List String to List add patient get Email List Patient Bean representatives patient get Representing patient for Patient Bean representative representatives if logged In representative get return patient get Prescriptions patient to List add representative get Email List Personnel Bean dlhcps patient get Declared Ps patient for Personnel Bean dlhcp dlhcps if logged In dlhcp get return patient get Prescriptions patient List Personnel Bean uaps personnel get Ps For dlhcp get for Personnel Bean uap uaps if logged In uap get return patient get Prescriptions patient Email email new Email email set To List to List email set From noreply itrust com email set Subject Messages get String View Prescription Records Action email set Body Messages get String View Prescription Records Action emailer send Email email return patient get Prescriptions patient 
package edu ncsu csc itrust action import java util List import edu ncsu csc itrust beans Patient Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Patient import edu ncsu csc itrust exception Exception import edu ncsu csc itrust Messages This action returns a list of patients with a special diagnosis history who have the logged in as a and whose medications are going to expire within seven days public class View Prescription Renewal Needs Action private Patient patient private long logged In Set up defaults param factory The Factory used to create the Os used in this action param logged In The of the person viewing the prescription renewals public View Prescription Renewal Needs Action Factory factory long logged In this patient factory get Patient this logged In logged In Uses Patient as a helper class to return a list of patients with a special diagnosis history who have the logged in as a and whose medications are going to expire within seven days return list of Patient Bean s public List Patient Bean get Renewal Needs Patients try return patient get Renewal Needs Patients logged In catch Exception e System out println Messages get String View Prescription Renewal Needs Action System out println e return null 
package edu ncsu csc itrust action import java util List import edu ncsu csc itrust beans Diagnosis Bean import edu ncsu csc itrust beans Patient Bean import edu ncsu csc itrust beans Personnel Bean import edu ncsu csc itrust beans Prescription Bean import edu ncsu csc itrust beans Procedure Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Patient import edu ncsu csc itrust dao mysql Personnel import edu ncsu csc itrust exception i Trust Exception Action class for View Report jsp public class View Report Action private Patient patient private Personnel personnel Set up defaults param factory The Factory used to create the Os used in this action param logged In The of the person viewing the report public View Report Action Factory factory long logged In patient factory get Patient personnel factory get Personnel Get diagnosis list for the given patient param pid the patient of interest return list of diagnoses throws i Trust Exception public List Diagnosis Bean get Diagnoses long pid throws i Trust Exception return patient get Diagnoses pid Get procedure list for the given patient param pid the patient of interest return list of procedures throws i Trust Exception public List Procedure Bean get Procedures long pid throws i Trust Exception return patient get Procedures pid Get prescription list for the given patient param pid the patient of interest return list of prescriptions throws i Trust Exception public List Prescription Bean get Prescriptions long pid throws i Trust Exception return patient get Current Prescriptions pid Get declared Ps list for the given patient param pid the patient of interest return list of declared Ps throws i Trust Exception public List Personnel Bean get Declared Ps long pid throws i Trust Exception return patient get Declared Ps pid Returns a Personnel Bean when given an param mid of interest return Personnel Bean of the given throws i Trust Exception public Personnel Bean get Personnel long mid throws i Trust Exception return personnel get Personnel mid Returns a Paitent Bean when given an param mid patient of interest return Patient Bean of the given throws i Trust Exception public Patient Bean get Patient long mid throws i Trust Exception return patient get Patient mid 
package edu ncsu csc itrust action import java util List import edu ncsu csc itrust beans Survey Result Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Survey Result import edu ncsu csc itrust exception Form Validation Exception import edu ncsu csc itrust exception i Trust Exception import edu ncsu csc itrust validate Survey Search Validator This class is used to handle retrieving survey results from the database It also logs the transaction public class View Survey Result Action private Survey Result survey Result private Survey Search Validator validator long logged In Set up defaults param factory The Factory used to create the Os used in this action param logged In The of the person retrieving survey results public View Survey Result Action Factory factory long logged In survey Result factory get Survey Result this logged In logged In validator new Survey Search Validator Retrieves survey results for a whole hospital param bean The Survey Result Bean containing the survey result specs return java util List of Survey Results throws i Trust Exception throws Form Validation Exception public List Survey Result Bean get Survey Results For Hospital Survey Result Bean bean throws i Trust Exception Form Validation Exception return survey Result get Survey Results For Hospital bean get Phospital bean get Pspecialty Retrieves survey results for a given zip code param bean The Survey Result Bean containing the survey result specs return java util List of Survey Results throws i Trust Exception throws Form Validation Exception public List Survey Result Bean get Survey Results For Zip Survey Result Bean bean throws i Trust Exception Form Validation Exception validator validate bean return survey Result get Survey Results For Zip bean get Pzip bean get Pspecialty 
package edu ncsu csc itrust action import java util Date import java util Linked Hash Map import java util List import java util Array List import edu ncsu csc itrust beans Personnel Bean import edu ncsu csc itrust beans Office Visit Bean import edu ncsu csc itrust beans Visit Bean import edu ncsu csc itrust dao Factory import edu ncsu csc itrust dao mysql Patient import edu ncsu csc itrust dao mysql Personnel import edu ncsu csc itrust dao mysql Office Visit import edu ncsu csc itrust exception Exception import edu ncsu csc itrust exception i Trust Exception Action class for View Visited Ps jsp public class View Visited Ps Action private long patient private Personnel doc private Office Visit visit private Patient patient private Array List Visit Bean visits private Declare Action declare Action private Array List Personnel Bean filter List Set up defaults param factory The Factory used to create the Os used in this action param logged In The of the person viewing the visited Ps public View Visited Ps Action Factory factory long logged In patient logged In doc factory get Personnel visit factory get Office Visit patient factory get Patient visits new Array List Visit Bean declare Action new Declare Action factory logged In filter List new Array List Personnel Bean Create an Visit Bean from a given Personnel Bean and office visit date param pb The Personnel Bean that will be visited param visit Date The date of the visit This may be the empty string return The new Visit Bean throws Exception private Visit Bean make Visit Bean Personnel Bean pb String visit Date throws Exception long hcpid pb get Visit Bean visit Bean new Visit Bean visit Bean set hcpid visit Bean set Name pb get Full Name visit Bean set Date visit Date visit Bean set Specialty pb get Specialty visit Bean set Addr pb get Street Address pb get Street Address pb get City pb get State pb get Zip visit Bean set Designated patient check Declared patient hcpid return visit Bean Checks to see if a Personnel Bean matches against a given set of criteria param pb The Personnel Bean to check param last Name The last name to check against May be null or the empty string to ignore param specialty The specialty to check against May be null or the empty string to ignore param zip The zip code to check against May be null or the empty string to ignore return true if the Personnel Bean matches all the given parameters or false otherwise private boolean match Personnel Personnel Bean pb String last Name String specialty String zip if last Name null last Name equals pb get Last Name starts With last Name return false if specialty null specialty equals specialty equals pb get Specialty return false if zip null zip equals zip equals pb get Zip return false return true Get a list of all Ps visited and or designated by by the current user The list can optionally be filtered by the doctor s last name specialty or zip code param last Name The last name or a part of it of the doctor to search for or null or an empty string to accept all doctors param specialty The specialty of the doctor to search for or null or an empty string to accept all doctors param zip The zip code of the doctor to search for or null or an empty string to accept all doctors return list of Visit Beans where each represents one that has been visited or has been designated throws i Trust Exception private List Visit Bean get All Visited Ps String last Name String specialty String zip throws i Trust Exception Visited Ps in this case includes both Ps visited and Ps designated by the patient These two groups are retrieved in different ways then combined List Visit Bean visits new Array List Visit Bean try List Office Visit Bean ovlist visit get All Office Visits patient get most recent office visit for each provider Linked Hash Map Long Office Visit Bean most Recent Visits new Linked Hash Map Long Office Visit Bean for Office Visit Bean ov ovlist long id ov get Hcp if most Recent Visits contains Key id most Recent Visits put id ov else Office Visit Bean old most Recent Visits get id Date ov Date ov get Visit Date Date old Date old get Visit Date if old Date before ov Date most Recent Visits put id ov Get visited Ps for Office Visit Bean ov most Recent Visits values long hcpid ov get Hcp Personnel Bean pb doc get Personnel hcpid if match Personnel pb last Name specialty zip Visit Bean visit Bean make Visit Bean pb most Recent Visits get hcpid get Visit Date Str visits add visit Bean Get all designated Ps Because a designated may have been visited we will ensure the is not already in the list List Personnel Bean dhcps patient get Declared Ps patient next for Personnel Bean pb dhcps if match Personnel pb last Name specialty zip long hcpid pb get if is already in visits list skip here for Visit Bean hv visits if hv get hcpid continue next String date Visit Bean visit Bean make Visit Bean pb date visits add visit Bean catch Exception dbe throw new i Trust Exception dbe get Message return visits Returns a list of all the visited and or designated Ps return list of all the visited Ps public List Visit Bean get Visited Ps List Visit Bean visits try visits get All Visited Ps null null null catch i Trust Exception ie visits new Array List Visit Bean return visits Given an s name return the corresponding Visit Bean param name return public Visit Bean get Named String name Visit Bean r new Visit Bean for Visit Bean bean get Visited Ps if name equals bean get Name r bean break return r Set a given as undeclared param name to undeclare return An empty string throws i Trust Exception public String undeclare String name throws i Trust Exception for Visit Bean visit get Visited Ps if visit get Name to Lower Case compare To name to Lower Case Long mid Long value Of visit get declare Action undeclare mid to String visit set Designated false if visit get Date compare To remove visit return Set a given as declared param name to declare return An empty string throws i Trust Exception public String declare String name throws i Trust Exception boolean match false for Visit Bean visit get Visited Ps if visit get Name to Lower Case compare To name to Lower Case match true Long mid Long value Of visit get if patient check Declared patient visit get declare Action declare mid to String visit set Designated true if match List Personnel Bean doclist doc get All Personnel for Personnel Bean ele doclist if name compare To ele get Full Name Visit Bean visit Bean visit Bean new Visit Bean visit Bean set ele get visit Bean set Name ele get Full Name visit Bean set Date visit Bean set Specialty ele get Specialty visit Bean set Addr ele get Street Address ele get Street Address ele get City ele get State ele get Zip visit Bean set Designated true Long mid Long value Of ele get if patient check Declared patient mid declare Action declare mid to String visits add visit Bean return Check to see if a given is declared param mid to check return true if the is declared otherwise false public boolean check Declared long mid throws Exception return patient check Declared patient mid Filter the list of Ps by last name specialty or zip code param doc Filter by last Name May be null or the empty string to ignore param specialty Filter by specialty May be null or the empty string to ignore param zip Filter by zip May be null or the empty string to ignore return Filtered list of Ps public List Visit Bean filter List String last Name String specialty String zip List Visit Bean visits try visits get All Visited Ps last Name specialty zip catch i Trust Exception ie visits new Array List Visit Bean return visits 
package edu ncsu csc itrust dao mysql import java sql Connection import java sql Prepared Statement import java sql Result Set import java sql Exception import java util Array List import java util List import edu ncsu csc itrust Util import edu ncsu csc itrust Date Util import edu ncsu csc itrust beans Visit Flag import edu ncsu csc itrust beans forms Visit Reminder Return Form import edu ncsu csc itrust beans loaders Visit Reminder Return Form Loader import edu ncsu csc itrust dao Factory import edu ncsu csc itrust exception Exception Used for queries related to patient reminders stands for Database Access Object All Os are intended to be reflections of the database that is one per table in the database most of the time For more complex sets of queries extra Os are added Os can assume that all data has been validated and is correct Os should never have setters or any other parameter to the constructor than a factory All Os should be accessed by Factory see link Factory and every should have a factory for obtaining connections and or accessing other Os author Andy public class Visit Reminders private Factory factory The typical constructor param factory The link Factory associated with this which is used for obtaining connections etc public Visit Reminders Factory factory this factory factory Returns a list of patients associated with a given param hcpid The of the in question return java util List of Visit Reminder Forms public List Visit Reminder Return Form get Patients long hcpid throws Exception Visit Reminder Return Form temp Visit Reminder Return Form Loader loader new Visit Reminder Return Form Loader List Visit Reminder Return Form patients new Array List Visit Reminder Return Form Connection conn null Prepared Statement ps null Result Set rs null try conn factory get Connection ps conn prepare Statement as hid dhcp patientid p last Name p first Name p phone p phone p phone Patients p declaredhcp dhcp dhcp hcpid p dhcp patientid p dateofdeath is null p dateofbirth ps set Long hcpid ps set Long hcpid rs ps execute Query while rs next temp loader load Single rs patients add temp catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps return patients Returns a list of patients who need a visit for this This means Alive patient no office visit for yr diagnosed Diabetes xx Asthma xx Circulatory System Disease param hcpid The of the in question return java util List of visit reminders public List Visit Reminder Return Form get Diagnosed Visit Needers long hcpid throws Exception Connection conn null Prepared Statement ps null Result Set rs null try conn factory get Connection ps conn prepare Statement hid last Name first Name phone phone phone Dcode visit Date as hid p as p last Name p first Name p phone p phone p phone ovd Dcode Patients p Office Visits ov Diagnosis ovd p ov Patient p Date Of Death is null ov ovd Visit ovd Code ovd Code ovd Code p p Patients p Office Visits ov p ov Patient ov visit Date a p ov visit Date as visit Date Patients p Office Visits ov p ov Patient p mid b last Name first Name Dcode ps set Long hcpid ps set Float f ps set Float f ps set Float f ps set Float f ps set Float f ps set Float f rs ps execute Query List Visit Reminder Return Form patients new Array List Visit Reminder Return Form Visit Reminder Return Form temp null Visit Reminder Return Form Loader loader new Visit Reminder Return Form Loader long last Id while rs next if last Id rs get Long patients get patients size add Visit Flag new Visit Flag Visit Flag rs get String else last Id rs get Long temp loader load Single rs temp add Visit Flag new Visit Flag Visit Flag rs get String temp add Visit Flag new Visit Flag Visit Flag rs get String patients add temp return patients catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps Returns a list of old people who need a flu shot Alive patient over years old no flu shot a during the months of current calendar year if in b during the months of last calendar year if not in Determines current date and calls one of two private methods these methods return different sets of people a people who have n t had a flu shot yet this year and need one b people who missed last year s flu shot and need a check up return java util List of Visit Reminder Forms param hcpid The of the in question param patient Birthday The birthday of the patient in question throws Exception public List Visit Reminder Return Form get Flu Shot Delinquents long hcpid throws Exception Connection conn null Prepared Statement ps null Result Set rs null Fall Bug Fix Use the correct range for a zero based calendar eg January is boolean this Year Date Util currently In Month Range String flag Type this Year Visit Flag Visit Flag java sql Date september new java sql Date l december new java sql Date l Date Util set Month Range september this Year december this Year try conn factory get Connection ps conn prepare Statement as hid p mid as patientid p lastname p firstname p phone p phone p phone Office Visits ov Patients p ov patientid p mid p mid ov patientid Office Visits ov p dateofdeath p dateofbirth p mid patientid mid Office Visits ov Procedure op ov id op visitid Code ov visitdate ov visitdate lastname firstname p mid ps conn prepare Statement as hid ov patientid p lastname p firstname p phone p phone p phone Office Visits ov Patients p ov patientid p mid p dateofdeath p dateofbirth patientid patientid Office Visits ov Medication om ov id om visitid Code Start Date End Date lastname firstname ov patientid ps set Long hcpid ps set Date september ps set Date december ps set Date september ps set Date december rs ps execute Query List Visit Reminder Return Form patients new Array List Visit Reminder Return Form Visit Reminder Return Form temp Visit Reminder Return Form Loader loader new Visit Reminder Return Form Loader while rs next temp loader load Single rs temp add Visit Flag new Visit Flag flag Type Flu Shot patients add temp return patients catch Exception e e print Stack Trace throw new Exception e finally Util close Connection conn ps 
