package org apache maven cli transfer Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io Print Stream import java text Decimal Format import java text Decimal Format Symbols import java util Locale import org apache commons lang Validate import org eclipse aether transfer Abstract Transfer Listener import org eclipse aether transfer Transfer Cancelled Exception import org eclipse aether transfer Transfer Event import org eclipse aether transfer Transfer Resource public abstract class Abstract Maven Transfer Listener extends Abstract Transfer Listener Line Length Formats file size with the associated a href https en wikipedia org wiki Metric prefix a prefix k and using the patterns code code for numbers between and and code code for numbers between and by default see a href https en wikipedia org wiki Metric prefix https en wikipedia org wiki Metric prefix a see a href https en wikipedia org wiki Binary prefix https en wikipedia org wiki Binary prefix a see a href https en wikipedia org wiki Octet computing https en wikipedia org wiki Octet computing a Line Length Move me to Maven Shared Utils static class File Size Format static enum Scale Unit Override public long bytes return Override public String symbol return Override public long bytes return Override public String symbol return k Override public long bytes return bytes bytes Override public String symbol return Override public long bytes return bytes bytes Override public String symbol return public abstract long bytes public abstract String symbol public static Scale Unit get Scale Unit long size Validate is True size file size can not be negative s size if size bytes return else if size bytes return else if size bytes return else return private Decimal Format small Format private Decimal Format large Format public File Size Format Locale locale small Format new Decimal Format new Decimal Format Symbols locale large Format new Decimal Format new Decimal Format Symbols locale public String format long size return format size null public String format long size Scale Unit unit return format size unit false public String format long size Scale Unit unit boolean omit Symbol Validate is True size file size can not be negative s size if unit null unit Scale Unit get Scale Unit size double scaled Size double size unit bytes String scaled Symbol unit symbol if omit Symbol scaled Symbol if unit Scale Unit return large Format format size scaled Symbol if scaled Size scaled Size return large Format format scaled Size scaled Symbol else return small Format format scaled Size scaled Symbol public String format Progress long progressed Size long size Validate is True progressed Size progressed file size can not be negative s progressed Size Validate is True size progressed Size size size progressed file size can not be greater than size s s progressed Size size if size progressed Size size Scale Unit unit Scale Unit get Scale Unit size String formatted Progressed Size format progressed Size unit true String formatted Size format size unit return formatted Progressed Size formatted Size else return format progressed Size protected Print Stream out protected Abstract Maven Transfer Listener Print Stream out this out out Override public void transfer Initiated Transfer Event event String action event get Request Type Transfer Event Request Type Uploading Downloading String direction event get Request Type Transfer Event Request Type to from Transfer Resource resource event get Resource String Builder message new String Builder message append action append append direction append append resource get Repository Id message append message append resource get Repository Url append resource get Resource Name out println message to String Override public void transfer Corrupted Transfer Event event throws Transfer Cancelled Exception Transfer Resource resource event get Resource This needs to be colorized out println event get Exception get Message from resource get Repository Id for resource get Repository Url resource get Resource Name Override public void transfer Succeeded Transfer Event event String action event get Request Type Transfer Event Request Type Uploaded Downloaded String direction event get Request Type Transfer Event Request Type to from Transfer Resource resource event get Resource long content Length event get Transferred Bytes File Size Format format new File Size Format Locale String Builder message new String Builder message append action append append direction append append resource get Repository Id message append message append resource get Repository Url append resource get Resource Name message append append format format content Length long duration System current Time Millis resource get Transfer Start Time if duration double bytes Per Second content Length duration message append at append format format long bytes Per Second append s message append out println message to String 
package org apache maven artifact resolver filter Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import org apache maven artifact Artifact Filter to only retain objects in the given artifact Scope or better author a href mailto brett apache org Brett Porter a abstract class Abstract Scope Artifact Filter implements Artifact Filter private boolean compile Scope private boolean runtime Scope private boolean test Scope private boolean provided Scope private boolean system Scope void add Scope Internal String scope if Artifact equals scope system Scope true provided Scope true compile Scope true else if Artifact equals scope compile Scope true runtime Scope true else if Artifact equals scope system Scope true provided Scope true compile Scope true runtime Scope true else if Artifact equals scope system Scope true compile Scope true runtime Scope true else if Artifact equals scope system Scope true provided Scope true compile Scope true runtime Scope true test Scope true public boolean include Artifact artifact if Artifact equals artifact get Scope return compile Scope else if Artifact equals artifact get Scope return runtime Scope else if Artifact equals artifact get Scope return test Scope else if Artifact equals artifact get Scope return provided Scope else if Artifact equals artifact get Scope return system Scope else return true 
package org apache maven model interpolation Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io File import java util Array List import java util Arrays import java util Collection import java util Hash Set import java util List import java util Properties import org apache maven model Model import org apache maven model building Model Building Request import org apache maven model building Model Problem Severity import org apache maven model building Model Problem Version import org apache maven model building Model Problem Collector import org apache maven model building Model Problem Collector Request import org apache maven model path Path Translator import org apache maven model path Url Normalizer import org codehaus plexus component annotations Requirement import org codehaus plexus interpolation Abstract Value Source import org codehaus plexus interpolation Interpolation Exception import org codehaus plexus interpolation Interpolation Post Processor import org codehaus plexus interpolation Interpolator import org codehaus plexus interpolation Map Based Value Source import org codehaus plexus interpolation Object Based Value Source import org codehaus plexus interpolation Prefix Aware Recursion Interceptor import org codehaus plexus interpolation Prefixed Object Value Source import org codehaus plexus interpolation Prefixed Value Source Wrapper import org codehaus plexus interpolation Recursion Interceptor import org codehaus plexus interpolation Value Source Use a regular expression search to find and resolve expressions within the author jdcasey Created on Feb public abstract class Abstract String Based Model Interpolator implements Model Interpolator public static final String sha public static final String changelist public static final String revision private static final List String Arrays as List pom project private static final Collection String static Collection String translated Prefixes new Hash Set If the build section is present and the project directory is non null we should make sure interpolation of the directories below uses translated paths Afterward we ll double back and translate any paths that were n t covered during interpolation via the code below translated Prefixes add build directory translated Prefixes add build output Directory translated Prefixes add build test Output Directory translated Prefixes add build source Directory translated Prefixes add build test Source Directory translated Prefixes add build script Source Directory translated Prefixes add reporting output Directory translated Prefixes Requirement private Path Translator path Translator Requirement private Url Normalizer url Normalizer private Interpolator interpolator private Recursion Interceptor recursion Interceptor public Abstract String Based Model Interpolator interpolator create Interpolator recursion Interceptor new Prefix Aware Recursion Interceptor public Abstract String Based Model Interpolator set Path Translator Path Translator path Translator this path Translator path Translator return this public Abstract String Based Model Interpolator set Url Normalizer Url Normalizer url Normalizer this url Normalizer url Normalizer return this protected List Value Source create Value Sources final Model model final File project Dir final Model Building Request config final Model Problem Collector problems Properties model Properties model get Properties Value Source model Value Source new Prefixed Object Value Source model false if config get Validation Level Model Building Request model Value Source new Problem Detecting Value Source model Value Source pom project problems Value Source model Value Source new Object Based Value Source model if config get Validation Level Model Building Request model Value Source new Problem Detecting Value Source model Value Source project problems Order counts here List Value Source value Sources new Array List if project Dir null Value Source basedir Value Source new Prefixed Value Source Wrapper new Abstract Value Source false Override public Object get Value String expression if basedir equals expression return project Dir get Absolute Path return null true value Sources add basedir Value Source Value Source base Uri Value Source new Prefixed Value Source Wrapper new Abstract Value Source false Override public Object get Value String expression if base Uri equals expression return project Dir get Absolute File to to String return null false value Sources add base Uri Value Source value Sources add new Build Timestamp Value Source config get Build Start Time model Properties value Sources add model Value Source value Sources add new Map Based Value Source config get User Properties Overwrite existing values in model properties Otherwise it s not possible to define the version via command line mvn Drevision if config get System Properties contains Key model Properties put config get System Properties get if config get System Properties contains Key model Properties put config get System Properties get if config get System Properties contains Key model Properties put config get System Properties get value Sources add new Map Based Value Source model Properties value Sources add new Map Based Value Source config get System Properties value Sources add new Abstract Value Source false Override public Object get Value String expression return config get System Properties get Property env expression value Sources add model Value Source return value Sources protected List extends Interpolation Post Processor create Post Processors final Model model final File project Dir final Model Building Request config List Interpolation Post Processor processors new Array List if project Dir null processors add new Path Translating Post Processor project Dir path Translator processors add new Url Normalizing Post Processor url Normalizer return processors protected String interpolate Internal String src List extends Value Source value Sources List extends Interpolation Post Processor post Processors Model Problem Collector problems if src contains return src String result src synchronized this for Value Source vs value Sources interpolator add Value Source vs for Interpolation Post Processor post Processor post Processors interpolator add Post Processor post Processor try try result interpolator interpolate result recursion Interceptor catch Interpolation Exception e problems add new Model Problem Collector Request Severity Version set Message e get Message set Exception e interpolator clear Feedback finally for Value Source vs value Sources interpolator remove Values Source vs for Interpolation Post Processor post Processor post Processors interpolator remove Post Processor post Processor return result protected Recursion Interceptor get Recursion Interceptor return recursion Interceptor protected void set Recursion Interceptor Recursion Interceptor recursion Interceptor this recursion Interceptor recursion Interceptor protected abstract Interpolator create Interpolator protected final Interpolator get Interpolator return interpolator 
package org apache maven artifact Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io File import java util Collection import java util List import java util regex Pattern import org apache maven artifact handler Artifact Handler import org apache maven artifact metadata Artifact Metadata import org apache maven artifact repository Artifact Repository import org apache maven artifact resolver filter Artifact Filter import org apache maven artifact versioning Artifact Version import org apache maven artifact versioning Over Constrained Version Exception import org apache maven artifact versioning Version Range Maven Artifact interface Notice that it mixes artifact definition concepts group Id artifact Id version with dependency information version range scope public interface Artifact extends Comparable Artifact String String String Pattern Pattern compile into artifact Scope handler String compile String compile runtime String test String runtime String runtime system String provided String system String import Used to import dependency Management dependencies String get Group Id String get Artifact Id String get Version void set Version String version String get Scope String get Type String get Classifier boolean has Classifier File get File void set File File destination String get Base Version void set Base Version String base Version String get Id String get Dependency Conflict Id void add Metadata Artifact Metadata metadata Collection Artifact Metadata get Metadata List void set Repository Artifact Repository remote Repository Artifact Repository get Repository void update Version String version Artifact Repository local Repository String get Download Url void set Download Url String download Url Artifact Filter get Dependency Filter void set Dependency Filter Artifact Filter artifact Filter Artifact Handler get Artifact Handler List String get Dependency Trail void set Dependency Trail List String dependency Trail void set Scope String scope Version Range get Version Range void set Version Range Version Range new Range void select Version String version void set Group Id String group Id void set Artifact Id String artifact Id boolean is Snapshot void set Resolved boolean resolved boolean is Resolved void set Resolved Version String version void set Artifact Handler Artifact Handler handler boolean is Release void set Release boolean release List Artifact Version get Available Versions void set Available Versions List Artifact Version versions boolean is Optional void set Optional boolean optional Artifact Version get Selected Version throws Over Constrained Version Exception boolean is Selected Version Known throws Over Constrained Version Exception 
package org apache maven artifact resolver Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util Array List import java util List import java util Map import java util Set import org apache maven artifact Artifact import org apache maven artifact repository Artifact Repository import org apache maven artifact repository Repository Cache import org apache maven artifact repository Repository Request import org apache maven artifact resolver filter Artifact Filter import org apache maven settings Mirror import org apache maven settings Proxy import org apache maven settings Server resolution request allows you to either use an existing Maven Project or a coordinate gid aid version to process a Ms dependencies author Jason van Zyl public class Artifact Resolution Request implements Repository Request private Artifact artifact Needs to go away These are really overrides now projects defining dependencies for a plugin that override what is specified in the plugin itself private Set Artifact artifact Dependencies private Artifact Repository local Repository private List Artifact Repository remote Repositories private Artifact Filter collection Filter private Artifact Filter resolution Filter Needs to go away private List Resolution Listener listeners new Array List This is like a filter but overrides all transitive versions private Map String Artifact managed Version Map private boolean resolve Root true private boolean resolve Transitively false private boolean offline private boolean force Update private List Server servers private List Mirror mirrors private List Proxy proxies public Artifact Resolution Request nothing here public Artifact Resolution Request Repository Request request set Local Repository request get Local Repository set Remote Repositories request get Remote Repositories set Offline request is Offline set Force Update request is Force Update public Artifact get Artifact return artifact public Artifact Resolution Request set Artifact Artifact artifact this artifact artifact return this public Artifact Resolution Request set Artifact Dependencies Set Artifact artifact Dependencies this artifact Dependencies artifact Dependencies return this public Set Artifact get Artifact Dependencies return artifact Dependencies public Artifact Repository get Local Repository return local Repository public Artifact Resolution Request set Local Repository Artifact Repository local Repository this local Repository local Repository return this public List Artifact Repository get Remote Repositories return remote Repositories public Artifact Resolution Request set Remote Repositories List Artifact Repository remote Repositories this remote Repositories remote Repositories return this Gets the artifact filter that controls traversal of the dependency graph return The filter used to determine which of the artifacts in the dependency graph should be traversed or code null to collect all transitive dependencies public Artifact Filter get Collection Filter return collection Filter public Artifact Resolution Request set Collection Filter Artifact Filter filter this collection Filter filter return this Gets the artifact filter that controls downloading of artifact files This filter operates on those artifacts that have been included by the link get Collection Filter return The filter used to determine which of the artifacts should have their files resolved or code null to resolve the files for all collected artifacts public Artifact Filter get Resolution Filter return resolution Filter public Artifact Resolution Request set Resolution Filter Artifact Filter filter this resolution Filter filter return this public List Resolution Listener get Listeners return listeners public Artifact Resolution Request set Listeners List Resolution Listener listeners this listeners listeners return this public Artifact Resolution Request add Listener Resolution Listener listener listeners add listener return this public Map String Artifact get Managed Version Map return managed Version Map public Artifact Resolution Request set Managed Version Map Map String Artifact managed Version Map this managed Version Map managed Version Map return this public Artifact Resolution Request set Resolve Root boolean resolve Root this resolve Root resolve Root return this public boolean is Resolve Root return resolve Root public Artifact Resolution Request set Resolve Transitively boolean resolve Dependencies this resolve Transitively resolve Dependencies return this public boolean is Resolve Transitively return resolve Transitively public String to String String Builder sb new String Builder append append n append artifact append artifact append n append artifact Dependencies append n append local Repository append local Repository append n append remote Repositories append remote Repositories append n return sb to String public boolean is Offline return offline public Artifact Resolution Request set Offline boolean offline this offline offline return this public boolean is Force Update return force Update public Artifact Resolution Request set Force Update boolean force Update this force Update force Update return this public Artifact Resolution Request set Servers List Server servers this servers servers return this public List Server get Servers if servers null servers new Array List return servers public Artifact Resolution Request set Mirrors List Mirror mirrors this mirrors mirrors return this public List Mirror get Mirrors if mirrors null mirrors new Array List return mirrors public Artifact Resolution Request set Proxies List Proxy proxies this proxies proxies return this public List Proxy get Proxies if proxies null proxies new Array List return proxies Used by Tycho and will break users and force them to upgrade to Maven so we should really leave this here possibly indefinitely public Artifact Resolution Request set Cache Repository Cache cache return this 
package org apache maven cli Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io Print Stream import java io Print Writer import org apache commons cli Command Line import org apache commons cli Command Line Parser import org apache commons cli Gnu Parser import org apache commons cli Help Formatter import org apache commons cli Option Builder import org apache commons cli Options import org apache commons cli Parse Exception author Jason van Zyl public class Manager public static final char f public static final char public static final char public static final char o public static final char q public static final char public static final char e public static final char h public static final char v public static final char public static final char public static final char public static final char public static final String nsu public static final char public static final char c public static final char s public static final String gs public static final char t public static final String gt public static final String ff public static final String fae public static final String fn public static final String rf public static final String pl public static final String am public static final String amd public static final String l public static final String emp public static final String ep public static final String public static final String llr public static final String b protected Options options Suppress Warnings static access checkstyle linelength public Manager options new Options options add Option Option Builder with Long Opt help with Description Display help information create options add Option Option Builder with Long Opt file has Arg with Description Force the use of an alternate file or directory with pom xml create options add Option Option Builder with Long Opt define has Arg with Description Define a system property create options add Option Option Builder with Long Opt offline with Description Work offline create options add Option Option Builder with Long Opt version with Description Display version information create options add Option Option Builder with Long Opt quiet with Description Quiet output only show errors create options add Option Option Builder with Long Opt debug with Description Produce execution debug output create options add Option Option Builder with Long Opt errors with Description Produce execution error messages create options add Option Option Builder with Long Opt non recursive with Description Do not recurse into sub projects create options add Option Option Builder with Long Opt update snapshots with Description Forces a check for missing releases and updated snapshots on remote repositories create options add Option Option Builder with Long Opt activate profiles with Description Comma delimited list of profiles to activate has Arg create options add Option Option Builder with Long Opt batch mode with Description Run in non interactive batch mode disables output color create options add Option Option Builder with Long Opt no snapshot updates with Description Suppress updates create options add Option Option Builder with Long Opt strict checksums with Description Fail the build if checksums do n t match create options add Option Option Builder with Long Opt lax checksums with Description Warn if checksums do n t match create options add Option Option Builder with Long Opt settings with Description Alternate path for the user settings file has Arg create options add Option Option Builder with Long Opt global settings with Description Alternate path for the global settings file has Arg create options add Option Option Builder with Long Opt toolchains with Description Alternate path for the user toolchains file has Arg create options add Option Option Builder with Long Opt global toolchains with Description Alternate path for the global toolchains file has Arg create options add Option Option Builder with Long Opt fail fast with Description Stop at first failure in reactorized builds create options add Option Option Builder with Long Opt fail at end with Description Only fail the build afterwards allow all non impacted builds to continue create options add Option Option Builder with Long Opt fail never with Description fail the build regardless of project result create options add Option Option Builder with Long Opt resume from has Arg with Description Resume reactor from specified project create options add Option Option Builder with Long Opt projects with Description Comma delimited list of specified reactor projects to build instead of all projects project can be specified by group Id artifact Id or by its relative path has Arg create options add Option Option Builder with Long Opt also make with Description If project list is specified also build projects required by the list create options add Option Option Builder with Long Opt also make dependents with Description If project list is specified also build projects that depend on projects on the list create options add Option Option Builder with Long Opt log file has Arg with Description Log file where all build output will go disables output color create options add Option Option Builder with Long Opt show version with Description Display version information stopping build create options add Option Option Builder with Long Opt encrypt master password has Optional Arg with Description Encrypt master security password create options add Option Option Builder with Long Opt encrypt password has Optional Arg with Description Encrypt server password create options add Option Option Builder with Long Opt threads has Arg with Description Thread count for instance where is core multiplied create options add Option Option Builder with Long Opt legacy local repository with Description Use Maven Legacy Local Repository behaviour ie no use of remote repositories Can also be activated by using Dmaven legacy Local Repo true create options add Option Option Builder with Long Opt builder has Arg with Description The id of the build strategy to use create Adding this back in for compatibility with the verifier that hard codes this option options add Option Option Builder with Long Opt no plugin registry with Description Ineffective only kept for backward compatibility create npr options add Option Option Builder with Long Opt check plugin updates with Description Ineffective only kept for backward compatibility create cpu options add Option Option Builder with Long Opt update plugins with Description Ineffective only kept for backward compatibility create up options add Option Option Builder with Long Opt no plugin updates with Description Ineffective only kept for backward compatibility create npu public Command Line parse String args throws Parse Exception We need to eat any quotes surrounding arguments String clean Args Clean Argument clean Args args Command Line Parser parser new Gnu Parser return parser parse options clean Args public void display Help Print Stream stdout stdout println Print Writer pw new Print Writer stdout Help Formatter formatter new Help Formatter formatter print Help pw Help Formatter mvn options goal s phase s n Options options Help Formatter Help Formatter n false pw flush 
package org apache maven cli Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import static org apache maven shared utils logging Message Utils buffer import java io Exception import java io Input Stream import java text Simple Date Format import java util Date import java util Locale import java util Properties import org apache commons lang String Utils import org codehaus plexus util Os import org slf j Logger Utility class used to report errors statistics application version info etc author jdcasey public final class Reporting Utils Magic Number public static final long private static final long private static final long private static final long private static final long Magic Number public static final String version public static String show Version final String ls System get Property line separator Properties properties get Build Properties String Builder version new String Builder version append buffer strong create Maven Version String properties append ls version append reduce properties get Property distribution Short Name home System get Property maven home unknown Maven home append ls version append Java version append System get Property java version unknown Java version append vendor append System get Property java vendor unknown vendor append ls version append Java home append System get Property java home unknown Java home append ls version append Default locale append Locale get Default append platform encoding append System get Property file encoding unknown encoding append ls version append name append Os append version append Os append arch append Os append family append Os append return version to String Create a human readable string containing the Maven version buildnumber and time of build param build Properties The build properties return Readable build info static String create Maven Version String Properties build Properties String timestamp reduce build Properties get Property timestamp String version reduce build Properties get Property String rev reduce build Properties get Property build Number String distribution Name reduce build Properties get Property distribution Name String msg distribution Name msg version null version version unknown if rev null timestamp null msg msg rev null rev if String Utils is Not Blank timestamp String ts format Timestamp Long value Of timestamp msg rev null ts msg return msg private static String reduce String s return s null s starts With s ends With null s null static Properties get Build Properties Properties properties new Properties try Input Stream resource As Stream Maven Cli class get Resource As Stream org apache maven messages build properties if resource As Stream null properties load resource As Stream catch Exception e System err println Unable determine version from file e get Message return properties public static void show Error Logger logger String message Throwable e boolean show Stack Trace if show Stack Trace logger error message e else logger error message if e null logger error e get Message for Throwable cause e get Cause cause null cause cause get Cause logger error Caused by cause get Message public static String format Timestamp long timestamp Simple Date Format sdf new Simple Date Format yyyy dd mm ss return sdf format new Date timestamp public static String format Duration long duration Magic Number long ms duration long s duration long m duration long h duration long d duration Magic Number String format if d Length chars format d d d d h else if h Length chars format d d h else if m Length chars format d d min else Length chars format d d s return String format format d h m s ms 
package org apache maven cli Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io File import java util Properties import org apache commons cli Command Line import org apache maven execution Default Maven Execution Request import org apache maven execution Maven Execution Request import org codehaus plexus classworlds Class World public class Cli Request String args Command Line command Line Class World class World String working Directory File multi Module Project Directory boolean debug boolean quiet boolean show Errors true Properties user Properties new Properties Properties system Properties new Properties Maven Execution Request request Cli Request String args Class World class World this args args this class World class World this request new Default Maven Execution Request public String get Args return args public Command Line get Command Line return command Line public Class World get Class World return class World public String get Working Directory return working Directory public File get Multi Module Project Directory return multi Module Project Directory public boolean is Debug return debug public boolean is Quiet return quiet public boolean is Show Errors return show Errors public Properties get User Properties return user Properties public Properties get System Properties return system Properties public Maven Execution Request get Request return request public void set User Properties Properties properties this user Properties put All properties 
package org apache maven artifact versioning Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java math Big Integer import java util Array List import java util Arrays import java util Iterator import java util List import java util Locale import java util Properties import java util Stack p Generic implementation of version comparison p Features ul li mixing of code code hyphen and code code dot separators li li transition between characters and digits also constitutes a separator code alpha gt alpha code li li unlimited number of version components li li version components in the text can be digits or strings li li strings are checked for well known qualifiers and the qualifier ordering is used for version ordering Well known qualifiers case insensitive are ul li code alpha code or code a code li li code beta code or code b code li li code milestone code or code m code li li code rc code or code cr code li li code snapshot code li li code the empty string code or code ga code or code final code li li code sp code li ul Unknown qualifiers are considered after known qualifiers with lexical order always case insensitive li li a hyphen usually precedes a qualifier and is always less important than something preceded with a dot li ul see a href https cwiki apache org confluence display Versioning Versioning on Maven Wiki a author a href mailto kenney apache org Kenney Westerhof a author a href mailto hboutemy apache org Herv Boutemy a public class Comparable Version implements Comparable Comparable Version private String value private String canonical private List Item items private interface Item int int int int compare To Item item int get Type boolean is Null Represents a numeric item in the version item list private static class Integer Item implements Item private static final Big Integer new Big Integer private final Big Integer value public static final Integer Item new Integer Item private Integer Item this value public Integer Item String str this value new Big Integer str public int get Type return public boolean is Null return equals value public int compare To Item item if item null return equals value switch item get Type case return value compare To Integer Item item value case return sp case return default throw new Runtime Exception invalid item item get Class public String to String return value to String Represents a string in the version item list usually a qualifier private static class String Item implements Item private static final String alpha beta milestone rc snapshot sp Suppress Warnings checkstyle constantname private static final List String Arrays as List private static final Properties new Properties static put ga put final put cr rc comparable value for the empty string qualifier This one is used to determine if a given qualifier makes the version older than one without a qualifier or more recent private static final String String value Of index Of private String value public String Item String value boolean followed By Digit if followed By Digit value length a alpha b beta m milestone switch value char At case a value alpha break case b value beta break case m value milestone break default this value get Property value value public int get Type return public boolean is Null return comparable Qualifier value compare To Returns a comparable value for a qualifier This method takes into account the ordering of known qualifiers then unknown qualifiers with lexical ordering just returning an Integer with the index here is faster but requires a lot of if then else to check for or size and then resort to lexical ordering Most comparisons are decided by the first character so this is still fast If more characters are needed then it requires a lexical sort anyway param qualifier return an equivalent value that can be used with lexical comparison public static String comparable Qualifier String qualifier int i index Of qualifier return i size qualifier String value Of i public int compare To Item item if item null rc ga return comparable Qualifier value compare To switch item get Type case return any case return comparable Qualifier value compare To comparable Qualifier String Item item value case return any default throw new Runtime Exception invalid item item get Class public String to String return value Represents a version list item This class is used both for the global item list and for sub lists which start with number in the version specification private static class List Item extends Array List Item implements Item public int get Type return public boolean is Null return size void normalize for int i size i i Item last Item get i if last Item is Null remove null trailing items empty list remove i else if last Item instanceof List Item break public int compare To Item item if item null if size return normalize Item first get return first compare To null switch item get Type case return x case return sp case Iterator Item left iterator Iterator Item right List Item item iterator while left has Next right has Next Item l left has Next left next null Item r right has Next right next null if this is shorter then invert the compare and mul with int result l null r null r compare To l l compare To r if result return result return default throw new Runtime Exception invalid item item get Class public String to String String Builder buffer new String Builder for Item item this if buffer length buffer append item instanceof List Item buffer append item return buffer to String public Comparable Version String version parse Version version public final void parse Version String version this value version items new List Item version version to Lower Case Locale List Item list items Stack Item stack new Stack stack push list boolean is Digit false int start Index for int i i version length i char c version char At i if c if i start Index list add Integer Item else list add parse Item is Digit version substring start Index i start Index i else if c if i start Index list add Integer Item else list add parse Item is Digit version substring start Index i start Index i list add list new List Item stack push list else if Character is Digit c if is Digit i start Index list add new String Item version substring start Index i true start Index i list add list new List Item stack push list is Digit true else if is Digit i start Index list add parse Item true version substring start Index i start Index i list add list new List Item stack push list is Digit false if version length start Index list add parse Item is Digit version substring start Index while stack is Empty list List Item stack pop list normalize canonical items to String private static Item parse Item boolean is Digit String buf return is Digit new Integer Item buf new String Item buf false public int compare To Comparable Version o return items compare To o items public String to String return value public String get Canonical return canonical public boolean equals Object o return o instanceof Comparable Version canonical equals Comparable Version o canonical public int hash Code return canonical hash Code Line Length Main to test version parsing and comparison p To check how compares to for example you can issue pre java jar maven repo local org apache maven maven artifact maven version maven artifact maven version jar pre command to command line Result of given command will be something like this pre Display parameters as parsed by Maven in canonical form and comparison result gt snapshot pre param args the version strings to parse and compare You can pass arbitrary number of version strings and always two adjacent will be compared Line Length public static void main String args System out println Display parameters as parsed by Maven in canonical form and comparison result if args length return Comparable Version prev null int i for String version args Comparable Version c new Comparable Version version if prev null int compare prev compare To c System out println prev to String compare compare version System out println String value Of i version c get Canonical prev c 
package org apache maven cli transfer Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io Print Stream import java util Collections import java util Iterator import java util Linked Hash Map import java util Locale import java util Map import org apache commons lang String Utils import org eclipse aether transfer Transfer Cancelled Exception import org eclipse aether transfer Transfer Event import org eclipse aether transfer Transfer Resource Console download progress meter author a href mailto brett apache org Brett Porter a public class Console Maven Transfer Listener extends Abstract Maven Transfer Listener private Map Transfer Resource Long transfers Collections synchronized Map new Linked Hash Map Transfer Resource Long private boolean print Resource Names private int last Length public Console Maven Transfer Listener Print Stream out boolean print Resource Names super out this print Resource Names print Resource Names Override public synchronized void transfer Initiated Transfer Event event override Previous Transfer event super transfer Initiated event Override public synchronized void transfer Corrupted Transfer Event event throws Transfer Cancelled Exception override Previous Transfer event super transfer Corrupted event Override public synchronized void transfer Progressed Transfer Event event throws Transfer Cancelled Exception Transfer Resource resource event get Resource transfers put resource event get Transferred Bytes String Builder buffer new String Builder buffer append Progress append transfers size append synchronized transfers Iterator Map Entry Transfer Resource Long entries transfers entry Set iterator while entries has Next Map Entry Transfer Resource Long entry entries next long total entry get Key get Content Length Long complete entry get Value buffer append get Status entry get Key get Resource Name complete total if entries has Next buffer append int pad last Length buffer length last Length buffer length pad buffer pad buffer append r out print buffer out flush private String get Status String resource Name long complete long total File Size Format format new File Size Format Locale String Builder status new String Builder if print Resource Names status append String Utils substring After Last resource Name status append status append format format Progress complete total if print Resource Names status append return status to String private void pad String Builder buffer int spaces String block while spaces int n Math min spaces block length buffer append block n spaces n Override public synchronized void transfer Succeeded Transfer Event event transfers remove event get Resource override Previous Transfer event super transfer Succeeded event Override public synchronized void transfer Failed Transfer Event event transfers remove event get Resource override Previous Transfer event super transfer Failed event private void override Previous Transfer Transfer Event event if last Length String Builder buffer new String Builder pad buffer last Length buffer append r out print buffer out flush last Length 
package org apache maven artifact resolver filter Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util Collection import java util Hash Set import java util Set Filter to only retain objects in the given scope or better This implementation allows the accumulation of multiple scopes and their associated implied scopes so that the user can filter apply a series of implication rules in a single step This should be a more efficient implementation of multiple standard link Scope Artifact Filter instances Red together author a href mailto brett apache org Brett Porter a author jdcasey public class Cumulative Scope Artifact Filter extends Abstract Scope Artifact Filter private Set String scopes Create a new filter with the specified scopes and their implied scopes enabled param scopes The scopes to enable along with all implied scopes may be code null public Cumulative Scope Artifact Filter Collection String scopes this scopes new Hash Set add Scopes scopes Creates a new filter that combines the specified filters param filters The filters to combine may be code null public Cumulative Scope Artifact Filter Cumulative Scope Artifact Filter filters this scopes new Hash Set if filters null for Cumulative Scope Artifact Filter filter filters add Scopes filter get Scopes private void add Scopes Collection String scopes if scopes null for String scope scopes add Scope scope private void add Scope String scope this scopes add scope add Scope Internal scope public Set String get Scopes return scopes Override public int hash Code int hash hash hash scopes hash Code return hash Override public boolean equals Object obj if this obj return true if obj instanceof Cumulative Scope Artifact Filter return false Cumulative Scope Artifact Filter that Cumulative Scope Artifact Filter obj return scopes equals that scopes 
package org apache maven artifact Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io File import java util Collection import java util Collections import java util Hash Map import java util List import java util Map import java util regex Matcher import org apache maven artifact handler Artifact Handler import org apache maven artifact metadata Artifact Metadata import org apache maven artifact repository Artifact Repository import org apache maven artifact resolver filter Artifact Filter import org apache maven artifact versioning Artifact Version import org apache maven artifact versioning Default Artifact Version import org apache maven artifact versioning Over Constrained Version Exception import org apache maven artifact versioning Version Range import org codehaus plexus util String Utils author Jason van Zyl public class Default Artifact implements Artifact private String group Id private String artifact Id private String base Version private final String type private final String classifier private volatile String scope private volatile File file private Artifact Repository repository private String download Url private Artifact Filter dependency Filter private Artifact Handler artifact Handler private List String dependency Trail private volatile String version private Version Range version Range private volatile boolean resolved private boolean release private List Artifact Version available Versions private Map Object Artifact Metadata metadata Map private boolean optional public Default Artifact String group Id String artifact Id String version String scope String type String classifier Artifact Handler artifact Handler this group Id artifact Id Version Range create From Version version scope type classifier artifact Handler false public Default Artifact String group Id String artifact Id Version Range version Range String scope String type String classifier Artifact Handler artifact Handler this group Id artifact Id version Range scope type classifier artifact Handler false public Default Artifact String group Id String artifact Id Version Range version Range String scope String type String classifier Artifact Handler artifact Handler boolean optional this group Id group Id this artifact Id artifact Id this version Range version Range select Version From New Range If Available this artifact Handler artifact Handler this scope scope this type type if classifier null classifier artifact Handler get Classifier this classifier classifier this optional optional validate Identity private void validate Identity if empty group Id throw new Invalid Artifact Exception group Id artifact Id get Version type The group Id can not be empty if artifact Id null throw new Invalid Artifact Exception group Id artifact Id get Version type The artifact Id can not be empty if type null throw new Invalid Artifact Exception group Id artifact Id get Version type The type can not be empty if version null version Range null throw new Invalid Artifact Exception group Id artifact Id get Version type The version can not be empty private boolean empty String value return value null value trim length public String get Classifier return classifier public boolean has Classifier return String Utils is Not Empty classifier public String get Scope return scope public String get Group Id return group Id public String get Artifact Id return artifact Id public String get Version return version public void set Version String version this version version set Base Version Internal version version Range null public String get Type return type public void set File File file this file file public File get File return file public Artifact Repository get Repository return repository public void set Repository Artifact Repository repository this repository repository public String get Id return get Dependency Conflict Id get Base Version public String get Dependency Conflict Id String Builder sb new String Builder sb append get Group Id sb append append Artifact Type Classifier String sb return sb to String private void append Artifact Type Classifier String String Builder sb sb append get Artifact Id sb append sb append get Type if has Classifier sb append sb append get Classifier public void add Metadata Artifact Metadata metadata if metadata Map null metadata Map new Hash Map Artifact Metadata m metadata Map get metadata get Key if m null m merge metadata else metadata Map put metadata get Key metadata public Collection Artifact Metadata get Metadata List if metadata Map null return Collections empty List return metadata Map values Object overrides public String to String String Builder sb new String Builder if get Group Id null sb append get Group Id sb append append Artifact Type Classifier String sb sb append if get Base Version Internal null sb append get Base Version Internal else sb append version Range to String if scope null sb append sb append scope return sb to String public int hash Code int result result result group Id hash Code result result artifact Id hash Code result result type hash Code if version null result result version hash Code result result classifier null classifier hash Code return result public boolean equals Object o if o this return true if o instanceof Artifact return false Artifact a Artifact o if a get Group Id equals group Id return false else if a get Artifact Id equals artifact Id return false else if a get Version equals version return false else if a get Type equals type return false else if a get Classifier null classifier null a get Classifier equals classifier return false We do n t consider the version range in the comparison just the resolved version return true public String get Base Version if base Version null version null set Base Version Internal version return base Version protected String get Base Version Internal if base Version null version null set Base Version Internal version return base Version public void set Base Version String base Version set Base Version Internal base Version protected void set Base Version Internal String base Version Matcher m matcher base Version if m matches this base Version m group else this base Version base Version public int compare To Artifact a int result group Id compare To a get Group Id if result result artifact Id compare To a get Artifact Id if result result type compare To a get Type if result if classifier null if a get Classifier null result else if a get Classifier null result classifier compare To a get Classifier else result if result We do n t consider the version range in the comparison just the resolved version result new Default Artifact Version version compare To new Default Artifact Version a get Version return result public void update Version String version Artifact Repository local Repository set Resolved Version version set File new File local Repository get Basedir local Repository path Of this public String get Download Url return download Url public void set Download Url String download Url this download Url download Url public Artifact Filter get Dependency Filter return dependency Filter public void set Dependency Filter Artifact Filter artifact Filter dependency Filter artifact Filter public Artifact Handler get Artifact Handler return artifact Handler public List String get Dependency Trail return dependency Trail public void set Dependency Trail List String dependency Trail this dependency Trail dependency Trail public void set Scope String scope this scope scope public Version Range get Version Range return version Range public void set Version Range Version Range version Range this version Range version Range select Version From New Range If Available private void select Version From New Range If Available if version Range null version Range get Recommended Version null select Version version Range get Recommended Version to String else version null base Version null public void select Version String version this version version set Base Version Internal version public void set Group Id String group Id this group Id group Id public void set Artifact Id String artifact Id this artifact Id artifact Id public boolean is Snapshot return get Base Version null get Base Version ends With get Base Version equals public void set Resolved boolean resolved this resolved resolved public boolean is Resolved return resolved public void set Resolved Version String version this version version retain base Version public void set Artifact Handler Artifact Handler artifact Handler this artifact Handler artifact Handler public void set Release boolean release this release release public boolean is Release return release public List Artifact Version get Available Versions return available Versions public void set Available Versions List Artifact Version available Versions this available Versions available Versions public boolean is Optional return optional public Artifact Version get Selected Version throws Over Constrained Version Exception return version Range get Selected Version this public boolean is Selected Version Known throws Over Constrained Version Exception return version Range is Selected Version Known this public void set Optional boolean optional this optional optional 
package org apache maven artifact resolver Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import org codehaus plexus component annotations Component Deprecated Component role Artifact Collector class public class Default Artifact Collector extends org apache maven repository legacy resolver Default Legacy Artifact Collector implements Artifact Collector 
package org apache maven artifact factory Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import org apache maven artifact Artifact import org apache maven artifact Default Artifact import org apache maven artifact handler Artifact Handler import org apache maven artifact handler manager Artifact Handler Manager import org apache maven artifact versioning Version Range import org codehaus plexus component annotations Component import org codehaus plexus component annotations Requirement Component role Artifact Factory class public class Default Artifact Factory implements Artifact Factory Requirement private Artifact Handler Manager artifact Handler Manager public Artifact create Artifact String group Id String artifact Id String version String scope String type return create Artifact group Id artifact Id version scope type null null public Artifact create Artifact With Classifier String group Id String artifact Id String version String type String classifier return create Artifact group Id artifact Id version null type classifier null public Artifact create Dependency Artifact String group Id String artifact Id Version Range version Range String type String classifier String scope return create Artifact group Id artifact Id version Range type classifier scope null public Artifact create Dependency Artifact String group Id String artifact Id Version Range version Range String type String classifier String scope boolean optional return create Artifact group Id artifact Id version Range type classifier scope null optional public Artifact create Dependency Artifact String group Id String artifact Id Version Range version Range String type String classifier String scope String inherited Scope return create Artifact group Id artifact Id version Range type classifier scope inherited Scope public Artifact create Dependency Artifact String group Id String artifact Id Version Range version Range String type String classifier String scope String inherited Scope boolean optional return create Artifact group Id artifact Id version Range type classifier scope inherited Scope optional public Artifact create Build Artifact String group Id String artifact Id String version String packaging return create Artifact group Id artifact Id version null packaging null null public Artifact create Project Artifact String group Id String artifact Id String version return create Project Artifact group Id artifact Id version null public Artifact create Parent Artifact String group Id String artifact Id String version return create Project Artifact group Id artifact Id version public Artifact create Plugin Artifact String group Id String artifact Id Version Range version Range return create Artifact group Id artifact Id version Range maven plugin null Artifact null public Artifact create Project Artifact String group Id String artifact Id String version String scope return create Artifact group Id artifact Id version scope pom public Artifact create Extension Artifact String group Id String artifact Id Version Range version Range return create Artifact group Id artifact Id version Range jar null Artifact null private Artifact create Artifact String group Id String artifact Id String version String scope String type String classifier String inherited Scope Version Range version Range null if version null version Range Version Range create From Version version return create Artifact group Id artifact Id version Range type classifier scope inherited Scope private Artifact create Artifact String group Id String artifact Id Version Range version Range String type String classifier String scope String inherited Scope return create Artifact group Id artifact Id version Range type classifier scope inherited Scope false private Artifact create Artifact String group Id String artifact Id Version Range version Range String type String classifier String scope String inherited Scope boolean optional String desired Scope Artifact if inherited Scope null desired Scope scope else if Artifact equals scope Artifact equals scope return null else if Artifact equals scope Artifact equals inherited Scope added to retain compile artifact Scope Remove if you want compile inherited as runtime desired Scope Artifact if Artifact equals inherited Scope desired Scope Artifact if Artifact equals inherited Scope desired Scope Artifact if Artifact equals scope system scopes come through unchanged desired Scope Artifact Artifact Handler handler artifact Handler Manager get Artifact Handler type return new Default Artifact group Id artifact Id version Range desired Scope type classifier handler optional 
package org apache maven artifact repository Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util Arrays import java util List import org apache maven artifact Unknown Repository Layout Exception import org apache maven artifact repository layout Artifact Repository Layout import org apache maven plugin Legacy Support import org apache maven repository Repository System import org codehaus plexus component annotations Component import org codehaus plexus component annotations Requirement import org eclipse aether Repository System Session author jdcasey Component role Artifact Repository Factory class public class Default Artifact Repository Factory implements Artifact Repository Factory Requirement private org apache maven repository legacy repository Artifact Repository Factory factory Requirement private Legacy Support legacy Support Requirement private Repository System repository System public Artifact Repository Layout get Layout String layout Id throws Unknown Repository Layout Exception return factory get Layout layout Id public Artifact Repository create Deployment Artifact Repository String id String url String layout Id boolean unique Version throws Unknown Repository Layout Exception return inject Session factory create Deployment Artifact Repository id url layout Id unique Version false public Artifact Repository create Deployment Artifact Repository String id String url Artifact Repository Layout repository Layout boolean unique Version return inject Session factory create Deployment Artifact Repository id url repository Layout unique Version false public Artifact Repository create Artifact Repository String id String url String layout Id Artifact Repository Policy snapshots Artifact Repository Policy releases throws Unknown Repository Layout Exception return inject Session factory create Artifact Repository id url layout Id snapshots releases true public Artifact Repository create Artifact Repository String id String url Artifact Repository Layout repository Layout Artifact Repository Policy snapshots Artifact Repository Policy releases return inject Session factory create Artifact Repository id url repository Layout snapshots releases true public void set Global Update Policy String update Policy factory set Global Update Policy update Policy public void set Global Checksum Policy String checksum Policy factory set Global Checksum Policy checksum Policy private Artifact Repository inject Session Artifact Repository repository boolean mirrors Repository System Session session legacy Support get Repository Session if session null repository null is Local Repository repository List Artifact Repository repositories Arrays as List repository if mirrors repository System inject Mirror session repositories repository System inject Proxy session repositories repository System inject Authentication session repositories return repository private boolean is Local Repository Artifact Repository repository unfortunately the does n t allow to tell a remote repo and the local repo apart return local equals repository get Id 
package org apache maven artifact resolver Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io File import java util Array List import java util Collections import java util Linked Hash Map import java util Linked Hash Set import java util List import java util Map import java util Set import java util concurrent Count Down Latch import java util concurrent Executor import java util concurrent Executor Service import java util concurrent Linked Blocking Queue import java util concurrent Thread Factory import java util concurrent Thread Pool Executor import java util concurrent Time Unit import java util concurrent atomic Atomic Integer import java util regex Matcher import org apache maven Repository Utils import org apache maven artifact Artifact import org apache maven artifact factory Artifact Factory import org apache maven artifact metadata Artifact Metadata Retrieval Exception import org apache maven artifact metadata Artifact Metadata Source import org apache maven artifact metadata Resolution Group import org apache maven artifact repository Artifact Repository import org apache maven artifact repository Legacy Local Repository Manager import org apache maven artifact repository Repository Request import org apache maven artifact repository metadata Snapshot import org apache maven artifact repository metadata Snapshot Artifact Repository Metadata import org apache maven artifact resolver filter Artifact Filter import org apache maven execution Maven Session import org apache maven plugin Legacy Support import org apache maven repository legacy metadata Default Metadata Resolution Request import org apache maven repository legacy metadata Metadata Resolution Request import org apache maven repository legacy resolver conflict Conflict Resolver import org apache maven wagon events Transfer Listener import org codehaus plexus Plexus Container import org codehaus plexus component annotations Component import org codehaus plexus component annotations Requirement import org codehaus plexus component repository exception Component Lookup Exception import org codehaus plexus logging Logger import org codehaus plexus personality plexus lifecycle phase Disposable import org eclipse aether Repository System import org eclipse aether Repository System Session import org eclipse aether repository Local Repository Manager import org eclipse aether resolution Artifact Request import org eclipse aether resolution Artifact Result author Jason van Zyl Component role Artifact Resolver class public class Default Artifact Resolver implements Artifact Resolver Disposable Requirement private Logger logger Requirement protected Artifact Factory artifact Factory Requirement private Artifact Collector artifact Collector Requirement private Resolution Error Handler resolution Error Handler Requirement private Artifact Metadata Source source Requirement private Plexus Container container Requirement private Legacy Support legacy Support Requirement private Repository System repo System private final Executor executor public Default Artifact Resolver int threads Integer get Integer maven artifact threads if threads executor new Executor public void execute Runnable command command run else executor new Thread Pool Executor threads threads Time Unit new Linked Blocking Queue Runnable new Daemon Thread Creator private Repository System Session get Session Artifact Repository local Repository return Legacy Local Repository Manager overlay local Repository legacy Support get Repository Session repo System private void inject Session Repository Request request Maven Session session if session null request set Offline session is Offline request set Force Update session get Request is Update Snapshots private void inject Session Artifact Resolution Request request Maven Session session inject Session request session if session null request set Servers session get Request get Servers request set Mirrors session get Request get Mirrors request set Proxies session get Request get Proxies public void resolve Artifact artifact List Artifact Repository remote Repositories Artifact Repository local Repository Transfer Listener resolution Listener throws Artifact Resolution Exception Artifact Not Found Exception resolve artifact remote Repositories get Session local Repository public void resolve Always Artifact artifact List Artifact Repository remote Repositories Artifact Repository local Repository throws Artifact Resolution Exception Artifact Not Found Exception resolve artifact remote Repositories get Session local Repository private void resolve Artifact artifact List Artifact Repository remote Repositories Repository System Session session throws Artifact Resolution Exception Artifact Not Found Exception if artifact null return if Artifact equals artifact get Scope File system File artifact get File if system File null throw new Artifact Not Found Exception System artifact artifact has no file attached artifact if system File exists throw new Artifact Not Found Exception System artifact artifact not found in path system File artifact if system File is File throw new Artifact Not Found Exception System artifact artifact is not a file system File artifact artifact set Resolved true return if artifact is Resolved Artifact Result result try Artifact Request artifact Request new Artifact Request artifact Request set Artifact Repository Utils to Artifact artifact artifact Request set Repositories Repository Utils to Repos remote Repositories Maven x quirk an artifact always points at the local repo regardless whether resolved or not Local Repository Manager lrm session get Local Repository Manager String path lrm get Path For Local Artifact artifact Request get Artifact artifact set File new File lrm get Repository get Basedir path result repo System resolve Artifact session artifact Request catch org eclipse aether resolution Artifact Resolution Exception e if e get Cause instanceof org eclipse aether transfer Artifact Not Found Exception throw new Artifact Not Found Exception e get Message artifact remote Repositories e else throw new Artifact Resolution Exception e get Message artifact remote Repositories e artifact select Version result get Artifact get Version artifact set File result get Artifact get File artifact set Resolved true if artifact is Snapshot Matcher matcher Artifact matcher artifact get Version if matcher matches Snapshot snapshot new Snapshot snapshot set Timestamp matcher group try snapshot set Build Number Integer parse Int matcher group artifact add Metadata new Snapshot Artifact Repository Metadata artifact snapshot catch Number Format Exception e logger warn Invalid artifact version artifact get Version e get Message public Artifact Resolution Result resolve Transitively Set Artifact artifacts Artifact originating Artifact Artifact Repository local Repository List Artifact Repository remote Repositories Artifact Metadata Source source Artifact Filter filter throws Artifact Resolution Exception Artifact Not Found Exception return resolve Transitively artifacts originating Artifact Collections String Artifact empty Map local Repository remote Repositories source filter public Artifact Resolution Result resolve Transitively Set Artifact artifacts Artifact originating Artifact Map String Artifact managed Versions Artifact Repository local Repository List Artifact Repository remote Repositories Artifact Metadata Source source throws Artifact Resolution Exception Artifact Not Found Exception return resolve Transitively artifacts originating Artifact managed Versions local Repository remote Repositories source null public Artifact Resolution Result resolve Transitively Set Artifact artifacts Artifact originating Artifact Map String Artifact managed Versions Artifact Repository local Repository List Artifact Repository remote Repositories Artifact Metadata Source source Artifact Filter filter throws Artifact Resolution Exception Artifact Not Found Exception return resolve Transitively artifacts originating Artifact managed Versions local Repository remote Repositories source filter null public Artifact Resolution Result resolve Transitively Set Artifact artifacts Artifact originating Artifact List Artifact Repository remote Repositories Artifact Repository local Repository Artifact Metadata Source source throws Artifact Resolution Exception Artifact Not Found Exception return resolve Transitively artifacts originating Artifact local Repository remote Repositories source null public Artifact Resolution Result resolve Transitively Set Artifact artifacts Artifact originating Artifact List Artifact Repository remote Repositories Artifact Repository local Repository Artifact Metadata Source source List Resolution Listener listeners throws Artifact Resolution Exception Artifact Not Found Exception return resolve Transitively artifacts originating Artifact Collections String Artifact empty Map local Repository remote Repositories source null listeners public Artifact Resolution Result resolve Transitively Set Artifact artifacts Artifact originating Artifact Map String Artifact managed Versions Artifact Repository local Repository List Artifact Repository remote Repositories Artifact Metadata Source source Artifact Filter filter List Resolution Listener listeners throws Artifact Resolution Exception Artifact Not Found Exception return resolve Transitively artifacts originating Artifact managed Versions local Repository remote Repositories source filter listeners null public Artifact Resolution Result resolve Transitively Set Artifact artifacts Artifact originating Artifact Map String Artifact managed Versions Artifact Repository local Repository List Artifact Repository remote Repositories Artifact Metadata Source source Artifact Filter filter List Resolution Listener listeners List Conflict Resolver conflict Resolvers throws Artifact Resolution Exception Artifact Not Found Exception Artifact Resolution Request request new Artifact Resolution Request set Artifact originating Artifact set Resolve Root false This is required by the surefire plugin set Artifact Dependencies artifacts set Managed Version Map managed Versions set Local Repository local Repository set Remote Repositories remote Repositories set Collection Filter filter set Listeners listeners inject Session request legacy Support get Session return resolve With Exceptions request public Artifact Resolution Result resolve With Exceptions Artifact Resolution Request request throws Artifact Resolution Exception Artifact Not Found Exception Artifact Resolution Result result resolve request We have collected all the problems so let s mimic the way the old code worked and just blow up right here That s right lets just let it rip right here and send a big incomprehensible blob of text at unsuspecting users Bad dog resolution Error Handler throw Errors request result return result public Artifact Resolution Result resolve Artifact Resolution Request request Artifact root Artifact request get Artifact Set Artifact artifacts request get Artifact Dependencies Map String Artifact managed Versions request get Managed Version Map List Resolution Listener listeners request get Listeners Artifact Filter collection Filter request get Collection Filter Artifact Filter resolution Filter request get Resolution Filter Repository System Session session get Session request get Local Repository hack because metadata is n t generated in m e correctly and i want to run the maven i have in the workspace if source null try source container lookup Artifact Metadata Source class catch Component Lookup Exception e wo n t happen if listeners null listeners new Array List if logger is Debug Enabled listeners add new Debug Resolution Listener logger listeners add new Warning Resolution Listener logger Artifact Resolution Result result new Artifact Resolution Result The root artifact may or may not be resolved so we need to check before we attempt to resolve This is often an artifact like a that is taken from disk and we already have hold of the file reference But this may be a Maven Plugin that we need to resolve from a remote repository as well as its dependencies if request is Resolve Root root Artifact get File null try resolve root Artifact request get Remote Repositories session catch Artifact Resolution Exception e result add Error Artifact Exception e return result catch Artifact Not Found Exception e result add Missing Artifact request get Artifact return result Artifact Resolution Request collection Request request if request is Resolve Transitively Metadata Resolution Request metadata Request new Default Metadata Resolution Request request metadata Request set Artifact root Artifact metadata Request set Resolve Managed Versions managed Versions null try Resolution Group resolution Group source retrieve metadata Request if managed Versions null managed Versions resolution Group get Managed Versions Set Artifact direct Artifacts resolution Group get Artifacts if artifacts null artifacts is Empty artifacts direct Artifacts else List Artifact all Artifacts new Array List all Artifacts add All artifacts all Artifacts add All direct Artifacts Map String Artifact merged Artifacts new Linked Hash Map for Artifact artifact all Artifacts String conflict Id artifact get Dependency Conflict Id if merged Artifacts contains Key conflict Id merged Artifacts put conflict Id artifact artifacts new Linked Hash Set merged Artifacts values collection Request new Artifact Resolution Request request collection Request set Servers request get Servers collection Request set Mirrors request get Mirrors collection Request set Proxies request get Proxies collection Request set Remote Repositories resolution Group get Resolution Repositories catch Artifact Metadata Retrieval Exception e Artifact Resolution Exception are new Artifact Resolution Exception Unable to get dependency information for root Artifact get Id e get Message root Artifact metadata Request get Remote Repositories e result add Metadata Resolution Exception are return result if artifacts null artifacts is Empty if request is Resolve Root result add Artifact root Artifact return result After the collection we will have the artifact object in the result but they will not be resolved yet result artifact Collector collect artifacts root Artifact managed Versions collection Request source collection Filter listeners null We have metadata retrieval problems or there are cycles that have been detected so we give this back to the calling code and let them deal with this information appropriately if result has Metadata Resolution Exceptions result has Version Range Violations result has Circular Dependency Exceptions logger info Failure detected return result if result get Artifact Resolution Nodes null Class Loader class Loader Thread current Thread get Context Class Loader Count Down Latch latch new Count Down Latch result get Artifact Resolution Nodes size for Resolution Node node result get Artifact Resolution Nodes Artifact artifact node get Artifact if resolution Filter null resolution Filter include artifact executor execute new Resolve Task class Loader latch artifact session node get Remote Repositories result else latch count Down try latch await catch Interrupted Exception e result add Error Artifact Exception new Artifact Resolution Exception Resolution interrupted root Artifact e We want to send the root artifact back in the result but we need to do this after the other dependencies have been resolved if request is Resolve Root Add the root artifact as the first artifact to retain logical order of class path Set Artifact all Artifacts new Linked Hash Set all Artifacts add root Artifact all Artifacts add All result get Artifacts result set Artifacts all Artifacts return result public void resolve Artifact artifact List Artifact Repository remote Repositories Artifact Repository local Repository throws Artifact Resolution Exception Artifact Not Found Exception resolve artifact remote Repositories local Repository null Thread Creator for creating daemon threads with fixed Thread Group name static final class Daemon Thread Creator implements Thread Factory static final String org apache maven artifact resolver Default Artifact Resolver static final Thread Group new Thread Group static final Atomic Integer new Atomic Integer public Thread new Thread Runnable r Thread new Thread new Thread r resolver get And Increment new Thread set Daemon true new Thread set Context Class Loader null return new Thread private class Resolve Task implements Runnable private final Class Loader class Loader private final Count Down Latch latch private final Artifact artifact private final Repository System Session session private final List Artifact Repository remote Repositories private final Artifact Resolution Result result public Resolve Task Class Loader class Loader Count Down Latch latch Artifact artifact Repository System Session session List Artifact Repository remote Repositories Artifact Resolution Result result this class Loader class Loader this latch latch this artifact artifact this session session this remote Repositories remote Repositories this result result public void run Class Loader old Thread current Thread get Context Class Loader try Thread current Thread set Context Class Loader class Loader resolve artifact remote Repositories session catch Artifact Not Found Exception anfe These are cases where the artifact just is n t present in any of the remote repositories because it was n t deployed or it was deployed in the wrong place synchronized result result add Missing Artifact artifact catch Artifact Resolution Exception e This is really a wagon Transfer Failed Exception so something went wrong after we successfully retrieved the metadata synchronized result result add Error Artifact Exception e finally latch count Down Thread current Thread set Context Class Loader old Override public void dispose if executor instanceof Executor Service Executor Service executor shutdown Now 
package org apache maven artifact versioning Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util String Tokenizer import java util regex Pattern import java util No Such Element Exception Default implementation of artifact versioning author a href mailto brett apache org Brett Porter a public class Default Artifact Version implements Artifact Version private Integer major Version private Integer minor Version private Integer incremental Version private Integer build Number private String qualifier private Comparable Version comparable public Default Artifact Version String version parse Version version Override public int hash Code return comparable hash Code Override public boolean equals Object other if this other return true if other instanceof Artifact Version return false return compare To Artifact Version other public int compare To Artifact Version other Version if other Version instanceof Default Artifact Version return this comparable compare To Default Artifact Version other Version comparable else return compare To new Default Artifact Version other Version to String public int get Major Version return major Version null major Version public int get Minor Version return minor Version null minor Version public int get Incremental Version return incremental Version null incremental Version public int get Build Number return build Number null build Number public String get Qualifier return qualifier public final void parse Version String version comparable new Comparable Version version int index version index Of String part String part null if index part version else part version substring index part version substring index if part null try if part length part starts With build Number Integer value Of part else qualifier part catch Number Format Exception e qualifier part if part contains part starts With try major Version Integer value Of part catch Number Format Exception e qualifier is the whole version including qualifier version build Number null else boolean fallback false String Tokenizer tok new String Tokenizer part try major Version get Next Integer Token tok if tok has More Tokens minor Version get Next Integer Token tok if tok has More Tokens incremental Version get Next Integer Token tok if tok has More Tokens qualifier tok next Token fallback Pattern compile d matcher qualifier matches string tokenizer wo n t detect these and ignores them if part contains part starts With part ends With fallback true catch Number Format Exception e fallback true if fallback qualifier is the whole version including qualifier version major Version null minor Version null incremental Version null build Number null private static Integer get Next Integer Token String Tokenizer tok try String s tok next Token if s length s starts With throw new Number Format Exception Number part has a leading s return Integer value Of s catch No Such Element Exception e throw new Number Format Exception Number is invalid Override public String to String return comparable to String 
package org apache maven classrealm Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io File import java net Malformed Exception import java util Array List import java util Collections import java util Linked Hash Set import java util List import java util Map import java util Random import java util Set import java util Tree Map import javax inject Inject import javax inject Named import javax inject Singleton import org apache commons lang Validate import org apache maven artifact Artifact Utils import org apache maven classrealm Class Realm Request Realm Type import org apache maven extension internal Core Exports Provider import org apache maven model Model import org apache maven model Plugin import org codehaus plexus Mutable Plexus Container import org codehaus plexus Plexus Container import org codehaus plexus classworlds Class World import org codehaus plexus classworlds realm Class Realm import org codehaus plexus classworlds realm Duplicate Realm Exception import org codehaus plexus logging Logger import org codehaus plexus util String Utils import org eclipse aether artifact Artifact Manages the class realms used by Maven strong Warning strong This is an internal utility class that is only public for technical reasons it is not part of the public In particular this class can be changed or deleted without prior notice author Benjamin Bentmann Named Singleton public class Default Class Realm Manager implements Class Realm Manager public static final String maven api During normal command line build Class World is loaded by jvm system classloader which only includes plexus classworlds jar and possibly javaagent classes see https issues apache org jira browse p Using Class World to determine plugin extensions realm parent classloaders gives m e and integration test harness flexibility to load multiple version of maven into dedicated classloaders without assuming state of jvm system classloader private static final Class Loader Class World class get Class Loader private final Logger logger private final Class World world private final Class Realm container Realm this is a live injected collection private final List Class Realm Manager Delegate delegates private final Class Realm maven Api Realm Patterns of artifacts provided by maven core and exported via maven api realm These artifacts are filtered from plugin and build extensions realms to avoid presence of duplicate and possibly conflicting classes on classpath private final Set String provided Artifacts Inject public Default Class Realm Manager Logger logger Plexus Container container List Class Realm Manager Delegate delegates Core Exports Provider exports this logger logger this world Mutable Plexus Container container get Class World this container Realm container get Container Realm this delegates delegates Map String Class Loader foreign Imports exports get get Exported Packages this maven Api Realm create Realm Realm Type Core null parent null parent Imports foreign Imports null artifacts this provided Artifacts exports get get Exported Artifacts private Class Realm new Realm String id synchronized world String realm Id id Random random new Random while true try Class Realm class Realm world new Realm realm Id if logger is Debug Enabled logger debug Created new class realm realm Id return class Realm catch Duplicate Realm Exception e realm Id id random next Int public Class Realm get Maven Api Realm return maven Api Realm Creates a new class realm with the specified parent and imports param base Realm Id The base id to use for the new realm must not be code null param type The type of the class realm must not be code null param parent The parent realm for the new realm may be code null param parent Imports The packages types to import from the parent realm may be code null param foreign Imports The packages types to import from foreign realms may be code null param artifacts The artifacts to add to the realm may be code null Unresolved artifacts i e with a missing file will automatically be excluded from the realm return The created class realm never code null private Class Realm create Realm String base Realm Id Realm Type type Class Loader parent List String parent Imports Map String Class Loader foreign Imports List Artifact artifacts Set String artifact Ids new Linked Hash Set List Class Realm Constituent constituents new Array List if artifacts null for Artifact artifact artifacts if is Provided Artifact artifact artifact Ids add get Id artifact if artifact get File null constituents add new Artifact Class Realm Constituent artifact if parent Imports null parent Imports new Array List parent Imports else parent Imports new Array List if foreign Imports null foreign Imports new Tree Map foreign Imports else foreign Imports new Tree Map Class Realm class Realm new Realm base Realm Id if parent null class Realm set Parent Class Loader parent call Delegates class Realm type parent parent Imports foreign Imports constituents wire Realm class Realm parent Imports foreign Imports Set String included Ids populate Realm class Realm constituents if logger is Debug Enabled artifact Ids remove All included Ids for String id artifact Ids logger debug Excluded id return class Realm public Class Realm get Core Realm return container Realm public Class Realm create Project Realm Model model List Artifact artifacts Validate not Null model model can not be null Class Loader parent get Maven Api Realm return create Realm get Key model Realm Type Project parent null null artifacts private static String get Key Model model return project model get Group Id model get Artifact Id model get Version public Class Realm create Extension Realm Plugin plugin List Artifact artifacts Validate not Null plugin plugin can not be null Class Loader parent Map String Class Loader foreign Imports Collections String Class Loader singleton Map get Maven Api Realm return create Realm get Key plugin true Realm Type Extension parent null foreign Imports artifacts private boolean is Provided Artifact Artifact artifact return provided Artifacts contains artifact get Group Id artifact get Artifact Id public Class Realm create Plugin Realm Plugin plugin Class Loader parent List String parent Imports Map String Class Loader foreign Imports List Artifact artifacts Validate not Null plugin plugin can not be null if parent null parent return create Realm get Key plugin false Realm Type Plugin parent parent Imports foreign Imports artifacts private static String get Key Plugin plugin boolean extension String version Artifact Utils to Snapshot Version plugin get Version return extension extension plugin plugin get Group Id plugin get Artifact Id version private static String get Id Artifact artifact return get Id artifact get Group Id artifact get Artifact Id artifact get Extension artifact get Classifier artifact get Base Version private static String get Id Class Realm Constituent constituent return get Id constituent get Group Id constituent get Artifact Id constituent get Type constituent get Classifier constituent get Version private static String get Id String gid String aid String type String cls String ver return gid aid type String Utils is Not Empty cls cls ver private void call Delegates Class Realm class Realm Realm Type type Class Loader parent List String parent Imports Map String Class Loader foreign Imports List Class Realm Constituent constituents List Class Realm Manager Delegate delegates new Array List this delegates if delegates is Empty Class Realm Request request new Default Class Realm Request type parent parent Imports foreign Imports constituents for Class Realm Manager Delegate delegate delegates try delegate setup Realm class Realm request catch Exception e logger error delegate get Class get Name failed to setup class realm class Realm e get Message e private Set String populate Realm Class Realm class Realm List Class Realm Constituent constituents Set String included Ids new Linked Hash Set if logger is Debug Enabled logger debug Populating class realm class Realm get Id for Class Realm Constituent constituent constituents File file constituent get File String id get Id constituent included Ids add id if logger is Debug Enabled logger debug Included id try class Realm add file to to catch Malformed Exception e Not going to happen logger error e get Message e return included Ids private void wire Realm Class Realm class Realm List String parent Imports Map String Class Loader foreign Imports if foreign Imports null foreign Imports is Empty if logger is Debug Enabled logger debug Importing foreign packages into class realm class Realm get Id for Map Entry String Class Loader entry foreign Imports entry Set Class Loader imported Realm entry get Value String imp entry get Key if logger is Debug Enabled logger debug Imported imp get Id imported Realm class Realm import From imported Realm imp if parent Imports null parent Imports is Empty if logger is Debug Enabled logger debug Importing parent packages into class realm class Realm get Id for String imp parent Imports if logger is Debug Enabled logger debug Imported imp get Id class Realm get Parent Class Loader class Realm import From Parent imp private String get Id Class Loader class Loader if class Loader instanceof Class Realm return Class Realm class Loader get Id return String value Of class Loader 
package org apache maven model composition Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util Array List import java util Linked Hash Map import java util List import java util Map import org apache maven model Dependency import org apache maven model Dependency Management import org apache maven model Model import org apache maven model building Model Building Request import org apache maven model building Model Problem Collector import org codehaus plexus component annotations Component Handles the import of dependency management from other models into the target model author Benjamin Bentmann Component role Dependency Management Importer class public class Default Dependency Management Importer implements Dependency Management Importer Override public void import Management Model target List extends Dependency Management sources Model Building Request request Model Problem Collector problems if sources null sources is Empty Map String Dependency dependencies new Linked Hash Map Dependency Management dep Mgmt target get Dependency Management if dep Mgmt null for Dependency dependency dep Mgmt get Dependencies dependencies put dependency get Management Key dependency else dep Mgmt new Dependency Management target set Dependency Management dep Mgmt for Dependency Management source sources for Dependency dependency source get Dependencies String key dependency get Management Key if dependencies contains Key key dependencies put key dependency dep Mgmt set Dependencies new Array List dependencies values 
package org apache maven cli event Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util Hash Map import java util Map import org apache maven eventspy Event Spy public class Default Event Spy Context implements Event Spy Context private final Map String Object data new Hash Map public Map String Object get Data return data 
package org apache maven plugin Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io File import java util Array List import java util List import java util Map import java util concurrent Concurrent Hash Map import org apache commons lang Validate import org apache maven artifact Artifact import org apache maven project Extension Descriptor import org apache maven project Maven Project import org codehaus plexus classworlds realm Class Realm import org codehaus plexus classworlds realm No Such Realm Exception import org codehaus plexus component annotations Component import org codehaus plexus personality plexus lifecycle phase Disposable Default extension realm cache implementation Assumes cached data does not change Component role Extension Realm Cache class public class Default Extension Realm Cache implements Extension Realm Cache Disposable protected static class Cache Key implements Key private final List File files private final List Long timestamps private final List Long sizes private final List String ids private final int hash Code public Cache Key List Artifact extension Artifacts this files new Array List extension Artifacts size this timestamps new Array List extension Artifacts size this sizes new Array List extension Artifacts size this ids new Array List extension Artifacts size for Artifact artifact extension Artifacts File file artifact get File files add file timestamps add file null Long value Of file last Modified Long value Of sizes add file null Long value Of file length Long value Of ids add artifact get Version this hash Code files hash Code ids hash Code timestamps hash Code sizes hash Code Override public int hash Code return hash Code Override public boolean equals Object o if o this return true if o instanceof Cache Key return false Cache Key other Cache Key o return ids equals other ids files equals other files timestamps equals other timestamps sizes equals other sizes Override public String to String return files to String protected final Map Key Cache Record cache new Concurrent Hash Map Override public Key create Key List Artifact extension Artifacts return new Cache Key extension Artifacts public Cache Record get Key key return cache get key public Cache Record put Key key Class Realm extension Realm Extension Descriptor extension Descriptor List Artifact artifacts Validate not Null extension Realm extension Realm can not be null if cache contains Key key throw new Illegal State Exception Duplicate extension realm for extension key Cache Record record new Cache Record extension Realm extension Descriptor artifacts cache put key record return record public void flush for Cache Record record cache values Class Realm realm record realm try realm get World dispose Realm realm get Id catch No Such Realm Exception e ignore cache clear public void register Maven Project project Key key Cache Record record default cache does not track extension usage public void dispose flush 
package org apache maven model inheritance Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util Array List import java util Hash Map import java util Linked Hash Map import java util List import java util Map import java util Properties import org apache maven model Input Location import org apache maven model Model import org apache maven model Model Base import org apache maven model Plugin import org apache maven model Plugin Container import org apache maven model Report Plugin import org apache maven model Reporting import org apache maven model building Model Building Request import org apache maven model building Model Problem Collector import org apache maven model merge Maven Model Merger import org codehaus plexus component annotations Component import org codehaus plexus util String Utils Handles inheritance of model values author Benjamin Bentmann Component role Inheritance Assembler class public class Default Inheritance Assembler implements Inheritance Assembler private Inheritance Model Merger merger new Inheritance Model Merger private static final String child directory private static final String project directory Override public void assemble Model Inheritance Model child Model parent Model Building Request request Model Problem Collector problems Map Object Object hints new Hash Map String child Path child get Properties get Property child get Artifact Id hints put child Path hints put Maven Model Merger get Child Path Adjustment child parent child Path merger merge child parent false hints Calculates the relative path from the base directory of the parent to the parent directory of the base directory of the child The general idea is to adjust inherited Ls to match the project layout in p This calculation is only a heuristic based on our conventions In detail the algo relies on the following assumptions ul li The parent uses aggregation and refers to the child via the modules section li li The module path to the child is considered to point at the rather than its base directory if the path ends with xml ignoring case li li The name of the child s base directory matches the artifact id of the child li ul Note that for the sake of independence from the user environment the filesystem is intentionally not used for the calculation p param child The child model must not be code null code param parent The parent model may be code null code param child Directory The directory defined in child model may be code null code return The path adjustment can be empty but never code null code private String get Child Path Adjustment Model child Model parent String child Directory String adjustment if parent null String child Name child get Artifact Id This logic using filesystem against wanted independence from the user environment exists only for the sake of backward compat with x In general it is wrong to base inheritance on the module directory names as this information is unavailable for Ms in the repository In other words modules where artifact Id module Dir Name will see different effective Ls depending on how the model was constructed from filesystem or from repository if child get Project Directory null child Name child get Project Directory get Name for String module parent get Modules module module replace if module region Matches true module length xml module module substring module last Index Of String module Name module if module Name ends With module Name module Name substring module Name length int last Slash module Name last Index Of module Name module Name substring last Slash if module Name equals child Name module Name equals child Directory last Slash adjustment module substring last Slash break return adjustment protected static class Inheritance Model Merger extends Maven Model Merger Override protected String extrapolate Child Url String parent Url Map Object Object context Object child Directory context get Object child Path Adjustment context get if String Utils is Blank parent Url child Directory null child Path Adjustment null return parent Url append child Path Adjustment and child Directory to parent url return append Path parent Url child Directory to String child Path Adjustment to String private String append Path String parent Url String child Path String path Adjustment String Builder url new String Builder parent Url length path Adjustment length child Path length path Adjustment length url append parent Url concat Path url path Adjustment concat Path url child Path return url to String private void concat Path String Builder url String path if path length boolean initial Url Ends With Slash url char At url length boolean path Starts With Slash path char At if path Starts With Slash if initial Url Ends With Slash extra to remove url set Length url length else if initial Url Ends With Slash add missing between url and path url append url append path ensure resulting url ends with slash if initial url was if initial Url Ends With Slash path ends With url append Override protected void merge Model Base Properties Model Base target Model Base source boolean source Dominant Map Object Object context Properties merged new Properties if source Dominant merged put All target get Properties put All merged source get Properties else put All merged source get Properties merged put All target get Properties target set Properties merged target set Location properties Input Location merge target get Location properties source get Location properties source Dominant private void put All Map Object Object s Map Object Object t Object exclude Key for Map Entry Object Object e t entry Set if e get Key equals exclude Key s put e get Key e get Value Override protected void merge Plugin Container Plugins Plugin Container target Plugin Container source boolean source Dominant Map Object Object context List Plugin src source get Plugins if src is Empty List Plugin tgt target get Plugins Map Object Plugin master new Linked Hash Map src size for Plugin element src if element is Inherited element get Executions is Empty Enforce recursive merge to trigger merging inheritance logic for executions Plugin plugin new Plugin plugin set Location element get Location plugin set Group Id null merge Plugin plugin element source Dominant context Object key get Plugin Key element master put key plugin Map Object List Plugin predecessors new Linked Hash Map List Plugin pending new Array List for Plugin element tgt Object key get Plugin Key element Plugin existing master get key if existing null merge Plugin element existing source Dominant context master put key element if pending is Empty predecessors put key pending pending new Array List else pending add element List Plugin result new Array List src size tgt size for Map Entry Object Plugin entry master entry Set List Plugin pre predecessors get entry get Key if pre null result add All pre result add entry get Value result add All pending target set Plugins result Override protected void merge Plugin Plugin target Plugin source boolean source Dominant Map Object Object context if source is Inherited merge Configuration Container target source source Dominant context merge Plugin Group Id target source source Dominant context merge Plugin Artifact Id target source source Dominant context merge Plugin Version target source source Dominant context merge Plugin Extensions target source source Dominant context merge Plugin Dependencies target source source Dominant context merge Plugin Executions target source source Dominant context Override protected void merge Reporting Plugins Reporting target Reporting source boolean source Dominant Map Object Object context List Report Plugin src source get Plugins if src is Empty List Report Plugin tgt target get Plugins Map Object Report Plugin merged new Linked Hash Map src size tgt size for Report Plugin element src Object key get Report Plugin Key element if element is Inherited Enforce recursive merge to trigger merging inheritance logic for executions as well Report Plugin plugin new Report Plugin plugin set Location element get Location plugin set Group Id null merge Report Plugin plugin element source Dominant context merged put key plugin for Report Plugin element tgt Object key get Report Plugin Key element Report Plugin existing merged get key if existing null merge Report Plugin element existing source Dominant context merged put key element target set Plugins new Array List merged values 
package org apache maven model plugin Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util Array List import java util Collection import java util Collections import java util Linked Hash Map import java util List import java util Map import org apache maven lifecycle Life Cycle Plugin Analyzer import org apache maven model Build import org apache maven model Model import org apache maven model Plugin import org apache maven model Plugin Container import org apache maven model Plugin Execution import org apache maven model Plugin Management import org apache maven model building Model Building Request import org apache maven model building Model Problem Collector import org apache maven model building Model Problem Severity import org apache maven model building Model Problem Version import org apache maven model building Model Problem Collector Request import org apache maven model merge Maven Model Merger import org codehaus plexus component annotations Component import org codehaus plexus component annotations Requirement Handles injection of plugin executions induced by the lifecycle bindings for a packaging author Benjamin Bentmann Component role Lifecycle Bindings Injector class public class Default Lifecycle Bindings Injector implements Lifecycle Bindings Injector private Lifecycle Bindings Merger merger new Lifecycle Bindings Merger Requirement private Life Cycle Plugin Analyzer lifecycle public void inject Lifecycle Bindings Model model Model Building Request request Model Problem Collector problems String packaging model get Packaging Collection Plugin default Plugins lifecycle get Plugins Bound By Default To All Lifecycles packaging if default Plugins null problems add new Model Problem Collector Request Severity Version set Message Unknown packaging packaging set Location model get Location packaging else if default Plugins is Empty Model lifecycle Model new Model lifecycle Model set Build new Build lifecycle Model get Build get Plugins add All default Plugins merger merge model lifecycle Model protected static class Lifecycle Bindings Merger extends Maven Model Merger private static final String plugin management public void merge Model target Model source if target get Build null target set Build new Build Map Object Object context Collections Object Object singleton Map target get Build get Plugin Management merge Plugin Container Plugins target get Build source get Build false context Override protected void merge Plugin Container Plugins Plugin Container target Plugin Container source boolean source Dominant Map Object Object context List Plugin src source get Plugins if src is Empty List Plugin tgt target get Plugins Map Object Plugin merged new Linked Hash Map src size tgt size for Plugin element tgt Object key get Plugin Key element merged put key element Map Object Plugin unmanaged new Linked Hash Map for Plugin element src Object key get Plugin Key element Plugin existing merged get key if existing null merge Plugin existing element source Dominant context else merged put key element unmanaged put key element if unmanaged is Empty Plugin Management plugin Mgmt Plugin Management context get if plugin Mgmt null for Plugin managed Plugin plugin Mgmt get Plugins Object key get Plugin Key managed Plugin Plugin unmanaged Plugin unmanaged get key if unmanaged Plugin null Plugin plugin managed Plugin clone merge Plugin plugin unmanaged Plugin source Dominant Collections empty Map merged put key plugin List Plugin result new Array List merged values target set Plugins result Override protected void merge Plugin Execution Plugin Execution target Plugin Execution source boolean source Dominant Map Object Object context super merge Plugin Execution target source source Dominant context target set Priority Math min target get Priority source get Priority 
package org apache maven lifecycle internal Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io Exception import java util Array List import java util Arrays import java util Collection import java util Collections import java util Hash Set import java util List import java util Map import org apache maven execution Maven Session import org apache maven lifecycle Default Lifecycles import org apache maven lifecycle Lifecycle import org apache maven lifecycle Lifecycle Mapping Delegate import org apache maven lifecycle Lifecycle Not Found Exception import org apache maven lifecycle Lifecycle Phase Not Found Exception import org apache maven lifecycle Maven Execution Plan import org apache maven lifecycle Mojo Execution Configurator import org apache maven lifecycle internal builder Builder Common import org apache maven plugin Build Plugin Manager import org apache maven plugin Invalid Plugin Descriptor Exception import org apache maven plugin Mojo Execution import org apache maven plugin Mojo Not Found Exception import org apache maven plugin Plugin Descriptor Parsing Exception import org apache maven plugin Plugin Not Found Exception import org apache maven plugin Plugin Resolution Exception import org apache maven plugin descriptor Mojo Descriptor import org apache maven plugin descriptor Parameter import org apache maven plugin descriptor Plugin Descriptor import org apache maven plugin lifecycle Execution import org apache maven plugin lifecycle Phase import org apache maven plugin prefix No Plugin Found For Prefix Exception import org apache maven plugin version Plugin Version Resolution Exception import org apache maven plugin version Plugin Version Resolver import org apache maven project Maven Project import org codehaus plexus component annotations Component import org codehaus plexus component annotations Requirement import org codehaus plexus util String Utils import org codehaus plexus util xml Xpp Dom import org codehaus plexus util xml pull Xml Pull Parser Exception import com google common collect Immutable Map strong strong This class is not part of any public api and can be changed or deleted without prior notice since author Benjamin Bentmann author Kristian Rosenvold Extract class Component role Lifecycle Execution Plan Calculator class public class Default Lifecycle Execution Plan Calculator implements Lifecycle Execution Plan Calculator Requirement private Plugin Version Resolver plugin Version Resolver Requirement private Build Plugin Manager plugin Manager Requirement private Default Lifecycles default Life Cycles Requirement private Mojo Descriptor Creator mojo Descriptor Creator Requirement private Lifecycle Plugin Resolver lifecycle Plugin Resolver Requirement hint Default Lifecycle Mapping Delegate private Lifecycle Mapping Delegate standard Delegate Requirement private Map String Lifecycle Mapping Delegate delegates Requirement private Map String Mojo Execution Configurator mojo Execution Configurators Suppress Warnings Unused Declaration public Default Lifecycle Execution Plan Calculator Only used for testing public Default Lifecycle Execution Plan Calculator Build Plugin Manager plugin Manager Default Lifecycles default Life Cycles Mojo Descriptor Creator mojo Descriptor Creator Lifecycle Plugin Resolver lifecycle Plugin Resolver this plugin Manager plugin Manager this default Life Cycles default Life Cycles this mojo Descriptor Creator mojo Descriptor Creator this lifecycle Plugin Resolver lifecycle Plugin Resolver this mojo Execution Configurators Immutable Map of default Mojo Execution Configurator new Default Mojo Execution Configurator Override public Maven Execution Plan calculate Execution Plan Maven Session session Maven Project project List Object tasks boolean setup throws Plugin Not Found Exception Plugin Resolution Exception Lifecycle Phase Not Found Exception Plugin Descriptor Parsing Exception Mojo Not Found Exception Invalid Plugin Descriptor Exception No Plugin Found For Prefix Exception Lifecycle Not Found Exception Plugin Version Resolution Exception lifecycle Plugin Resolver resolve Missing Plugin Versions project session final List Mojo Execution executions calculate Mojo Executions session project tasks if setup setup Mojo Executions session project executions final List Execution Plan Item plan Item Execution Plan Item create Execution Plan Items project executions return new Maven Execution Plan plan Item default Life Cycles Override public Maven Execution Plan calculate Execution Plan Maven Session session Maven Project project List Object tasks throws Plugin Not Found Exception Plugin Resolution Exception Lifecycle Phase Not Found Exception Plugin Descriptor Parsing Exception Mojo Not Found Exception Invalid Plugin Descriptor Exception No Plugin Found For Prefix Exception Lifecycle Not Found Exception Plugin Version Resolution Exception return calculate Execution Plan session project tasks true private void setup Mojo Executions Maven Session session Maven Project project List Mojo Execution mojo Executions throws Plugin Not Found Exception Plugin Resolution Exception Plugin Descriptor Parsing Exception Mojo Not Found Exception Invalid Plugin Descriptor Exception No Plugin Found For Prefix Exception Lifecycle Phase Not Found Exception Lifecycle Not Found Exception Plugin Version Resolution Exception for Mojo Execution mojo Execution mojo Executions setup Mojo Execution session project mojo Execution Override public void setup Mojo Execution Maven Session session Maven Project project Mojo Execution mojo Execution throws Plugin Not Found Exception Plugin Resolution Exception Plugin Descriptor Parsing Exception Mojo Not Found Exception Invalid Plugin Descriptor Exception No Plugin Found For Prefix Exception Lifecycle Phase Not Found Exception Lifecycle Not Found Exception Plugin Version Resolution Exception Mojo Descriptor mojo Descriptor mojo Execution get Mojo Descriptor if mojo Descriptor null mojo Descriptor plugin Manager get Mojo Descriptor mojo Execution get Plugin mojo Execution get Goal project get Remote Plugin Repositories session get Repository Session mojo Execution set Mojo Descriptor mojo Descriptor mojo Execution Configurator mojo Execution configure project mojo Execution Mojo Execution Source equals mojo Execution get Source finalize Mojo Configuration mojo Execution calculate Forked Executions mojo Execution session project new Hash Set Mojo Descriptor public List Mojo Execution calculate Mojo Executions Maven Session session Maven Project project List Object tasks throws Plugin Not Found Exception Plugin Resolution Exception Plugin Descriptor Parsing Exception Mojo Not Found Exception No Plugin Found For Prefix Exception Invalid Plugin Descriptor Exception Plugin Version Resolution Exception Lifecycle Phase Not Found Exception final List Mojo Execution mojo Executions new Array List for Object task tasks if task instanceof Goal Task String plugin Goal Goal Task task plugin Goal String execution Id default cli int execution Idx plugin Goal index Of if execution Idx execution Id plugin Goal substring execution Idx Mojo Descriptor mojo Descriptor mojo Descriptor Creator get Mojo Descriptor plugin Goal session project Mojo Execution mojo Execution new Mojo Execution mojo Descriptor execution Id Mojo Execution Source mojo Executions add mojo Execution else if task instanceof Lifecycle Task String lifecycle Phase Lifecycle Task task get Lifecycle Phase Map String List Mojo Execution phase To Mojo Mapping calculate Lifecycle Mappings session project lifecycle Phase for List Mojo Execution mojo Executions From Lifecycle phase To Mojo Mapping values mojo Executions add All mojo Executions From Lifecycle else throw new Illegal State Exception unexpected task task return mojo Executions private Map String List Mojo Execution calculate Lifecycle Mappings Maven Session session Maven Project project String lifecycle Phase throws Lifecycle Phase Not Found Exception Plugin Not Found Exception Plugin Resolution Exception Plugin Descriptor Parsing Exception Mojo Not Found Exception Invalid Plugin Descriptor Exception Determine the lifecycle that corresponds to the given phase Lifecycle lifecycle default Life Cycles get lifecycle Phase if lifecycle null throw new Lifecycle Phase Not Found Exception Unknown lifecycle phase lifecycle Phase You must specify a valid lifecycle phase or a goal in the format plugin prefix goal or plugin group id plugin artifact id plugin version goal Available lifecycle phases are default Life Cycles get Lifecycle Phase List lifecycle Phase Lifecycle Mapping Delegate delegate if Arrays binary Search Default Lifecycles lifecycle get Id delegate standard Delegate else delegate delegates get lifecycle get Id if delegate null delegate standard Delegate return delegate calculate Lifecycle Mappings session project lifecycle lifecycle Phase Post processes the effective configuration for the specified mojo execution This step discards all parameters from the configuration that are not applicable to the mojo and injects the default values for any missing parameters param mojo Execution The mojo execution whose configuration should be finalized must not be code null private void finalize Mojo Configuration Mojo Execution mojo Execution Mojo Descriptor mojo Descriptor mojo Execution get Mojo Descriptor Xpp Dom execution Configuration mojo Execution get Configuration if execution Configuration null execution Configuration new Xpp Dom configuration Xpp Dom default Configuration get Mojo Configuration mojo Descriptor Xpp Dom final Configuration new Xpp Dom configuration if mojo Descriptor get Parameters null for Parameter parameter mojo Descriptor get Parameters Xpp Dom parameter Configuration execution Configuration get Child parameter get Name if parameter Configuration null parameter Configuration execution Configuration get Child parameter get Alias Xpp Dom parameter Defaults default Configuration get Child parameter get Name parameter Configuration Xpp Dom merge Xpp Dom parameter Configuration parameter Defaults Boolean if parameter Configuration null parameter Configuration new Xpp Dom parameter Configuration parameter get Name if String Utils is Empty parameter Configuration get Attribute implementation String Utils is Not Empty parameter get Implementation parameter Configuration set Attribute implementation parameter get Implementation final Configuration add Child parameter Configuration mojo Execution set Configuration final Configuration private Xpp Dom get Mojo Configuration Mojo Descriptor mojo Descriptor return Mojo Descriptor Creator convert mojo Descriptor Override public void calculate Forked Executions Mojo Execution mojo Execution Maven Session session throws Mojo Not Found Exception Plugin Not Found Exception Plugin Resolution Exception Plugin Descriptor Parsing Exception No Plugin Found For Prefix Exception Invalid Plugin Descriptor Exception Lifecycle Phase Not Found Exception Lifecycle Not Found Exception Plugin Version Resolution Exception calculate Forked Executions mojo Execution session session get Current Project new Hash Set Mojo Descriptor private void calculate Forked Executions Mojo Execution mojo Execution Maven Session session Maven Project project Collection Mojo Descriptor already Forked Executions throws Mojo Not Found Exception Plugin Not Found Exception Plugin Resolution Exception Plugin Descriptor Parsing Exception No Plugin Found For Prefix Exception Invalid Plugin Descriptor Exception Lifecycle Phase Not Found Exception Lifecycle Not Found Exception Plugin Version Resolution Exception Mojo Descriptor mojo Descriptor mojo Execution get Mojo Descriptor if mojo Descriptor is Forking return if already Forked Executions add mojo Descriptor return List Maven Project forked Projects Lifecycle Dependency Resolver get Projects project session mojo Descriptor is Aggregator for Maven Project forked Project forked Projects if forked Project project lifecycle Plugin Resolver resolve Missing Plugin Versions forked Project session List Mojo Execution forked Executions if String Utils is Not Empty mojo Descriptor get Execute Phase forked Executions calculate Forked Lifecycle mojo Execution session forked Project already Forked Executions else forked Executions calculate Forked Goal mojo Execution session forked Project already Forked Executions mojo Execution set Forked Executions Builder Common get Key forked Project forked Executions already Forked Executions remove mojo Descriptor private List Mojo Execution calculate Forked Lifecycle Mojo Execution mojo Execution Maven Session session Maven Project project Collection Mojo Descriptor already Forked Executions throws Mojo Not Found Exception Plugin Not Found Exception Plugin Resolution Exception Plugin Descriptor Parsing Exception No Plugin Found For Prefix Exception Invalid Plugin Descriptor Exception Lifecycle Phase Not Found Exception Lifecycle Not Found Exception Plugin Version Resolution Exception Mojo Descriptor mojo Descriptor mojo Execution get Mojo Descriptor String forked Phase mojo Descriptor get Execute Phase Map String List Mojo Execution lifecycle Mappings calculate Lifecycle Mappings session project forked Phase for List Mojo Execution forked Executions lifecycle Mappings values for Mojo Execution forked Execution forked Executions if forked Execution get Mojo Descriptor null Mojo Descriptor forked Mojo Descriptor plugin Manager get Mojo Descriptor forked Execution get Plugin forked Execution get Goal project get Remote Plugin Repositories session get Repository Session forked Execution set Mojo Descriptor forked Mojo Descriptor mojo Execution Configurator forked Execution configure project forked Execution false inject Lifecycle Overlay lifecycle Mappings mojo Execution session project List Mojo Execution mojo Executions new Array List for List Mojo Execution forked Executions lifecycle Mappings values for Mojo Execution forked Execution forked Executions if already Forked Executions contains forked Execution get Mojo Descriptor finalize Mojo Configuration forked Execution calculate Forked Executions forked Execution session project already Forked Executions mojo Executions add forked Execution return mojo Executions private void inject Lifecycle Overlay Map String List Mojo Execution lifecycle Mappings Mojo Execution mojo Execution Maven Session session Maven Project project throws Plugin Descriptor Parsing Exception Lifecycle Not Found Exception Mojo Not Found Exception Plugin Not Found Exception Plugin Resolution Exception No Plugin Found For Prefix Exception Invalid Plugin Descriptor Exception Plugin Version Resolution Exception Mojo Descriptor mojo Descriptor mojo Execution get Mojo Descriptor Plugin Descriptor plugin Descriptor mojo Descriptor get Plugin Descriptor String forked Lifecycle mojo Descriptor get Execute Lifecycle if String Utils is Empty forked Lifecycle return org apache maven plugin lifecycle Lifecycle lifecycle Overlay try lifecycle Overlay plugin Descriptor get Lifecycle Mapping forked Lifecycle catch Exception Xml Pull Parser Exception e throw new Plugin Descriptor Parsing Exception plugin Descriptor get Plugin plugin Descriptor get Source e if lifecycle Overlay null throw new Lifecycle Not Found Exception forked Lifecycle for Phase phase lifecycle Overlay get Phases List Mojo Execution forked Executions lifecycle Mappings get phase get Id if forked Executions null for Execution execution phase get Executions for String goal execution get Goals Mojo Descriptor forked Mojo Descriptor if goal index Of forked Mojo Descriptor plugin Descriptor get Mojo goal if forked Mojo Descriptor null throw new Mojo Not Found Exception goal plugin Descriptor else forked Mojo Descriptor mojo Descriptor Creator get Mojo Descriptor goal session project Mojo Execution forked Execution new Mojo Execution forked Mojo Descriptor mojo Execution get Execution Id Xpp Dom forked Configuration Xpp Dom execution get Configuration forked Execution set Configuration forked Configuration mojo Execution Configurator forked Execution configure project forked Execution true forked Executions add forked Execution Xpp Dom phase Configuration Xpp Dom phase get Configuration if phase Configuration null for Mojo Execution forked Execution forked Executions Xpp Dom forked Configuration forked Execution get Configuration forked Configuration Xpp Dom merge Xpp Dom phase Configuration forked Configuration forked Execution set Configuration forked Configuration org apache maven plugins maven remote resources plugin process take repo mans into account as one may be aggregating prefixes of many collect at the root of the repository read the one at the root and fetch remote if something is missing or the user forces the issue private List Mojo Execution calculate Forked Goal Mojo Execution mojo Execution Maven Session session Maven Project project Collection Mojo Descriptor already Forked Executions throws Mojo Not Found Exception Plugin Not Found Exception Plugin Resolution Exception Plugin Descriptor Parsing Exception No Plugin Found For Prefix Exception Invalid Plugin Descriptor Exception Lifecycle Phase Not Found Exception Lifecycle Not Found Exception Plugin Version Resolution Exception Mojo Descriptor mojo Descriptor mojo Execution get Mojo Descriptor Plugin Descriptor plugin Descriptor mojo Descriptor get Plugin Descriptor String forked Goal mojo Descriptor get Execute Goal Mojo Descriptor forked Mojo Descriptor plugin Descriptor get Mojo forked Goal if forked Mojo Descriptor null throw new Mojo Not Found Exception forked Goal plugin Descriptor if already Forked Executions contains forked Mojo Descriptor return Collections empty List Mojo Execution forked Execution new Mojo Execution forked Mojo Descriptor forked Goal mojo Execution Configurator forked Execution configure project forked Execution true finalize Mojo Configuration forked Execution calculate Forked Executions forked Execution session project already Forked Executions return Collections singleton List forked Execution private Mojo Execution Configurator mojo Execution Configurator Mojo Execution mojo Execution String configurator Id mojo Execution get Mojo Descriptor get Component Configurator if configurator Id null configurator Id default Mojo Execution Configurator mojo Execution Configurator mojo Execution Configurators get configurator Id if mojo Execution Configurator null The plugin has a custom component configurator but does not have a custom mojo execution configurator so fall back to the default mojo execution configurator mojo Execution Configurator mojo Execution Configurators get default return mojo Execution Configurator 
package org apache maven Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io File import java util Array List import java util Arrays import java util Collection import java util Collections import java util Date import java util Hash Set import java util Linked Hash Map import java util Linked Hash Set import java util List import java util Map import org apache maven artifact Artifact Utils import org apache maven execution Default Maven Execution Result import org apache maven execution Execution Event import org apache maven execution Maven Execution Request import org apache maven execution Maven Execution Result import org apache maven execution Maven Session import org apache maven execution Project Dependency Graph import org apache maven graph Graph Builder import org apache maven internal aether Default Repository System Session Factory import org apache maven lifecycle internal Execution Event Catapult import org apache maven lifecycle internal Lifecycle Starter import org apache maven model Prerequisites import org apache maven model building Model Problem import org apache maven model building Result import org apache maven plugin Legacy Support import org apache maven project Maven Project import org apache maven project Project Builder import org apache maven repository Local Repository Not Accessible Exception import org apache maven session scope internal Session Scope import org codehaus plexus Plexus Container import org codehaus plexus component annotations Component import org codehaus plexus component annotations Requirement import org codehaus plexus component repository exception Component Lookup Exception import org codehaus plexus logging Logger import org eclipse aether Default Repository System Session import org eclipse aether Repository System Session import org eclipse aether repository Workspace Reader import org eclipse aether util repository Chained Workspace Reader import com google common collect Iterables author Jason van Zyl Component role Maven class public class Default Maven implements Maven Requirement private Logger logger Requirement protected Project Builder project Builder Requirement private Lifecycle Starter lifecycle Starter Requirement protected Plexus Container container Requirement private Execution Event Catapult event Catapult Requirement private Legacy Support legacy Support Requirement private Session Scope session Scope Requirement private Default Repository System Session Factory repository Session Factory Requirement hint Graph Builder private Graph Builder graph Builder Override public Maven Execution Result execute Maven Execution Request request Maven Execution Result result try result do Execute request catch Out Of Memory Error e result add Exception To Result new Default Maven Execution Result e catch Runtime Exception e Hack to make the cycle detection the same for the new graph builder if e get Cause instanceof Project Cycle Exception result add Exception To Result new Default Maven Execution Result e get Cause else result add Exception To Result new Default Maven Execution Result new Internal Error Exception Internal error e e finally legacy Support set Session null return result Setup initial properties Validate local repository directory is accessible Create Repository System Session Create Maven Session Execute Abstract Lifecycle Participant after Session Start session Get reactor projects looking for general errors Create Project Dependency Graph using trimming which takes into account projects and reactor mode This ensures that the projects passed into the Reactor Reader are only those specified Create Reactor Reader with the get Project Map projects that get Project Map projects is the code that checks for duplicate projects definitions in the build Ideally this type of duplicate checking should be part of getting the reactor projects in The duplicate checking is conflated with get Project Map projects Execute Abstract Lifecycle Participant after Projects Read session Create Project Dependency Graph without trimming as trimming was done in new topological sort is required after the execution of as the Abstract Lifecycle Participants are free to mutate the Maven Project instances which may change dependencies which can in turn affect the build order Execute Lifecycle Starter start Suppress Warnings checkstyle methodlength private Maven Execution Result do Execute Maven Execution Request request request set Start Time new Date Maven Execution Result result new Default Maven Execution Result try validate Local Repository request catch Local Repository Not Accessible Exception e return add Exception To Result result e We enter the session scope right after the Maven Session creation and before any of the Abstract Lifecycle Participant lookups so that Session Scoped components can be Injected into Abstract Lifecycle Participants session Scope enter try Default Repository System Session repo Session Default Repository System Session new Repository Session request Maven Session session new Maven Session container repo Session request result session Scope seed Maven Session class session legacy Support set Session session return do Execute request session result repo Session finally session Scope exit private Maven Execution Result do Execute Maven Execution Request request Maven Session session Maven Execution Result result Default Repository System Session repo Session try Line Length for Abstract Maven Lifecycle Participant listener get Lifecycle Participants Collections Maven Project empty List listener after Session Start session Line Length catch Maven Execution Exception e return add Exception To Result result e event Catapult fire Execution Event Type Project Discovery Started session null Result extends Project Dependency Graph graph Result build Graph session result if graph Result has Errors return add Exception To Result result Iterables to Array graph Result get Problems Model Problem class get Exception try session set Project Map get Project Map session get Projects catch Duplicate Project Exception e return add Exception To Result result e Workspace Reader reactor Workspace try reactor Workspace container lookup Workspace Reader class Reactor Reader catch Component Lookup Exception e return add Exception To Result result e Desired order of precedence for local artifact repositories Reactor Workspace User Local Repository repo Session set Workspace Reader Chained Workspace Reader new Instance reactor Workspace repo Session get Workspace Reader repo Session set Read Only Class Loader original Class Loader Thread current Thread get Context Class Loader try for Abstract Maven Lifecycle Participant listener get Lifecycle Participants session get Projects Thread current Thread set Context Class Loader listener get Class get Class Loader listener after Projects Read session catch Maven Execution Exception e return add Exception To Result result e finally Thread current Thread set Context Class Loader original Class Loader The projects need to be topologically after the participants have run their after Projects Read session because the participant is free to change the dependencies of a project which can potentially change the topological order of the projects and therefore can potentially change the build order Note that participants may affect the topological order of the projects but it is not expected that a participant will add or remove projects from the session graph Result build Graph session result if graph Result has Errors return add Exception To Result result Iterables to Array graph Result get Problems Model Problem class get Exception try if result has Exceptions return result result set Topologically Sorted Projects session get Projects result set Project session get Top Level Project validate Prerequisites For Non Maven Plugin Projects session get Projects lifecycle Starter execute session validate Activated Profiles session get Projects request get Active Profiles if session get Result has Exceptions return add Exception To Result result session get Result get Exceptions get finally try after Session End session get Projects session catch Maven Execution Exception e return add Exception To Result result e return result private void after Session End Collection Maven Project projects Maven Session session throws Maven Execution Exception Class Loader original Class Loader Thread current Thread get Context Class Loader try for Abstract Maven Lifecycle Participant listener get Lifecycle Participants projects Thread current Thread set Context Class Loader listener get Class get Class Loader listener after Session End session finally Thread current Thread set Context Class Loader original Class Loader public Repository System Session new Repository Session Maven Execution Request request return repository Session Factory new Repository Session request private void validate Local Repository Maven Execution Request request throws Local Repository Not Accessible Exception File local Repo Dir request get Local Repository Path logger debug Using local repository at local Repo Dir local Repo Dir mkdirs if local Repo Dir is Directory throw new Local Repository Not Accessible Exception Could not create local repository at local Repo Dir private Collection Abstract Maven Lifecycle Participant get Lifecycle Participants Collection Maven Project projects Collection Abstract Maven Lifecycle Participant lifecycle Listeners new Linked Hash Set Class Loader original Class Loader Thread current Thread get Context Class Loader try try lifecycle Listeners add All container lookup List Abstract Maven Lifecycle Participant class catch Component Lookup Exception e this is just silly lookup List should return an empty list logger warn Failed to lookup lifecycle participants e get Message Collection Class Loader scanned Realms new Hash Set for Maven Project project projects Class Loader project Realm project get Class Realm if project Realm null scanned Realms add project Realm Thread current Thread set Context Class Loader project Realm try lifecycle Listeners add All container lookup List Abstract Maven Lifecycle Participant class catch Component Lookup Exception e this is just silly lookup List should return an empty list logger warn Failed to lookup lifecycle participants e get Message finally Thread current Thread set Context Class Loader original Class Loader return lifecycle Listeners private Maven Execution Result add Exception To Result Maven Execution Result result Throwable e if result get Exceptions contains e result add Exception e return result private void validate Prerequisites For Non Maven Plugin Projects List Maven Project projects for Maven Project maven Project projects if maven plugin equals maven Project get Packaging Prerequisites prerequisites maven Project get Prerequisites if prerequisites null prerequisites get Maven null logger warn The project maven Project get Id uses prerequisites which is only intended for maven plugin projects but not for non maven plugin projects For such purposes you should use the maven enforcer plugin See https maven apache org enforcer enforcer rules require Maven Version html private void validate Activated Profiles List Maven Project projects List String active Profile Ids Collection String not Activated Profile Ids new Linked Hash Set active Profile Ids for Maven Project project projects for List String profile Ids project get Injected Profile Ids values not Activated Profile Ids remove All profile Ids for String not Activated Profile Id not Activated Profile Ids logger warn The requested profile not Activated Profile Id could not be activated because it does not exist private Map String Maven Project get Project Map Collection Maven Project projects throws Duplicate Project Exception Map String Maven Project index new Linked Hash Map Map String List File collisions new Linked Hash Map for Maven Project project projects String project Id Artifact Utils key project get Group Id project get Artifact Id project get Version Maven Project collision index get project Id if collision null index put project Id project else List File pom Files collisions get project Id if pom Files null pom Files new Array List Arrays as List collision get File project get File collisions put project Id pom Files else pom Files add project get File if collisions is Empty throw new Duplicate Project Exception Two or more projects in the reactor have the same identifier please make sure that group Id artifact Id version is unique for each project collisions collisions return index private Result extends Project Dependency Graph build Graph Maven Session session Maven Execution Result result Result extends Project Dependency Graph graph Result graph Builder build session for Model Problem problem graph Result get Problems if problem get Severity Model Problem Severity logger warn problem to String else logger error problem to String if graph Result has Errors Project Dependency Graph project Dependency Graph graph Result get session set Projects project Dependency Graph get Sorted Projects session set All Projects project Dependency Graph get All Projects session set Project Dependency Graph project Dependency Graph return graph Result Deprecated January protected Logger get Logger return logger 
package org apache maven execution Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io File import java util Array List import java util Date import java util Hash Map import java util List import java util Map import java util Properties import org apache commons lang Validate import org apache maven artifact repository Artifact Repository import org apache maven eventspy internal Event Spy Dispatcher import org apache maven model Profile import org apache maven project Default Project Building Request import org apache maven project Project Building Request import org apache maven properties internal System Properties import org apache maven settings Mirror import org apache maven settings Proxy import org apache maven settings Server import org apache maven toolchain model Toolchain Model import org eclipse aether Default Repository Cache import org eclipse aether Repository Cache import org eclipse aether repository Workspace Reader import org eclipse aether transfer Transfer Listener import com google common collect Maps author Jason van Zyl public class Default Maven Execution Request implements Maven Execution Request private Repository Cache repository Cache new Default Repository Cache private Workspace Reader workspace Reader private Artifact Repository local Repository private Event Spy Dispatcher event Spy Dispatcher private File local Repository Path private boolean offline false private boolean interactive Mode true private boolean cache Transfer Error private boolean cache Not Found private List Proxy proxies private List Server servers private List Mirror mirrors private List Profile profiles private List String plugin Groups private boolean is Project Present true We need to allow per execution user and global settings as the embedder might be running in a mode where its executing many threads with totally different settings private File user Settings File private File global Settings File private File user Toolchains File private File global Toolchains File Request private File multi Module Project Directory private File basedir private List String goals private boolean use Reactor false private boolean recursive true private File pom private String reactor Failure Behavior private List String selected Projects private List String excluded Projects private String resume From private String make Behavior private Properties system Properties private Properties user Properties private Date start Time private boolean show Errors false private List String active Profiles private List String inactive Profiles private Transfer Listener transfer Listener private int logging Level private String global Checksum Policy private boolean update Snapshots false private List Artifact Repository remote Repositories private List Artifact Repository plugin Artifact Repositories private Execution Listener execution Listener private int degree Of Concurrency private String builder Id singlethreaded private Map String List Toolchain Model toolchains Suppress updates issue private boolean no Snapshot Updates private boolean use Legacy Local Repository Manager false private Map String Object data public Default Maven Execution Request public static Maven Execution Request copy Maven Execution Request original Default Maven Execution Request copy new Default Maven Execution Request copy set Local Repository original get Local Repository copy set Local Repository Path original get Local Repository Path copy set Offline original is Offline copy set Interactive Mode original is Interactive Mode copy set Cache Not Found original is Cache Not Found copy set Cache Transfer Error original is Cache Transfer Error copy set Proxies original get Proxies copy set Servers original get Servers copy set Mirrors original get Mirrors copy set Profiles original get Profiles copy set Plugin Groups original get Plugin Groups copy set Project Present original is Project Present copy set User Settings File original get User Settings File copy set Global Settings File original get Global Settings File copy set User Toolchains File original get User Toolchains File copy set Global Toolchains File original get Global Toolchains File copy set Base Directory original get Base Directory null new File original get Base Directory null copy set Goals original get Goals copy set Recursive original is Recursive copy set Pom original get Pom copy set System Properties original get System Properties copy set User Properties original get User Properties copy set Show Errors original is Show Errors copy set Active Profiles original get Active Profiles copy set Inactive Profiles original get Inactive Profiles copy set Transfer Listener original get Transfer Listener copy set Logging Level original get Logging Level copy set Global Checksum Policy original get Global Checksum Policy copy set Update Snapshots original is Update Snapshots copy set Remote Repositories original get Remote Repositories copy set Plugin Artifact Repositories original get Plugin Artifact Repositories copy set Repository Cache original get Repository Cache copy set Workspace Reader original get Workspace Reader copy set No Snapshot Updates original is No Snapshot Updates copy set Execution Listener original get Execution Listener copy set Use Legacy Local Repository original is Use Legacy Local Repository copy set Builder Id original get Builder Id return copy Override public String get Base Directory if basedir null return null return basedir get Absolute Path Override public Artifact Repository get Local Repository return local Repository Override public File get Local Repository Path return local Repository Path Override public List String get Goals if goals null goals new Array List return goals Override public Properties get System Properties if system Properties null system Properties new Properties return system Properties Override public Properties get User Properties if user Properties null user Properties new Properties return user Properties Override public File get Pom return pom Override public String get Reactor Failure Behavior return reactor Failure Behavior Override public List String get Selected Projects if selected Projects null selected Projects new Array List return selected Projects Override public List String get Excluded Projects if excluded Projects null excluded Projects new Array List return excluded Projects Override public String get Resume From return resume From Override public String get Make Behavior return make Behavior Override public Date get Start Time return start Time Override public boolean is Show Errors return show Errors Override public boolean is Interactive Mode return interactive Mode Override public Maven Execution Request set Active Profiles List String active Profiles if active Profiles null this active Profiles new Array List active Profiles else this active Profiles null return this Override public Maven Execution Request set Inactive Profiles List String inactive Profiles if inactive Profiles null this inactive Profiles new Array List inactive Profiles else this inactive Profiles null return this Override public Maven Execution Request set Remote Repositories List Artifact Repository remote Repositories if remote Repositories null this remote Repositories new Array List remote Repositories else this remote Repositories null return this Override public Maven Execution Request set Plugin Artifact Repositories List Artifact Repository plugin Artifact Repositories if plugin Artifact Repositories null this plugin Artifact Repositories new Array List plugin Artifact Repositories else this plugin Artifact Repositories null return this public void set Project Building Configuration Project Building Request project Building Configuration this project Building Request project Building Configuration Override public List String get Active Profiles if active Profiles null active Profiles new Array List return active Profiles Override public List String get Inactive Profiles if inactive Profiles null inactive Profiles new Array List return inactive Profiles Override public Transfer Listener get Transfer Listener return transfer Listener Override public int get Logging Level return logging Level Override public boolean is Offline return offline Override public boolean is Update Snapshots return update Snapshots Override public boolean is No Snapshot Updates return no Snapshot Updates Override public String get Global Checksum Policy return global Checksum Policy Override public boolean is Recursive return recursive Override public Maven Execution Request set Base Directory File basedir this basedir basedir return this Override public Maven Execution Request set Start Time Date start Time this start Time start Time return this Override public Maven Execution Request set Show Errors boolean show Errors this show Errors show Errors return this Override public Maven Execution Request set Goals List String goals if goals null this goals new Array List goals else this goals null return this Override public Maven Execution Request set Local Repository Artifact Repository local Repository this local Repository local Repository if local Repository null set Local Repository Path new File local Repository get Basedir get Absolute File return this Override public Maven Execution Request set Local Repository Path File local Repository local Repository Path local Repository return this Override public Maven Execution Request set Local Repository Path String local Repository local Repository Path local Repository null new File local Repository null return this Override public Maven Execution Request set System Properties Properties properties if properties null this system Properties System Properties copy Properties properties else this system Properties null return this Override public Maven Execution Request set User Properties Properties user Properties if user Properties null this user Properties new Properties this user Properties put All user Properties else this user Properties null return this Override public Maven Execution Request set Reactor Failure Behavior String failure Behavior reactor Failure Behavior failure Behavior return this Override public Maven Execution Request set Selected Projects List String selected Projects if selected Projects null this selected Projects new Array List selected Projects else this selected Projects null return this Override public Maven Execution Request set Excluded Projects List String excluded Projects if excluded Projects null this excluded Projects new Array List excluded Projects else this excluded Projects null return this Override public Maven Execution Request set Resume From String project this resume From project return this Override public Maven Execution Request set Make Behavior String make Behavior this make Behavior make Behavior return this Override public Maven Execution Request add Active Profile String profile if get Active Profiles contains profile get Active Profiles add profile return this Override public Maven Execution Request add Inactive Profile String profile if get Inactive Profiles contains profile get Inactive Profiles add profile return this Override public Maven Execution Request add Active Profiles List String profiles for String profile profiles add Active Profile profile return this Override public Maven Execution Request add Inactive Profiles List String profiles for String profile profiles add Inactive Profile profile return this public Maven Execution Request set Use Reactor boolean reactor Active use Reactor reactor Active return this public boolean use Reactor return use Reactor deprecated use link set Pom File Deprecated public Maven Execution Request set Pom File String pom Filename if pom Filename null pom new File pom Filename return this Override public Maven Execution Request set Pom File pom this pom pom return this Override public Maven Execution Request set Interactive Mode boolean interactive interactive Mode interactive return this Override public Maven Execution Request set Transfer Listener Transfer Listener transfer Listener this transfer Listener transfer Listener return this Override public Maven Execution Request set Logging Level int logging Level this logging Level logging Level return this Override public Maven Execution Request set Offline boolean offline this offline offline return this Override public Maven Execution Request set Update Snapshots boolean update Snapshots this update Snapshots update Snapshots return this Override public Maven Execution Request set No Snapshot Updates boolean no Snapshot Updates this no Snapshot Updates no Snapshot Updates return this Override public Maven Execution Request set Global Checksum Policy String global Checksum Policy this global Checksum Policy global Checksum Policy return this Settings equivalents Override public List Proxy get Proxies if proxies null proxies new Array List return proxies Override public Maven Execution Request set Proxies List Proxy proxies if proxies null this proxies new Array List proxies else this proxies null return this Override public Maven Execution Request add Proxy Proxy proxy Validate not Null proxy proxy can not be null for Proxy p get Proxies if p get Id null p get Id equals proxy get Id return this get Proxies add proxy return this Override public List Server get Servers if servers null servers new Array List return servers Override public Maven Execution Request set Servers List Server servers if servers null this servers new Array List servers else this servers null return this Override public Maven Execution Request add Server Server server Validate not Null server server can not be null for Server p get Servers if p get Id null p get Id equals server get Id return this get Servers add server return this Override public List Mirror get Mirrors if mirrors null mirrors new Array List return mirrors Override public Maven Execution Request set Mirrors List Mirror mirrors if mirrors null this mirrors new Array List mirrors else this mirrors null return this Override public Maven Execution Request add Mirror Mirror mirror Validate not Null mirror mirror can not be null for Mirror p get Mirrors if p get Id null p get Id equals mirror get Id return this get Mirrors add mirror return this Override public List Profile get Profiles if profiles null profiles new Array List return profiles Override public Maven Execution Request set Profiles List Profile profiles if profiles null this profiles new Array List profiles else this profiles null return this Override public List String get Plugin Groups if plugin Groups null plugin Groups new Array List return plugin Groups Override public Maven Execution Request set Plugin Groups List String plugin Groups if plugin Groups null this plugin Groups new Array List plugin Groups else this plugin Groups null return this Override public Maven Execution Request add Plugin Group String plugin Group if get Plugin Groups contains plugin Group get Plugin Groups add plugin Group return this Override public Maven Execution Request add Plugin Groups List String plugin Groups for String plugin Group plugin Groups add Plugin Group plugin Group return this Override public Maven Execution Request set Recursive boolean recursive this recursive recursive return this calculated from request attributes private Project Building Request project Building Request Override public boolean is Project Present return is Project Present Override public Maven Execution Request set Project Present boolean project Present is Project Present project Present return this Settings files Override public File get User Settings File return user Settings File Override public Maven Execution Request set User Settings File File user Settings File this user Settings File user Settings File return this Override public File get Global Settings File return global Settings File Override public Maven Execution Request set Global Settings File File global Settings File this global Settings File global Settings File return this Override public File get User Toolchains File return user Toolchains File Override public Maven Execution Request set User Toolchains File File user Toolchains File this user Toolchains File user Toolchains File return this Override public File get Global Toolchains File return global Toolchains File Override public Maven Execution Request set Global Toolchains File File global Toolchains File this global Toolchains File global Toolchains File return this Override public Maven Execution Request add Remote Repository Artifact Repository repository for Artifact Repository repo get Remote Repositories if repo get Id null repo get Id equals repository get Id return this get Remote Repositories add repository return this Override public List Artifact Repository get Remote Repositories if remote Repositories null remote Repositories new Array List return remote Repositories Override public Maven Execution Request add Plugin Artifact Repository Artifact Repository repository for Artifact Repository repo get Plugin Artifact Repositories if repo get Id null repo get Id equals repository get Id return this get Plugin Artifact Repositories add repository return this Override public List Artifact Repository get Plugin Artifact Repositories if plugin Artifact Repositories null plugin Artifact Repositories new Array List return plugin Artifact Repositories this does not belong here Override public Project Building Request get Project Building Request if project Building Request null project Building Request new Default Project Building Request project Building Request set Local Repository get Local Repository project Building Request set System Properties get System Properties project Building Request set User Properties get User Properties project Building Request set Remote Repositories get Remote Repositories project Building Request set Plugin Artifact Repositories get Plugin Artifact Repositories project Building Request set Active Profile Ids get Active Profiles project Building Request set Inactive Profile Ids get Inactive Profiles project Building Request set Profiles get Profiles project Building Request set Process Plugins true project Building Request set Build Start Time get Start Time return project Building Request Override public Maven Execution Request add Profile Profile profile Validate not Null profile profile can not be null for Profile p get Profiles if p get Id null p get Id equals profile get Id return this get Profiles add profile return this Override public Repository Cache get Repository Cache return repository Cache Override public Maven Execution Request set Repository Cache Repository Cache repository Cache this repository Cache repository Cache return this Override public Execution Listener get Execution Listener return execution Listener Override public Maven Execution Request set Execution Listener Execution Listener execution Listener this execution Listener execution Listener return this Override public void set Degree Of Concurrency final int degree Of Concurrency this degree Of Concurrency degree Of Concurrency Override public int get Degree Of Concurrency return degree Of Concurrency Override public Workspace Reader get Workspace Reader return workspace Reader Override public Maven Execution Request set Workspace Reader Workspace Reader workspace Reader this workspace Reader workspace Reader return this Override public boolean is Cache Transfer Error return cache Transfer Error Override public Maven Execution Request set Cache Transfer Error boolean cache Transfer Error this cache Transfer Error cache Transfer Error return this Override public boolean is Cache Not Found return cache Not Found Override public Maven Execution Request set Cache Not Found boolean cache Not Found this cache Not Found cache Not Found return this Override public boolean is Use Legacy Local Repository return this use Legacy Local Repository Manager Override public Maven Execution Request set Use Legacy Local Repository boolean use Legacy Local Repository Manager this use Legacy Local Repository Manager use Legacy Local Repository Manager return this Override public Maven Execution Request set Builder Id String builder Id this builder Id builder Id return this Override public String get Builder Id return builder Id Override public Map String List Toolchain Model get Toolchains if toolchains null toolchains new Hash Map return toolchains Override public Maven Execution Request set Toolchains Map String List Toolchain Model toolchains this toolchains toolchains return this Override public void set Multi Module Project Directory File directory this multi Module Project Directory directory Override public File get Multi Module Project Directory return multi Module Project Directory Override public Maven Execution Request set Event Spy Dispatcher Event Spy Dispatcher event Spy Dispatcher this event Spy Dispatcher event Spy Dispatcher return this Override public Event Spy Dispatcher get Event Spy Dispatcher return event Spy Dispatcher Override public Map String Object get Data if data null data Maps new Hash Map return data 
package org apache maven execution Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io File import java util Array List import java util Hash Map import java util List import java util Map import java util Set import javax inject Inject import javax inject Named import org apache maven artifact Invalid Repository Exception import org apache maven artifact repository Artifact Repository import org apache maven bridge Maven Repository System import org apache maven repository Repository System All of this needs to go away and be couched in terms of the execution request import org apache maven settings Mirror import org apache maven settings Proxy import org apache maven settings Repository import org apache maven settings Server import org apache maven settings Settings import org apache maven settings Settings Utils Settings in core import org apache maven toolchain model Persisted Toolchains import org apache maven toolchain model Toolchain Model import org codehaus plexus util String Utils Named public class Default Maven Execution Request Populator implements Maven Execution Request Populator private final Maven Repository System repository System Inject public Default Maven Execution Request Populator Maven Repository System repository System this repository System repository System Override public Maven Execution Request populate From Toolchains Maven Execution Request request Persisted Toolchains toolchains throws Maven Execution Request Population Exception if toolchains null Map String List Toolchain Model grouped Toolchains new Hash Map for Toolchain Model model toolchains get Toolchains if grouped Toolchains contains Key model get Type grouped Toolchains put model get Type new Array List Toolchain Model grouped Toolchains get model get Type add model request set Toolchains grouped Toolchains return request Override public Maven Execution Request populate Defaults Maven Execution Request request throws Maven Execution Request Population Exception base Directory request local Repository request populate Default Plugin Groups request inject Default Repositories request inject Default Plugin Repositories request return request private void populate Default Plugin Groups Maven Execution Request request request add Plugin Group org apache maven plugins request add Plugin Group org codehaus mojo private void inject Default Repositories Maven Execution Request request throws Maven Execution Request Population Exception Set String defined Repositories repository System get Repo Ids request get Remote Repositories if defined Repositories contains Repository System try request add Remote Repository repository System create Default Remote Repository request catch Exception e throw new Maven Execution Request Population Exception Can not create default remote repository e private void inject Default Plugin Repositories Maven Execution Request request throws Maven Execution Request Population Exception Set String defined Repositories repository System get Repo Ids request get Plugin Artifact Repositories if defined Repositories contains Repository System try request add Plugin Artifact Repository repository System create Default Remote Repository request catch Exception e throw new Maven Execution Request Population Exception Can not create default remote repository e private void local Repository Maven Execution Request request throws Maven Execution Request Population Exception Local Repository Use a value has been passed in via the configuration Use value in the resultant settings Use default value if request get Local Repository null request set Local Repository create Local Repository request if request get Local Repository Path null request set Local Repository Path new File request get Local Repository get Basedir get Absolute File Artifact Transfer Mechanism private Artifact Repository create Local Repository Maven Execution Request request throws Maven Execution Request Population Exception String local Repository Path null if request get Local Repository Path null local Repository Path request get Local Repository Path get Absolute Path if String Utils is Empty local Repository Path local Repository Path Repository System default User Local Repository get Absolute Path try return repository System create Local Repository request new File local Repository Path catch Exception e throw new Maven Execution Request Population Exception Can not create local repository e private void base Directory Maven Execution Request request if request get Base Directory null request get Pom null request set Base Directory request get Pom get Absolute File get Parent File if not Override Deprecated public Maven Execution Request populate From Settings Maven Execution Request request Settings settings throws Maven Execution Request Population Exception if settings null return request request set Offline settings is Offline request set Interactive Mode settings is Interactive Mode request set Plugin Groups settings get Plugin Groups request set Local Repository Path settings get Local Repository for Server server settings get Servers server server clone request add Server server proxies proxy active true active protocol http protocol host proxy somewhere com host port port username proxyuser username password somepassword password non Proxy Hosts www google com somewhere com non Proxy Hosts proxy proxies for Proxy proxy settings get Proxies if proxy is Active continue proxy proxy clone request add Proxy proxy mirrors mirror id nexus id mirror Of mirror Of url http repository sonatype org content groups public url mirror mirrors for Mirror mirror settings get Mirrors mirror mirror clone request add Mirror mirror request set Active Profiles settings get Active Profiles for org apache maven settings Profile raw Profile settings get Profiles request add Profile Settings Utils convert From Settings Profile raw Profile if settings get Active Profiles contains raw Profile get Id List Repository remote Repositories raw Profile get Repositories for Repository remote Repository remote Repositories try request add Remote Repository repository System build Artifact Repository remote Repository catch Invalid Repository Exception e do nothing for now List Repository plugin Repositories raw Profile get Plugin Repositories for Repository plugin Repo plugin Repositories try request add Plugin Artifact Repository repository System build Artifact Repository plugin Repo catch Invalid Repository Exception e do nothing for now return request end 
package org apache maven plugin internal Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import org apache commons lang Validate import org apache maven Repository Utils import org apache maven artifact Artifact import org apache maven classrealm Class Realm Manager import org apache maven execution Maven Session import org apache maven execution scope internal Mojo Execution Scope Module import org apache maven model Plugin import org apache maven monitor logging Default Log import org apache maven plugin Context Enabled import org apache maven plugin Debug Configuration Listener import org apache maven plugin Extension Realm Cache import org apache maven plugin Invalid Plugin Descriptor Exception import org apache maven plugin Maven Plugin Manager import org apache maven plugin Maven Plugin Validator import org apache maven plugin Mojo import org apache maven plugin Mojo Execution import org apache maven plugin Mojo Not Found Exception import org apache maven plugin Plugin Artifacts Cache import org apache maven plugin Plugin Configuration Exception import org apache maven plugin Plugin Container Exception import org apache maven plugin Plugin Descriptor Cache import org apache maven plugin Plugin Descriptor Parsing Exception import org apache maven plugin Plugin Incompatible Exception import org apache maven plugin Plugin Manager Exception import org apache maven plugin Plugin Parameter Exception import org apache maven plugin Plugin Parameter Expression Evaluator import org apache maven plugin Plugin Realm Cache import org apache maven plugin Plugin Resolution Exception import org apache maven plugin descriptor Mojo Descriptor import org apache maven plugin descriptor Parameter import org apache maven plugin descriptor Plugin Descriptor import org apache maven plugin descriptor Plugin Descriptor Builder import org apache maven plugin version Default Plugin Version Request import org apache maven plugin version Plugin Version Request import org apache maven plugin version Plugin Version Resolution Exception import org apache maven plugin version Plugin Version Resolver import org apache maven project Extension Descriptor import org apache maven project Extension Descriptor Builder import org apache maven project Maven Project import org apache maven rtinfo Runtime Information import org apache maven session scope internal Session Scope Module import org codehaus plexus Default Plexus Container import org codehaus plexus Plexus Container import org codehaus plexus classworlds realm Class Realm import org codehaus plexus component annotations Component import org codehaus plexus component annotations Requirement import org codehaus plexus component composition Cycle Detected In Component Graph Exception import org codehaus plexus component configurator Component Configuration Exception import org codehaus plexus component configurator Component Configurator import org codehaus plexus component configurator Configuration Listener import org codehaus plexus component configurator expression Expression Evaluation Exception import org codehaus plexus component configurator expression Expression Evaluator import org codehaus plexus component repository Component Descriptor import org codehaus plexus component repository exception Component Lifecycle Exception import org codehaus plexus component repository exception Component Lookup Exception import org codehaus plexus configuration Plexus Configuration import org codehaus plexus configuration Plexus Configuration Exception import org codehaus plexus configuration xml Xml Plexus Configuration import org codehaus plexus logging Logger import org codehaus plexus logging Logger Manager import org codehaus plexus util Reader Factory import org codehaus plexus util String Utils import org codehaus plexus util xml Xpp Dom import org eclipse aether Repository System Session import org eclipse aether graph Dependency Filter import org eclipse aether graph Dependency Node import org eclipse aether repository Remote Repository import org eclipse aether util filter And Dependency Filter import org eclipse aether util graph visitor Preorder Node List Generator import java io Buffered Input Stream import java io Byte Array Output Stream import java io File import java io File Input Stream import java io Exception import java io Input Stream import java io Print Stream import java io Reader import java util Array List import java util Collection import java util Collections import java util Hash Map import java util Iterator import java util List import java util Map import java util jar Jar File import java util zip Zip Entry Provides basic services to manage Maven plugins and their mojos This component is kept general in its design such that the plugins mojos can be used in arbitrary contexts In particular the mojos can be used for ordinary build plugins as well as special purpose plugins like reports author Benjamin Bentmann since Component role Maven Plugin Manager class public class Default Maven Plugin Manager implements Maven Plugin Manager p Plugin Id gt Extension Realm Cache Cache Record map Maven Project context value key The map is used to ensure the same class realm is used to load build extensions and load mojos for extensions true plugins p strong Note strong This is part of internal implementation and may be changed or removed without notice since public static final String Default Maven Plugin Manager class get Name extensions Realms Requirement private Logger logger Requirement private Logger Manager logger Manager Requirement private Plexus Container container Requirement private Class Realm Manager class Realm Manager Requirement private Plugin Descriptor Cache plugin Descriptor Cache Requirement private Plugin Realm Cache plugin Realm Cache Requirement private Plugin Dependencies Resolver plugin Dependencies Resolver Requirement private Runtime Information runtime Information Requirement private Extension Realm Cache extension Realm Cache Requirement private Plugin Version Resolver plugin Version Resolver Requirement private Plugin Artifacts Cache plugin Artifacts Cache private Extension Descriptor Builder extension Descriptor Builder new Extension Descriptor Builder private Plugin Descriptor Builder builder new Plugin Descriptor Builder public synchronized Plugin Descriptor get Plugin Descriptor Plugin plugin List Remote Repository repositories Repository System Session session throws Plugin Resolution Exception Plugin Descriptor Parsing Exception Invalid Plugin Descriptor Exception Plugin Descriptor Cache Key cache Key plugin Descriptor Cache create Key plugin repositories session Plugin Descriptor plugin Descriptor plugin Descriptor Cache get cache Key if plugin Descriptor null org eclipse aether artifact Artifact artifact plugin Dependencies Resolver resolve plugin repositories session Artifact plugin Artifact Repository Utils to Artifact artifact plugin Descriptor extract Plugin Descriptor plugin Artifact plugin plugin Descriptor set Required Maven Version artifact get Property required Maven Version null plugin Descriptor Cache put cache Key plugin Descriptor plugin Descriptor set Plugin plugin return plugin Descriptor private Plugin Descriptor extract Plugin Descriptor Artifact plugin Artifact Plugin plugin throws Plugin Descriptor Parsing Exception Invalid Plugin Descriptor Exception Plugin Descriptor plugin Descriptor null File plugin File plugin Artifact get File try if plugin File is File try Jar File plugin Jar new Jar File plugin File false Zip Entry plugin Descriptor Entry plugin Jar get Entry get Plugin Descriptor Location if plugin Descriptor Entry null Input Stream is plugin Jar get Input Stream plugin Descriptor Entry plugin Descriptor parse Plugin Descriptor is plugin plugin File get Absolute Path else File plugin Xml new File plugin File get Plugin Descriptor Location if plugin Xml is File try Input Stream is new Buffered Input Stream new File Input Stream plugin Xml plugin Descriptor parse Plugin Descriptor is plugin plugin Xml get Absolute Path if plugin Descriptor null throw new Exception No plugin descriptor found at get Plugin Descriptor Location catch Exception e throw new Plugin Descriptor Parsing Exception plugin plugin File get Absolute Path e Maven Plugin Validator validator new Maven Plugin Validator plugin Artifact validator validate plugin Descriptor if validator has Errors throw new Invalid Plugin Descriptor Exception Invalid plugin descriptor for plugin get Id plugin File validator get Errors plugin Descriptor set Plugin Artifact plugin Artifact return plugin Descriptor private String get Plugin Descriptor Location return maven plugin xml private Plugin Descriptor parse Plugin Descriptor Input Stream is Plugin plugin String descriptor Location throws Plugin Descriptor Parsing Exception try Reader reader Reader Factory new Xml Reader is Plugin Descriptor plugin Descriptor builder build reader descriptor Location return plugin Descriptor catch Exception Plexus Configuration Exception e throw new Plugin Descriptor Parsing Exception plugin descriptor Location e public Mojo Descriptor get Mojo Descriptor Plugin plugin String goal List Remote Repository repositories Repository System Session session throws Mojo Not Found Exception Plugin Resolution Exception Plugin Descriptor Parsing Exception Invalid Plugin Descriptor Exception Plugin Descriptor plugin Descriptor get Plugin Descriptor plugin repositories session Mojo Descriptor mojo Descriptor plugin Descriptor get Mojo goal if mojo Descriptor null throw new Mojo Not Found Exception goal plugin Descriptor return mojo Descriptor public void check Required Maven Version Plugin Descriptor plugin Descriptor throws Plugin Incompatible Exception String required Maven Version plugin Descriptor get Required Maven Version if String Utils is Not Blank required Maven Version try if runtime Information is Maven Version required Maven Version throw new Plugin Incompatible Exception plugin Descriptor get Plugin The plugin plugin Descriptor get Id requires Maven version required Maven Version catch Runtime Exception e logger warn Could not verify plugin s Maven prerequisite e get Message public synchronized void setup Plugin Realm Plugin Descriptor plugin Descriptor Maven Session session Class Loader parent List String imports Dependency Filter filter throws Plugin Resolution Exception Plugin Container Exception Plugin plugin plugin Descriptor get Plugin Maven Project project session get Current Project if plugin is Extensions Extension Realm Cache Cache Record extension Record try Repository System Session repository Session session get Repository Session extension Record setup Extensions Realm project plugin repository Session catch Plugin Manager Exception e extensions realm is expected to be fully setup at this point any exception means a problem in maven code not a user error throw new Illegal State Exception e Class Realm plugin Realm extension Record realm List Artifact plugin Artifacts extension Record artifacts for Component Descriptor component Descriptor plugin Descriptor get Components component Descriptor set Realm plugin Realm plugin Descriptor set Class Realm plugin Realm plugin Descriptor set Artifacts plugin Artifacts else Map String Class Loader foreign Imports calc Imports project parent imports Plugin Realm Cache Key cache Key plugin Realm Cache create Key plugin parent foreign Imports filter project get Remote Plugin Repositories session get Repository Session Plugin Realm Cache Cache Record cache Record plugin Realm Cache get cache Key if cache Record null plugin Descriptor set Class Realm cache Record realm plugin Descriptor set Artifacts new Array List cache Record artifacts for Component Descriptor component Descriptor plugin Descriptor get Components component Descriptor set Realm cache Record realm else create Plugin Realm plugin Descriptor session parent foreign Imports filter cache Record plugin Realm Cache put cache Key plugin Descriptor get Class Realm plugin Descriptor get Artifacts plugin Realm Cache register project cache Key cache Record private void create Plugin Realm Plugin Descriptor plugin Descriptor Maven Session session Class Loader parent Map String Class Loader foreign Imports Dependency Filter filter throws Plugin Resolution Exception Plugin Container Exception Plugin plugin Validate not Null plugin Descriptor get Plugin plugin Descriptor plugin can not be null Artifact plugin Artifact Validate not Null plugin Descriptor get Plugin Artifact plugin Descriptor plugin Artifact can not be null Maven Project project session get Current Project final Class Realm plugin Realm final List Artifact plugin Artifacts Repository System Session repository Session session get Repository Session Dependency Filter dependency Filter project get Extension Dependency Filter dependency Filter And Dependency Filter new Instance dependency Filter filter Dependency Node root plugin Dependencies Resolver resolve plugin Repository Utils to Artifact plugin Artifact dependency Filter project get Remote Plugin Repositories repository Session Preorder Node List Generator nlg new Preorder Node List Generator root accept nlg plugin Artifacts to Maven Artifacts root nlg plugin Realm class Realm Manager create Plugin Realm plugin parent null foreign Imports to Aether Artifacts plugin Artifacts discover Plugin Components plugin Realm plugin plugin Descriptor plugin Descriptor set Class Realm plugin Realm plugin Descriptor set Artifacts plugin Artifacts private void discover Plugin Components final Class Realm plugin Realm Plugin plugin Plugin Descriptor plugin Descriptor throws Plugin Container Exception try if plugin Descriptor null for Component Descriptor component Descriptor plugin Descriptor get Components component Descriptor set Realm plugin Realm container add Component Descriptor component Descriptor Default Plexus Container container discover Components plugin Realm new Session Scope Module container new Mojo Execution Scope Module container catch Component Lookup Exception Cycle Detected In Component Graph Exception e throw new Plugin Container Exception plugin plugin Realm Error in component graph of plugin plugin get Id e get Message e private List org eclipse aether artifact Artifact to Aether Artifacts final List Artifact plugin Artifacts return new Array List Repository Utils to Artifacts plugin Artifacts private List Artifact to Maven Artifacts Dependency Node root Preorder Node List Generator nlg List Artifact artifacts new Array List nlg get Nodes size Repository Utils to Artifacts artifacts Collections singleton root Collections String empty List null for Iterator Artifact it artifacts iterator it has Next Artifact artifact it next if artifact get File null it remove return artifacts private Map String Class Loader calc Imports Maven Project project Class Loader parent List String imports Map String Class Loader foreign Imports new Hash Map Class Loader project Realm project get Class Realm if project Realm null foreign Imports put project Realm else foreign Imports put class Realm Manager get Maven Api Realm if parent null imports null for String parent Import imports foreign Imports put parent Import parent return foreign Imports public get Configured Mojo Class mojo Interface Maven Session session Mojo Execution mojo Execution throws Plugin Configuration Exception Plugin Container Exception Mojo Descriptor mojo Descriptor mojo Execution get Mojo Descriptor Plugin Descriptor plugin Descriptor mojo Descriptor get Plugin Descriptor Class Realm plugin Realm plugin Descriptor get Class Realm if logger is Debug Enabled logger debug Configuring mojo mojo Descriptor get Id from plugin realm plugin Realm We are forcing the use of the plugin realm for all lookups that might occur during the lifecycle that is part of the lookup Here we are specifically trying to keep lookups that occur in contextualize calls in line with the right realm Class Realm old Lookup Realm container set Lookup Realm plugin Realm Class Loader old Class Loader Thread current Thread get Context Class Loader Thread current Thread set Context Class Loader plugin Realm try mojo try mojo container lookup mojo Interface mojo Descriptor get Role Hint catch Component Lookup Exception e Throwable cause e get Cause while cause null cause instanceof Linkage Error cause instanceof Class Not Found Exception cause cause get Cause if cause instanceof No Class Def Found Error cause instanceof Class Not Found Exception Byte Array Output Stream os new Byte Array Output Stream Print Stream ps new Print Stream os ps println Unable to load the mojo mojo Descriptor get Goal in the plugin plugin Descriptor get Id required class is missing cause get Message plugin Realm display ps throw new Plugin Container Exception mojo Descriptor plugin Realm os to String cause else if cause instanceof Linkage Error Byte Array Output Stream os new Byte Array Output Stream Print Stream ps new Print Stream os ps println Unable to load the mojo mojo Descriptor get Goal in the plugin plugin Descriptor get Id due to an incompatibility e get Class get Name cause get Message plugin Realm display ps throw new Plugin Container Exception mojo Descriptor plugin Realm os to String cause throw new Plugin Container Exception mojo Descriptor plugin Realm Unable to load the mojo mojo Descriptor get Goal or one of its required components from the plugin plugin Descriptor get Id e if mojo instanceof Context Enabled Maven Project project session get Current Project Map String Object plugin Context session get Plugin Context plugin Descriptor project if plugin Context null plugin Context put project project plugin Context put plugin Descriptor plugin Descriptor Context Enabled mojo set Plugin Context plugin Context if mojo instanceof Mojo Logger mojo Logger logger Manager get Logger For Component mojo Descriptor get Implementation Mojo mojo set Log new Default Log mojo Logger Xpp Dom dom mojo Execution get Configuration Plexus Configuration pom Configuration if dom null pom Configuration new Xml Plexus Configuration configuration else pom Configuration new Xml Plexus Configuration dom Expression Evaluator expression Evaluator new Plugin Parameter Expression Evaluator session mojo Execution populate Plugin Fields mojo mojo Descriptor plugin Realm pom Configuration expression Evaluator return mojo finally Thread current Thread set Context Class Loader old Class Loader container set Lookup Realm old Lookup Realm private void populate Plugin Fields Object mojo Mojo Descriptor mojo Descriptor Class Realm plugin Realm Plexus Configuration configuration Expression Evaluator expression Evaluator throws Plugin Configuration Exception Component Configurator configurator null String configurator Id mojo Descriptor get Component Configurator if String Utils is Empty configurator Id configurator Id basic try could the configuration be passed to lookup and the configurator known to plexus via the descriptor so that this method could entirely be handled by a plexus lookup configurator container lookup Component Configurator class configurator Id Configuration Listener listener new Debug Configuration Listener logger Validating Configuration Listener validator new Validating Configuration Listener mojo mojo Descriptor listener logger debug Configuring mojo mojo Descriptor get Id with configurator Id configurator configurator configure Component mojo configuration expression Evaluator plugin Realm validator logger debug end configuration Collection Parameter missing Parameters validator get Missing Parameters if missing Parameters is Empty if basic equals configurator Id throw new Plugin Parameter Exception mojo Descriptor new Array List missing Parameters else Other configurators like the map oriented one do n t call into the listener so do it the hard way validate Parameters mojo Descriptor configuration expression Evaluator catch Component Configuration Exception e String message Unable to parse configuration of mojo mojo Descriptor get Id if e get Failed Configuration null message for parameter e get Failed Configuration get Name message e get Message throw new Plugin Configuration Exception mojo Descriptor get Plugin Descriptor message e catch Component Lookup Exception e throw new Plugin Configuration Exception mojo Descriptor get Plugin Descriptor Unable to retrieve component configurator configurator Id for configuration of mojo mojo Descriptor get Id e catch No Class Def Found Error e Byte Array Output Stream os new Byte Array Output Stream Print Stream ps new Print Stream os ps println required class was missing during configuration of mojo mojo Descriptor get Id e get Message plugin Realm display ps throw new Plugin Configuration Exception mojo Descriptor get Plugin Descriptor os to String e catch Linkage Error e Byte Array Output Stream os new Byte Array Output Stream Print Stream ps new Print Stream os ps println An incompatibility was encountered during configuration of mojo mojo Descriptor get Id e get Class get Name e get Message plugin Realm display ps throw new Plugin Configuration Exception mojo Descriptor get Plugin Descriptor os to String e finally if configurator null try container release configurator catch Component Lifecycle Exception e logger debug Failed to release mojo configurator ignoring private void validate Parameters Mojo Descriptor mojo Descriptor Plexus Configuration configuration Expression Evaluator expression Evaluator throws Component Configuration Exception Plugin Parameter Exception if mojo Descriptor get Parameters null return List Parameter invalid Parameters new Array List for Parameter parameter mojo Descriptor get Parameters if parameter is Required continue Object value null Plexus Configuration config configuration get Child parameter get Name false if config null String expression config get Value null try value expression Evaluator evaluate expression if value null value config get Attribute default value null catch Expression Evaluation Exception e String msg Error evaluating the expression expression for configuration value configuration get Name throw new Component Configuration Exception configuration msg e if value null config null config get Child Count invalid Parameters add parameter if invalid Parameters is Empty throw new Plugin Parameter Exception mojo Descriptor invalid Parameters public void release Mojo Object mojo Mojo Execution mojo Execution if mojo null try container release mojo catch Component Lifecycle Exception e String goal Exec Id mojo Execution get Goal if mojo Execution get Execution Id null goal Exec Id execution mojo Execution get Execution Id logger debug Error releasing mojo for goal Exec Id e public Extension Realm Cache Cache Record setup Extensions Realm Maven Project project Plugin plugin Repository System Session session throws Plugin Manager Exception Suppress Warnings unchecked Map String Extension Realm Cache Cache Record plugin Realms Map String Extension Realm Cache Cache Record project get Context Value if plugin Realms null plugin Realms new Hash Map project set Context Value plugin Realms final String plugin Key plugin get Id Extension Realm Cache Cache Record extension Record plugin Realms get plugin Key if extension Record null return extension Record final List Remote Repository repositories project get Remote Plugin Repositories resolve plugin version as necessary if plugin get Version null Plugin Version Request version Request new Default Plugin Version Request plugin session repositories try plugin set Version plugin Version Resolver resolve version Request get Version catch Plugin Version Resolution Exception e throw new Plugin Manager Exception plugin e get Message e resolve plugin artifacts List Artifact artifacts Plugin Artifacts Cache Key cache Key plugin Artifacts Cache create Key plugin null repositories session Plugin Artifacts Cache Cache Record record Artifacts try record Artifacts plugin Artifacts Cache get cache Key catch Plugin Resolution Exception e throw new Plugin Manager Exception plugin e get Message e if record Artifacts null artifacts record Artifacts artifacts else try artifacts resolve Extension Artifacts plugin repositories session record Artifacts plugin Artifacts Cache put cache Key artifacts catch Plugin Resolution Exception e plugin Artifacts Cache put cache Key e plugin Artifacts Cache register project cache Key record Artifacts throw new Plugin Manager Exception plugin e get Message e plugin Artifacts Cache register project cache Key record Artifacts create and cache extensions realms final Extension Realm Cache Key extension Key extension Realm Cache create Key artifacts extension Record extension Realm Cache get extension Key if extension Record null Class Realm extension Realm class Realm Manager create Extension Realm plugin to Aether Artifacts artifacts figure out how to use the same Plugin Descriptor when running mojos Plugin Descriptor plugin Descriptor null if plugin is Extensions artifacts is Empty ignore plugin descriptor parsing errors at this point these errors will reported during calculation of project build execution plan try plugin Descriptor extract Plugin Descriptor artifacts get plugin catch Plugin Descriptor Parsing Exception Invalid Plugin Descriptor Exception e ignore see above discover Plugin Components extension Realm plugin plugin Descriptor Extension Descriptor extension Descriptor null Artifact extension Artifact artifacts get try extension Descriptor extension Descriptor Builder build extension Artifact get File catch Exception e String message Invalid extension descriptor for plugin get Id e get Message if logger is Debug Enabled logger error message e else logger error message extension Record extension Realm Cache put extension Key extension Realm extension Descriptor artifacts extension Realm Cache register project extension Key extension Record plugin Realms put plugin Key extension Record return extension Record private List Artifact resolve Extension Artifacts Plugin extension Plugin List Remote Repository repositories Repository System Session session throws Plugin Resolution Exception Dependency Node root plugin Dependencies Resolver resolve extension Plugin null null repositories session Preorder Node List Generator nlg new Preorder Node List Generator root accept nlg return to Maven Artifacts root nlg 
package org apache maven project Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io File import java util Array List import java util Arrays import java util List import java util Properties import org apache maven artifact Artifact import org apache maven artifact Invalid Repository Exception import org apache maven artifact repository Artifact Repository import org apache maven artifact resolver Artifact Not Found Exception import org apache maven artifact resolver Artifact Resolution Exception import org apache maven execution Maven Execution Request import org apache maven execution Maven Session import org apache maven model Repository import org apache maven model building Model Building Exception import org apache maven model building Model Building Request import org apache maven model building Model Source import org apache maven model building Url Model Source import org apache maven plugin Legacy Support import org apache maven profiles Profile Manager import org apache maven properties internal Environment Utils import org apache maven repository Repository System import org apache maven wagon events Transfer Listener import org codehaus plexus component annotations Component import org codehaus plexus component annotations Requirement Component role Maven Project Builder class Deprecated public class Default Maven Project Builder implements Maven Project Builder Requirement private Project Builder project Builder Requirement private Repository System repository System Requirement private Legacy Support legacy Support Maven Project Builder Implementation private Project Building Request to Request Project Builder Configuration configuration Default Project Building Request request new Default Project Building Request request set Validation Level Model Building Request request set Resolve Dependencies false request set Local Repository configuration get Local Repository request set Build Start Time configuration get Build Start Time request set User Properties configuration get User Properties request set System Properties configuration get Execution Properties Profile Manager profile Manager configuration get Global Profile Manager if profile Manager null request set Active Profile Ids profile Manager get Explicitly Activated Ids request set Inactive Profile Ids profile Manager get Explicitly Deactivated Ids else Hack to workaround deficiency of legacy which makes it impossible for plugins to access the global profile manager which is required to build a like a invocation does Failure to consider the activated profiles can cause repo declarations to be lost which in turn will result in artifact resolution failures in particular when using the enhanced local repo which guards access to local files based on the configured remote repos Maven Session session legacy Support get Session if session null Maven Execution Request req session get Request if req null request set Active Profile Ids req get Active Profiles request set Inactive Profile Ids req get Inactive Profiles return request private Project Building Request inject Session Project Building Request request Maven Session session legacy Support get Session if session null request set Repository Session session get Repository Session request set System Properties session get System Properties if request get User Properties is Empty request set User Properties session get User Properties Maven Execution Request req session get Request if req null request set Remote Repositories req get Remote Repositories else Properties props new Properties Environment Utils add Env Vars props props put All System get Properties request set System Properties props return request Suppress Warnings unchecked private List Artifact Repository normalize To Artifact Repositories List repositories Project Building Request request throws Project Building Exception This provides backward compat with x that allowed plugins like the maven remote resources plugin to populate the builder configuration with model repositories instead of artifact repositories if repositories null boolean normalized false List Artifact Repository repos new Array List repositories size for Object repository repositories if repository instanceof Repository try Artifact Repository repo repository System build Artifact Repository Repository repository repository System inject Mirror request get Repository Session Arrays as List repo repository System inject Proxy request get Repository Session Arrays as List repo repository System inject Authentication request get Repository Session Arrays as List repo repos add repo catch Invalid Repository Exception e throw new Project Building Exception Invalid remote repository repository e normalized true else repos add Artifact Repository repository if normalized return repos return List Artifact Repository repositories private Project Building Exception transform Error Project Building Exception e if e get Cause instanceof Model Building Exception return new Invalid Project Model Exception e get Project Id e get Message e get Pom File return e public Maven Project build File pom Project Builder Configuration configuration throws Project Building Exception Project Building Request request inject Session to Request configuration try return project Builder build pom request get Project catch Project Building Exception e throw transform Error e This is used by the plugin public Maven Project build File pom Artifact Repository local Repository Profile Manager profile Manager throws Project Building Exception Project Builder Configuration configuration new Default Project Builder Configuration configuration set Local Repository local Repository configuration set Global Profile Manager profile Manager return build pom configuration public Maven Project build From Repository Artifact artifact List Artifact Repository remote Repositories Project Builder Configuration configuration boolean allow Stub Model throws Project Building Exception Project Building Request request inject Session to Request configuration request set Remote Repositories normalize To Artifact Repositories remote Repositories request request set Process Plugins false request set Validation Level Model Building Request try return project Builder build artifact allow Stub Model request get Project catch Project Building Exception e throw transform Error e public Maven Project build From Repository Artifact artifact List Artifact Repository remote Repositories Artifact Repository local Repository boolean allow Stub Model throws Project Building Exception Project Builder Configuration configuration new Default Project Builder Configuration configuration set Local Repository local Repository return build From Repository artifact remote Repositories configuration allow Stub Model public Maven Project build From Repository Artifact artifact List Artifact Repository remote Repositories Artifact Repository local Repository throws Project Building Exception return build From Repository artifact remote Repositories local Repository true This is used for pom less execution like running archetype generate am taking out the profile handling and the interpolation of the base directory until we spec this out properly public Maven Project build Standalone Super Project Project Builder Configuration configuration throws Project Building Exception Project Building Request request inject Session to Request configuration request set Process Plugins false request set Validation Level Model Building Request Model Source model Source new Url Model Source get Class get Resource standalone xml Maven Project project project Builder build model Source request get Project project set Execution Root true return project public Maven Project build Standalone Super Project Artifact Repository local Repository throws Project Building Exception return build Standalone Super Project local Repository null public Maven Project build Standalone Super Project Artifact Repository local Repository Profile Manager profile Manager throws Project Building Exception Project Builder Configuration configuration new Default Project Builder Configuration configuration set Local Repository local Repository configuration set Global Profile Manager profile Manager return build Standalone Super Project configuration public Maven Project build With Dependencies File pom Artifact Repository local Repository Profile Manager profile Manager Transfer Listener transfer Listener throws Project Building Exception Artifact Resolution Exception Artifact Not Found Exception Project Builder Configuration configuration new Default Project Builder Configuration configuration set Local Repository local Repository configuration set Global Profile Manager profile Manager Project Building Request request inject Session to Request configuration request set Resolve Dependencies true try return project Builder build pom request get Project catch Project Building Exception e throw transform Error e public Maven Project build With Dependencies File pom Artifact Repository local Repository Profile Manager profile Manager throws Project Building Exception Artifact Resolution Exception Artifact Not Found Exception return build With Dependencies pom local Repository profile Manager null 
package org apache maven repository Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java net Malformed Exception import java net import java util List import org apache maven Repository Utils import org apache maven artifact repository Artifact Repository import org apache maven settings Mirror import org codehaus plexus component annotations Component import org codehaus plexus util String Utils Component role Mirror Selector class public class Default Mirror Selector implements Mirror Selector private static final String private static final String external public Mirror get Mirror Artifact Repository repository List Mirror mirrors String repo Id repository get Id if repo Id null mirrors null for Mirror mirror mirrors if repo Id equals mirror get Mirror Of matches Layout repository mirror return mirror for Mirror mirror mirrors if match Pattern repository mirror get Mirror Of matches Layout repository mirror return mirror return null This method checks if the pattern matches the original Repository Valid patterns everything external everything not on the localhost and not file based repo repo repo or repo repo everything except repo param original Repository to compare for a match param pattern used for match Currently only is supported return true if the repository is a match to this pattern static boolean match Pattern Artifact Repository original Repository String pattern boolean result false String original Id original Repository get Id simple checks first to short circuit processing below if equals pattern pattern equals original Id result true else process the list String repos pattern split for String repo repos repo repo trim see if this is a negative match if repo length repo starts With if repo substring equals original Id explicitly exclude Set result and stop processing result false break check for exact match else if repo equals original Id result true break check for external else if equals repo is External Repo original Repository result true do n t stop processing in case a future segment explicitly excludes this repo else if equals repo result true do n t stop processing in case a future segment explicitly excludes this repo return result Checks the to see if this repository refers to an external repository param original Repository return true if external static boolean is External Repo Artifact Repository original Repository try url new original Repository get Url return url get Host equals localhost url get Host equals url get Protocol equals file catch Malformed Exception e bad url just skip it here It should have been validated already but the wagon lookup will deal with it return false static boolean matches Layout Artifact Repository repository Mirror mirror return matches Layout Repository Utils get Layout repository mirror get Mirror Of Layouts Checks whether the layouts configured for a mirror match with the layout of the repository param repo Layout The layout of the repository may be code null param mirror Layout The layouts supported by the mirror may be code null return code true if the layouts associated with the mirror match the layout of the original repository code false otherwise static boolean matches Layout String repo Layout String mirror Layout boolean result false simple checks first to short circuit processing below if String Utils is Empty mirror Layout equals mirror Layout result true else if mirror Layout equals repo Layout result true else process the list String layouts mirror Layout split for String layout layouts see if this is a negative match if layout length layout starts With if layout substring equals repo Layout explicitly exclude Set result and stop processing result false break check for exact match else if layout equals repo Layout result true break else if equals layout result true do n t stop processing in case a future segment explicitly excludes this repo return result 
package org apache maven model building Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import org apache commons lang Validate import org apache maven artifact versioning Default Artifact Version import org apache maven artifact versioning Invalid Version Specification Exception import org apache maven artifact versioning Version Range import org apache maven model Activation import org apache maven model Build import org apache maven model Dependency import org apache maven model Dependency Management import org apache maven model Input Location import org apache maven model Input Source import org apache maven model Model import org apache maven model Parent import org apache maven model Plugin import org apache maven model Plugin Management import org apache maven model Profile import org apache maven model Repository import org apache maven model building Model Problem Severity import org apache maven model building Model Problem Version import org apache maven model composition Dependency Management Importer import org apache maven model inheritance Inheritance Assembler import org apache maven model interpolation Model Interpolator import org apache maven model io Model Parse Exception import org apache maven model management Dependency Management Injector import org apache maven model management Plugin Management Injector import org apache maven model normalization Model Normalizer import org apache maven model path Model Path Translator import org apache maven model path Model Url Normalizer import org apache maven model plugin Lifecycle Bindings Injector import org apache maven model plugin Plugin Configuration Expander import org apache maven model plugin Report Configuration Expander import org apache maven model plugin Reporting Converter import org apache maven model profile Default Profile Activation Context import org apache maven model profile Profile Injector import org apache maven model profile Profile Selector import org apache maven model resolution Invalid Repository Exception import org apache maven model resolution Model Resolver import org apache maven model resolution Unresolvable Model Exception import org apache maven model resolution Workspace Model Resolver import org apache maven model superpom Super Pom Provider import org apache maven model validation Model Validator import org codehaus plexus component annotations Component import org codehaus plexus component annotations Requirement import org codehaus plexus interpolation Map Based Value Source import org codehaus plexus interpolation String Search Interpolator import java io File import java io Exception import java util Array List import java util Collection import java util Hash Map import java util Iterator import java util Linked Hash Set import java util List import java util Map import java util Properties import static org apache maven model building Result error import static org apache maven model building Result new Result author Benjamin Bentmann Component role Model Builder class public class Default Model Builder implements Model Builder Requirement private Model Processor model Processor Requirement private Model Validator model Validator Requirement private Model Normalizer model Normalizer Requirement private Model Interpolator model Interpolator Requirement private Model Path Translator model Path Translator Requirement private Model Url Normalizer model Url Normalizer Requirement private Super Pom Provider super Pom Provider Requirement private Inheritance Assembler inheritance Assembler Requirement private Profile Selector profile Selector Requirement private Profile Injector profile Injector Requirement private Plugin Management Injector plugin Management Injector Requirement private Dependency Management Injector dependency Management Injector Requirement private Dependency Management Importer dependency Management Importer Requirement optional true private Lifecycle Bindings Injector lifecycle Bindings Injector Requirement private Plugin Configuration Expander plugin Configuration Expander Requirement private Report Configuration Expander report Configuration Expander Requirement private Reporting Converter reporting Converter public Default Model Builder set Model Processor Model Processor model Processor this model Processor model Processor return this public Default Model Builder set Model Validator Model Validator model Validator this model Validator model Validator return this public Default Model Builder set Model Normalizer Model Normalizer model Normalizer this model Normalizer model Normalizer return this public Default Model Builder set Model Interpolator Model Interpolator model Interpolator this model Interpolator model Interpolator return this public Default Model Builder set Model Path Translator Model Path Translator model Path Translator this model Path Translator model Path Translator return this public Default Model Builder set Model Url Normalizer Model Url Normalizer model Url Normalizer this model Url Normalizer model Url Normalizer return this public Default Model Builder set Super Pom Provider Super Pom Provider super Pom Provider this super Pom Provider super Pom Provider return this public Default Model Builder set Profile Selector Profile Selector profile Selector this profile Selector profile Selector return this public Default Model Builder set Profile Injector Profile Injector profile Injector this profile Injector profile Injector return this public Default Model Builder set Inheritance Assembler Inheritance Assembler inheritance Assembler this inheritance Assembler inheritance Assembler return this public Default Model Builder set Dependency Management Importer Dependency Management Importer dep Mgmt Importer this dependency Management Importer dep Mgmt Importer return this public Default Model Builder set Dependency Management Injector Dependency Management Injector dep Mgmt Injector this dependency Management Injector dep Mgmt Injector return this public Default Model Builder set Lifecycle Bindings Injector Lifecycle Bindings Injector lifecycle Bindings Injector this lifecycle Bindings Injector lifecycle Bindings Injector return this public Default Model Builder set Plugin Configuration Expander Plugin Configuration Expander plugin Configuration Expander this plugin Configuration Expander plugin Configuration Expander return this public Default Model Builder set Plugin Management Injector Plugin Management Injector plugin Management Injector this plugin Management Injector plugin Management Injector return this public Default Model Builder set Report Configuration Expander Report Configuration Expander report Configuration Expander this report Configuration Expander report Configuration Expander return this public Default Model Builder set Reporting Converter Reporting Converter reporting Converter this reporting Converter reporting Converter return this Override public Model Building Result build Model Building Request request throws Model Building Exception phase Default Model Building Result result new Default Model Building Result Default Model Problem Collector problems new Default Model Problem Collector result profile activation Default Profile Activation Context profile Activation Context get Profile Activation Context request problems set Source external profiles List Profile active External Profiles profile Selector get Active Profiles request get Profiles profile Activation Context problems result set Active External Profiles active External Profiles if active External Profiles is Empty Properties profile Props new Properties for Profile profile active External Profiles profile Props put All profile get Properties profile Props put All profile Activation Context get User Properties profile Activation Context set User Properties profile Props read and validate raw model Model input Model request get Raw Model if input Model null input Model read Model request get Model Source request get Pom File request problems problems set Root Model input Model Model Data result Data new Model Data request get Model Source input Model Model Data super Data new Model Data null get Super Model Collection String parent Ids new Linked Hash Set List Model Data lineage new Array List for Model Data current Data result Data current Data null lineage add current Data Model raw Model current Data get Model current Data set Raw Model raw Model Model tmp Model raw Model clone current Data set Model tmp Model problems set Source tmp Model model normalization model Normalizer merge Duplicates tmp Model request problems profile Activation Context set Project Properties tmp Model get Properties List Profile active Pom Profiles profile Selector get Active Profiles raw Model get Profiles profile Activation Context problems current Data set Active Profiles active Pom Profiles Map String Activation interpolated Activations get Profile Activations raw Model false inject Profile Activations tmp Model interpolated Activations profile injection for Profile active Profile active Pom Profiles profile Injector inject Profile tmp Model active Profile request problems if current Data result Data for Profile active Profile active External Profiles profile Injector inject Profile tmp Model active Profile request problems if current Data super Data break configure Resolver request get Model Resolver tmp Model problems Model Data parent Data read Parent tmp Model current Data get Source request problems if parent Data null current Data super Data else if current Data result Data First iteration add initial id after version resolution current Data set Group Id current Data get Raw Model get Group Id null parent Data get Group Id current Data get Raw Model get Group Id current Data set Version current Data get Raw Model get Version null parent Data get Version current Data get Raw Model get Version current Data set Artifact Id current Data get Raw Model get Artifact Id parent Ids add current Data get Id Reset only needed for get Id current Data set Group Id null current Data set Artifact Id null current Data set Version null current Data parent Data else if parent Ids add parent Data get Id String message The parents form a cycle for String model Id parent Ids message model Id message parent Data get Id problems add new Model Problem Collector Request Model Problem Severity Model Problem Version set Message message throw problems new Model Building Exception else current Data parent Data problems set Source input Model check Plugin Versions lineage request problems inheritance assembly assemble Inheritance lineage request problems Model result Model result Data get Model problems set Source result Model problems set Root Model result Model model interpolation result Model interpolate Model result Model request problems result Data set Model result Model url normalization model Url Normalizer normalize result Model request Now the fully interpolated model is available reconfigure the resolver configure Resolver request get Model Resolver result Model problems true result Data set Group Id result Model get Group Id result Data set Artifact Id result Model get Artifact Id result Data set Version result Model get Version result set Effective Model result Model for Model Data current Data lineage String model Id current Data super Data current Data get Id result add Model Id model Id result set Active Pom Profiles model Id current Data get Active Profiles result set Raw Model model Id current Data get Raw Model if request is Two Phase Building build request result return result Override public Model Building Result build Model Building Request request Model Building Result result throws Model Building Exception return build request result new Linked Hash Set String private Model Building Result build Model Building Request request Model Building Result result Collection String imports throws Model Building Exception phase Model result Model result get Effective Model Default Model Problem Collector problems new Default Model Problem Collector result problems set Source result Model problems set Root Model result Model model path translation model Path Translator align To Base Directory result Model result Model get Project Directory request plugin management injection plugin Management Injector inject Management result Model request problems fire Event result Model request problems Model Building Event Catapult if request is Process Plugins if lifecycle Bindings Injector null throw new Illegal State Exception lifecycle bindings injector is missing lifecycle bindings injection lifecycle Bindings Injector inject Lifecycle Bindings result Model request problems dependency management import import Dependency Management result Model request problems imports dependency management injection dependency Management Injector inject Management result Model request problems model Normalizer inject Default Values result Model request problems if request is Process Plugins reports configuration report Configuration Expander expand Plugin Configuration result Model request problems reports conversion to decoupled site plugin reporting Converter convert Reporting result Model request problems plugins configuration plugin Configuration Expander expand Plugin Configuration result Model request problems effective model validation model Validator validate Effective Model result Model request problems if has Model Errors problems throw problems new Model Building Exception return result Override public Result extends Model build Raw Model File pom File int validation Level boolean location Tracking final Model Building Request request new Default Model Building Request set Validation Level validation Level set Location Tracking location Tracking final Default Model Problem Collector collector new Default Model Problem Collector new Default Model Building Result try return new Result read Model null pom File request collector collector get Problems catch Model Building Exception e return error collector get Problems private Model read Model Model Source model Source File pom File Model Building Request request Default Model Problem Collector problems throws Model Building Exception Model model if model Source null if pom File null model Source new File Model Source pom File else throw new Null Pointer Exception neither pom File nor model Source can be null problems set Source model Source get Location try boolean strict request get Validation Level Model Building Request Input Source source request is Location Tracking new Input Source null Map String Object options new Hash Map options put Model Processor strict options put Model Processor source options put Model Processor model Source try model model Processor read model Source get Input Stream options catch Model Parse Exception e if strict throw e options put Model Processor Boolean try model model Processor read model Source get Input Stream options catch Model Parse Exception ne still unreadable even in non strict mode rethrow original error throw e if pom File null problems add new Model Problem Collector Request Severity Version set Message Malformed model Source get Location e get Message set Exception e else problems add new Model Problem Collector Request Severity Version set Message Malformed model Source get Location e get Message set Exception e if source null source set Model Id Model Problem Utils to Id model source set Location model Source get Location catch Model Parse Exception e problems add new Model Problem Collector Request Severity Version set Message Non parseable model Source get Location e get Message set Exception e throw problems new Model Building Exception catch Exception e String msg e get Message if msg null msg length There s java nio charset Malformed Input Exception and sun io Malformed Input Exception if e get Class get Name ends With Malformed Input Exception msg Some input bytes do not match the file encoding else msg e get Class get Simple Name problems add new Model Problem Collector Request Severity Version set Message Non readable model Source get Location msg set Exception e throw problems new Model Building Exception model set Pom File pom File problems set Source model model Validator validate Raw Model model request problems if has Fatal Errors problems throw problems new Model Building Exception return model private Default Profile Activation Context get Profile Activation Context Model Building Request request Default Profile Activation Context context new Default Profile Activation Context context set Active Profile Ids request get Active Profile Ids context set Inactive Profile Ids request get Inactive Profile Ids context set System Properties request get System Properties context set User Properties request get User Properties context set Project Directory request get Pom File null request get Pom File get Parent File null return context private void configure Resolver Model Resolver model Resolver Model model Default Model Problem Collector problems configure Resolver model Resolver model problems false private void configure Resolver Model Resolver model Resolver Model model Default Model Problem Collector problems boolean replace Repositories if model Resolver null return problems set Source model List Repository repositories model get Repositories for Repository repository repositories try model Resolver add Repository repository replace Repositories catch Invalid Repository Exception e problems add new Model Problem Collector Request Severity Version set Message Invalid repository repository get Id e get Message set Location repository get Location set Exception e private void check Plugin Versions List Model Data lineage Model Building Request request Model Problem Collector problems if request get Validation Level Model Building Request return Map String Plugin plugins new Hash Map Map String String versions new Hash Map Map String String managed Versions new Hash Map for int i lineage size i i Model model lineage get i get Model Build build model get Build if build null for Plugin plugin build get Plugins String key plugin get Key if versions get key null versions put key plugin get Version plugins put key plugin Plugin Management mgmt build get Plugin Management if mgmt null for Plugin plugin mgmt get Plugins String key plugin get Key if managed Versions get key null managed Versions put key plugin get Version for String key versions key Set if versions get key null managed Versions get key null Input Location location plugins get key get Location problems add new Model Problem Collector Request Severity Version set Message build plugins plugin version for key is missing set Location location private void assemble Inheritance List Model Data lineage Model Building Request request Model Problem Collector problems for int i lineage size i i Model parent lineage get i get Model Model child lineage get i get Model inheritance Assembler assemble Model Inheritance child parent request problems private Map String Activation get Profile Activations Model model boolean clone Map String Activation activations new Hash Map for Profile profile model get Profiles Activation activation profile get Activation if activation null continue if clone activation activation clone activations put profile get Id activation return activations private void inject Profile Activations Model model Map String Activation activations for Profile profile model get Profiles Activation activation profile get Activation if activation null continue restore activation profile set Activation activations get profile get Id private Model interpolate Model Model model Model Building Request request Model Problem Collector problems save profile activations before interpolation since they are evaluated with limited scope Map String Activation original Activations get Profile Activations model true Model interpolated Model model Interpolator interpolate Model model model get Project Directory request problems if interpolated Model get Parent null String Search Interpolator ssi new String Search Interpolator ssi add Value Source new Map Based Value Source request get User Properties ssi add Value Source new Map Based Value Source model get Properties ssi add Value Source new Map Based Value Source request get System Properties try String interpolated ssi interpolate interpolated Model get Parent get Version interpolated Model get Parent set Version interpolated catch Exception e Model Problem Collector Request mpcr new Model Problem Collector Request Severity Version set Message Failed to interpolate field interpolated Model get Parent get Version on class set Exception e problems add mpcr interpolated Model set Pom File model get Pom File restore profiles with file activation to their value before full interpolation inject Profile Activations model original Activations return interpolated Model private Model Data read Parent Model child Model Model Source child Source Model Building Request request Default Model Problem Collector problems throws Model Building Exception Model Data parent Data Parent parent child Model get Parent if parent null String group Id parent get Group Id String artifact Id parent get Artifact Id String version parent get Version parent Data get Cache request get Model Cache group Id artifact Id version Model Cache Tag if parent Data null parent Data read Parent Locally child Model child Source request problems if parent Data null parent Data read Parent Externally child Model request problems put Cache request get Model Cache group Id artifact Id version Model Cache Tag parent Data else This is a sanity check of the cache hit If the cached parent was locally resolved the child s relative Path should point at that parent too If it does n t we ignore the cache and resolve externally to mimic the behavior if the cache did n t exist in the first place Otherwise the cache would obscure a bad File pom File parent Data get Model get Pom File if pom File null Model Source expected Parent Source get Parent Pom File child Model child Source if expected Parent Source instanceof Model Source pom File to equals Model Source expected Parent Source get Location parent Data read Parent Externally child Model request problems Model parent Model parent Data get Model if pom equals parent Model get Packaging problems add new Model Problem Collector Request Severity Version set Message Invalid packaging for parent Model Problem Utils to Source Hint parent Model must be pom but is parent Model get Packaging set Location parent Model get Location packaging else parent Data null return parent Data private Model Data read Parent Locally Model child Model Model Source child Source Model Building Request request Default Model Problem Collector problems throws Model Building Exception final Parent parent child Model get Parent final Model Source candidate Source final Model candidate Model final Workspace Model Resolver resolver request get Workspace Model Resolver if resolver null candidate Source get Parent Pom File child Model child Source if candidate Source null return null File pom File null if candidate Source instanceof File Model Source pom File File Model Source candidate Source get Pom File candidate Model read Model candidate Source pom File request problems else try candidate Model resolver resolve Raw Model parent get Group Id parent get Artifact Id parent get Version catch Unresolvable Model Exception e problems add new Model Problem Collector Request Severity Version set Message e get Message to String set Location parent get Location set Exception e throw problems new Model Building Exception if candidate Model null return null candidate Source new File Model Source candidate Model get Pom File jvz Why is n t all this checking the job of the duty of the workspace resolver we know that we have a model that is suitable yet more checks are done here and the one for the version is problematic before because with parents as ranges it will never work in this scenario String group Id candidate Model get Group Id if group Id null candidate Model get Parent null group Id candidate Model get Parent get Group Id String artifact Id candidate Model get Artifact Id String version candidate Model get Version if version null candidate Model get Parent null version candidate Model get Parent get Version if group Id null group Id equals parent get Group Id artifact Id null artifact Id equals parent get Artifact Id String Builder buffer new String Builder buffer append parent relative Path if child Model problems get Root Model buffer append of append Model Problem Utils to Source Hint child Model buffer append points at append group Id append append artifact Id buffer append instead of append parent get Group Id append buffer append parent get Artifact Id append please verify your project structure problems set Source child Model problems add new Model Problem Collector Request Severity Version set Message buffer to String set Location parent get Location return null if version null parent get Version null version equals parent get Version try Version Range parent Range Version Range create From Version Spec parent get Version if parent Range has Restrictions the parent version is not a range we have version skew drop back to resolution from repo return null if parent Range contains Version new Default Artifact Version version version skew drop back to resolution from the repository return null Validate versions are n t inherited when using parent ranges the same way as when read externally if child Model get Version null Message below is checked for in the core problems add new Model Problem Collector Request Severity Version set Message Version must be a constant set Location child Model get Location else if child Model get Version contains Message below is checked for in the core problems add new Model Problem Collector Request Severity Version set Message Version must be a constant set Location child Model get Location version What else to check here catch Invalid Version Specification Exception e invalid version range so drop back to resolution from the repository return null Here we just need to know that a version is fine to use but this validation we can do in our workspace resolver if version null version equals parent get Version return null Model Data parent Data new Model Data candidate Source candidate Model group Id artifact Id version return parent Data private Model Source get Parent Pom File Model child Model Model Source source if source instanceof Model Source return null String parent Path child Model get Parent get Relative Path if parent Path null parent Path length return null return Model Source source get Related Source parent Path private Model Data read Parent Externally Model child Model Model Building Request request Default Model Problem Collector problems throws Model Building Exception problems set Source child Model Parent parent child Model get Parent clone String group Id parent get Group Id String artifact Id parent get Artifact Id String version parent get Version Model Resolver model Resolver request get Model Resolver Validate not Null model Resolver request model Resolver can not be null parent s and s Model Problem Utils to Id group Id artifact Id version Model Problem Utils to Source Hint child Model Model Source model Source try model Source model Resolver resolve Model parent catch Unresolvable Model Exception e Message below is checked for in the core String Builder buffer new String Builder buffer append Non resolvable parent if contains Coordinates e get Message group Id artifact Id version buffer append append Model Problem Utils to Id group Id artifact Id version if child Model problems get Root Model buffer append for append Model Problem Utils to Id child Model buffer append append e get Message if child Model get Project Directory null if parent get Relative Path null parent get Relative Path length buffer append and parent relative Path points at no local else buffer append and parent relative Path points at wrong local problems add new Model Problem Collector Request Severity Version set Message buffer to String set Location parent get Location set Exception e throw problems new Model Building Exception Model Building Request lenient Request request if request get Validation Level Model Building Request lenient Request new Filter Model Building Request request Override public int get Validation Level return Model Building Request Model parent Model read Model model Source null lenient Request problems if parent get Version equals version if child Model get Version null Message below is checked for in the core problems add new Model Problem Collector Request Severity Version set Message Version must be a constant set Location child Model get Location else if child Model get Version contains Message below is checked for in the core problems add new Model Problem Collector Request Severity Version set Message Version must be a constant set Location child Model get Location version What else to check here Model Data parent Data new Model Data model Source parent Model parent get Group Id parent get Artifact Id parent get Version return parent Data private Model get Super Model return super Pom Provider get Super Model clone private void import Dependency Management Model model Model Building Request request Default Model Problem Collector problems Collection String import Ids Dependency Management dep Mgmt model get Dependency Management if dep Mgmt null return String importing model get Group Id model get Artifact Id model get Version import Ids add importing final Workspace Model Resolver workspace Resolver request get Workspace Model Resolver final Model Resolver model Resolver request get Model Resolver Model Building Request import Request null List Dependency Management import Mgmts null for Iterator Dependency it dep Mgmt get Dependencies iterator it has Next Dependency dependency it next if pom equals dependency get Type import equals dependency get Scope continue it remove String group Id dependency get Group Id String artifact Id dependency get Artifact Id String version dependency get Version if group Id null group Id length problems add new Model Problem Collector Request Severity Version set Message dependency Management dependencies dependency group Id for dependency get Management Key is missing set Location dependency get Location continue if artifact Id null artifact Id length problems add new Model Problem Collector Request Severity Version set Message dependency Management dependencies dependency artifact Id for dependency get Management Key is missing set Location dependency get Location continue if version null version length problems add new Model Problem Collector Request Severity Version set Message dependency Management dependencies dependency version for dependency get Management Key is missing set Location dependency get Location continue String imported group Id artifact Id version if import Ids contains imported String message The dependencies of type pom and with scope import form a cycle for String model Id import Ids message model Id message imported problems add new Model Problem Collector Request Severity Version set Message message continue Dependency Management import Mgmt get Cache request get Model Cache group Id artifact Id version Model Cache Tag if import Mgmt null if workspace Resolver null model Resolver null throw new Null Pointer Exception String format request workspace Model Resolver and request model Resolver can not be null parent s and s Model Problem Utils to Id group Id artifact Id version Model Problem Utils to Source Hint model Model import Model null if workspace Resolver null try import Model workspace Resolver resolve Effective Model group Id artifact Id version catch Unresolvable Model Exception e problems add new Model Problem Collector Request Severity Version set Message e get Message to String set Exception e continue no workspace resolver or workspace resolver returned null i e model not in workspace if import Model null final Model Source import Source try import Source model Resolver resolve Model group Id artifact Id version catch Unresolvable Model Exception e String Builder buffer new String Builder buffer append Non resolvable import if contains Coordinates e get Message group Id artifact Id version buffer append append Model Problem Utils to Id group Id artifact Id version buffer append append e get Message problems add new Model Problem Collector Request Severity Version set Message buffer to String set Location dependency get Location set Exception e continue if import Request null import Request new Default Model Building Request import Request set Validation Level Model Building Request import Request set Model Cache request get Model Cache import Request set System Properties request get System Properties import Request set User Properties request get User Properties import Request set Location Tracking request is Location Tracking import Request set Model Source import Source import Request set Model Resolver model Resolver new Copy final Model Building Result import Result try import Result build import Request catch Model Building Exception e problems add All e get Problems continue problems add All import Result get Problems import Model import Result get Effective Model import Mgmt import Model get Dependency Management if import Mgmt null import Mgmt new Dependency Management put Cache request get Model Cache group Id artifact Id version Model Cache Tag import Mgmt if import Mgmts null import Mgmts new Array List import Mgmts add import Mgmt import Ids remove importing dependency Management Importer import Management model import Mgmts request problems private void put Cache Model Cache model Cache String group Id String artifact Id String version Model Cache Tag tag data if model Cache null model Cache put group Id artifact Id version tag get Name tag into Cache data private get Cache Model Cache model Cache String group Id String artifact Id String version Model Cache Tag tag if model Cache null Object data model Cache get group Id artifact Id version tag get Name if data null return tag from Cache tag get Type cast data return null private void fire Event Model model Model Building Request request Model Problem Collector problems Model Building Event Catapult catapult throws Model Building Exception Model Building Listener listener request get Model Building Listener if listener null Model Building Event event new Default Model Building Event model request problems catapult fire listener event private boolean contains Coordinates String message String group Id String artifact Id String version return message null group Id null message contains group Id artifact Id null message contains artifact Id version null message contains version protected boolean has Model Errors Model Problem Collector Ext problems if problems instanceof Default Model Problem Collector return Default Model Problem Collector problems has Errors else the default execution path only knows the Default Model Problem Collector only reason it s not in signature is because it s package private throw new Illegal State Exception protected boolean has Fatal Errors Model Problem Collector Ext problems if problems instanceof Default Model Problem Collector return Default Model Problem Collector problems has Fatal Errors else the default execution path only knows the Default Model Problem Collector only reason it s not in signature is because it s package private throw new Illegal State Exception 
package org apache maven project Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util List import org apache commons lang Validate import org apache maven artifact repository Artifact Repository import org apache maven model Model import org apache maven model building Abstract Model Building Listener import org apache maven model building Model Building Event import org apache maven model building Model Problem Severity import org apache maven model building Model Problem Version import org apache maven model building Model Problem Collector Request import org apache maven plugin Plugin Manager Exception import org apache maven plugin Plugin Resolution Exception import org apache maven plugin version Plugin Version Resolution Exception Processes events from the model builder while building the effective model for a link Maven Project instance author Benjamin Bentmann public class Default Model Building Listener extends Abstract Model Building Listener private Maven Project project private Project Building Helper project Building Helper private Project Building Request project Building Request private List Artifact Repository remote Repositories private List Artifact Repository plugin Repositories public Default Model Building Listener Maven Project project Project Building Helper project Building Helper Project Building Request project Building Request this project Validate not Null project project can not be null this project Building Helper Validate not Null project Building Helper project Building Helper can not be null this project Building Request Validate not Null project Building Request project Building Request can not be null this remote Repositories project Building Request get Remote Repositories this plugin Repositories project Building Request get Plugin Artifact Repositories Gets the project whose model is being built return The project never code null public Maven Project get Project return project Override public void build Extensions Assembled Model Building Event event Model model event get Model try plugin Repositories project Building Helper create Artifact Repositories model get Plugin Repositories plugin Repositories project Building Request catch Exception e event get Problems add new Model Problem Collector Request Severity Version set Message Invalid plugin repository e get Message set Exception e project set Plugin Artifact Repositories plugin Repositories if event get Request is Process Plugins try Project Realm Cache Cache Record record project Building Helper create Project Realm project model project Building Request project set Class Realm record realm project set Extension Dependency Filter record extension Artifact Filter catch Plugin Resolution Exception Plugin Manager Exception Plugin Version Resolution Exception e event get Problems add new Model Problem Collector Request Severity Version set Message Unresolveable build extension e get Message set Exception e project Building Helper select Project Realm project build the regular repos after extensions are loaded to allow for custom layouts try remote Repositories project Building Helper create Artifact Repositories model get Repositories remote Repositories project Building Request catch Exception e event get Problems add new Model Problem Collector Request Severity Version set Message Invalid artifact repository e get Message set Exception e project set Remote Artifact Repositories remote Repositories 
package org apache maven model building Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io File import java util Array List import java util Date import java util List import java util Properties import org apache maven model Model import org apache maven model Profile import org apache maven model resolution Model Resolver import org apache maven model resolution Workspace Model Resolver Collects settings that control building of effective models author Benjamin Bentmann public class Default Model Building Request implements Model Building Request private Model raw Model private File pom File private Model Source model Source private int validation Level private boolean process Plugins private boolean two Phase Building private boolean location Tracking private List Profile profiles private List String active Profile Ids private List String inactive Profile Ids private Properties system Properties private Properties user Properties private Date build Start Time private Model Resolver model Resolver private Model Building Listener model Building Listener private Model Cache model Cache private Workspace Model Resolver workspace Resolver Creates an empty request public Default Model Building Request Creates a shallow copy of the specified request param request The request to copy must not be code null public Default Model Building Request Model Building Request request set Pom File request get Pom File set Model Source request get Model Source set Validation Level request get Validation Level set Process Plugins request is Process Plugins set Two Phase Building request is Two Phase Building set Profiles request get Profiles set Active Profile Ids request get Active Profile Ids set Inactive Profile Ids request get Inactive Profile Ids set System Properties request get System Properties set User Properties request get User Properties set Build Start Time request get Build Start Time set Model Resolver request get Model Resolver set Model Building Listener request get Model Building Listener set Model Cache request get Model Cache Override public File get Pom File return pom File Override public Default Model Building Request set Pom File File pom File this pom File pom File null pom File get Absolute File null return this Override public synchronized Model Source get Model Source if model Source null pom File null model Source new File Model Source pom File return model Source Override public Default Model Building Request set Model Source Model Source model Source this model Source model Source return this Override public int get Validation Level return validation Level Override public Default Model Building Request set Validation Level int validation Level this validation Level validation Level return this Override public boolean is Process Plugins return process Plugins Override public Default Model Building Request set Process Plugins boolean process Plugins this process Plugins process Plugins return this Override public boolean is Two Phase Building return two Phase Building Override public Default Model Building Request set Two Phase Building boolean two Phase Building this two Phase Building two Phase Building return this Override public boolean is Location Tracking return location Tracking Override public Default Model Building Request set Location Tracking boolean location Tracking this location Tracking location Tracking return this Override public List Profile get Profiles if profiles null profiles new Array List return profiles Override public Default Model Building Request set Profiles List Profile profiles if profiles null this profiles new Array List profiles else this profiles null return this Override public List String get Active Profile Ids if active Profile Ids null active Profile Ids new Array List return active Profile Ids Override public Default Model Building Request set Active Profile Ids List String active Profile Ids if active Profile Ids null this active Profile Ids new Array List active Profile Ids else this active Profile Ids null return this Override public List String get Inactive Profile Ids if inactive Profile Ids null inactive Profile Ids new Array List return inactive Profile Ids Override public Default Model Building Request set Inactive Profile Ids List String inactive Profile Ids if inactive Profile Ids null this inactive Profile Ids new Array List inactive Profile Ids else this inactive Profile Ids null return this Override public Properties get System Properties if system Properties null system Properties new Properties return system Properties Override public Default Model Building Request set System Properties Properties system Properties if system Properties null this system Properties new Properties synchronized system Properties avoid concurrentmodification if someone else sets removes an unrelated system property this system Properties put All system Properties else this system Properties null return this Override public Properties get User Properties if user Properties null user Properties new Properties return user Properties Override public Default Model Building Request set User Properties Properties user Properties if user Properties null this user Properties new Properties this user Properties put All user Properties else this user Properties null return this Override public Date get Build Start Time return build Start Time Override public Model Building Request set Build Start Time Date build Start Time this build Start Time build Start Time return this Override public Model Resolver get Model Resolver return this model Resolver Override public Default Model Building Request set Model Resolver Model Resolver model Resolver this model Resolver model Resolver return this Override public Model Building Listener get Model Building Listener return model Building Listener Override public Model Building Request set Model Building Listener Model Building Listener model Building Listener this model Building Listener model Building Listener return this Override public Model Cache get Model Cache return this model Cache Override public Default Model Building Request set Model Cache Model Cache model Cache this model Cache model Cache return this Override public Model get Raw Model return raw Model Override public Model Building Request set Raw Model Model raw Model this raw Model raw Model return this Override public Workspace Model Resolver get Workspace Model Resolver return workspace Resolver Override public Model Building Request set Workspace Model Resolver Workspace Model Resolver workspace Resolver this workspace Resolver workspace Resolver return this 
package org apache maven project inheritance Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util Array List import java util Linked Hash Map import java util Linked List import java util List import java util Map import java util Properties import java util String Tokenizer import java util Tree Map import org apache maven model Build import org apache maven model Dependency import org apache maven model Dependency Management import org apache maven model Deployment Repository import org apache maven model Distribution Management import org apache maven model Extension import org apache maven model Model import org apache maven model Plugin Management import org apache maven model Report Plugin import org apache maven model Report Set import org apache maven model Reporting import org apache maven model Resource import org apache maven model Scm import org apache maven model Site import org apache maven project Model Utils import org codehaus plexus component annotations Component import org codehaus plexus util String Utils import org codehaus plexus util xml Xpp Dom Component role Model Inheritance Assembler class public class Default Model Inheritance Assembler implements Model Inheritance Assembler Remove this Suppress Warnings unchecked public void assemble Build Inheritance Build child Build Build parent Build boolean handle As Inheritance The build has been set but we want to step in here and fill in values that have not been set by the child if child Build get Source Directory null child Build set Source Directory parent Build get Source Directory if child Build get Script Source Directory null child Build set Script Source Directory parent Build get Script Source Directory if child Build get Test Source Directory null child Build set Test Source Directory parent Build get Test Source Directory if child Build get Output Directory null child Build set Output Directory parent Build get Output Directory if child Build get Test Output Directory null child Build set Test Output Directory parent Build get Test Output Directory Extensions are accumulated merge Extension Lists child Build parent Build if child Build get Directory null child Build set Directory parent Build get Directory if child Build get Default Goal null child Build set Default Goal parent Build get Default Goal if child Build get Final Name null child Build set Final Name parent Build get Final Name Model Utils merge Filter Lists child Build get Filters parent Build get Filters List Resource resources child Build get Resources if resources null resources is Empty child Build set Resources parent Build get Resources resources child Build get Test Resources if resources null resources is Empty child Build set Test Resources parent Build get Test Resources Plugins are aggregated if Plugin inherit false Model Utils merge Plugin Lists child Build parent Build handle As Inheritance Plugin management aggregate Plugin Management dominant child Build get Plugin Management Plugin Management recessive parent Build get Plugin Management if dominant null recessive null Filter out the inherited false stuff child Build set Plugin Management recessive else Model Utils merge Plugin Lists child Build get Plugin Management parent Build get Plugin Management false private void assemble Scm Inheritance Model child Model parent String child Path Adjustment boolean append Paths if parent get Scm null Scm parent Scm parent get Scm Scm child Scm child get Scm if child Scm null child Scm new Scm child set Scm child Scm if String Utils is Empty child Scm get Connection String Utils is Empty parent Scm get Connection child Scm set Connection append Path parent Scm get Connection child get Artifact Id child Path Adjustment append Paths if String Utils is Empty child Scm get Developer Connection String Utils is Empty parent Scm get Developer Connection child Scm set Developer Connection append Path parent Scm get Developer Connection child get Artifact Id child Path Adjustment append Paths if String Utils is Empty child Scm get Url String Utils is Empty parent Scm get Url child Scm set Url append Path parent Scm get Url child get Artifact Id child Path Adjustment append Paths public void copy Model Model dest Model source assemble Model Inheritance dest source null false public void assemble Model Inheritance Model child Model parent String child Path Adjustment assemble Model Inheritance child parent child Path Adjustment true public void assemble Model Inheritance Model child Model parent assemble Model Inheritance child parent null true private void assemble Model Inheritance Model child Model parent String child Path Adjustment boolean append Paths can not inherit from null parent if parent null return Group id if child get Group Id null child set Group Id parent get Group Id version if child get Version null The parent version may have resolved to something different so we take what we asked for instead of child set Version parent get Version if child get Parent null child set Version child get Parent get Version inception Year if child get Inception Year null child set Inception Year parent get Inception Year url if child get Url null if parent get Url null child set Url append Path parent get Url child get Artifact Id child Path Adjustment append Paths else child set Url parent get Url assemble Distribution Inheritance child parent child Path Adjustment append Paths issue Management if child get Issue Management null child set Issue Management parent get Issue Management description if child get Description null child set Description parent get Description Organization if child get Organization null child set Organization parent get Organization Scm assemble Scm Inheritance child parent child Path Adjustment append Paths ci Management if child get Ci Management null child set Ci Management parent get Ci Management developers if child get Developers size child set Developers parent get Developers licenses if child get Licenses size child set Licenses parent get Licenses developers if child get Contributors size child set Contributors parent get Contributors mailing Lists if child get Mailing Lists size child set Mailing Lists parent get Mailing Lists Build assemble Build Inheritance child parent assemble Dependency Inheritance child parent child set Repositories Model Utils merge Repository Lists child get Repositories parent get Repositories child set Plugin Repositories Model Utils merge Repository Lists child get Plugin Repositories parent get Plugin Repositories assemble Reporting Inheritance child parent assemble Dependency Management Inheritance child parent Properties props new Properties props put All parent get Properties props put All child get Properties child set Properties props Remove this Suppress Warnings unchecked private void assemble Dependency Management Inheritance Model child Model parent Dependency Management parent Dep Mgmt parent get Dependency Management Dependency Management child Dep Mgmt child get Dependency Management if parent Dep Mgmt null if child Dep Mgmt null child set Dependency Management parent Dep Mgmt else List Dependency child Deps child Dep Mgmt get Dependencies Map String Dependency mapped Child Deps new Tree Map for Dependency dep child Deps mapped Child Deps put dep get Management Key dep for Dependency dep parent Dep Mgmt get Dependencies if mapped Child Deps contains Key dep get Management Key child Dep Mgmt add Dependency dep private void assemble Reporting Inheritance Model child Model parent Reports aggregate Reporting child Reporting child get Reporting Reporting parent Reporting parent get Reporting if parent Reporting null if child Reporting null child Reporting new Reporting child set Reporting child Reporting child Reporting set Exclude Defaults parent Reporting is Exclude Defaults if String Utils is Empty child Reporting get Output Directory child Reporting set Output Directory parent Reporting get Output Directory merge Report Plugin Lists child Reporting parent Reporting true private static void merge Report Plugin Lists Reporting child Reporting parent boolean handle As Inheritance if child null parent null nothing to do return List Report Plugin parent Plugins parent get Plugins if parent Plugins null parent Plugins is Empty Map String Report Plugin assembled Plugins new Tree Map Map String Report Plugin child Plugins child get Report Plugins As Map for Report Plugin parent Plugin parent Plugins String parent Inherited parent Plugin get Inherited if handle As Inheritance parent Inherited null Boolean value Of parent Inherited Report Plugin assembled Plugin parent Plugin Report Plugin child Plugin child Plugins get parent Plugin get Key if child Plugin null assembled Plugin child Plugin merge Report Plugin Definitions child Plugin parent Plugin handle As Inheritance if handle As Inheritance parent Inherited null assembled Plugin unset Inheritance Applied assembled Plugins put assembled Plugin get Key assembled Plugin for Report Plugin child Plugin child Plugins values if assembled Plugins contains Key child Plugin get Key assembled Plugins put child Plugin get Key child Plugin child set Plugins new Array List assembled Plugins values child flush Report Plugin Map private static void merge Report Set Definitions Report Set child Report Set parent List String parent Reports parent get Reports List String child Reports child get Reports List String reports new Array List if child Reports null child Reports is Empty reports add All child Reports if parent Reports null for String report parent Reports if reports contains report reports add report child set Reports reports Xpp Dom child Configuration Xpp Dom child get Configuration Xpp Dom parent Configuration Xpp Dom parent get Configuration child Configuration Xpp Dom merge Xpp Dom child Configuration parent Configuration child set Configuration child Configuration public static void merge Report Plugin Definitions Report Plugin child Report Plugin parent boolean handle As Inheritance if child null parent null nothing to do return if child get Version null parent get Version null child set Version parent get Version from here to the end of the method is dealing with merging of the executions section String parent Inherited parent get Inherited boolean parent Is Inherited parent Inherited null Boolean value Of parent Inherited List Report Set parent Report Sets parent get Report Sets if parent Report Sets null parent Report Sets is Empty Map String Report Set assembled Report Sets new Tree Map Map String Report Set child Report Sets child get Report Sets As Map for Object parent Report Set parent Report Sets Report Set parent Report Set Report Set parent Report Set if handle As Inheritance parent Is Inherited Report Set assembled Report Set parent Report Set Report Set child Report Set child Report Sets get parent Report Set get Id if child Report Set null merge Report Set Definitions child Report Set parent Report Set assembled Report Set child Report Set else if handle As Inheritance parent Inherited null parent Report Set unset Inheritance Applied assembled Report Sets put assembled Report Set get Id assembled Report Set for Map Entry String Report Set entry child Report Sets entry Set String id entry get Key if assembled Report Sets contains Key id assembled Report Sets put id entry get Value child set Report Sets new Array List assembled Report Sets values child flush Report Set Map Remove this Suppress Warnings unchecked private void assemble Dependency Inheritance Model child Model parent Map String Dependency deps Map new Linked Hash Map List Dependency deps parent get Dependencies if deps null for Dependency dependency deps deps Map put dependency get Management Key dependency deps child get Dependencies if deps null for Dependency dependency deps deps Map put dependency get Management Key dependency child set Dependencies new Array List deps Map values private void assemble Build Inheritance Model child Model parent Build child Build child get Build Build parent Build parent get Build if parent Build null if child Build null child Build new Build child set Build child Build assemble Build Inheritance child Build parent Build true private void assemble Distribution Inheritance Model child Model parent String child Path Adjustment boolean append Paths if parent get Distribution Management null Distribution Management parent Dist Mgmt parent get Distribution Management Distribution Management child Dist Mgmt child get Distribution Management if child Dist Mgmt null child Dist Mgmt new Distribution Management child set Distribution Management child Dist Mgmt if child Dist Mgmt get Site null if parent Dist Mgmt get Site null Site site new Site child Dist Mgmt set Site site site set Id parent Dist Mgmt get Site get Id site set Name parent Dist Mgmt get Site get Name site set Url parent Dist Mgmt get Site get Url if site get Url null site set Url append Path site get Url child get Artifact Id child Path Adjustment append Paths if child Dist Mgmt get Repository null if parent Dist Mgmt get Repository null Deployment Repository repository copy Distribution Repository parent Dist Mgmt get Repository child Dist Mgmt set Repository repository if child Dist Mgmt get Snapshot Repository null if parent Dist Mgmt get Snapshot Repository null Deployment Repository repository copy Distribution Repository parent Dist Mgmt get Snapshot Repository child Dist Mgmt set Snapshot Repository repository if String Utils is Empty child Dist Mgmt get Download Url child Dist Mgmt set Download Url parent Dist Mgmt get Download Url We be inheriting status since this is an assessment of the quality We be inheriting relocation since this relates to a single private static Deployment Repository copy Distribution Repository Deployment Repository parent Repository Deployment Repository repository new Deployment Repository repository set Id parent Repository get Id repository set Name parent Repository get Name repository set Url parent Repository get Url repository set Layout parent Repository get Layout repository set Unique Version parent Repository is Unique Version return repository This should eventually be migrated to Default Path Translator protected String append Path String parent Path String child Path String path Adjustment boolean append Paths String unclean Path parent Path if append Paths if path Adjustment null unclean Path path Adjustment if child Path null unclean Path child Path String cleaned Path int protocol Idx unclean Path index Of if protocol Idx cleaned Path unclean Path substring protocol Idx unclean Path unclean Path substring protocol Idx if unclean Path starts With cleaned Path return cleaned Path resolve Path unclean Path Move this to plexus utils Path Tool private static String resolve Path String unclean Path Linked List String path Elements new Linked List String Tokenizer tokenizer new String Tokenizer unclean Path while tokenizer has More Tokens String token tokenizer next Token switch token case Empty path entry remove break case if path Elements is Empty somehow report to the user that there are too many elements For now ignore the extra else path Elements remove Last break default path Elements add Last token break String Builder cleaned Path new String Builder while path Elements is Empty cleaned Path append path Elements remove First if path Elements is Empty cleaned Path append return cleaned Path to String private static void merge Extension Lists Build child Build Build parent Build for Extension e parent Build get Extensions if child Build get Extensions contains e child Build add Extension e 
package org apache maven model building Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util Enum Set import java util List import java util Set import org apache maven model Model import org apache maven model io Model Parse Exception Collects problems that are encountered during model building The primary purpose of this component is to account for the fact that the problem reporter has should not have information about the calling context and hence can not provide an expressive source hint for the model problem Instead the source hint is configured by the model builder before it delegates to other components that potentially encounter problems Then the problem reporter can focus on providing a simple error message leaving the donkey work of creating a nice model problem to this component author Benjamin Bentmann class Default Model Problem Collector implements Model Problem Collector Ext private final Model Building Result result private List Model Problem problems private String source private Model source Model private Model root Model private Set Model Problem Severity severities Enum Set none Of Model Problem Severity class public Default Model Problem Collector Model Building Result result this result result this problems result get Problems for Model Problem problem this problems severities add problem get Severity public boolean has Fatal Errors return severities contains Model Problem Severity public boolean has Errors return severities contains Model Problem Severity severities contains Model Problem Severity Override public List Model Problem get Problems return problems public void set Source String source this source source this source Model null public void set Source Model source this source Model source this source null if root Model null root Model source private String get Source if source null source Model null source Model Problem Utils to Path source Model return source private String get Model Id return Model Problem Utils to Id source Model public void set Root Model Model root Model this root Model root Model public Model get Root Model return root Model public String get Root Model Id return Model Problem Utils to Id root Model public void add Model Problem problem problems add problem severities add problem get Severity public void add All List Model Problem problems this problems add All problems for Model Problem problem problems severities add problem get Severity Override public void add Model Problem Collector Request req int line int column String source null String model Id null if req get Location null line req get Location get Line Number column req get Location get Column Number if req get Location get Source null model Id req get Location get Source get Model Id source req get Location get Source get Location if model Id null model Id get Model Id source get Source if line column req get Exception instanceof Model Parse Exception Model Parse Exception e Model Parse Exception req get Exception line e get Line Number column e get Column Number Model Problem problem new Default Model Problem req get Message req get Severity req get Version source line column model Id req get Exception add problem public Model Building Exception new Model Building Exception Model Building Result result this result if result get Model Ids is Empty Default Model Building Result tmp new Default Model Building Result tmp set Effective Model result get Effective Model tmp set Problems get Problems tmp set Active External Profiles result get Active External Profiles String id get Root Model Id tmp add Model Id id tmp set Raw Model id get Root Model result tmp return new Model Building Exception result 
package org apache maven model validation Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io File import java util Arrays import java util Hash Map import java util Hash Set import java util List import java util Map import java util Set import java util regex Pattern import org apache maven model Activation import org apache maven model Activation File import org apache maven model Build import org apache maven model Build Base import org apache maven model Dependency import org apache maven model Dependency Management import org apache maven model Distribution Management import org apache maven model Exclusion import org apache maven model Input Location import org apache maven model Input Location Tracker import org apache maven model Model import org apache maven model Parent import org apache maven model Plugin import org apache maven model Plugin Execution import org apache maven model Plugin Management import org apache maven model Profile import org apache maven model Report Plugin import org apache maven model Reporting import org apache maven model Repository import org apache maven model Resource import org apache maven model building Model Building Request import org apache maven model building Model Problem Severity import org apache maven model building Model Problem Version import org apache maven model building Model Problem Collector import org apache maven model building Model Problem Collector Request import org apache maven model interpolation Abstract String Based Model Interpolator import org codehaus plexus component annotations Component import org codehaus plexus util String Utils author a href mailto trygvis inamo no Trygve Laugst oslash l a Component role Model Validator class public class Default Model Validator implements Model Validator private static final Pattern Pattern compile Za z private static final Pattern Pattern compile Za z private static final String private static final String private static final String Override public void validate Raw Model Model m Model Building Request request Model Problem Collector problems Parent parent m get Parent if parent null validate String Not Empty parent group Id problems Severity Version parent get Group Id parent validate String Not Empty parent artifact Id problems Severity Version parent get Artifact Id parent validate String Not Empty parent version problems Severity Version parent get Version parent if equals parent get Group Id m get Group Id equals parent get Artifact Id m get Artifact Id add Violation problems Severity Version parent artifact Id null must be changed the parent element can not have the same group Id artifact Id as the project parent if request get Validation Level Model Building Request Severity err On get Severity request Model Building Request Maven should produce an error if no model version has been set in a file used to build an effective model As of the model version is mandatory even in raw models The element still is optional in the schema and this will not change anytime soon We do not want to build effective models based on models without a version starting with validate String Not Empty model Version problems Severity Version m get Model Version m validate Enum model Version problems Severity Version m get Model Version null m validate String No Expression group Id problems Severity Version m get Group Id m if parent null validate String Not Empty group Id problems Severity Version m get Group Id m validate String No Expression artifact Id problems Severity Version m get Artifact Id m validate String Not Empty artifact Id problems Severity Version m get Artifact Id m validate Version No Expression version problems Severity Version m get Version m if parent null validate String Not Empty version problems Severity Version m get Version m validate Raw Dependencies problems m get Dependencies dependencies dependency request validate Raw Dependencies Self Referencing problems m m get Dependencies dependencies dependency request if m get Dependency Management null validate Raw Dependencies problems m get Dependency Management get Dependencies dependency Management dependencies dependency request validate Raw Repositories problems m get Repositories repositories repository request validate Raw Repositories problems m get Plugin Repositories plugin Repositories plugin Repository request Build build m get Build if build null validate Raw Plugins problems build get Plugins build plugins plugin request Plugin Management mgmt build get Plugin Management if mgmt null validate Raw Plugins problems mgmt get Plugins build plugin Management plugins plugin request Set String profile Ids new Hash Set for Profile profile m get Profiles String prefix profiles profile profile get Id if profile Ids add profile get Id add Violation problems err On Version profiles profile id null must be unique but found duplicate profile with id profile get Id profile validate Raw Profile Activation problems profile get Activation profile get Id prefix activation request validate Raw Dependencies problems profile get Dependencies prefix dependencies dependency request if profile get Dependency Management null validate Raw Dependencies problems profile get Dependency Management get Dependencies prefix dependency Management dependencies dependency request validate Raw Repositories problems profile get Repositories prefix repositories repository request validate Raw Repositories problems profile get Plugin Repositories prefix plugin Repositories plugin Repository request Build Base build Base profile get Build if build Base null validate Raw Plugins problems build Base get Plugins prefix plugins plugin request Plugin Management mgmt build Base get Plugin Management if mgmt null validate Raw Plugins problems mgmt get Plugins prefix plugin Management plugins plugin request private void validate Raw Profile Activation Model Problem Collector problems Activation activation String source Hint String prefix Model Building Request request if activation null return Activation File file activation get File if file null String path boolean missing if String Utils is Not Empty file get Exists path file get Exists missing false else if String Utils is Not Empty file get Missing path file get Missing missing true else return if path contains project basedir add Violation problems Severity Version prefix missing file missing file exists null Failed to interpolate file location path for profile source Hint project basedir expression not supported during profile activation use basedir instead file get Location missing missing exists else if has Project Expression path add Violation problems Severity Version prefix missing file missing file exists null Failed to interpolate file location path for profile source Hint project expressions are not supported during profile activation file get Location missing missing exists private void validate Raw Plugins Model Problem Collector problems List Plugin plugins String prefix Model Building Request request Severity err On get Severity request Model Building Request Map String Plugin index new Hash Map for Plugin plugin plugins if plugin get Group Id null plugin get Group Id null plugin get Group Id trim is Empty add Violation problems Severity Version prefix group Id artifact Id null group Id of a plugin must be defined plugin if plugin get Artifact Id null plugin get Artifact Id null plugin get Artifact Id trim is Empty add Violation problems Severity Version prefix group Id artifact Id null artifact Id of a plugin must be defined plugin This will catch cases like version version or version if plugin get Version null plugin get Version trim is Empty add Violation problems Severity Version prefix group Id artifact Id null version of a plugin must be defined plugin String key plugin get Key Plugin existing index get key if existing null add Violation problems err On Version prefix group Id artifact Id null must be unique but found duplicate declaration of plugin key plugin else index put key plugin Set String execution Ids new Hash Set for Plugin Execution exec plugin get Executions if execution Ids add exec get Id add Violation problems Severity Version prefix plugin get Key executions execution id null must be unique but found duplicate execution with id exec get Id exec Override public void validate Effective Model Model m Model Building Request request Model Problem Collector problems validate String Not Empty model Version problems Severity Version m get Model Version m validate Id group Id problems m get Group Id m validate Id artifact Id problems m get Artifact Id m validate String Not Empty packaging problems Severity Version m get Packaging m if m get Modules is Empty if pom equals m get Packaging add Violation problems Severity Version packaging null with value m get Packaging is invalid Aggregator projects require pom as packaging m for int i n m get Modules size i n i String module m get Modules get i if String Utils is Blank module add Violation problems Severity Version modules module i null has been specified without a path to the project directory m get Location modules validate String Not Empty version problems Severity Version m get Version m Severity err On get Severity request Model Building Request validate Effective Dependencies problems m m get Dependencies false request Dependency Management mgmt m get Dependency Management if mgmt null validate Effective Dependencies problems m mgmt get Dependencies true request if request get Validation Level Model Building Request Set String modules new Hash Set for int i n m get Modules size i n i String module m get Modules get i if modules add module add Violation problems Severity Version modules module i null specifies duplicate child module module m get Location modules Severity err On get Severity request Model Building Request validate Banned Characters version problems err On Version m get Version null m validate Proper Snapshot Version version problems err On Version m get Version null m Build build m get Build if build null for Plugin p build get Plugins validate String Not Empty build plugins plugin artifact Id problems Severity Version p get Artifact Id p validate String Not Empty build plugins plugin group Id problems Severity Version p get Group Id p validate Plugin Version build plugins plugin version problems p get Version p get Key p request validate Boolean build plugins plugin inherited problems err On Version p get Inherited p get Key p validate Boolean build plugins plugin extensions problems err On Version p get Extensions p get Key p validate Effective Plugin Dependencies problems p request validate Raw Resources problems build get Resources build resources resource request validate Raw Resources problems build get Test Resources build test Resources test Resource request Reporting reporting m get Reporting if reporting null for Report Plugin p reporting get Plugins validate String Not Empty reporting plugins plugin artifact Id problems Severity Version p get Artifact Id p validate String Not Empty reporting plugins plugin group Id problems Severity Version p get Group Id p for Repository repository m get Repositories validate Effective Repository problems repository repositories repository request for Repository repository m get Plugin Repositories validate Effective Repository problems repository plugin Repositories plugin Repository request Distribution Management dist Mgmt m get Distribution Management if dist Mgmt null if dist Mgmt get Status null add Violation problems Severity Version distribution Management status null must not be specified dist Mgmt validate Effective Repository problems dist Mgmt get Repository distribution Management repository request validate Effective Repository problems dist Mgmt get Snapshot Repository distribution Management snapshot Repository request private void validate Raw Dependencies Model Problem Collector problems List Dependency dependencies String prefix Model Building Request request Severity err On get Severity request Model Building Request Severity err On get Severity request Model Building Request Map String Dependency index new Hash Map for Dependency dependency dependencies String key dependency get Management Key if import equals dependency get Scope if pom equals dependency get Type add Violation problems Severity Version prefix type key must be pom to import the managed dependencies dependency else if String Utils is Not Empty dependency get Classifier add Violation problems err On Version prefix classifier key must be empty imported can not have a classifier dependency else if system equals dependency get Scope if request get Validation Level Model Building Request add Violation problems Severity Version prefix scope key declares usage of deprecated system scope dependency String sys Path dependency get System Path if String Utils is Not Empty sys Path if has Expression sys Path add Violation problems Severity Version prefix system Path key should use a variable instead of a hard coded path sys Path dependency else if sys Path contains basedir sys Path contains project basedir add Violation problems Severity Version prefix system Path key should not point at files within the project directory sys Path will be unresolvable by dependent projects dependency if equals dependency get Version equals dependency get Version add Violation problems Severity Version prefix version key is either or both of them are being deprecated dependency Dependency existing index get key if existing null String msg if equals existing get Version dependency get Version msg duplicate declaration of version String Utils default String dependency get Version else msg version String Utils default String existing get Version vs String Utils default String dependency get Version add Violation problems err On Version prefix group Id artifact Id type classifier null must be unique key msg dependency else index put key dependency private void validate Raw Dependencies Self Referencing Model Problem Collector problems Model m List Dependency dependencies String prefix Model Building Request request We only check for group Id artifact Id cause if there is another module with the same group Id artifact Id this will fail the build earlier like Project is duplicated in the reactor So it is sufficient to check only group Id artifact Id and not the packaging type for Dependency dependency dependencies String key dependency get Group Id dependency get Artifact Id dependency get Version String m Key m get Group Id m get Artifact Id m get Version if key equals m Key This means a module which is build has a dependency which has the same group Id artifact Id and version coordinates This is in consequence a self reference or in other words a circular reference which can not being resolved add Violation problems Severity Version prefix key key is referencing itself dependency private void validate Effective Dependencies Model Problem Collector problems Model m List Dependency dependencies boolean management Model Building Request request Severity err On get Severity request Model Building Request String prefix management dependency Management dependencies dependency dependencies dependency for Dependency d dependencies validate Effective Dependency problems d management prefix request if request get Validation Level Model Building Request validate Boolean prefix optional problems err On Version d get Optional d get Management Key d if management validate Version prefix version problems err On Version d get Version d get Management Key d Extensions like Flex Mojos use custom scopes like merged internal external etc In order to do n t break backward compat with those only warn but do n t error out validate Enum prefix scope problems Severity Version d get Scope d get Management Key d provided compile runtime test system validate Effective Model Against Dependency prefix problems m d request private void validate Effective Model Against Dependency String prefix Model Problem Collector problems Model m Dependency d Model Building Request request String key d get Group Id d get Artifact Id d get Version String m Key m get Group Id m get Artifact Id m get Version if key equals m Key This means a module which is build has a dependency which has the same group Id artifact Id and version coordinates This is in consequence a self reference or in other words a circular reference which can not being resolved add Violation problems Severity Version prefix key key is referencing itself d private void validate Effective Plugin Dependencies Model Problem Collector problems Plugin plugin Model Building Request request List Dependency dependencies plugin get Dependencies if dependencies is Empty String prefix build plugins plugin plugin get Key dependencies dependency Severity err On get Severity request Model Building Request for Dependency d dependencies validate Effective Dependency problems d false prefix request validate Version prefix version problems err On Version d get Version d get Management Key d validate Enum prefix scope problems err On Version d get Scope d get Management Key d compile runtime system private void validate Effective Dependency Model Problem Collector problems Dependency d boolean management String prefix Model Building Request request validate Id prefix artifact Id problems Severity Version d get Artifact Id d get Management Key d validate Id prefix group Id problems Severity Version d get Group Id d get Management Key d if management validate String Not Empty prefix type problems Severity Version d get Type d get Management Key d validate Dependency Version problems d prefix if system equals d get Scope String system Path d get System Path if String Utils is Empty system Path add Violation problems Severity Version prefix system Path d get Management Key is missing d else File sys File new File system Path if sys File is Absolute add Violation problems Severity Version prefix system Path d get Management Key must specify an absolute path but is system Path d else if sys File is File String msg refers to a non existing file sys File get Absolute Path system Path system Path replace File separator Char replace File separator Char String jdk Home request get System Properties get Property java home File separator if system Path starts With jdk Home msg Please verify that you run Maven using a and not just a add Violation problems Severity Version prefix system Path d get Management Key msg d else if String Utils is Not Empty d get System Path add Violation problems Severity Version prefix system Path d get Management Key must be omitted This field may only be specified for a dependency with system scope d if request get Validation Level Model Building Request for Exclusion exclusion d get Exclusions if request get Validation Level Model Building Request validate Id prefix exclusions exclusion group Id problems Severity Version exclusion get Group Id d get Management Key exclusion validate Id prefix exclusions exclusion artifact Id problems Severity Version exclusion get Artifact Id d get Management Key exclusion else validate Id With Wildcards prefix exclusions exclusion group Id problems Severity Version exclusion get Group Id d get Management Key exclusion validate Id With Wildcards prefix exclusions exclusion artifact Id problems Severity Version exclusion get Artifact Id d get Management Key exclusion since protected void validate Dependency Version Model Problem Collector problems Dependency d String prefix validate String Not Empty prefix version problems Severity Version d get Version d get Management Key d private void validate Raw Repositories Model Problem Collector problems List Repository repositories String prefix Model Building Request request Map String Repository index new Hash Map for Repository repository repositories validate String Not Empty prefix id problems Severity Version repository get Id repository validate String Not Empty prefix repository get Id url problems Severity Version repository get Url repository String key repository get Id Repository existing index get key if existing null Severity err On get Severity request Model Building Request add Violation problems err On Version prefix id null must be unique repository get Id existing get Url vs repository get Url repository else index put key repository private void validate Effective Repository Model Problem Collector problems Repository repository String prefix Model Building Request request if repository null Severity err On get Severity request Model Building Request validate Banned Characters prefix id problems err On Version repository get Id null repository if local equals repository get Id add Violation problems err On Version prefix id null must not be local this identifier is reserved for the local repository using it for other repositories will corrupt your repository metadata repository if legacy equals repository get Layout add Violation problems Severity Version prefix layout repository get Id uses the unsupported value legacy artifact resolution might fail repository private void validate Raw Resources Model Problem Collector problems List Resource resources String prefix Model Building Request request Severity err On get Severity request Model Building Request for Resource resource resources validate String Not Empty prefix directory problems Severity Version resource get Directory resource validate Boolean prefix filtering problems err On Version resource get Filtering resource get Directory resource Field validation private boolean validate Id String field Name Model Problem Collector problems String id Input Location Tracker tracker return validate Id field Name problems Severity Version id null tracker private boolean validate Id String field Name Model Problem Collector problems Severity severity Version version String id String source Hint Input Location Tracker tracker if validate String Not Empty field Name problems severity version id source Hint tracker return false else boolean match matcher id matches if match add Violation problems severity version field Name source Hint with value id does not match a valid id pattern tracker return match private boolean validate Id With Wildcards String field Name Model Problem Collector problems Severity severity Version version String id String source Hint Input Location Tracker tracker if validate String Not Empty field Name problems severity version id source Hint tracker return false else boolean match matcher id matches if match add Violation problems severity version field Name source Hint with value id does not match a valid id pattern tracker return match private boolean validate String No Expression String field Name Model Problem Collector problems Severity severity Version version String string Input Location Tracker tracker if has Expression string return true add Violation problems severity version field Name null contains an expression but should be a constant tracker return false private boolean validate Version No Expression String field Name Model Problem Collector problems Severity severity Version version String string Input Location Tracker tracker if has Expression string return true Acceptable versions for continuous delivery changelist revision sha string string trim if string contains Abstract String Based Model Interpolator string contains Abstract String Based Model Interpolator string contains Abstract String Based Model Interpolator return true add Violation problems severity version field Name null contains an expression but should be a constant tracker return false private boolean has Expression String value return value null value contains private boolean has Project Expression String value return value null value contains project private boolean validate String Not Empty String field Name Model Problem Collector problems Severity severity Version version String string Input Location Tracker tracker return validate String Not Empty field Name problems severity version string null tracker Asserts p ul li code string null code li code string length code ul private boolean validate String Not Empty String field Name Model Problem Collector problems Severity severity Version version String string String source Hint Input Location Tracker tracker if validate Not Null field Name problems severity version string source Hint tracker return false if string length return true add Violation problems severity version field Name source Hint is missing tracker return false Asserts p ul li code string null code ul private boolean validate Not Null String field Name Model Problem Collector problems Severity severity Version version Object object String source Hint Input Location Tracker tracker if object null return true add Violation problems severity version field Name source Hint is missing tracker return false private boolean validate Boolean String field Name Model Problem Collector problems Severity severity Version version String string String source Hint Input Location Tracker tracker if string null string length return true if true equals Ignore Case string false equals Ignore Case string return true add Violation problems severity version field Name source Hint must be true or false but is string tracker return false private boolean validate Enum String field Name Model Problem Collector problems Severity severity Version version String string String source Hint Input Location Tracker tracker String valid Values if string null string length return true List String values Arrays as List valid Values if values contains string return true add Violation problems severity version field Name source Hint must be one of values but is string tracker return false private boolean validate Banned Characters String field Name Model Problem Collector problems Severity severity Version version String string String source Hint Input Location Tracker tracker String banned if string null for int i string length i i if banned index Of string char At i add Violation problems severity version field Name source Hint must not contain any of these characters banned but found string char At i tracker return false return true private boolean validate Version String field Name Model Problem Collector problems Severity severity Version version String string String source Hint Input Location Tracker tracker if string null string length return true if has Expression string add Violation problems severity version field Name source Hint must be a valid version but is string tracker return false return validate Banned Characters field Name problems severity version string source Hint tracker private boolean validate Proper Snapshot Version String field Name Model Problem Collector problems Severity severity Version version String string String source Hint Input Location Tracker tracker if string null string length return true if string ends With string ends With add Violation problems severity version field Name source Hint uses an unsupported snapshot version format should be instead tracker return false return true private boolean validate Plugin Version String field Name Model Problem Collector problems String string String source Hint Input Location Tracker tracker Model Building Request request if string null The check for missing plugin versions is handled directly by the model builder return true Severity err On get Severity request Model Building Request if validate Version field Name problems err On Version string source Hint tracker return false if string length equals string equals string add Violation problems err On Version field Name source Hint must be a valid version but is string tracker return false return true private static void add Violation Model Problem Collector problems Severity severity Version version String field Name String source Hint String message Input Location Tracker tracker String Builder buffer new String Builder buffer append append field Name append if source Hint null buffer append for append source Hint buffer append append message Line Length problems add new Model Problem Collector Request severity version set Message buffer to String set Location get Location field Name tracker Line Length private static Input Location get Location String field Name Input Location Tracker tracker Input Location location null if tracker null if field Name null Object key field Name int idx field Name last Index Of if idx field Name field Name substring idx key field Name if field Name ends With key field Name substring field Name last Index Of field Name length try key Integer value Of key to String catch Number Format Exception e use key as is location tracker get Location key if location null location tracker get Location return location private static boolean equals String s String s return String Utils clean s equals String Utils clean s private static Severity get Severity Model Building Request request int error Threshold return get Severity request get Validation Level error Threshold private static Severity get Severity int validation Level int error Threshold if validation Level error Threshold return Severity else return Severity 
package org apache maven lifecycle internal Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util Collection import org apache maven lifecycle Mojo Execution Configurator import org apache maven model Plugin import org apache maven model Plugin Execution import org apache maven plugin Mojo Execution import org apache maven project Maven Project import org codehaus plexus component annotations Component import org codehaus plexus util String Utils import org codehaus plexus util xml Xpp Dom since Component role Mojo Execution Configurator class public class Default Mojo Execution Configurator implements Mojo Execution Configurator Override public void configure Maven Project project Mojo Execution mojo Execution boolean allow Plugin Level Config String g mojo Execution get Group Id String a mojo Execution get Artifact Id Plugin plugin find Plugin g a project get Build Plugins if plugin null project get Plugin Management null plugin find Plugin g a project get Plugin Management get Plugins if plugin null Plugin Execution plugin Execution find Plugin Execution mojo Execution get Execution Id plugin get Executions Xpp Dom pom Configuration null if plugin Execution null pom Configuration Xpp Dom plugin Execution get Configuration else if allow Plugin Level Config pom Configuration Xpp Dom plugin get Configuration Xpp Dom mojo Configuration pom Configuration null new Xpp Dom pom Configuration null mojo Configuration Xpp Dom merge Xpp Dom mojo Execution get Configuration mojo Configuration mojo Execution set Configuration mojo Configuration private Plugin find Plugin String group Id String artifact Id Collection Plugin plugins for Plugin plugin plugins if artifact Id equals plugin get Artifact Id group Id equals plugin get Group Id return plugin return null private Plugin Execution find Plugin Execution String execution Id Collection Plugin Execution executions if String Utils is Not Empty execution Id for Plugin Execution execution executions if execution Id equals execution get Id return execution return null 
package org apache maven model profile Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util Array List import java util Collection import java util Hash Set import java util List import org apache maven model Activation import org apache maven model Profile import org apache maven model building Model Problem Collector import org apache maven model building Model Problem Severity import org apache maven model building Model Problem Version import org apache maven model building Model Problem Collector Request import org apache maven model profile activation Profile Activator import org codehaus plexus component annotations Component import org codehaus plexus component annotations Requirement Calculates the active profiles among a given collection of profiles author Benjamin Bentmann Component role Profile Selector class public class Default Profile Selector implements Profile Selector Requirement role Profile Activator class private List Profile Activator activators new Array List public Default Profile Selector add Profile Activator Profile Activator profile Activator if profile Activator null activators add profile Activator return this Override public List Profile get Active Profiles Collection Profile profiles Profile Activation Context context Model Problem Collector problems Collection String activated Ids new Hash Set context get Active Profile Ids Collection String deactivated Ids new Hash Set context get Inactive Profile Ids List Profile active Profiles new Array List profiles size List Profile active Pom Profiles By Default new Array List boolean activated Pom Profile Not By Default false for Profile profile profiles if deactivated Ids contains profile get Id if activated Ids contains profile get Id is Active profile context problems active Profiles add profile if Profile equals profile get Source activated Pom Profile Not By Default true else if is Active By Default profile if Profile equals profile get Source active Pom Profiles By Default add profile else active Profiles add profile if activated Pom Profile Not By Default active Profiles add All active Pom Profiles By Default return active Profiles private boolean is Active Profile profile Profile Activation Context context Model Problem Collector problems boolean is Active false for Profile Activator activator activators if activator present In Config profile context problems is Active true for Profile Activator activator activators try if activator present In Config profile context problems is Active activator is Active profile context problems catch Runtime Exception e problems add new Model Problem Collector Request Severity Version set Message Failed to determine activation for profile profile get Id set Location profile get Location set Exception e return false return is Active private boolean is Active By Default Profile profile Activation activation profile get Activation return activation null activation is Active By Default 
package org apache maven project Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io File import java io Exception import java util Array List import java util Arrays import java util Collections import java util Hash Map import java util Hash Set import java util Linked Hash Set import java util List import java util Map import java util Set import org apache maven Repository Utils import org apache maven artifact Artifact import org apache maven artifact Invalid Repository Exception import org apache maven artifact repository Artifact Repository import org apache maven artifact repository Legacy Local Repository Manager import org apache maven bridge Maven Repository System import org apache maven model Build import org apache maven model Dependency import org apache maven model Dependency Management import org apache maven model Deployment Repository import org apache maven model Extension import org apache maven model Model import org apache maven model Plugin import org apache maven model Profile import org apache maven model Report Plugin import org apache maven model building Default Model Building Request import org apache maven model building Default Model Problem import org apache maven model building File Model Source import org apache maven model building Model Builder import org apache maven model building Model Building Exception import org apache maven model building Model Building Request import org apache maven model building Model Building Result import org apache maven model building Model Problem import org apache maven model building Model Processor import org apache maven model building Model Source import org apache maven model building String Model Source import org apache maven model resolution Model Resolver import org apache maven repository internal Artifact Descriptor Utils import org codehaus plexus component annotations Component import org codehaus plexus component annotations Requirement import org codehaus plexus logging Logger import org codehaus plexus util Os import org codehaus plexus util String Utils import org eclipse aether Repository System Session import org eclipse aether Request Trace import org eclipse aether impl Remote Repository Manager import org eclipse aether repository Local Repository Manager import org eclipse aether repository Remote Repository import org eclipse aether repository Workspace Repository import org eclipse aether resolution Artifact Request import org eclipse aether resolution Artifact Result Component role Project Builder class public class Default Project Builder implements Project Builder Requirement private Logger logger Requirement private Model Builder model Builder Requirement private Model Processor model Processor Requirement private Project Building Helper project Building Helper Requirement private Maven Repository System repository System Requirement private org eclipse aether Repository System repo System Requirement private Remote Repository Manager repository Manager Requirement private Project Dependencies Resolver dependency Resolver Maven Project Builder Implementation Override public Project Building Result build File pom File Project Building Request request throws Project Building Exception return build pom File new File Model Source pom File new Internal Config request null null Override public Project Building Result build Model Source model Source Project Building Request request throws Project Building Exception return build null model Source new Internal Config request null null private Project Building Result build File pom File Model Source model Source Internal Config config throws Project Building Exception Class Loader old Context Class Loader Thread current Thread get Context Class Loader try Project Building Request project Building Request config request Maven Project project project Building Request get Project List Model Problem model Problems null Throwable error null if project null Model Building Request request get Model Building Request config project new Maven Project project set File pom File Default Model Building Listener listener new Default Model Building Listener project project Building Helper project Building Request request set Model Building Listener listener request set Pom File pom File request set Model Source model Source request set Location Tracking true Model Building Result result try result model Builder build request catch Model Building Exception e result e get Result if result null result get Effective Model null throw new Project Building Exception e get Model Id e get Message pom File e validation error continue project building and delay failing to help Es error e model Problems result get Problems init Project project Collections String Maven Project empty Map result new Hash Map File Boolean project Building Request else if project Building Request is Resolve Dependencies project Building Helper select Project Realm project Dependency Resolution Result resolution Result null if project Building Request is Resolve Dependencies resolution Result resolve Dependencies project config session Project Building Result result new Default Project Building Result project model Problems resolution Result if error null Project Building Exception e new Project Building Exception Arrays as List result e init Cause error throw e return result finally Thread current Thread set Context Class Loader old Context Class Loader private Dependency Resolution Result resolve Dependencies Maven Project project Repository System Session session Dependency Resolution Result resolution Result try Default Dependency Resolution Request resolution new Default Dependency Resolution Request project session resolution Result dependency Resolver resolve resolution catch Dependency Resolution Exception e resolution Result e get Result Set Artifact artifacts new Linked Hash Set if resolution Result get Dependency Graph null Repository Utils to Artifacts artifacts resolution Result get Dependency Graph get Children Collections singleton List project get Artifact get Id null Maven x quirk an artifact always points at the local repo regardless whether resolved or not Local Repository Manager lrm session get Local Repository Manager for Artifact artifact artifacts if artifact is Resolved String path lrm get Path For Local Artifact Repository Utils to Artifact artifact artifact set File new File lrm get Repository get Basedir path project set Resolved Artifacts artifacts project set Artifacts artifacts return resolution Result private List String get Profile Ids List Profile profiles List String ids new Array List profiles size for Profile profile profiles ids add profile get Id return ids private Model Building Request get Model Building Request Internal Config config Project Building Request configuration config request Model Building Request request new Default Model Building Request Request Trace trace Request Trace new Child null configuration new Child request Model Resolver resolver new Project Model Resolver config session trace repo System repository Manager config repositories configuration get Repository Merging config model Pool request set Validation Level configuration get Validation Level request set Process Plugins configuration is Process Plugins request set Profiles configuration get Profiles request set Active Profile Ids configuration get Active Profile Ids request set Inactive Profile Ids configuration get Inactive Profile Ids request set System Properties configuration get System Properties request set User Properties configuration get User Properties request set Build Start Time configuration get Build Start Time request set Model Resolver resolver request set Model Cache config model Cache return request Override public Project Building Result build Artifact artifact Project Building Request request throws Project Building Exception return build artifact false request Override public Project Building Result build Artifact artifact boolean allow Stub Model Project Building Request request throws Project Building Exception org eclipse aether artifact Artifact pom Artifact Repository Utils to Artifact artifact pom Artifact Artifact Descriptor Utils to Pom Artifact pom Artifact Internal Config config new Internal Config request null null boolean local Project try Artifact Request pom Request new Artifact Request pom Request set Artifact pom Artifact pom Request set Repositories config repositories Artifact Result pom Result repo System resolve Artifact config session pom Request pom Artifact pom Result get Artifact local Project pom Result get Repository instanceof Workspace Repository catch org eclipse aether resolution Artifact Resolution Exception e if e get Results get is Missing allow Stub Model return build null create Stub Model Source artifact config throw new Project Building Exception artifact get Id Error resolving project artifact e get Message e File pom File pom Artifact get File if pom equals artifact get Type artifact select Version pom Artifact get Version artifact set File pom File artifact set Resolved true return build local Project pom File null new File Model Source pom File config private Model Source create Stub Model Source Artifact artifact String Builder buffer new String Builder buffer append xml version buffer append project buffer append model Version model Version buffer append group Id append artifact get Group Id append group Id buffer append artifact Id append artifact get Artifact Id append artifact Id buffer append version append artifact get Base Version append version buffer append packaging append artifact get Type append packaging buffer append project return new String Model Source buffer artifact get Id Override public List Project Building Result build List File pom Files boolean recursive Project Building Request request throws Project Building Exception List Project Building Result results new Array List List Interim Result interim Results new Array List Reactor Model Pool model Pool new Reactor Model Pool Reactor Model Cache model Cache new Reactor Model Cache Internal Config config new Internal Config request model Pool model Cache Map String Maven Project project Index new Hash Map boolean no Errors build results interim Results project Index pom Files new Linked Hash Set File true recursive config populate Reactor Model Pool model Pool interim Results Class Loader old Context Class Loader Thread current Thread get Context Class Loader try no Errors build results new Array List Maven Project project Index interim Results request new Hash Map File Boolean no Errors finally Thread current Thread set Context Class Loader old Context Class Loader if no Errors throw new Project Building Exception results return results private boolean build List Project Building Result results List Interim Result interim Results Map String Maven Project project Index List File pom Files Set File aggregator Files boolean is Root boolean recursive Internal Config config boolean no Errors true for File pom File pom Files aggregator Files add pom File if build results interim Results project Index pom File aggregator Files is Root recursive config no Errors false aggregator Files remove pom File return no Errors private boolean build List Project Building Result results List Interim Result interim Results Map String Maven Project project Index File pom File Set File aggregator Files boolean is Root boolean recursive Internal Config config boolean no Errors true Model Building Request request get Model Building Request config Maven Project project new Maven Project request set Pom File pom File request set Two Phase Building true request set Location Tracking true Default Model Building Listener listener new Default Model Building Listener project project Building Helper config request request set Model Building Listener listener try Model Building Result result model Builder build request Model model result get Effective Model project Index put result get Model Ids get project Interim Result interim Result new Interim Result pom File request result listener is Root interim Results add interim Result if recursive model get Modules is Empty File basedir pom File get Parent File List File module Files new Array List for String module model get Modules if String Utils is Empty module continue module module replace File separator Char replace File separator Char File module File new File basedir module if module File is Directory module File model Processor locate Pom module File if module File is File Model Problem problem new Default Model Problem Child module module File of pom File does not exist Model Problem Severity Model Problem Version model null result get Problems add problem no Errors false continue if Os is Family Os we do n t canonicalize on unix to avoid interfering with symlinks try module File module File get Canonical File catch Exception e module File module File get Absolute File else module File new File module File to normalize if aggregator Files contains module File String Builder buffer new String Builder for File aggregator File aggregator Files buffer append aggregator File append buffer append module File Model Problem problem new Default Model Problem Child module module File of pom File forms aggregation cycle buffer Model Problem Severity Model Problem Version model null result get Problems add problem no Errors false continue module Files add module File interim Result modules new Array List if build results interim Result modules project Index module Files aggregator Files false recursive config no Errors false catch Model Building Exception e results add new Default Project Building Result e get Model Id pom File e get Problems no Errors false return no Errors static class Interim Result File pom File Model Building Request request Model Building Result result Default Model Building Listener listener boolean root List Interim Result modules Collections empty List Interim Result File pom File Model Building Request request Model Building Result result Default Model Building Listener listener boolean root this pom File pom File this request request this result result this listener listener this root root private void populate Reactor Model Pool Reactor Model Pool reactor Model Pool List Interim Result interim Results for Interim Result interim Result interim Results Model model interim Result result get Effective Model reactor Model Pool put model get Group Id model get Artifact Id model get Version model get Pom File populate Reactor Model Pool reactor Model Pool interim Result modules private boolean build List Project Building Result results List Maven Project projects Map String Maven Project project Index List Interim Result interim Results Project Building Request request Map File Boolean profiles Xmls boolean no Errors true for Interim Result interim Result interim Results try Model Building Result result model Builder build interim Result request interim Result result Maven Project project interim Result listener get Project init Project project project Index result profiles Xmls request List Maven Project modules new Array List no Errors build results modules project Index interim Result modules request profiles Xmls no Errors projects add All modules projects add project project set Execution Root interim Result root project set Collected Projects modules results add new Default Project Building Result project result get Problems null catch Model Building Exception e results add new Default Project Building Result e get Model Id interim Result pom File e get Problems no Errors false return no Errors private void init Project Maven Project project Map String Maven Project projects Model Building Result result Map File Boolean profiles Xmls Project Building Request project Building Request Model model result get Effective Model project set Model model project set Original Model result get Raw Model project set File model get Pom File Model parent Model result get Model Ids size result get Model Ids get is Empty result get Raw Model result get Model Ids get null if parent Model null final String parent Group Id inherited Group Id result final String parent Version inherited Version result project set Parent Artifact repository System create Project Artifact parent Group Id parent Model get Artifact Id parent Version org apache maven its mng parent String parent Model Id result get Model Ids get File parent Pom File result get Raw Model parent Model Id get Pom File Maven Project parent projects get parent Model Id if parent null At this point the Default Model Building Listener has fired and it populates the remote repositories with those found in the pom xml along with the existing externally defined repositories project Building Request set Remote Repositories project get Remote Artifact Repositories if parent Pom File null project set Parent File parent Pom File try parent build parent Pom File project Building Request get Project catch Project Building Exception e where let invalid parents slide on by if logger is Debug Enabled Message below is checked for in the core logger warn Failed to build parent project for project get Id e else Message below is checked for in the core logger warn Failed to build parent project for project get Id else Artifact parent Artifact project get Parent Artifact try parent build parent Artifact project Building Request get Project catch Project Building Exception e where let invalid parents slide on by if logger is Debug Enabled Message below is checked for in the core logger warn Failed to build parent project for project get Id e else Message below is checked for in the core logger warn Failed to build parent project for project get Id project set Parent parent Artifact project Artifact repository System create Artifact project get Group Id project get Artifact Id project get Version null project get Packaging project set Artifact project Artifact if project get File null Build build project get Build project add Script Source Root build get Script Source Directory project add Compile Source Root build get Source Directory project add Test Compile Source Root build get Test Source Directory List Profile active Profiles new Array List active Profiles add All result get Active Pom Profiles result get Model Ids get active Profiles add All result get Active External Profiles project set Active Profiles active Profiles project set Injected Profile Ids external get Profile Ids result get Active External Profiles for String model Id result get Model Ids project set Injected Profile Ids model Id get Profile Ids result get Active Pom Profiles model Id String model Id find Profiles Xml result profiles Xmls if model Id null Model Problem problem new Default Model Problem Detected profiles xml alongside model Id this file is no longer supported and was ignored please use the settings xml instead Model Problem Severity Model Problem Version model null result get Problems add problem All the parts that were taken out of Maven Project for Maven project set Project Building Request project Building Request plugin Artifacts Set Artifact plugin Artifacts new Hash Set for Plugin plugin project get Build Plugins Artifact artifact repository System create Plugin Artifact plugin if artifact null plugin Artifacts add artifact project set Plugin Artifacts plugin Artifacts report Artifacts Set Artifact report Artifacts new Hash Set for Report Plugin report project get Report Plugins Plugin pp new Plugin pp set Group Id report get Group Id pp set Artifact Id report get Artifact Id pp set Version report get Version Artifact artifact repository System create Plugin Artifact pp if artifact null report Artifacts add artifact project set Report Artifacts report Artifacts extension Artifacts Set Artifact extension Artifacts new Hash Set List Extension extensions project get Build Extensions if extensions null for Extension ext extensions String version if String Utils is Empty ext get Version version else version ext get Version Artifact artifact repository System create Artifact ext get Group Id ext get Artifact Id version null jar if artifact null extension Artifacts add artifact project set Extension Artifacts extension Artifacts managed Version Map Map String Artifact map null if repository System null List Dependency deps Dependency Management dependency Management project get Dependency Management if dependency Management null deps dependency Management get Dependencies null deps size map new Hash Map for Dependency d dependency Management get Dependencies Artifact artifact repository System create Dependency Artifact d if artifact null map put d get Management Key artifact else map Collections empty Map project set Managed Version Map map release artifact repository if project get Distribution Management null project get Distribution Management get Repository null try Deployment Repository r project get Distribution Management get Repository if String Utils is Empty r get Id String Utils is Empty r get Url Artifact Repository repo repository System build Artifact Repository r repository System inject Proxy project Building Request get Repository Session Arrays as List repo repository System inject Authentication project Building Request get Repository Session Arrays as List repo project set Release Artifact Repository repo catch Invalid Repository Exception e throw new Illegal State Exception Failed to create release distribution repository for project get Id e snapshot artifact repository if project get Distribution Management null project get Distribution Management get Snapshot Repository null try Deployment Repository r project get Distribution Management get Snapshot Repository if String Utils is Empty r get Id String Utils is Empty r get Url Artifact Repository repo repository System build Artifact Repository r repository System inject Proxy project Building Request get Repository Session Arrays as List repo repository System inject Authentication project Building Request get Repository Session Arrays as List repo project set Snapshot Artifact Repository repo catch Invalid Repository Exception e throw new Illegal State Exception Failed to create snapshot distribution repository for project get Id e private static String inherited Group Id final Model Building Result result final int model Index String group Id null final String model Id result get Model Ids get model Index if model Id is Empty final Model model result get Raw Model model Id group Id model get Group Id null model get Group Id inherited Group Id result model Index return group Id private static String inherited Version final Model Building Result result final int model Index String version null final String model Id result get Model Ids get model Index if model Id is Empty final Model model result get Raw Model model Id version model get Version null model get Version inherited Version result model Index return version private String find Profiles Xml Model Building Result result Map File Boolean profiles Xmls for String model Id result get Model Ids Model model result get Raw Model model Id File basedir model get Project Directory if basedir null break Boolean profiles Xml profiles Xmls get basedir if profiles Xml null profiles Xml new File basedir profiles xml exists profiles Xmls put basedir profiles Xml if profiles Xml return model Id return null class Internal Config public final Project Building Request request public final Repository System Session session public final List Remote Repository repositories public final Reactor Model Pool model Pool public final Reactor Model Cache model Cache Internal Config Project Building Request request Reactor Model Pool model Pool Reactor Model Cache model Cache this request request this model Pool model Pool this model Cache model Cache session Legacy Local Repository Manager overlay request get Local Repository request get Repository Session repo System repositories Repository Utils to Repos request get Remote Repositories 
package org apache maven project Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util Array List import java util Arrays import java util Collection import java util Hash Map import java util Hash Set import java util Linked Hash Set import java util List import java util Map import java util Set import org apache maven Repository Utils import org apache maven artifact Artifact import org apache maven artifact Invalid Repository Exception import org apache maven artifact repository Artifact Repository import org apache maven classrealm Class Realm Manager import org apache maven model Build import org apache maven model Extension import org apache maven model Model import org apache maven model Plugin import org apache maven model Repository import org apache maven plugin Extension Realm Cache import org apache maven plugin Maven Plugin Manager import org apache maven plugin Plugin Manager Exception import org apache maven plugin Plugin Resolution Exception import org apache maven plugin version Plugin Version Resolution Exception import org apache maven repository Repository System import org codehaus plexus Plexus Container import org codehaus plexus classworlds realm Class Realm import org codehaus plexus component annotations Component import org codehaus plexus component annotations Requirement import org codehaus plexus logging Logger import org eclipse aether graph Dependency Filter import org eclipse aether util filter Exclusions Dependency Filter Assists the project builder strong Warning strong This is an internal utility class that is only public for technical reasons it is not part of the public In particular this class can be changed or deleted without prior notice author Benjamin Bentmann Component role Project Building Helper class public class Default Project Building Helper implements Project Building Helper Requirement private Logger logger Requirement private Plexus Container container Requirement private Class Realm Manager class Realm Manager Requirement private Project Realm Cache project Realm Cache Requirement private Repository System repository System Requirement private Maven Plugin Manager plugin Manager public List Artifact Repository create Artifact Repositories List Repository pom Repositories List Artifact Repository external Repositories Project Building Request request throws Invalid Repository Exception List Artifact Repository internal Repositories new Array List for Repository repository pom Repositories internal Repositories add repository System build Artifact Repository repository repository System inject Mirror request get Repository Session internal Repositories repository System inject Proxy request get Repository Session internal Repositories repository System inject Authentication request get Repository Session internal Repositories List Artifact Repository dominant Repositories List Artifact Repository recessive Repositories if Project Building Request Repository Merging equals request get Repository Merging dominant Repositories external Repositories recessive Repositories internal Repositories else dominant Repositories internal Repositories recessive Repositories external Repositories List Artifact Repository artifact Repositories new Array List Collection String repo Ids new Hash Set if dominant Repositories null for Artifact Repository repository dominant Repositories repo Ids add repository get Id artifact Repositories add repository if recessive Repositories null for Artifact Repository repository recessive Repositories if repo Ids add repository get Id artifact Repositories add repository artifact Repositories repository System get Effective Repositories artifact Repositories return artifact Repositories public synchronized Project Realm Cache Cache Record create Project Realm Maven Project project Model model Project Building Request request throws Plugin Resolution Exception Plugin Version Resolution Exception Plugin Manager Exception Class Realm project Realm List Plugin extension Plugins new Array List Build build model get Build if build null for Extension extension build get Extensions Plugin plugin new Plugin plugin set Group Id extension get Group Id plugin set Artifact Id extension get Artifact Id plugin set Version extension get Version extension Plugins add plugin for Plugin plugin build get Plugins if plugin is Extensions extension Plugins add plugin if extension Plugins is Empty if logger is Debug Enabled logger debug Extension realms for project model get Id none return new Project Realm Cache Cache Record null null List Class Realm extension Realms new Array List Map Class Realm List String exported Packages new Hash Map Map Class Realm List String exported Artifacts new Hash Map List Artifact public Artifacts new Array List for Plugin plugin extension Plugins Extension Realm Cache Cache Record record Realm plugin Manager setup Extensions Realm project plugin request get Repository Session final Class Realm extension Realm record Realm realm final Extension Descriptor extension Descriptor record Realm descriptor final List Artifact artifacts record Realm artifacts extension Realms add extension Realm if extension Descriptor null exported Packages put extension Realm extension Descriptor get Exported Packages exported Artifacts put extension Realm extension Descriptor get Exported Artifacts if plugin is Extensions artifacts size artifacts get get File null plexus utils equals artifacts get get Artifact Id This is purely for backward compat with x where extensions consisting of a single artifact where loaded into the core and hence available to plugins in contrast to bigger extensions that were loaded into a dedicated realm which is invisible to plugins public Artifacts add artifacts get if logger is Debug Enabled logger debug Extension realms for project model get Id extension Realms Project Realm Cache Key project Realm Key project Realm Cache create Key extension Realms Project Realm Cache Cache Record record project Realm Cache get project Realm Key if record null project Realm class Realm Manager create Project Realm model to Aether Artifacts public Artifacts Set String exclusions new Linked Hash Set for Class Realm extension Realm extension Realms List String excludes exported Artifacts get extension Realm if excludes null exclusions add All excludes List String exports exported Packages get extension Realm if exports null exports is Empty Most existing extensions do n t define exported packages i e no classes are to be exposed to plugins yet the components provided by the extension e g artifact handlers must be accessible i e we still must import the extension realm into the project realm exports Arrays as List extension Realm get Id for String export exports project Realm import From extension Realm export Dependency Filter extension Artifact Filter null if exclusions is Empty extension Artifact Filter new Exclusions Dependency Filter exclusions record project Realm Cache put project Realm Key project Realm extension Artifact Filter project Realm Cache register project project Realm Key record return record public void select Project Realm Maven Project project Class Loader project Realm project get Class Realm if project Realm null project Realm class Realm Manager get Core Realm Thread current Thread set Context Class Loader project Realm private List org eclipse aether artifact Artifact to Aether Artifacts final List Artifact plugin Artifacts return new Array List Repository Utils to Artifacts plugin Artifacts 
package org apache maven project Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util Array List import java util Date import java util List import java util Properties import org apache commons lang Validate import org apache maven artifact repository Artifact Repository import org apache maven model Profile import org apache maven model building Model Building Request import org apache maven properties internal System Properties import org eclipse aether Repository System Session public class Default Project Building Request implements Project Building Request private Repository System Session repository Session private Artifact Repository local Repository private List Artifact Repository remote Repositories private List Artifact Repository plugin Artifact Repositories private Maven Project project private int validation Level Model Building Request private boolean process Plugins private List Profile profiles private List String active Profile Ids private List String inactive Profile Ids private Properties system Properties private Properties user Properties private Date build Start Time private boolean resolve Dependencies Deprecated private boolean resolve Version Ranges private Repository Merging repository Merging Repository Merging public Default Project Building Request process Plugins true profiles new Array List active Profile Ids new Array List inactive Profile Ids new Array List system Properties new Properties user Properties new Properties remote Repositories new Array List plugin Artifact Repositories new Array List public Default Project Building Request Project Building Request request this set Process Plugins request is Process Plugins set Profiles request get Profiles set Active Profile Ids request get Active Profile Ids set Inactive Profile Ids request get Inactive Profile Ids set System Properties request get System Properties set User Properties request get User Properties set Remote Repositories request get Remote Repositories set Plugin Artifact Repositories request get Plugin Artifact Repositories set Repository Session request get Repository Session set Local Repository request get Local Repository set Build Start Time request get Build Start Time set Project request get Project set Resolve Dependencies request is Resolve Dependencies set Validation Level request get Validation Level public Maven Project get Project return project public void set Project Maven Project maven Project this project maven Project public Project Building Request set Local Repository Artifact Repository local Repository this local Repository local Repository return this public Artifact Repository get Local Repository return local Repository public List Artifact Repository get Remote Repositories return remote Repositories public Project Building Request set Remote Repositories List Artifact Repository remote Repositories if remote Repositories null this remote Repositories new Array List remote Repositories else this remote Repositories clear return this public List Artifact Repository get Plugin Artifact Repositories return plugin Artifact Repositories public Project Building Request set Plugin Artifact Repositories List Artifact Repository plugin Artifact Repositories if plugin Artifact Repositories null this plugin Artifact Repositories new Array List plugin Artifact Repositories else this plugin Artifact Repositories clear return this public Properties get System Properties return system Properties public Project Building Request set System Properties Properties system Properties if system Properties null this system Properties System Properties copy Properties system Properties else this system Properties clear return this public Properties get User Properties return user Properties public Project Building Request set User Properties Properties user Properties if user Properties null this user Properties new Properties this user Properties put All user Properties else this user Properties clear return this public boolean is Process Plugins return process Plugins public Project Building Request set Process Plugins boolean process Plugins this process Plugins process Plugins return this public Project Building Request set Resolve Dependencies boolean resolve Dependencies this resolve Dependencies resolve Dependencies return this public boolean is Resolve Dependencies return resolve Dependencies since deprecated This got added when implementing and is no longer used Commit cf c bc ab b ace ba updated the way Maven Project objects are initialized Deprecated public Project Building Request set Resolve Version Ranges boolean value this resolve Version Ranges value return this since deprecated This got added when implementing and is no longer used Commit cf c bc ab b ace ba updated the way Maven Project objects are initialized Deprecated public boolean is Resolve Version Ranges return this resolve Version Ranges public Project Building Request set Validation Level int validation Level this validation Level validation Level return this public int get Validation Level return validation Level public List String get Active Profile Ids return active Profile Ids public void set Active Profile Ids List String active Profile Ids if active Profile Ids null this active Profile Ids new Array List active Profile Ids else this active Profile Ids clear public List String get Inactive Profile Ids return inactive Profile Ids public void set Inactive Profile Ids List String inactive Profile Ids if inactive Profile Ids null this inactive Profile Ids new Array List inactive Profile Ids else this inactive Profile Ids clear public void set Profiles List Profile profiles if profiles null this profiles new Array List profiles else this profiles clear public void add Profile Profile profile profiles add profile public List Profile get Profiles return profiles public Date get Build Start Time return build Start Time public void set Build Start Time Date build Start Time this build Start Time build Start Time public Repository System Session get Repository Session return repository Session public Default Project Building Request set Repository Session Repository System Session repository Session this repository Session repository Session return this public Default Project Building Request set Repository Merging Repository Merging repository Merging this repository Merging Validate not Null repository Merging repository Merging can not be null return this public Repository Merging get Repository Merging return repository Merging 
package org apache maven Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util Collection import java util Collections import java util Hash Set import java util Iterator import java util Linked Hash Set import java util Set import org apache maven artifact Artifact import org apache maven artifact Artifact Utils import org apache maven artifact resolver Artifact Not Found Exception import org apache maven artifact resolver Artifact Resolution Exception import org apache maven artifact resolver Artifact Resolution Request import org apache maven artifact resolver Artifact Resolution Result import org apache maven artifact resolver Multiple Artifacts Not Found Exception import org apache maven artifact resolver Resolution Error Handler import org apache maven artifact resolver filter Cumulative Scope Artifact Filter import org apache maven execution Maven Session import org apache maven project Maven Project import org apache maven project artifact Project Artifact import org apache maven repository Repository System import org codehaus plexus component annotations Component import org codehaus plexus component annotations Requirement Deprecated Component role Project Dependencies Resolver class public class Default Project Dependencies Resolver implements Project Dependencies Resolver Requirement private Repository System repository System Requirement private Resolution Error Handler resolution Error Handler public Set Artifact resolve Maven Project project Collection String scopes To Resolve Maven Session session throws Artifact Resolution Exception Artifact Not Found Exception return resolve Collections singleton project scopes To Resolve session public Set Artifact resolve Maven Project project Collection String scopes To Collect Collection String scopes To Resolve Maven Session session throws Artifact Resolution Exception Artifact Not Found Exception Set Maven Project maven Projects Collections singleton project return resolve Impl maven Projects scopes To Collect scopes To Resolve session get Ignorable Artifacts maven Projects public Set Artifact resolve Collection extends Maven Project projects Collection String scopes To Resolve Maven Session session throws Artifact Resolution Exception Artifact Not Found Exception return resolve Impl projects null scopes To Resolve session get Ignorable Artifacts projects public Set Artifact resolve Maven Project project Collection String scopes To Collect Collection String scopes To Resolve Maven Session session Set Artifact ignoreable Artifacts throws Artifact Resolution Exception Artifact Not Found Exception return resolve Impl Collections singleton project scopes To Collect scopes To Resolve session get Ignorable Artifacts ignoreable Artifacts private Set Artifact resolve Impl Collection extends Maven Project projects Collection String scopes To Collect Collection String scopes To Resolve Maven Session session Set String project Ids throws Artifact Resolution Exception Artifact Not Found Exception Set Artifact resolved new Linked Hash Set if projects null projects is Empty return resolved if scopes To Collect null scopes To Collect is Empty scopes To Resolve null scopes To Resolve is Empty return resolved Logic for transitive global exclusions List String exclusions new Array List String for Dependency d project get Dependencies if d get Exclusions null for Exclusion e d get Exclusions exclusions add e get Group Id e get Artifact Id Artifact Filter scope Filter new Scope Artifact Filter scope Artifact Filter filter if exclusions is Empty filter new And Artifact Filter Arrays as List new Artifact Filter new Excludes Artifact Filter exclusions scope Filter else filter scope Filter Cumulative Scope Artifact Filter resolution Scope Filter new Cumulative Scope Artifact Filter scopes To Resolve Cumulative Scope Artifact Filter collection Scope Filter new Cumulative Scope Artifact Filter scopes To Collect collection Scope Filter new Cumulative Scope Artifact Filter collection Scope Filter resolution Scope Filter Artifact Resolution Request request new Artifact Resolution Request set Resolve Root false set Resolve Transitively true set Collection Filter collection Scope Filter set Resolution Filter resolution Scope Filter set Local Repository session get Local Repository set Offline session is Offline set Force Update session get Request is Update Snapshots request set Servers session get Request get Servers request set Mirrors session get Request get Mirrors request set Proxies session get Request get Proxies for Maven Project project projects request set Artifact new Project Artifact project request set Artifact Dependencies project get Dependency Artifacts request set Managed Version Map project get Managed Version Map request set Remote Repositories project get Remote Artifact Repositories Artifact Resolution Result result repository System resolve request try resolution Error Handler throw Errors request result catch Multiple Artifacts Not Found Exception e Collection Artifact missing new Hash Set e get Missing Artifacts for Iterator Artifact it missing iterator it has Next String key Artifact Utils key it next if project Ids contains key it remove if missing is Empty throw e resolved add All result get Artifacts return resolved private Set String get Ignorable Artifacts Collection extends Maven Project projects Set String project Ids new Hash Set projects size for Maven Project p projects String key Artifact Utils key p get Group Id p get Artifact Id p get Version project Ids add key return project Ids private Set String get Ignorable Artifacts Iterable Artifact artifact Iterable Set String project Ids new Hash Set for Artifact artifact artifact Iterable String key Artifact Utils key artifact project Ids add key return project Ids 
package org apache maven graph Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util Array List import java util Collection import java util Collections import java util Hash Set import java util List import java util Set import org apache commons lang Validate import org apache maven execution Project Dependency Graph import org apache maven project Duplicate Project Exception import org apache maven project Maven Project import org apache maven project Project Sorter import org codehaus plexus util dag Cycle Detected Exception Describes the inter dependencies between projects in the reactor author Benjamin Bentmann public class Default Project Dependency Graph implements Project Dependency Graph private Project Sorter sorter private List Maven Project all Projects Creates a new project dependency graph based on the specified projects param projects The projects to create the dependency graph with throws Duplicate Project Exception throws Cycle Detected Exception public Default Project Dependency Graph Collection Maven Project projects throws Cycle Detected Exception Duplicate Project Exception super this all Projects Collections unmodifiable List new Array List projects this sorter new Project Sorter projects Creates a new project dependency graph based on the specified projects param all Projects All collected projects param projects The projects to create the dependency graph with throws Duplicate Project Exception throws Cycle Detected Exception since public Default Project Dependency Graph final List Maven Project all Projects final Collection Maven Project projects throws Cycle Detected Exception Duplicate Project Exception super this all Projects Collections unmodifiable List new Array List all Projects this sorter new Project Sorter projects since public List Maven Project get All Projects return this all Projects public List Maven Project get Sorted Projects return new Array List sorter get Sorted Projects public List Maven Project get Downstream Projects Maven Project project boolean transitive Validate not Null project project can not be null Set String project Ids new Hash Set get Downstream Projects Project Sorter get Id project project Ids transitive return get Sorted Projects project Ids private void get Downstream Projects String project Id Set String project Ids boolean transitive for String id sorter get Dependents project Id if project Ids add id transitive get Downstream Projects id project Ids transitive public List Maven Project get Upstream Projects Maven Project project boolean transitive Validate not Null project project can not be null Set String project Ids new Hash Set get Upstream Projects Project Sorter get Id project project Ids transitive return get Sorted Projects project Ids private void get Upstream Projects String project Id Collection String project Ids boolean transitive for String id sorter get Dependencies project Id if project Ids add id transitive get Upstream Projects id project Ids transitive private List Maven Project get Sorted Projects Set String project Ids List Maven Project result new Array List project Ids size for Maven Project maven Project sorter get Sorted Projects if project Ids contains Project Sorter get Id maven Project result add maven Project return result Override public String to String return sorter get Sorted Projects to String 
package org apache maven project Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util Collections import java util List import java util Map import java util concurrent Concurrent Hash Map import org apache commons lang Validate import org codehaus plexus classworlds realm Class Realm import org codehaus plexus classworlds realm No Such Realm Exception import org codehaus plexus component annotations Component import org codehaus plexus personality plexus lifecycle phase Disposable import org eclipse aether graph Dependency Filter Default project realm cache implementation Assumes cached data does not change Component role Project Realm Cache class public class Default Project Realm Cache implements Project Realm Cache Disposable protected static class Cache Key implements Key private final List extends Class Realm extension Realms private final int hash Code public Cache Key List extends Class Realm extension Realms this extension Realms extension Realms null extension Realms Collections Class Realm empty List this hash Code this extension Realms hash Code Override public int hash Code return hash Code Override public boolean equals Object o if o this return true if o instanceof Cache Key return false Cache Key other Cache Key o return extension Realms equals other extension Realms Override public String to String return extension Realms to String protected final Map Key Cache Record cache new Concurrent Hash Map Override public Key create Key List extends Class Realm extension Realms return new Cache Key extension Realms public Cache Record get Key key return cache get key public Cache Record put Key key Class Realm project Realm Dependency Filter extension Artifact Filter Validate not Null project Realm project Realm can not be null if cache contains Key key throw new Illegal State Exception Duplicate project realm for extensions key Cache Record record new Cache Record project Realm extension Artifact Filter cache put key record return record public void flush for Cache Record record cache values Class Realm realm record realm try realm get World dispose Realm realm get Id catch No Such Realm Exception e ignore cache clear public void register Maven Project project Key key Cache Record record default cache does not track record usage Override public void dispose flush 
package org apache maven model plugin Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import org apache maven model Build import org apache maven model Model import org apache maven model Plugin import org apache maven model Plugin Management import org apache maven model Report Plugin import org apache maven model Report Set import org apache maven model Reporting import org apache maven model building Model Building Request import org apache maven model building Model Problem Collector import org apache maven model building Model Problem Collector Request import org apache maven model building Model Problem Severity import org apache maven model building Model Problem Version import org codehaus plexus component annotations Component import org codehaus plexus util String Utils import org codehaus plexus util xml Xpp Dom Handles conversion of the code lt reporting gt code section into the configuration of Maven Site Plugin x i e code report Plugins code and code output Directory code parameters author Benjamin Bentmann Component role Reporting Converter class public class Default Reporting Converter implements Reporting Converter Override public void convert Reporting Model model Model Building Request request Model Problem Collector problems Reporting reporting model get Reporting if reporting null return Build build model get Build if build null build new Build model set Build build Plugin site Plugin find Site Plugin build if site Plugin null site Plugin new Plugin site Plugin set Artifact Id maven site plugin Plugin Management plugin Management build get Plugin Management if plugin Management null plugin Management new Plugin Management build set Plugin Management plugin Management plugin Management add Plugin site Plugin Xpp Dom configuration Xpp Dom site Plugin get Configuration if configuration null configuration new Xpp Dom configuration site Plugin set Configuration configuration Xpp Dom report Plugins configuration get Child report Plugins if report Plugins null new style report configuration already present warn since this new style has been deprecated in favor of classical reporting section problems add new Model Problem Collector Request Severity Version set Message Reporting configuration should be done in reporting section not in maven site plugin configuration as report Plugins parameter set Location site Plugin get Location configuration return if configuration get Child output Directory null add Dom configuration output Directory reporting get Output Directory report Plugins new Xpp Dom report Plugins configuration add Child report Plugins boolean has Maven Project Info Reports Plugin false waiting for before deprecating reporting section if reporting get Plugins is Empty request get Validation Level Model Building Request problems add new Model Problem Collector Request Severity Version set Message The reporting section is deprecated please move the reports to the configuration section of the new Maven Site Plugin set Location reporting get Location for Report Plugin plugin reporting get Plugins Xpp Dom report Plugin convert plugin report Plugins add Child report Plugin if reporting is Exclude Defaults has Maven Project Info Reports Plugin org apache maven plugins equals plugin get Group Id maven project info reports plugin equals plugin get Artifact Id has Maven Project Info Reports Plugin true if reporting is Exclude Defaults has Maven Project Info Reports Plugin Xpp Dom dom new Xpp Dom report Plugin add Dom dom group Id org apache maven plugins add Dom dom artifact Id maven project info reports plugin report Plugins add Child dom private Plugin find Site Plugin Build build for Plugin plugin build get Plugins if is Site Plugin plugin return plugin Plugin Management plugin Management build get Plugin Management if plugin Management null for Plugin plugin plugin Management get Plugins if is Site Plugin plugin return plugin return null private boolean is Site Plugin Plugin plugin return maven site plugin equals plugin get Artifact Id org apache maven plugins equals plugin get Group Id private Xpp Dom convert Report Plugin plugin Xpp Dom dom new Xpp Dom report Plugin add Dom dom group Id plugin get Group Id add Dom dom artifact Id plugin get Artifact Id add Dom dom version plugin get Version Xpp Dom configuration Xpp Dom plugin get Configuration if configuration null configuration new Xpp Dom configuration dom add Child configuration if plugin get Report Sets is Empty Xpp Dom report Sets new Xpp Dom report Sets for Report Set report Set plugin get Report Sets Xpp Dom rs convert report Set report Sets add Child rs dom add Child report Sets return dom private Xpp Dom convert Report Set report Set Xpp Dom dom new Xpp Dom report Set add Dom dom id report Set get Id Xpp Dom configuration Xpp Dom report Set get Configuration if configuration null configuration new Xpp Dom configuration dom add Child configuration if report Set get Reports is Empty Xpp Dom reports new Xpp Dom reports for String report report Set get Reports add Dom reports report report dom add Child reports return dom private void add Dom Xpp Dom parent String child Name String child Value if String Utils is Not Empty child Value parent add Child new Dom child Name child Value private Xpp Dom new Dom String name String value Xpp Dom dom new Xpp Dom name dom set Value value return dom 
package org apache maven artifact repository metadata Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import org apache maven artifact metadata Artifact Metadata import org apache maven artifact repository Artifact Repository import org apache maven artifact repository Artifact Repository Policy import org apache maven artifact repository Default Repository Request import org apache maven artifact repository Repository Request import org apache maven artifact repository metadata io xpp Metadata Xpp Reader import org apache maven artifact repository metadata io xpp Metadata Xpp Writer import org apache maven repository legacy Update Check Manager import org apache maven repository legacy Wagon Manager import org apache maven wagon Resource Does Not Exist Exception import org apache maven wagon Transfer Failed Exception import org codehaus plexus component annotations Component import org codehaus plexus component annotations Requirement import org codehaus plexus logging Abstract Log Enabled import org codehaus plexus util Reader Factory import org codehaus plexus util Writer Factory import org codehaus plexus util xml pull Xml Pull Parser Exception import java io File import java io File Not Found Exception import java io Exception import java io Reader import java io Writer import java util Date import java util Hash Map import java util List import java util Map author Jason van Zyl Component role Repository Metadata Manager class public class Default Repository Metadata Manager extends Abstract Log Enabled implements Repository Metadata Manager Requirement private Wagon Manager wagon Manager Requirement private Update Check Manager update Check Manager public void resolve Repository Metadata metadata List Artifact Repository remote Repositories Artifact Repository local Repository throws Repository Metadata Resolution Exception Repository Request request new Default Repository Request request set Local Repository local Repository request set Remote Repositories remote Repositories resolve metadata request public void resolve Repository Metadata metadata Repository Request request throws Repository Metadata Resolution Exception Artifact Repository local Repo request get Local Repository List Artifact Repository remote Repositories request get Remote Repositories if request is Offline Date local Copy Last Modified null if metadata get Base Version null local Copy Last Modified get Local Copy Last Modified local Repo metadata for Artifact Repository repository remote Repositories Artifact Repository Policy policy metadata get Policy repository File file new File local Repo get Basedir local Repo path Of Local Repository Metadata metadata repository boolean update if policy is Enabled update false if get Logger is Debug Enabled get Logger debug Skipping update check for metadata get Key file from disabled repository repository get Id repository get Url else if request is Force Update update true else if local Copy Last Modified null policy check Out Of Date local Copy Last Modified update false if get Logger is Debug Enabled get Logger debug Skipping update check for metadata get Key file from repository repository get Id repository get Url in favor of local copy else update update Check Manager is Update Required metadata repository file if update get Logger info metadata get Key checking for updates from repository get Id try wagon Manager get Artifact Metadata metadata repository file policy get Checksum Policy catch Resource Does Not Exist Exception e get Logger debug metadata could not be found on repository repository get Id delete the local copy so the old details are n t used if file exists if file delete sleep for ms just in case this is windows holding a file lock try Thread sleep catch Interrupted Exception ie ignore file delete if this fails forget about it catch Transfer Failed Exception e get Logger warn metadata could not be retrieved from repository repository get Id due to an error e get Message get Logger debug Exception e finally update Check Manager touch metadata repository file should this be inside the above check touch file so that this is not checked again until interval has passed if file exists file set Last Modified System current Time Millis try merge Metadata metadata remote Repositories local Repo catch Repository Metadata Store Exception e throw new Repository Metadata Resolution Exception Unable to store local copy of metadata e get Message e private Date get Local Copy Last Modified Artifact Repository local Repository Repository Metadata metadata String metadata Path local Repository path Of Local Repository Metadata metadata local Repository File metadata File new File local Repository get Basedir metadata Path return metadata File is File new Date metadata File last Modified null private void merge Metadata Repository Metadata metadata List Artifact Repository remote Repositories Artifact Repository local Repository throws Repository Metadata Store Exception currently this is first wins but really we should take the latest by comparing either the snapshot timestamp or some other timestamp later encoded into the metadata this needs to be repeated here so the merging does n t interfere with the written metadata we d be much better having a pristine input and an ongoing metadata for merging instead Map Artifact Repository Metadata previous Metadata new Hash Map Artifact Repository selected null for Artifact Repository repository remote Repositories Artifact Repository Policy policy metadata get Policy repository if policy is Enabled load Metadata metadata repository local Repository previous Metadata metadata set Repository repository selected repository if load Metadata metadata local Repository local Repository previous Metadata metadata set Repository null selected local Repository update Snapshot Metadata metadata previous Metadata selected local Repository private void update Snapshot Metadata Repository Metadata metadata Map Artifact Repository Metadata previous Metadata Artifact Repository selected Artifact Repository local Repository throws Repository Metadata Store Exception this could be a lot nicer should really be in the snapshot transformation if metadata is Snapshot Metadata prev Metadata metadata get Metadata for Artifact Repository repository previous Metadata key Set Metadata m previous Metadata get repository if repository equals selected if m get Versioning null m set Versioning new Versioning if m get Versioning get Snapshot null m get Versioning set Snapshot new Snapshot else if m get Versioning null m get Versioning get Snapshot null m get Versioning get Snapshot is Local Copy m get Versioning get Snapshot set Local Copy false metadata set Metadata m metadata store In Local Repository local Repository repository metadata set Metadata prev Metadata private boolean load Metadata Repository Metadata repo Metadata Artifact Repository remote Repository Artifact Repository local Repository Map Artifact Repository Metadata previous Metadata boolean set Repository false File metadata File new File local Repository get Basedir local Repository path Of Local Repository Metadata repo Metadata remote Repository if metadata File exists Metadata metadata try metadata read Metadata metadata File catch Repository Metadata Read Exception e if get Logger is Debug Enabled get Logger warn e get Message e else get Logger warn e get Message return set Repository if repo Metadata is Snapshot previous Metadata null previous Metadata put remote Repository metadata if repo Metadata get Metadata null set Repository repo Metadata get Metadata merge metadata else repo Metadata set Metadata metadata set Repository true return set Repository share with Default Plugin Mapping Manager protected Metadata read Metadata File mapping File throws Repository Metadata Read Exception Metadata result try Reader reader Reader Factory new Xml Reader mapping File Metadata Xpp Reader mapping Reader new Metadata Xpp Reader result mapping Reader read reader false catch File Not Found Exception e throw new Repository Metadata Read Exception Can not read metadata from mapping File e catch Exception Xml Pull Parser Exception e throw new Repository Metadata Read Exception Can not read metadata from mapping File e get Message e return result Ensures the last updated timestamp of the specified metadata does not refer to the future and fixes the local metadata if necessary to allow proper merging updating of metadata during deployment private void fix Timestamp File metadata File Metadata metadata Metadata reference boolean changed false if metadata null reference null Versioning versioning metadata get Versioning Versioning versioning Ref reference get Versioning if versioning null versioning Ref null String last Updated versioning get Last Updated String now versioning Ref get Last Updated if last Updated null now null now compare To last Updated get Logger warn The last updated timestamp in metadata File refers to the future now now last Updated last Updated Please verify that the clocks of all deploying machines are reasonably synchronized versioning set Last Updated now changed true if changed get Logger debug Repairing metadata in metadata File try Writer writer Writer Factory new Xml Writer metadata File new Metadata Xpp Writer write writer metadata catch Exception e String msg Could not write fixed metadata to metadata File e get Message if get Logger is Debug Enabled get Logger warn msg e else get Logger warn msg public void resolve Always Repository Metadata metadata Artifact Repository local Repository Artifact Repository remote Repository throws Repository Metadata Resolution Exception File file try file get Artifact Metadata From Deployment Repository metadata local Repository remote Repository catch Transfer Failed Exception e throw new Repository Metadata Resolution Exception metadata could not be retrieved from repository remote Repository get Id due to an error e get Message e try if file exists Metadata prev Metadata read Metadata file metadata set Metadata prev Metadata catch Repository Metadata Read Exception e throw new Repository Metadata Resolution Exception e get Message e private File get Artifact Metadata From Deployment Repository Artifact Metadata metadata Artifact Repository local Repo Artifact Repository remote Repository throws Transfer Failed Exception File file new File local Repo get Basedir local Repo path Of Local Repository Metadata metadata remote Repository try wagon Manager get Artifact Metadata From Deployment Repository metadata remote Repository file Artifact Repository Policy catch Resource Does Not Exist Exception e get Logger info metadata could not be found on repository remote Repository get Id so will be created delete the local copy so the old details are n t used if file exists if file delete sleep for ms just in case this is windows holding a file lock try Thread sleep catch Interrupted Exception ie ignore file delete if this fails forget about it finally if metadata instanceof Repository Metadata update Check Manager touch Repository Metadata metadata remote Repository file return file public void deploy Artifact Metadata metadata Artifact Repository local Repository Artifact Repository deployment Repository throws Repository Metadata Deployment Exception File file if metadata instanceof Repository Metadata get Logger info Retrieving previous metadata from deployment Repository get Id try file get Artifact Metadata From Deployment Repository metadata local Repository deployment Repository catch Transfer Failed Exception e throw new Repository Metadata Deployment Exception metadata could not be retrieved from repository deployment Repository get Id due to an error e get Message e if file is File try fix Timestamp file read Metadata file Repository Metadata metadata get Metadata catch Repository Metadata Read Exception e will be reported via store Inlocal Repository else It s a we do n t need to retrieve it first file new File local Repository get Basedir local Repository path Of Local Repository Metadata metadata deployment Repository try metadata store In Local Repository local Repository deployment Repository catch Repository Metadata Store Exception e throw new Repository Metadata Deployment Exception Error installing metadata e get Message e try wagon Manager put Artifact Metadata file metadata deployment Repository catch Transfer Failed Exception e throw new Repository Metadata Deployment Exception Error while deploying metadata e get Message e public void install Artifact Metadata metadata Artifact Repository local Repository throws Repository Metadata Installation Exception try metadata store In Local Repository local Repository local Repository catch Repository Metadata Store Exception e throw new Repository Metadata Installation Exception Error installing metadata e get Message e 
package org apache maven artifact manager Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util List import org apache maven artifact Artifact import org apache maven artifact repository Artifact Repository import org apache maven artifact repository Artifact Repository Factory import org apache maven execution Maven Execution Request import org apache maven execution Maven Session import org apache maven plugin Legacy Support import org apache maven repository Mirror Selector import org apache maven settings Mirror import org apache maven settings Proxy import org apache maven settings Server import org apache maven settings crypto Default Settings Decryption Request import org apache maven settings crypto Settings Decrypter import org apache maven settings crypto Settings Decryption Result import org apache maven wagon Resource Does Not Exist Exception import org apache maven wagon Transfer Failed Exception import org apache maven wagon authentication Authentication Info import org apache maven wagon proxy Proxy Info import org codehaus plexus component annotations Component import org codehaus plexus component annotations Requirement import org codehaus plexus logging Logger Component role Wagon Manager class public class Default Wagon Manager extends org apache maven repository legacy Default Wagon Manager implements Wagon Manager This must use a different field name than in the super class or Io has no chance to inject the loggers Requirement private Logger log Requirement private Legacy Support legacy Support Requirement private Settings Decrypter settings Decrypter Requirement private Mirror Selector mirror Selector Requirement private Artifact Repository Factory artifact Repository Factory public Authentication Info get Authentication Info String id Maven Session session legacy Support get Session if session null id null Maven Execution Request request session get Request if request null List Server servers request get Servers if servers null for Server server servers if id equals Ignore Case server get Id Settings Decryption Result result settings Decrypter decrypt new Default Settings Decryption Request server server result get Server Authentication Info auth Info new Authentication Info auth Info set User Name server get Username auth Info set Password server get Password auth Info set Private Key server get Private Key auth Info set Passphrase server get Passphrase return auth Info empty one to prevent return new Authentication Info public Proxy Info get Proxy String protocol Maven Session session legacy Support get Session if session null protocol null Maven Execution Request request session get Request if request null List Proxy proxies request get Proxies if proxies null for Proxy proxy proxies if proxy is Active protocol equals Ignore Case proxy get Protocol Settings Decryption Result result settings Decrypter decrypt new Default Settings Decryption Request proxy proxy result get Proxy Proxy Info proxy Info new Proxy Info proxy Info set Host proxy get Host proxy Info set Type proxy get Protocol proxy Info set Port proxy get Port proxy Info set Non Proxy Hosts proxy get Non Proxy Hosts proxy Info set User Name proxy get Username proxy Info set Password proxy get Password return proxy Info return null public void get Artifact Artifact artifact Artifact Repository repository throws Transfer Failed Exception Resource Does Not Exist Exception get Artifact artifact repository null false public void get Artifact Artifact artifact List Artifact Repository remote Repositories throws Transfer Failed Exception Resource Does Not Exist Exception get Artifact artifact remote Repositories null false Deprecated public Artifact Repository get Mirror Repository Artifact Repository repository Mirror mirror mirror Selector get Mirror repository legacy Support get Session get Settings get Mirrors if mirror null String id mirror get Id if id null this should be illegal in settings xml id repository get Id log debug Using mirror mirror get Url id id repository artifact Repository Factory create Artifact Repository id mirror get Url repository get Layout repository get Snapshots repository get Releases return repository 
Generated by Modello any modifications will be overwritten package org apache maven model The code lt dependency gt code element contains information about a dependency of the project version Revision Date Suppress Warnings all public class Dependency implements java io Serializable java lang Cloneable org apache maven model Input Location Tracker Class Member Variables The project group that produced the dependency e g code org apache maven code private String group Id The unique id for an artifact produced by the project group e g code maven artifact code private String artifact Id The version of the dependency e g code code In Maven this can also be specified as a range of versions private String version The type of dependency While it usually represents the extension on the filename of the dependency that is not always the case type can be mapped to a different extension and a classifier The type often corresponds to the packaging used though this is also not always the case Some examples are code jar code code war code code ejb client code and code test jar code see a href maven core artifact handlers html default artifact handlers a for a list New types can be defined by plugins that set code extensions code to code true code so this is not a complete list private String type jar The classifier of the dependency It is appended to the filename after the version This allows ul li referring to attached artifact for example code sources code and code javadoc code see a href maven core artifact handlers html default artifact handlers a for a list li li distinguishing two artifacts that belong to the same but were built differently For example code jdk code and code jdk code li ul private String classifier The scope of the dependency code compile code code runtime code code test code code system code and code provided code Used to calculate the various classpaths used for compilation testing and so on It also assists in determining which artifacts to include in a distribution of this project For more information see a href https maven apache org guides introduction introduction to dependency mechanism html the dependency mechanism a The default scope is code compile code private String scope Note that use of this property is b discouraged b and may be replaced in later versions This specifies the path on the filesystem for this dependency Requires an absolute path for the value not relative Use a property that gives the machine specific absolute path e g code java home code private String system Path Field exclusions private java util List Exclusion exclusions Indicates the dependency is optional for use of this library While the version of the dependency will be taken into account for dependency calculation if the library is used elsewhere it will not be passed on transitively Note While the type of this field is code String code for technical reasons the semantic type is actually code Boolean code Default value is code false code private String optional Field locations private java util Map Object Input Location locations Methods Method add Exclusion param exclusion public void add Exclusion Exclusion exclusion get Exclusions add exclusion void add Exclusion Exclusion Method clone return Dependency public Dependency clone try Dependency copy Dependency super clone if this exclusions null copy exclusions new java util Array List Exclusion for Exclusion item this exclusions copy exclusions add Exclusion item clone if copy locations null copy locations new java util Linked Hash Map copy locations return copy catch java lang Exception ex throw java lang Runtime Exception new java lang Unsupported Operation Exception get Class get Name does not support clone init Cause ex Dependency clone Get the unique id for an artifact produced by the project group e g code maven artifact code return String public String get Artifact Id return this artifact Id String get Artifact Id Get the classifier of the dependency It is appended to the filename after the version This allows ul li referring to attached artifact for example code sources code and code javadoc code see a href maven core artifact handlers html default artifact handlers a for a list li li distinguishing two artifacts that belong to the same but were built differently For example code jdk code and code jdk code li ul return String public String get Classifier return this classifier String get Classifier Method get Exclusions return List public java util List Exclusion get Exclusions if this exclusions null this exclusions new java util Array List Exclusion return this exclusions java util List Exclusion get Exclusions Get the project group that produced the dependency e g code org apache maven code return String public String get Group Id return this group Id String get Group Id param key return Input Location public Input Location get Location Object key return locations null locations get key null Input Location get Location Object Get indicates the dependency is optional for use of this library While the version of the dependency will be taken into account for dependency calculation if the library is used elsewhere it will not be passed on transitively Note While the type of this field is code String code for technical reasons the semantic type is actually code Boolean code Default value is code false code return String public String get Optional return this optional String get Optional Get the scope of the dependency code compile code code runtime code code test code code system code and code provided code Used to calculate the various classpaths used for compilation testing and so on It also assists in determining which artifacts to include in a distribution of this project For more information see a href https maven apache org guides introduction introduction to dependency mechanism html the dependency mechanism a The default scope is code compile code return String public String get Scope return this scope String get Scope Get f Note that use of this property is b discouraged b and may be replaced in later versions This specifies the path on the filesystem for this dependency Requires an absolute path for the value not relative Use a property that gives the machine specific absolute path e g code java home code return String public String get System Path return this system Path String get System Path Get the type of dependency While it usually represents the extension on the filename of the dependency that is not always the case type can be mapped to a different extension and a classifier The type often corresponds to the packaging used though this is also not always the case Some examples are code jar code code war code code ejb client code and code test jar code see a href maven core artifact handlers html default artifact handlers a for a list New types can be defined by plugins that set code extensions code to code true code so this is not a complete list return String public String get Type return this type String get Type Get the version of the dependency e g code code In Maven this can also be specified as a range of versions return String public String get Version return this version String get Version Method remove Exclusion param exclusion public void remove Exclusion Exclusion exclusion get Exclusions remove exclusion void remove Exclusion Exclusion Set the unique id for an artifact produced by the project group e g code maven artifact code param artifact Id public void set Artifact Id String artifact Id this artifact Id artifact Id void set Artifact Id String Set the classifier of the dependency It is appended to the filename after the version This allows ul li referring to attached artifact for example code sources code and code javadoc code see a href maven core artifact handlers html default artifact handlers a for a list li li distinguishing two artifacts that belong to the same but were built differently For example code jdk code and code jdk code li ul param classifier public void set Classifier String classifier this classifier classifier void set Classifier String Set lists a set of artifacts that should be excluded from this dependency s artifact list when it comes to calculating transitive dependencies param exclusions public void set Exclusions java util List Exclusion exclusions this exclusions exclusions void set Exclusions java util List Set the project group that produced the dependency e g code org apache maven code param group Id public void set Group Id String group Id this group Id group Id void set Group Id String param key param location public void set Location Object key Input Location location if location null if this locations null this locations new java util Linked Hash Map Object Input Location this locations put key location void set Location Object Input Location Set indicates the dependency is optional for use of this library While the version of the dependency will be taken into account for dependency calculation if the library is used elsewhere it will not be passed on transitively Note While the type of this field is code String code for technical reasons the semantic type is actually code Boolean code Default value is code false code param optional public void set Optional String optional this optional optional void set Optional String Set the scope of the dependency code compile code code runtime code code test code code system code and code provided code Used to calculate the various classpaths used for compilation testing and so on It also assists in determining which artifacts to include in a distribution of this project For more information see a href https maven apache org guides introduction introduction to dependency mechanism html the dependency mechanism a The default scope is code compile code param scope public void set Scope String scope this scope scope void set Scope String Set f Note that use of this property is b discouraged b and may be replaced in later versions This specifies the path on the filesystem for this dependency Requires an absolute path for the value not relative Use a property that gives the machine specific absolute path e g code java home code param system Path public void set System Path String system Path this system Path system Path void set System Path String Set the type of dependency While it usually represents the extension on the filename of the dependency that is not always the case type can be mapped to a different extension and a classifier The type often corresponds to the packaging used though this is also not always the case Some examples are code jar code code war code code ejb client code and code test jar code see a href maven core artifact handlers html default artifact handlers a for a list New types can be defined by plugins that set code extensions code to code true code so this is not a complete list param type public void set Type String type this type type void set Type String Set the version of the dependency e g code code In Maven this can also be specified as a range of versions param version public void set Version String version this version version void set Version String public boolean is Optional return optional null Boolean parse Boolean optional false public void set Optional boolean optional this optional String value Of optional see java lang Object to String public String to String return Dependency group Id group Id artifact Id artifact Id version version type type private String management Key return the management key as code group Id artifact Id type code public String get Management Key if management Key null management Key group Id artifact Id type classifier null classifier return management Key 
package org apache maven eventspy internal Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util Array List import java util List import org apache maven eventspy Event Spy import org apache maven execution Execution Listener import org codehaus plexus component annotations Component import org codehaus plexus component annotations Requirement import org codehaus plexus logging Logger import org eclipse aether Repository Listener Dispatches callbacks to all registered eventspies since Component role Event Spy Dispatcher class public class Event Spy Dispatcher Requirement private Logger logger Requirement role Event Spy class private List Event Spy event Spies public void set Event Spies List Event Spy event Spies make copy to get rid of needless overhead for dynamic lookups this event Spies new Array List event Spies public List Event Spy get Event Spies return event Spies public Execution Listener chain Listener Execution Listener listener if event Spies is Empty return listener return new Event Spy Execution Listener this listener public Repository Listener chain Listener Repository Listener listener if event Spies is Empty return listener return new Event Spy Repository Listener this listener public void init Event Spy Context context if event Spies is Empty return for Event Spy event Spy event Spies try event Spy init context catch Exception Linkage Error e log Error initialize e event Spy public void on Event Object event if event Spies is Empty return for Event Spy event Spy event Spies try event Spy on Event event catch Exception Linkage Error e log Error notify e event Spy public void close if event Spies is Empty return for Event Spy event Spy event Spies try event Spy close catch Exception Linkage Error e log Error close e event Spy private void log Error String action Throwable e Event Spy spy String msg Failed to action spy spy get Class get Name e get Message if logger is Debug Enabled logger warn msg e else logger warn msg 
package org apache maven cli event Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import static org apache maven cli Reporting Utils format Duration import static org apache maven cli Reporting Utils format Timestamp import static org apache maven shared utils logging Message Utils buffer import org apache commons lang Validate import org apache maven execution Abstract Execution Listener import org apache maven execution Build Failure import org apache maven execution Build Success import org apache maven execution Build Summary import org apache maven execution Execution Event import org apache maven execution Maven Execution Result import org apache maven execution Maven Session import org apache maven plugin Mojo Execution import org apache maven plugin descriptor Mojo Descriptor import org apache maven project Maven Project import org apache maven shared utils logging Message Builder import org codehaus plexus util String Utils import org slf j Logger import org slf j Logger Factory Logs execution events to logger eventually user supplied author Benjamin Bentmann public class Execution Event Logger extends Abstract Execution Listener private final Logger logger private static final int private static final int private static final int public Execution Event Logger logger Logger Factory get Logger Execution Event Logger class should we deprecate public Execution Event Logger Logger logger this logger Validate not Null logger logger can not be null private static String chars char c int count String Builder buffer new String Builder count for int i count i i buffer append c return buffer to String private void info Line char c info Main chars c private void info Main String msg logger info buffer strong msg to String Override public void project Discovery Started Execution Event event if logger is Info Enabled logger info Scanning for projects Override public void session Started Execution Event event if logger is Info Enabled event get Session get Projects size info Line info Main Reactor Build Order logger info for Maven Project project event get Session get Projects logger info project get Name Override public void session Ended Execution Event event if logger is Info Enabled if event get Session get Projects size log Reactor Summary event get Session log Result event get Session log Stats event get Session info Line private void log Reactor Summary Maven Session session info Line info Main Reactor Summary logger info Maven Execution Result result session get Result for Maven Project project session get Projects String Builder buffer new String Builder buffer append project get Name buffer append if buffer length while buffer length buffer append buffer append Build Summary build Summary result get Build Summary project if build Summary null buffer append buffer warning else if build Summary instanceof Build Success buffer append buffer success buffer append String build Time Duration format Duration build Summary get Time int pad Size build Time Duration length if pad Size buffer append chars pad Size buffer append build Time Duration buffer append else if build Summary instanceof Build Failure buffer append buffer failure buffer append String build Time Duration format Duration build Summary get Time int pad Size build Time Duration length if pad Size buffer append chars pad Size buffer append build Time Duration buffer append logger info buffer to String private void log Result Maven Session session info Line Message Builder buffer buffer if session get Result has Exceptions buffer failure else buffer success logger info buffer to String private void log Stats Maven Session session info Line long finish System current Time Millis long time finish session get Request get Start Time get Time String wall Clock session get Request get Degree Of Concurrency Wall Clock logger info Total time format Duration time wall Clock logger info Finished at format Timestamp finish System gc Runtime r Runtime get Runtime long mb logger info Final Memory r total Memory r free Memory mb r total Memory mb Override public void project Skipped Execution Event event if logger is Info Enabled logger info info Line info Main Skipping event get Project get Name logger info This project has been banned from the build due to previous failures info Line Override public void project Started Execution Event event if logger is Info Enabled logger info info Line info Main Building event get Project get Name event get Project get Version info Line Override public void mojo Skipped Execution Event event if logger is Warn Enabled logger warn Goal event get Mojo Execution get Goal requires online mode for execution but Maven is currently offline skipping pre mojo artifact Id version goal mojo execution Id project artifact Id pre Override public void mojo Started Execution Event event if logger is Info Enabled logger info Message Builder buffer buffer strong append buffer event get Mojo Execution append buffer event get Project buffer strong logger info buffer to String Line Length pre gt gt gt mojo artifact Id version goal mojo execution Id gt forked goal project artifact Id gt gt gt pre pre gt gt gt mojo artifact Id version goal mojo execution Id gt lifecycle phase project artifact Id gt gt gt pre Line Length Override public void fork Started Execution Event event if logger is Info Enabled logger info Message Builder buffer buffer strong append buffer event get Mojo Execution buffer strong append Fork Info buffer event get Mojo Execution get Mojo Descriptor append buffer event get Project buffer strong logger info buffer to String Line Length pre lt lt lt mojo artifact Id version goal mojo execution Id lt forked goal project artifact Id lt lt lt pre pre lt lt lt mojo artifact Id version goal mojo execution Id lt lifecycle phase project artifact Id lt lt lt pre Line Length Override public void fork Succeeded Execution Event event if logger is Info Enabled logger info Message Builder buffer buffer strong append buffer event get Mojo Execution buffer strong append Fork Info buffer event get Mojo Execution get Mojo Descriptor append buffer event get Project buffer strong logger info buffer to String logger info private void append Message Builder buffer Mojo Execution me buffer mojo me get Artifact Id me get Version me get Goal if me get Execution Id null buffer a strong me get Execution Id private void append Fork Info Message Builder buffer Mojo Descriptor md String Builder buff new String Builder if String Utils is Not Empty md get Execute Phase forked phase if String Utils is Not Empty md get Execute Lifecycle buff append buff append md get Execute Lifecycle buff append buff append md get Execute Phase else forked goal buff append buff append md get Execute Goal buffer strong buff to String private void append Message Builder buffer Maven Project project buffer a project project get Artifact Id Override public void forked Project Started Execution Event event if logger is Info Enabled event get Mojo Execution get Forked Executions size logger info info Line info Main Forking event get Project get Name event get Project get Version info Line 
package org apache maven project Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util Array List import java util List Provides metadata about a build extension strong Warning strong This is an internal utility class that is only public for technical reasons it is not part of the public In particular this class can be changed or deleted without prior notice author Benjamin Bentmann public class Extension Descriptor private List String exported Packages private List String exported Artifacts Extension Descriptor hide constructor public List String get Exported Packages if exported Packages null exported Packages new Array List return exported Packages public void set Exported Packages List String exported Packages if exported Packages null this exported Packages null else this exported Packages new Array List exported Packages public List String get Exported Artifacts if exported Artifacts null exported Artifacts new Array List return exported Artifacts public void set Exported Artifacts List String exported Artifacts if exported Artifacts null this exported Artifacts null else this exported Artifacts new Array List exported Artifacts 
package org apache maven project Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import org codehaus plexus util Reader Factory import org codehaus plexus util xml Xpp Dom import org codehaus plexus util xml Xpp Dom Builder import org codehaus plexus util xml pull Xml Pull Parser Exception import java io Buffered Input Stream import java io File import java io File Input Stream import java io Exception import java io Input Stream import java util Array List import java util List import java util jar Jar File import java util zip Zip Entry Creates an extension descriptor from some stream author Benjamin Bentmann public class Extension Descriptor Builder since public String get Extension Descriptor Location return maven extension xml Extracts the extension descriptor if any from the specified file param extension Jar The file or directory to extract the descriptor from must not be code null return The extracted descriptor or code null if no descriptor was found throws Exception If the descriptor is present but could not be parsed public Extension Descriptor build File extension Jar throws Exception Extension Descriptor extension Descriptor null if extension Jar is File try Jar File plugin Jar new Jar File extension Jar false Zip Entry plugin Descriptor Entry plugin Jar get Entry get Extension Descriptor Location if plugin Descriptor Entry null try Input Stream is plugin Jar get Input Stream plugin Descriptor Entry extension Descriptor build is else File plugin Xml new File extension Jar get Extension Descriptor Location if plugin Xml can Read try Input Stream is new Buffered Input Stream new File Input Stream plugin Xml extension Descriptor build is return extension Descriptor since public Extension Descriptor build Input Stream is throws Exception Extension Descriptor extension Descriptor new Extension Descriptor Xpp Dom dom try dom Xpp Dom Builder build Reader Factory new Xml Reader is catch Xml Pull Parser Exception e throw Exception new Exception e get Message init Cause e if extension equals dom get Name throw new Exception Unexpected root element dom get Name expected extension extension Descriptor set Exported Packages parse Strings dom get Child exported Packages extension Descriptor set Exported Artifacts parse Strings dom get Child exported Artifacts return extension Descriptor private List String parse Strings Xpp Dom dom List String strings null if dom null strings new Array List for Xpp Dom child dom get Children String string child get Value if string null string string trim if string length strings add string return strings 
package org apache maven model building Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io File import java net import org apache maven building File Source Wraps an ordinary link File as a model source author Benjamin Bentmann public class File Model Source extends File Source implements Model Source Creates a new model source backed by the specified file param pom File The file must not be code null public File Model Source File pom File super pom File return the file of this source deprecated instead use link get File Deprecated public File get Pom File return get File Override public Model Source get Related Source String rel Path rel Path rel Path replace File separator Char replace File separator Char File related Pom new File get File get Parent File rel Path if related Pom is Directory figure out how to reuse Model Locator locate Pom File here related Pom new File related Pom pom xml if related Pom is File related Pom can Read return new File Model Source new File related Pom to normalize return null Override public get Location return get File to 
package org apache maven model profile activation Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io File import org apache maven model Activation import org apache maven model Activation File import org apache maven model Profile import org apache maven model building Model Problem Collector import org apache maven model building Model Problem Severity import org apache maven model building Model Problem Version import org apache maven model building Model Problem Collector Request import org apache maven model path Path Translator import org apache maven model profile Profile Activation Context import org codehaus plexus component annotations Component import org codehaus plexus component annotations Requirement import org codehaus plexus interpolation Abstract Value Source import org codehaus plexus interpolation Map Based Value Source import org codehaus plexus interpolation Regex Based Interpolator import org codehaus plexus util String Utils Determines profile activation based on the existence absence of some file File name interpolation support is limited to code basedir code since Maven see a href https issues apache org jira browse a System properties and request properties code project basedir code is intentionally not supported as this form would suggest that other code project code expressions can be used which is however beyond the design author Benjamin Bentmann see Activation File see org apache maven model validation Default Model Validator validate Raw Model Component role Profile Activator class hint file public class File Profile Activator implements Profile Activator Requirement private Path Translator path Translator public File Profile Activator set Path Translator Path Translator path Translator this path Translator path Translator return this Override public boolean is Active Profile profile Profile Activation Context context Model Problem Collector problems Activation activation profile get Activation if activation null return false Activation File file activation get File if file null return false String path boolean missing if String Utils is Not Empty file get Exists path file get Exists missing false else if String Utils is Not Empty file get Missing path file get Missing missing true else return false Regex Based Interpolator interpolator new Regex Based Interpolator final File basedir context get Project Directory if basedir null interpolator add Value Source new Abstract Value Source false Override public Object get Value String expression We intentionally only support basedir and not project basedir as the latter form would suggest that other project expressions can be used which is however beyond the design if basedir equals expression return basedir get Absolute Path return null else if path contains basedir return false interpolator add Value Source new Map Based Value Source context get Project Properties interpolator add Value Source new Map Based Value Source context get User Properties interpolator add Value Source new Map Based Value Source context get System Properties try path interpolator interpolate path catch Exception e problems add new Model Problem Collector Request Severity Version set Message Failed to interpolate file location path for profile profile get Id e get Message set Location file get Location missing missing exists set Exception e return false path path Translator align To Base Directory path basedir replace activation value with interpolated value if missing file set Missing path else file set Exists path File f new File path if f is Absolute return false boolean file Exists f exists return missing file Exists file Exists Override public boolean present In Config Profile profile Profile Activation Context context Model Problem Collector problems Activation activation profile get Activation if activation null return false Activation File file activation get File if file null return false return true 
package org apache maven building Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io File import java io File Input Stream import java io Exception import java io Input Stream import org apache commons lang Validate Wraps an ordinary link File as a source author Benjamin Bentmann public class File Source implements Source private final File file Creates a new source backed by the specified file param file The file must not be code null public File Source File file this file Validate not Null file file can not be null get Absolute File Override public Input Stream get Input Stream throws Exception return new File Input Stream file Override public String get Location return file get Path Gets the file of this source return The underlying file never code null public File get File return file Override public String to String return get Location 
package org apache maven model profile activation Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util Array List import java util Arrays import java util List import org apache maven model Activation import org apache maven model Profile import org apache maven model building Model Problem Collector import org apache maven model building Model Problem Severity import org apache maven model building Model Problem Version import org apache maven model building Model Problem Collector Request import org apache maven model profile Profile Activation Context import org codehaus plexus component annotations Component Determines profile activation based on the version of the current Java runtime author Benjamin Bentmann see Activation get Jdk Component role Profile Activator class hint jdk version public class Jdk Version Profile Activator implements Profile Activator Override public boolean is Active Profile profile Profile Activation Context context Model Problem Collector problems Activation activation profile get Activation if activation null return false String jdk activation get Jdk if jdk null return false String version context get System Properties get java version if version null version length problems add new Model Problem Collector Request Severity Version set Message Failed to determine Java version for profile profile get Id set Location activation get Location jdk return false if jdk starts With return version starts With jdk substring else if is Range jdk return is In Range version get Range jdk else return version starts With jdk Override public boolean present In Config Profile profile Profile Activation Context context Model Problem Collector problems Activation activation profile get Activation if activation null return false String jdk activation get Jdk if jdk null return false return true private static boolean is In Range String value List Range Value range int left Relation get Relation Order value range get true if left Relation return true if left Relation return false return get Relation Order value range get false private static int get Relation Order String value Range Value range Value boolean is Left if range Value value length return is Left value value replace All List String value Tokens new Array List Arrays as List value split List String range Value Tokens new Array List Arrays as List range Value value split add Zero Tokens value Tokens add Zero Tokens range Value Tokens for int i i i int x Integer parse Int value Tokens get i int y Integer parse Int range Value Tokens get i if x y return else if x y return if range Value closed return is Left return private static void add Zero Tokens List String tokens int max while tokens size max tokens add private static boolean is Range String value return value starts With value starts With private static List Range Value get Range String range List Range Value ranges new Array List for String token range split if token starts With ranges add new Range Value token replace true else if token starts With ranges add new Range Value token replace false else if token ends With ranges add new Range Value token replace true else if token ends With ranges add new Range Value token replace false else if token length ranges add new Range Value false if ranges size ranges add new Range Value false return ranges private static class Range Value private String value private boolean closed Range Value String value boolean closed this value value trim this closed closed Override public String to String return value 
package org apache maven repository legacy Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io File import java io Exception import java util Array List import java util Collection import java util Collections import java util Hash Map import java util Linked Hash Map import java util List import java util Map import org apache maven Repository Utils import org apache maven artifact Artifact import org apache maven artifact Invalid Repository Exception import org apache maven artifact factory Artifact Factory import org apache maven artifact metadata Artifact Metadata import org apache maven artifact repository Artifact Repository import org apache maven repository legacy repository Artifact Repository Factory import org apache maven artifact repository Artifact Repository Policy import org apache maven artifact repository Authentication import org apache maven artifact repository layout Artifact Repository Layout import org apache maven artifact resolver Artifact Resolution Request import org apache maven artifact resolver Artifact Resolution Result import org apache maven artifact resolver Artifact Resolver import org apache maven artifact resolver filter Excludes Artifact Filter import org apache maven artifact versioning Invalid Version Specification Exception import org apache maven artifact versioning Version Range import org apache maven model Dependency import org apache maven model Exclusion import org apache maven model Plugin import org apache maven model Repository import org apache maven model Repository Policy import org apache maven repository Delegating Local Artifact Repository import org apache maven repository Local Artifact Repository import org apache maven repository Artifact Transfer Listener import org apache maven repository Mirror Selector import org apache maven repository Proxy import org apache maven repository Repository System import org apache maven repository Artifact Does Not Exist Exception import org apache maven repository Artifact Transfer Failed Exception import org apache maven settings Mirror import org apache maven settings Server import org apache maven settings building Settings Problem import org apache maven settings crypto Default Settings Decryption Request import org apache maven settings crypto Settings Decrypter import org apache maven settings crypto Settings Decryption Request import org apache maven settings crypto Settings Decryption Result import org apache maven wagon proxy Proxy Info import org apache maven wagon proxy Proxy Utils import org codehaus plexus Plexus Container import org codehaus plexus component annotations Component import org codehaus plexus component annotations Requirement import org codehaus plexus component repository exception Component Lookup Exception import org codehaus plexus logging Logger import org codehaus plexus util String Utils import org eclipse aether Repository System Session import org eclipse aether repository Authentication Context import org eclipse aether repository Authentication Selector import org eclipse aether repository Proxy Selector import org eclipse aether repository Remote Repository author Jason van Zyl Component role Repository System class hint default public class Legacy Repository System implements Repository System Requirement private Logger logger Requirement private Artifact Factory artifact Factory Requirement private Artifact Resolver artifact Resolver Requirement private Artifact Repository Factory artifact Repository Factory Requirement role Artifact Repository Layout class private Map String Artifact Repository Layout layouts Requirement private Wagon Manager wagon Manager Requirement private Plexus Container plexus Requirement private Mirror Selector mirror Selector Requirement private Settings Decrypter settings Decrypter public Artifact create Artifact String group Id String artifact Id String version String scope String type return artifact Factory create Artifact group Id artifact Id version scope type public Artifact create Artifact String group Id String artifact Id String version String packaging return artifact Factory create Build Artifact group Id artifact Id version packaging public Artifact create Artifact With Classifier String group Id String artifact Id String version String type String classifier return artifact Factory create Artifact With Classifier group Id artifact Id version type classifier public Artifact create Project Artifact String group Id String artifact Id String meta Version Id return artifact Factory create Project Artifact group Id artifact Id meta Version Id public Artifact create Dependency Artifact Dependency d Version Range version Range try version Range Version Range create From Version Spec d get Version catch Invalid Version Specification Exception e Log a message instead of returning null silently this logger error String format Invalid version specification s creating dependency artifact s d get Version d e return null Artifact artifact artifact Factory create Dependency Artifact d get Group Id d get Artifact Id version Range d get Type d get Classifier d get Scope d is Optional if Artifact equals d get Scope d get System Path null artifact set File new File d get System Path if d get Exclusions is Empty List String exclusions new Array List for Exclusion exclusion d get Exclusions exclusions add exclusion get Group Id exclusion get Artifact Id artifact set Dependency Filter new Excludes Artifact Filter exclusions return artifact public Artifact create Extension Artifact String group Id String artifact Id String version Version Range version Range try version Range Version Range create From Version Spec version catch Invalid Version Specification Exception e Log a message instead of returning null silently this logger error String format Invalid version specification s creating extension artifact s s s version group Id artifact Id version e return null return artifact Factory create Extension Artifact group Id artifact Id version Range public Artifact create Parent Artifact String group Id String artifact Id String version return artifact Factory create Parent Artifact group Id artifact Id version public Artifact create Plugin Artifact Plugin plugin String version plugin get Version if String Utils is Empty version version Version Range version Range try version Range Version Range create From Version Spec version catch Invalid Version Specification Exception e Log a message instead of returning null silently this logger error String format Invalid version specification s creating plugin artifact s version plugin e return null return artifact Factory create Plugin Artifact plugin get Group Id plugin get Artifact Id version Range public Artifact Repository Policy build Artifact Repository Policy Repository Policy policy boolean enabled true String update Policy null String checksum Policy null if policy null enabled policy is Enabled if policy get Update Policy null update Policy policy get Update Policy if policy get Checksum Policy null checksum Policy policy get Checksum Policy return new Artifact Repository Policy enabled update Policy checksum Policy public Artifact Repository create Default Local Repository throws Invalid Repository Exception return create Local Repository Repository System default User Local Repository public Artifact Repository create Local Repository File local Repository throws Invalid Repository Exception return create Repository file local Repository to get Raw Path Repository System true Artifact Repository Policy true Artifact Repository Policy Artifact Repository Policy public Artifact Repository create Default Remote Repository throws Invalid Repository Exception return create Repository Repository System Repository System true Artifact Repository Policy false Artifact Repository Policy Artifact Repository Policy public Artifact Repository create Local Repository String url String repository Id throws Exception return create Repository canonical File Url url repository Id true Artifact Repository Policy true Artifact Repository Policy Artifact Repository Policy private String canonical File Url String url throws Exception if url starts With file url file url else if url starts With file url starts With file url file url substring file length So now we have an url of the form file path We want to eliminate any relative path nonsense and lock down the path so we need to fully resolve it before any sub modules use the path This can happen when you are using a custom settings xml that contains a relative path entry for the local repository setting File local Repository new File url substring file length if local Repository is Absolute url file local Repository get Canonical Path return url public Artifact Resolution Result resolve Artifact Resolution Request request Probably is not worth it but here make sure restore request to its original state try Local Artifact Repository ide Workspace plexus lookup Local Artifact Repository class Local Artifact Repository if request get Local Repository instanceof Delegating Local Artifact Repository Delegating Local Artifact Repository delegating Local Repository Delegating Local Artifact Repository request get Local Repository Local Artifact Repository orig delegating Local Repository get Ide Workspace delegating Local Repository set Ide Workspace ide Workspace try return artifact Resolver resolve request finally delegating Local Repository set Ide Workspace orig else Artifact Repository local Repository request get Local Repository Delegating Local Artifact Repository delegating Local Repository new Delegating Local Artifact Repository local Repository delegating Local Repository set Ide Workspace ide Workspace request set Local Repository delegating Local Repository try return artifact Resolver resolve request finally request set Local Repository local Repository catch Component Lookup Exception e no ide workspace artifact resolution return artifact Resolver resolve request public void add Proxy String protocol String host int port String username String password String non Proxy Hosts Proxy Info proxy Info new Proxy Info proxy Info set Host host proxy Info set Type protocol proxy Info set Port port proxy Info set Non Proxy Hosts non Proxy Hosts proxy Info set User Name username proxy Info set Password password proxies put protocol proxy Info wagon Manager add Proxy protocol host port username password non Proxy Hosts public List Artifact Repository get Effective Repositories List Artifact Repository repositories if repositories null return null Map String List Artifact Repository repos By Key new Linked Hash Map for Artifact Repository repository repositories String key repository get Id List Artifact Repository aliased Repos repos By Key get key if aliased Repos null aliased Repos new Array List repos By Key put key aliased Repos aliased Repos add repository List Artifact Repository effective Repositories new Array List for List Artifact Repository aliased Repos repos By Key values List Artifact Repository mirrored Repos new Array List List Artifact Repository Policy release Policies new Array List aliased Repos size for Artifact Repository aliased Repo aliased Repos release Policies add aliased Repo get Releases mirrored Repos add All aliased Repo get Mirrored Repositories Artifact Repository Policy release Policy get Effective Policy release Policies List Artifact Repository Policy snapshot Policies new Array List aliased Repos size for Artifact Repository aliased Repo aliased Repos snapshot Policies add aliased Repo get Snapshots Artifact Repository Policy snapshot Policy get Effective Policy snapshot Policies Artifact Repository aliased Repo aliased Repos get Artifact Repository effective Repository create Artifact Repository aliased Repo get Id aliased Repo get Url aliased Repo get Layout snapshot Policy release Policy effective Repository set Authentication aliased Repo get Authentication effective Repository set Proxy aliased Repo get Proxy effective Repository set Mirrored Repositories mirrored Repos effective Repositories add effective Repository return effective Repositories private Artifact Repository Policy get Effective Policy Collection Artifact Repository Policy policies Artifact Repository Policy effective Policy null for Artifact Repository Policy policy policies if effective Policy null effective Policy new Artifact Repository Policy policy else effective Policy merge policy return effective Policy public Mirror get Mirror Artifact Repository repository List Mirror mirrors return mirror Selector get Mirror repository mirrors public void inject Mirror List Artifact Repository repositories List Mirror mirrors if repositories null mirrors null for Artifact Repository repository repositories Mirror mirror get Mirror repository mirrors inject Mirror repository mirror private Mirror get Mirror Repository System Session session Artifact Repository repository if session null org eclipse aether repository Mirror Selector selector session get Mirror Selector if selector null Remote Repository repo selector get Mirror Repository Utils to Repo repository if repo null Mirror mirror new Mirror mirror set Id repo get Id mirror set Url repo get Url mirror set Layout repo get Content Type return mirror return null public void inject Mirror Repository System Session session List Artifact Repository repositories if repositories null session null for Artifact Repository repository repositories Mirror mirror get Mirror session repository inject Mirror repository mirror private void inject Mirror Artifact Repository repository Mirror mirror if mirror null Artifact Repository original create Artifact Repository repository get Id repository get Url repository get Layout repository get Snapshots repository get Releases repository set Mirrored Repositories Collections singleton List original repository set Id mirror get Id repository set Url mirror get Url if String Utils is Not Empty mirror get Layout repository set Layout get Layout mirror get Layout public void inject Authentication List Artifact Repository repositories List Server servers if repositories null Map String Server servers By Id new Hash Map if servers null for Server server servers if servers By Id contains Key server get Id servers By Id put server get Id server for Artifact Repository repository repositories Server server servers By Id get repository get Id if server null Settings Decryption Request request new Default Settings Decryption Request server Settings Decryption Result result settings Decrypter decrypt request server result get Server if logger is Debug Enabled for Settings Problem problem result get Problems logger debug problem get Message problem get Exception Authentication authentication new Authentication server get Username server get Password authentication set Private Key server get Private Key authentication set Passphrase server get Passphrase repository set Authentication authentication else repository set Authentication null private Authentication get Authentication Repository System Session session Artifact Repository repository if session null Authentication Selector selector session get Authentication Selector if selector null Remote Repository repo Repository Utils to Repo repository org eclipse aether repository Authentication auth selector get Authentication repo if auth null repo new Remote Repository Builder repo set Authentication auth build Authentication Context auth Ctx Authentication Context for Repository session repo Authentication result new Authentication auth Ctx get Authentication Context auth Ctx get Authentication Context result set Private Key auth Ctx get Authentication Context result set Passphrase auth Ctx get Authentication Context auth Ctx close return result return null public void inject Authentication Repository System Session session List Artifact Repository repositories if repositories null session null for Artifact Repository repository repositories repository set Authentication get Authentication session repository private org apache maven settings Proxy get Proxy Artifact Repository repository List org apache maven settings Proxy proxies if proxies null repository get Protocol null for org apache maven settings Proxy proxy proxies if proxy is Active repository get Protocol equals Ignore Case proxy get Protocol if String Utils is Not Empty proxy get Non Proxy Hosts Proxy Info pi new Proxy Info pi set Non Proxy Hosts proxy get Non Proxy Hosts org apache maven wagon repository Repository repo new org apache maven wagon repository Repository repository get Id repository get Url if Proxy Utils validate Non Proxy Hosts pi repo get Host return proxy else return proxy return null public void inject Proxy List Artifact Repository repositories List org apache maven settings Proxy proxies if repositories null for Artifact Repository repository repositories org apache maven settings Proxy proxy get Proxy repository proxies if proxy null Settings Decryption Request request new Default Settings Decryption Request proxy Settings Decryption Result result settings Decrypter decrypt request proxy result get Proxy if logger is Debug Enabled for Settings Problem problem result get Problems logger debug problem get Message problem get Exception Proxy p new Proxy p set Host proxy get Host p set Protocol proxy get Protocol p set Port proxy get Port p set Non Proxy Hosts proxy get Non Proxy Hosts p set User Name proxy get Username p set Password proxy get Password repository set Proxy p else repository set Proxy null private Proxy get Proxy Repository System Session session Artifact Repository repository if session null Proxy Selector selector session get Proxy Selector if selector null Remote Repository repo Repository Utils to Repo repository org eclipse aether repository Proxy proxy selector get Proxy repo if proxy null Proxy p new Proxy p set Host proxy get Host p set Protocol proxy get Type p set Port proxy get Port if proxy get Authentication null repo new Remote Repository Builder repo set Proxy proxy build Authentication Context auth Ctx Authentication Context for Proxy session repo p set User Name auth Ctx get Authentication Context p set Password auth Ctx get Authentication Context p set Ntlm Domain auth Ctx get Authentication Context p set Ntlm Host auth Ctx get Authentication Context auth Ctx close return p return null public void inject Proxy Repository System Session session List Artifact Repository repositories if repositories null session null for Artifact Repository repository repositories repository set Proxy get Proxy session repository public void retrieve Artifact Repository repository File destination String remote Path Artifact Transfer Listener transfer Listener throws Artifact Transfer Failed Exception Artifact Does Not Exist Exception try wagon Manager get Remote File repository destination remote Path Transfer Listener Adapter new Adapter transfer Listener Artifact Repository Policy true catch org apache maven wagon Transfer Failed Exception e throw new Artifact Transfer Failed Exception get Message e Error transferring artifact e catch org apache maven wagon Resource Does Not Exist Exception e throw new Artifact Does Not Exist Exception get Message e Requested artifact does not exist e public void publish Artifact Repository repository File source String remote Path Artifact Transfer Listener transfer Listener throws Artifact Transfer Failed Exception try wagon Manager put Remote File repository source remote Path Transfer Listener Adapter new Adapter transfer Listener catch org apache maven wagon Transfer Failed Exception e throw new Artifact Transfer Failed Exception get Message e Error transferring artifact e Artifact Repository Creation public Artifact Repository build Artifact Repository Repository repo throws Invalid Repository Exception if repo null String id repo get Id if String Utils is Empty id throw new Invalid Repository Exception Repository identifier missing String url repo get Url if String Utils is Empty url throw new Invalid Repository Exception missing for repository id id Artifact Repository Policy snapshots build Artifact Repository Policy repo get Snapshots Artifact Repository Policy releases build Artifact Repository Policy repo get Releases return create Artifact Repository id url get Layout repo get Layout snapshots releases else return null private Artifact Repository create Repository String url String repository Id boolean releases String release Updates boolean snapshots String snapshot Updates String checksum Policy Artifact Repository Policy snapshots Policy new Artifact Repository Policy snapshots snapshot Updates checksum Policy Artifact Repository Policy releases Policy new Artifact Repository Policy releases release Updates checksum Policy return create Artifact Repository repository Id url null snapshots Policy releases Policy public Artifact Repository create Artifact Repository String repository Id String url Artifact Repository Layout repository Layout Artifact Repository Policy snapshots Artifact Repository Policy releases if repository Layout null repository Layout layouts get default Artifact Repository artifact Repository artifact Repository Factory create Artifact Repository repository Id url repository Layout snapshots releases return artifact Repository private static String get Message Throwable error String def if error null return def String msg error get Message if String Utils is Not Empty msg return msg return get Message error get Cause def private Artifact Repository Layout get Layout String id Artifact Repository Layout layout layouts get id if layout null layout new Unknown Repository Layout id layouts get default return layout In the future the legacy system might encounter repository types for which no layout components exists because the actual communication with the repository happens via a repository connector As a minimum the legacy system needs to retain the id of this layout so that the content type of the remote repository can still be accurately described static class Unknown Repository Layout implements Artifact Repository Layout private final String id private final Artifact Repository Layout fallback public Unknown Repository Layout String id Artifact Repository Layout fallback this id id this fallback fallback public String get Id return id public String path Of Artifact artifact return fallback path Of artifact public String path Of Local Repository Metadata Artifact Metadata metadata Artifact Repository repository return fallback path Of Local Repository Metadata metadata repository public String path Of Remote Repository Metadata Artifact Metadata metadata return fallback path Of Remote Repository Metadata metadata Override public String to String return get Id 
package org apache maven lifecycle Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import static org apache maven shared utils logging Message Utils buffer import org apache maven plugin Mojo Execution import org apache maven project Maven Project import org apache maven shared utils logging Message Builder author a href mailto jason maven org Jason van Zyl a public class Lifecycle Execution Exception extends Exception private Maven Project project public Lifecycle Execution Exception String message super message public Lifecycle Execution Exception Throwable cause super cause public Lifecycle Execution Exception String message Throwable cause super message cause public Lifecycle Execution Exception String message Maven Project project super message this project project public Lifecycle Execution Exception String message Mojo Execution execution Maven Project project super message this project project public Lifecycle Execution Exception String message Mojo Execution execution Maven Project project Throwable cause super message cause this project project public Lifecycle Execution Exception Mojo Execution execution Maven Project project Throwable cause this create Message execution project cause execution project cause public Maven Project get Project return project private static String create Message Mojo Execution execution Maven Project project Throwable cause Message Builder buffer buffer buffer a Failed to execute goal if execution null buffer a buffer mojo execution get Group Id execution get Artifact Id execution get Version execution get Goal buffer a strong execution get Execution Id if project null buffer a on project buffer project project get Artifact Id if cause null buffer a failure cause get Message return buffer to String 
package org apache maven cli Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import com google common base Charsets import com google common io Files import com google inject Abstract Module import org apache commons cli Command Line import org apache commons cli Option import org apache commons cli Parse Exception import org apache commons cli Unrecognized Option Exception import org apache maven Build Abort import org apache maven Internal Error Exception import org apache maven Maven import org apache maven building File Source import org apache maven building Problem import org apache maven building Source import org apache maven cli configuration Configuration Processor import org apache maven cli configuration Settings Xml Configuration Processor import org apache maven cli event Default Event Spy Context import org apache maven cli event Execution Event Logger import org apache maven cli internal Bootstrap Core Extension Manager import org apache maven cli internal extension model Core Extension import org apache maven cli internal extension model io xpp Core Extensions Xpp Reader import org apache maven cli logging Slf j Configuration import org apache maven cli logging Slf j Configuration Factory import org apache maven cli logging Slf j Logger Manager import org apache maven cli logging Slf j Stdout Logger import org apache maven cli transfer Console Maven Transfer Listener import org apache maven cli transfer Quiet Maven Transfer Listener import org apache maven cli transfer Slf j Maven Transfer Listener import org apache maven eventspy internal Event Spy Dispatcher import org apache maven exception Default Exception Handler import org apache maven exception Exception Handler import org apache maven exception Exception Summary import org apache maven execution Default Maven Execution Request import org apache maven execution Execution Listener import org apache maven execution Maven Execution Request import org apache maven execution Maven Execution Request Population Exception import org apache maven execution Maven Execution Request Populator import org apache maven execution Maven Execution Result import org apache maven execution scope internal Mojo Execution Scope Module import org apache maven extension internal Core Exports import org apache maven extension internal Core Extension Entry import org apache maven lifecycle Lifecycle Execution Exception import org apache maven model building Model Processor import org apache maven project Maven Project import org apache maven properties internal Environment Utils import org apache maven properties internal System Properties import org apache maven session scope internal Session Scope Module import org apache maven shared utils logging Message Builder import org apache maven shared utils logging Message Utils import org apache maven toolchain building Default Toolchains Building Request import org apache maven toolchain building Toolchains Builder import org apache maven toolchain building Toolchains Building Result import org codehaus plexus Container Configuration import org codehaus plexus Default Container Configuration import org codehaus plexus Default Plexus Container import org codehaus plexus Plexus Constants import org codehaus plexus Plexus Container import org codehaus plexus classworlds Class World import org codehaus plexus classworlds realm Class Realm import org codehaus plexus classworlds realm No Such Realm Exception import org codehaus plexus component repository exception Component Lookup Exception import org codehaus plexus logging Logger Manager import org codehaus plexus util String Utils import org codehaus plexus util xml pull Xml Pull Parser Exception import org eclipse aether transfer Transfer Listener import org slf j Logger Factory import org slf j Logger import org slf j Logger Factory import org sonatype plexus components cipher Default Plexus Cipher import org sonatype plexus components sec dispatcher Default Sec Dispatcher import org sonatype plexus components sec dispatcher Sec Dispatcher import org sonatype plexus components sec dispatcher Sec Util import org sonatype plexus components sec dispatcher model Settings Security import java io Buffered Input Stream import java io Console import java io File import java io File Input Stream import java io File Not Found Exception import java io File Output Stream import java io Exception import java io Input Stream import java io Print Stream import java util Array List import java util Collections import java util Hash Set import java util Linked Hash Map import java util List import java util Map import java util Map Entry import java util Properties import java util Set import java util String Tokenizer import java util regex Matcher import java util regex Pattern import static org apache maven shared utils logging Message Utils buffer push all common bits back to plexus cli and prepare for transition to Guice We do n t need ways to make Is author Jason van Zyl public class Maven Cli public static final String maven repo local public static final String maven threads experimental public static final String maven multi Module Project Directory public static final String System get Property user home public static final File new File m public static final File new File toolchains xml public static final File new File System get Property maven conf toolchains xml private static final String maven ext class path private static final String mvn extensions xml private static final String mvn maven config public static final String style color private Class World class World private Logger Manager plexus Logger Manager private Logger Factory slf j Logger Factory private Logger slf j Logger private Event Spy Dispatcher event Spy Dispatcher private Model Processor model Processor private Maven maven private Maven Execution Request Populator execution Request Populator private Toolchains Builder toolchains Builder private Default Sec Dispatcher dispatcher private Map String Configuration Processor configuration Processors public Maven Cli this null This supports painless invocation by the Verifier during embedded execution of the core Ts public Maven Cli Class World class World this class World class World public static void main String args int result main args null System exit result public static int main String args Class World class World Maven Cli cli new Maven Cli Message Utils system Install int result cli do Main new Cli Request args class World Message Utils system Uninstall return result need to externalize Cli Request public static int do Main String args Class World class World Maven Cli cli new Maven Cli return cli do Main new Cli Request args class World This supports painless invocation by the Verifier during embedded execution of the core Ts See a href http maven apache org shared maven verifier xref org apache maven it Embedded x Launcher html code Embedded x Launcher code in code maven verifier code a public int do Main String args String working Directory Print Stream stdout Print Stream stderr Print Stream oldout System out Print Stream olderr System err final Set String realms if class World null realms new Hash Set for Class Realm realm class World get Realms realms add realm get Id else realms Collections empty Set try if stdout null System set Out stdout if stderr null System set Err stderr Cli Request cli Request new Cli Request args class World cli Request working Directory working Directory return do Main cli Request finally if class World null for Class Realm realm new Array List class World get Realms String realm Id realm get Id if realms contains realm Id try class World dispose Realm realm Id catch No Such Realm Exception ignored ca n t happen System set Out oldout System set Err olderr need to externalize Cli Request public int do Main Cli Request cli Request Plexus Container local Container null try initialize cli Request cli cli Request logging cli Request version cli Request properties cli Request local Container container cli Request commands cli Request configure cli Request toolchains cli Request populate Request cli Request encryption cli Request repository cli Request return execute cli Request catch Exit Exception e return e exit Code catch Unrecognized Option Exception e pure user error suppress stack trace return catch Build Abort e Reporting Utils show Error slf j Logger e cli Request show Errors return catch Exception e Reporting Utils show Error slf j Logger Error executing Maven e cli Request show Errors return finally if local Container null local Container dispose void initialize Cli Request cli Request throws Exit Exception if cli Request working Directory null cli Request working Directory System get Property user dir if cli Request multi Module Project Directory null String basedir Property System get Property if basedir Property null System err format s system property is not set throw new Exit Exception File basedir basedir Property null new File basedir Property new File try cli Request multi Module Project Directory basedir get Canonical File catch Exception e cli Request multi Module Project Directory basedir get Absolute File Make sure the Maven home directory is an absolute path to save us from confusion with say drive relative Windows paths String maven Home System get Property maven home if maven Home null System set Property maven home new File maven Home get Absolute Path void cli Cli Request cli Request throws Exception Parsing errors can happen during the processing of the arguments and we prefer not having to check if the logger is null and construct this so we can use an logger everywhere slf j Logger new Slf j Stdout Logger Manager cli Manager new Manager List String args new Array List Command Line maven Config null try File config File new File cli Request multi Module Project Directory if config File is File for String arg Files to String config File Charsets split s if arg is Empty args add arg maven Config cli Manager parse args to Array new String args size List unrecongized maven Config get Arg List if unrecongized is Empty throw new Parse Exception Unrecognized maven config entries unrecongized catch Parse Exception e System err println Unable to parse maven config e get Message cli Manager display Help System out throw e try if maven Config null cli Request command Line cli Manager parse cli Request args else cli Request command Line cli Merge cli Manager parse cli Request args maven Config catch Parse Exception e System err println Unable to parse command line options e get Message cli Manager display Help System out throw e if cli Request command Line has Option Manager cli Manager display Help System out throw new Exit Exception if cli Request command Line has Option Manager System out println Reporting Utils show Version throw new Exit Exception private Command Line cli Merge Command Line maven Args Command Line maven Config Command Line Builder command Line Builder new Command Line Builder the args are easy cli first then config file for String arg maven Args get Args command Line Builder add Arg arg for String arg maven Config get Args command Line Builder add Arg arg now add all options except for with cli first then config file List Option set Property Options new Array List for Option opt maven Args get Options if String value Of Manager equals opt get Opt set Property Options add opt else command Line Builder add Option opt for Option opt maven Config get Options command Line Builder add Option opt finally add the system properties for Option opt set Property Options command Line Builder add Option opt return command Line Builder build configure logging void logging Cli Request cli Request cli Request debug cli Request command Line has Option Manager cli Request quiet cli Request debug cli Request command Line has Option Manager cli Request show Errors cli Request debug cli Request command Line has Option Manager slf j Logger Factory Logger Factory get Logger Factory Slf j Configuration slf j Configuration Slf j Configuration Factory get Configuration slf j Logger Factory if cli Request debug cli Request request set Logging Level Maven Execution Request slf j Configuration set Root Logger Level Slf j Configuration Level else if cli Request quiet cli Request request set Logging Level Maven Execution Request slf j Configuration set Root Logger Level Slf j Configuration Level else fall back to default log level specified in conf see https issues apache org jira browse String style Color cli Request get User Properties get Property auto if always equals style Color Message Utils set Color Enabled true else if never equals style Color Message Utils set Color Enabled false else if auto equals style Color throw new Illegal Argument Exception Invalid color configuration option style Color Supported values are auto always never else if cli Request command Line has Option Manager cli Request command Line has Option Manager Message Utils set Color Enabled false if cli Request command Line has Option Manager File log File new File cli Request command Line get Option Value Manager log File resolve File log File cli Request working Directory redirect stdout and stderr to file try Print Stream ps new Print Stream new File Output Stream log File System set Out ps System set Err ps catch File Not Found Exception e Ignore slf j Configuration activate plexus Logger Manager new Slf j Logger Manager slf j Logger slf j Logger Factory get Logger this get Class get Name private void version Cli Request cli Request if cli Request debug cli Request command Line has Option Manager System out println Reporting Utils show Version private void commands Cli Request cli Request if cli Request show Errors slf j Logger info Error stacktraces are turned on if Maven Execution Request equals cli Request request get Global Checksum Policy slf j Logger info Disabling strict checksum verification on all artifact downloads else if Maven Execution Request equals cli Request request get Global Checksum Policy slf j Logger info Enabling strict checksum verification on all artifact downloads if slf j Logger is Debug Enabled slf j Logger debug Message scheme Message Utils is Color Enabled color plain if Message Utils is Color Enabled Message Builder buff Message Utils buffer buff a Message styles buff debug debug a buff info info a buff warning warning a buff error error a buff success success a buff failure failure a buff strong strong a buff mojo mojo a buff project project slf j Logger debug buff to String Needed to make this method package visible to make writing a unit test possible Maybe it s better to move some of those methods to separate class So void properties Cli Request cli Request populate Properties cli Request command Line cli Request system Properties cli Request user Properties private Plexus Container container Cli Request cli Request throws Exception if cli Request class World null cli Request class World new Class World plexus core Thread current Thread get Context Class Loader Class Realm core Realm cli Request class World get Class Realm plexus core if core Realm null core Realm cli Request class World get Realms iterator next List File ext Class Path parse Ext Classpath cli Request Core Extension Entry core Entry Core Extension Entry discover From core Realm List Core Extension Entry extensions load Core Extensions cli Request core Realm core Entry get Exported Artifacts Class Realm container Realm setup Container Realm cli Request class World core Realm ext Class Path extensions Container Configuration cc new Default Container Configuration set Class World cli Request class World set Realm container Realm set Class Path Scanning Plexus Constants set Auto Wiring true set Lifecycle true set Name maven Set String exported Artifacts new Hash Set core Entry get Exported Artifacts Set String exported Packages new Hash Set core Entry get Exported Packages for Core Extension Entry extension extensions exported Artifacts add All extension get Exported Artifacts exported Packages add All extension get Exported Packages final Core Exports exports new Core Exports container Realm exported Artifacts exported Packages Default Plexus Container container new Default Plexus Container cc new Abstract Module Override protected void configure bind Logger Factory class to Instance slf j Logger Factory bind Core Exports class to Instance exports To avoid inconsistencies we ll use the exclusively for lookups container set Lookup Realm null Thread current Thread set Context Class Loader container get Container Realm container set Logger Manager plexus Logger Manager for Core Extension Entry extension extensions container discover Components extension get Class Realm new Session Scope Module container new Mojo Execution Scope Module container customize Container container container get Logger Manager set Thresholds cli Request request get Logging Level event Spy Dispatcher container lookup Event Spy Dispatcher class Default Event Spy Context event Spy Context new Default Event Spy Context Map String Object data event Spy Context get Data data put plexus container data put working Directory cli Request working Directory data put system Properties cli Request system Properties data put user Properties cli Request user Properties data put version Properties Reporting Utils get Build Properties event Spy Dispatcher init event Spy Context refresh logger in case container got customized by spy slf j Logger slf j Logger Factory get Logger this get Class get Name maven container lookup Maven class execution Request Populator container lookup Maven Execution Request Populator class model Processor create Model Processor container configuration Processors container lookup Map Configuration Processor class toolchains Builder container lookup Toolchains Builder class dispatcher Default Sec Dispatcher container lookup Sec Dispatcher class maven return container private List Core Extension Entry load Core Extensions Cli Request cli Request Class Realm container Realm Set String provided Artifacts if cli Request multi Module Project Directory null return Collections empty List File extensions File new File cli Request multi Module Project Directory if extensions File is File return Collections empty List try List Core Extension extensions read Core Extensions Descriptor extensions File if extensions is Empty return Collections empty List Container Configuration cc new Default Container Configuration set Class World cli Request class World set Realm container Realm set Class Path Scanning Plexus Constants set Auto Wiring true set Lifecycle true set Name maven Default Plexus Container container new Default Plexus Container cc new Abstract Module Override protected void configure bind Logger Factory class to Instance slf j Logger Factory try container set Lookup Realm null container set Logger Manager plexus Logger Manager container get Logger Manager set Thresholds cli Request request get Logging Level Thread current Thread set Context Class Loader container get Container Realm execution Request Populator container lookup Maven Execution Request Populator class configuration Processors container lookup Map Configuration Processor class configure cli Request Maven Execution Request request Default Maven Execution Request copy cli Request request request populate Request cli Request request request execution Request Populator populate Defaults request Bootstrap Core Extension Manager resolver container lookup Bootstrap Core Extension Manager class return resolver load Core Extensions request provided Artifacts extensions finally execution Request Populator null container dispose catch Runtime Exception e runtime exceptions are most likely bugs in maven let them bubble up to the user throw e catch Exception e slf j Logger warn Failed to read extensions descriptor extensions File e get Message return Collections empty List private List Core Extension read Core Extensions Descriptor File extensions File throws Exception Xml Pull Parser Exception Core Extensions Xpp Reader parser new Core Extensions Xpp Reader try Input Stream is new Buffered Input Stream new File Input Stream extensions File return parser read is get Extensions private Class Realm setup Container Realm Class World class World Class Realm core Realm List File ext Class Path List Core Extension Entry extensions throws Exception if ext Class Path is Empty extensions is Empty Class Realm ext Realm class World new Realm maven ext null ext Realm set Parent Realm core Realm slf j Logger debug Populating class realm ext Realm get Id for File file ext Class Path slf j Logger debug Included file ext Realm add file to to for Core Extension Entry entry reverse extensions Set String exported Packages entry get Exported Packages Class Realm realm entry get Class Realm for String exported Package exported Packages ext Realm import From realm exported Package if exported Packages is Empty sisu uses realm imports to establish component visibility ext Realm import From realm realm get Id return ext Realm return core Realm private static List reverse List list List copy new Array List list Collections reverse copy return copy private List File parse Ext Classpath Cli Request cli Request String ext Class Path cli Request user Properties get Property if ext Class Path null ext Class Path cli Request system Properties get Property List File jars new Array List if String Utils is Not Empty ext Class Path for String jar String Utils split ext Class Path File path Separator File file resolve File new File jar cli Request working Directory slf j Logger debug Included file jars add file return jars This should probably be a separate tool and not be baked into Maven private void encryption Cli Request cli Request throws Exception if cli Request command Line has Option Manager String passwd cli Request command Line get Option Value Manager if passwd null Console cons System console char password cons null null cons read Password Master password if password null Cipher uses Strings passwd String copy Value Of password Sun Oracle advises to empty the char array java util Arrays fill password Default Plexus Cipher cipher new Default Plexus Cipher System out println cipher encrypt And Decorate passwd Default Sec Dispatcher throw new Exit Exception else if cli Request command Line has Option Manager String passwd cli Request command Line get Option Value Manager if passwd null Console cons System console char password cons null null cons read Password Password if password null Cipher uses Strings passwd String copy Value Of password Sun Oracle advises to empty the char array java util Arrays fill password String configuration File dispatcher get Configuration File if configuration File starts With configuration File System get Property user home configuration File substring String file System get Property Default Sec Dispatcher configuration File String master null Settings Security sec Sec Util read file true if sec null master sec get Master if master null throw new Illegal State Exception Master password is not set in the setting security file file Default Plexus Cipher cipher new Default Plexus Cipher String master Passwd cipher decrypt Decorated master Default Sec Dispatcher System out println cipher encrypt And Decorate passwd master Passwd throw new Exit Exception private void repository Cli Request cli Request throws Exception if cli Request command Line has Option Manager Boolean get Boolean maven legacy Local Repo cli Request request set Use Legacy Local Repository true private int execute Cli Request cli Request throws Maven Execution Request Population Exception Maven Execution Request request execution Request Populator populate Defaults cli Request request event Spy Dispatcher on Event request Maven Execution Result result maven execute request event Spy Dispatcher on Event result event Spy Dispatcher close if result has Exceptions Exception Handler handler new Default Exception Handler Map String String references new Linked Hash Map Maven Project project null for Throwable exception result get Exceptions Exception Summary summary handler handle Exception exception log Summary summary references cli Request show Errors if project null exception instanceof Lifecycle Execution Exception project Lifecycle Execution Exception exception get Project slf j Logger error if cli Request show Errors slf j Logger error To see the full stack trace of the errors re run Maven with the buffer strong e switch if slf j Logger is Debug Enabled slf j Logger error Re run Maven using the buffer strong switch to enable full debug logging if references is Empty slf j Logger error slf j Logger error For more information about the errors and possible solutions please read the following articles for Map Entry String String entry references entry Set slf j Logger error buffer strong entry get Value entry get Key if project null project equals result get Topologically Sorted Projects get slf j Logger error slf j Logger error After correcting the problems you can resume the build with the command slf j Logger error buffer a strong mvn goals rf project get Artifact Id to String if Maven Execution Request equals cli Request request get Reactor Failure Behavior slf j Logger info Build failures were ignored return else return else return private void log Summary Exception Summary summary Map String String references String indent boolean show Errors String reference Key if String Utils is Not Empty summary get Reference reference Key references get summary get Reference if reference Key null reference Key Help references size references put summary get Reference reference Key String msg summary get Message if String Utils is Not Empty reference Key if msg index Of n msg buffer strong reference Key else msg n buffer strong reference Key String lines msg split r n r n String current Color for int i i lines length i add eventual current color inherited from previous line String line current Color lines i look for last escape sequence to check if next Color Matcher matcher matcher line String next Color if matcher find next Color matcher group if equals next Color last escape code is reset no next color next Color effective line with indent and reset if end is colored line indent line equals next Color if i lines length show Errors summary get Exception instanceof Internal Error Exception slf j Logger error line summary get Exception else slf j Logger error line current Color next Color indent for Exception Summary child summary get Children log Summary child references indent show Errors private static final Pattern Pattern compile u d u private static final String u u Bm private void configure Cli Request cli Request throws Exception This is not ideal but there are events specifically for configuration from the which do n t believe are really valid but there are Ts which assert the right events are published so this needs to be supported so the Event Spy Dispatcher needs to be put in the Cli Request so that it can be accessed by configuration processors cli Request request set Event Spy Dispatcher event Spy Dispatcher We expect at most implementations to be available The Settings Xml Configuration Processor implementation is always available in the core and likely always will be but we may have another Configuration Processor present supplied by the user The rule is that we only allow the execution of one Configuration Processor If there is more than one then we execute the one supplied by the user otherwise we execute the the default Settings Xml Configuration Processor int user Supplied Configuration Processor Count configuration Processors size if user Supplied Configuration Processor Count Our settings xml source is historically how we have configured Maven from the so we are going to have to honour its existence forever So let s run it configuration Processors get Settings Xml Configuration Processor process cli Request else if user Supplied Configuration Processor Count Run the user supplied Configuration Processor for Entry String Configuration Processor entry configuration Processors entry Set String hint entry get Key if hint equals Settings Xml Configuration Processor Configuration Processor configuration Processor entry get Value configuration Processor process cli Request else if user Supplied Configuration Processor Count There are too many Configuration Processors so we do n t know which one to run so report the error String Builder sb new String Builder String format n There can only be one user supplied Configuration Processor there are s n n user Supplied Configuration Processor Count for Entry String Configuration Processor entry configuration Processors entry Set String hint entry get Key if hint equals Settings Xml Configuration Processor Configuration Processor configuration Processor entry get Value sb append String format s n configuration Processor get Class get Name sb append String format n throw new Exception sb to String private void toolchains Cli Request cli Request throws Exception File user Toolchains File if cli Request command Line has Option Manager user Toolchains File new File cli Request command Line get Option Value Manager user Toolchains File resolve File user Toolchains File cli Request working Directory if user Toolchains File is File throw new File Not Found Exception The specified user toolchains file does not exist user Toolchains File else user Toolchains File File global Toolchains File if cli Request command Line has Option Manager global Toolchains File new File cli Request command Line get Option Value Manager global Toolchains File resolve File global Toolchains File cli Request working Directory if global Toolchains File is File throw new File Not Found Exception The specified global toolchains file does not exist global Toolchains File else global Toolchains File cli Request request set Global Toolchains File global Toolchains File cli Request request set User Toolchains File user Toolchains File Default Toolchains Building Request toolchains Request new Default Toolchains Building Request if global Toolchains File is File toolchains Request set Global Toolchains Source new File Source global Toolchains File if user Toolchains File is File toolchains Request set User Toolchains Source new File Source user Toolchains File event Spy Dispatcher on Event toolchains Request slf j Logger debug Reading global toolchains from get Location toolchains Request get Global Toolchains Source global Toolchains File slf j Logger debug Reading user toolchains from get Location toolchains Request get User Toolchains Source user Toolchains File Toolchains Building Result toolchains Result toolchains Builder build toolchains Request event Spy Dispatcher on Event toolchains Request execution Request Populator populate From Toolchains cli Request request toolchains Result get Effective Toolchains if toolchains Result get Problems is Empty slf j Logger is Warn Enabled slf j Logger warn slf j Logger warn Some problems were encountered while building the effective toolchains for Problem problem toolchains Result get Problems slf j Logger warn problem get Message problem get Location slf j Logger warn private Object get Location Source source File default Location if source null return source get Location return default Location private Maven Execution Request populate Request Cli Request cli Request return populate Request cli Request cli Request request private Maven Execution Request populate Request Cli Request cli Request Maven Execution Request request Command Line command Line cli Request command Line String working Directory cli Request working Directory boolean quiet cli Request quiet boolean show Errors cli Request show Errors String deprecated Options up npu cpu npr for String deprecated Option deprecated Options if command Line has Option deprecated Option slf j Logger warn Command line option deprecated Option is deprecated and will be removed in future Maven versions Now that we have everything that we need we will fire up plexus and bring the maven component to life for use if command Line has Option Manager request set Interactive Mode false boolean no Snapshot Updates false if command Line has Option Manager no Snapshot Updates true List String goals command Line get Arg List boolean recursive true this is the default behavior String reactor Failure Behaviour Maven Execution Request if command Line has Option Manager recursive false if command Line has Option Manager reactor Failure Behaviour Maven Execution Request else if command Line has Option Manager reactor Failure Behaviour Maven Execution Request else if command Line has Option Manager reactor Failure Behaviour Maven Execution Request if command Line has Option Manager request set Offline true boolean update Snapshots false if command Line has Option Manager update Snapshots true String global Checksum Policy null if command Line has Option Manager global Checksum Policy Maven Execution Request else if command Line has Option Manager global Checksum Policy Maven Execution Request File base Directory new File working Directory get Absolute File Profile Activation List String active Profiles new Array List List String inactive Profiles new Array List if command Line has Option Manager String profile Option Values command Line get Option Values Manager if profile Option Values null for String profile Option Value profile Option Values String Tokenizer profile Tokens new String Tokenizer profile Option Value while profile Tokens has More Tokens String profile Action profile Tokens next Token trim if profile Action starts With profile Action starts With inactive Profiles add profile Action substring else if profile Action starts With active Profiles add profile Action substring else active Profiles add profile Action Transfer Listener transfer Listener if quiet transfer Listener new Quiet Maven Transfer Listener else if request is Interactive Mode cli Request command Line has Option Manager If we re logging to a file then we do n t want the console transfer listener as it will spew download progress all over the place transfer Listener get Console Transfer Listener cli Request command Line has Option Manager else transfer Listener get Batch Transfer Listener Execution Listener execution Listener new Execution Event Logger if event Spy Dispatcher null execution Listener event Spy Dispatcher chain Listener execution Listener String alternate Pom File null if command Line has Option Manager alternate Pom File command Line get Option Value Manager request set Base Directory base Directory set Goals goals set System Properties cli Request system Properties set User Properties cli Request user Properties set Reactor Failure Behavior reactor Failure Behaviour default fail fast set Recursive recursive default true set Show Errors show Errors default false add Active Profiles active Profiles optional add Inactive Profiles inactive Profiles optional set Execution Listener execution Listener set Transfer Listener transfer Listener default batch mode which goes along with interactive set Update Snapshots update Snapshots default false set No Snapshot Updates no Snapshot Updates default false set Global Checksum Policy global Checksum Policy default warn set Multi Module Project Directory cli Request multi Module Project Directory if alternate Pom File null File pom resolve File new File alternate Pom File working Directory if pom is Directory pom new File pom pom xml request set Pom pom else if model Processor null File pom model Processor locate Pom base Directory if pom is File request set Pom pom if request get Pom null request get Pom get Parent File null request set Base Directory request get Pom get Parent File if command Line has Option Manager request set Resume From command Line get Option Value Manager if command Line has Option Manager String project Option Values command Line get Option Values Manager List String incl Projects new Array List List String excl Projects new Array List if project Option Values null for String project Option Value project Option Values String Tokenizer project Tokens new String Tokenizer project Option Value while project Tokens has More Tokens String project Action project Tokens next Token trim if project Action starts With project Action starts With excl Projects add project Action substring else if project Action starts With incl Projects add project Action substring else incl Projects add project Action request set Selected Projects incl Projects request set Excluded Projects excl Projects if command Line has Option Manager command Line has Option Manager request set Make Behavior Maven Execution Request else if command Line has Option Manager command Line has Option Manager request set Make Behavior Maven Execution Request else if command Line has Option Manager command Line has Option Manager request set Make Behavior Maven Execution Request String local Repo Property request get User Properties get Property Maven Cli if local Repo Property null local Repo Property request get System Properties get Property Maven Cli if local Repo Property null request set Local Repository Path local Repo Property request set Cache Not Found true request set Cache Transfer Error false Builder concurrency and parallelism We preserve the existing methods for builder selection which is to look for various inputs in the threading configuration We do n t have an easy way to allow a pluggable builder to provide its own configuration parameters but this is sufficient for now Ultimately we want components like Builders to provide a way to extend the command line to accept its own configuration parameters final String thread Configuration command Line has Option Manager command Line get Option Value Manager request get System Properties get Property Maven Cli Remove this setting Note that the int tests use it if thread Configuration null Default to the standard multithreaded builder request set Builder Id multithreaded if thread Configuration contains request set Degree Of Concurrency calculate Degree Of Concurrency With Core Multiplier thread Configuration else request set Degree Of Concurrency Integer value Of thread Configuration Allow the builder to be overridden by the user if requested The builders are now pluggable if command Line has Option Manager request set Builder Id command Line get Option Value Manager return request int calculate Degree Of Concurrency With Core Multiplier String thread Configuration int procs Runtime get Runtime available Processors return int Float value Of thread Configuration replace procs static File resolve File File file String working Directory if file null return null else if file is Absolute return file else if file get Path starts With File separator drive relative Windows path return file get Absolute File else return new File working Directory file get Path get Absolute File System properties handling static void populate Properties Command Line command Line Properties system Properties Properties user Properties Environment Utils add Env Vars system Properties Options that are set on the command line become system properties and therefore are set in the session properties System properties are most dominant if command Line has Option Manager String def Strs command Line get Option Values Manager if def Strs null for String def Str def Strs set Cli Property def Str user Properties System Properties add System Properties system Properties Properties containing info about the currently running version of Maven These override any corresponding properties set on the command line Properties build Properties Reporting Utils get Build Properties String maven Version build Properties get Property Reporting Utils system Properties set Property maven version maven Version String maven Build Version Reporting Utils create Maven Version String build Properties system Properties set Property maven build version maven Build Version private static void set Cli Property String property Properties properties String name String value int i property index Of if i name property trim value true else name property substring i trim value property substring i properties set Property name value m leaving the setting of system properties here as not to break the System Property Profile Activator This wo n t harm embedding jvz System set Property name value static class Exit Exception extends Exception Suppress Warnings checkstyle visibilitymodifier public int exit Code public Exit Exception int exit Code this exit Code exit Code Customizations available via the protected Transfer Listener get Console Transfer Listener boolean print Resource Names return new Console Maven Transfer Listener System out print Resource Names protected Transfer Listener get Batch Transfer Listener return new Slf j Maven Transfer Listener protected void customize Container Plexus Container container protected Model Processor create Model Processor Plexus Container container throws Component Lookup Exception return container lookup Model Processor class 
package org apache maven lifecycle Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util Array List import java util Hash Map import java util Hash Set import java util Iterator import java util Linked Hash Map import java util Linked Hash Set import java util List import java util Map import java util Set import org apache maven lifecycle internal Execution Plan Item import org apache maven model Plugin import org apache maven plugin Mojo Execution import org apache maven plugin descriptor Mojo Descriptor lifecycles being executed what runs in each phase plugins that need downloading project dependencies that need downloading unfortunately the plugins need to be downloaded in order to get the plugin xml file need to externalize this from the plugin archive this will be the class that people get in Es to modify public class Maven Execution Plan implements Iterable Execution Plan Item At the moment this class is totally immutable and this is in line with thoughts about the pre calculated execution plan that stays the same during the execution If deciding to add mutable state to this class it should be at least considered to separate this into a separate mutable structure private final List Execution Plan Item plan Item private final Map String Execution Plan Item last Mojo Execution For All Phases final List String phases In Execution Plan public Maven Execution Plan List Execution Plan Item plan Item Default Lifecycles default Lifecycles this plan Item plan Item last Mojo Execution For All Phases new Linked Hash Map Linked Hash Set String total Phase Set new Linked Hash Set if default Lifecycles null for String phase get Distinct Phases In Order Of Execution Plan Appearance plan Item final Lifecycle lifecycle default Lifecycles get phase if lifecycle null total Phase Set add All lifecycle get Phases this phases In Execution Plan new Array List total Phase Set Map String Execution Plan Item last In Existing Phases new Hash Map for Execution Plan Item execution Plan Item get Execution Plan Items last In Existing Phases put execution Plan Item get Lifecycle Phase execution Plan Item Execution Plan Item last Seen Execution Plan Item null for String phase total Phase Set Execution Plan Item for This Phase last In Existing Phases get phase if for This Phase null last Seen Execution Plan Item for This Phase last Mojo Execution For All Phases put phase last Seen Execution Plan Item public Iterator Execution Plan Item iterator return get Execution Plan Items iterator Returns the last Execution Plan Item in the supplied phase If no items are in the specified phase the closest execution Plan Item from an earlier phase item will be returned param requested Phase the requested phase The execution plan item return The Execution Plan Item or null if none can be found public Execution Plan Item find Last In Phase String requested Phase return last Mojo Execution For All Phases get requested Phase private List Execution Plan Item get Execution Plan Items return plan Item private static Iterable String get Distinct Phases In Order Of Execution Plan Appearance List Execution Plan Item plan Items Linked Hash Set String result new Linked Hash Set for Execution Plan Item execution Plan Item plan Items final String phase execution Plan Item get Lifecycle Phase if result contains phase result add phase return result public List Mojo Execution get Mojo Executions List Mojo Execution result new Array List for Execution Plan Item execution Plan Item plan Item result add execution Plan Item get Mojo Execution return result Get set of plugins having a goal mojo used but not marked thread Safe return the set of plugins without info on which goal is concerned public Set Plugin get Non Thread Safe Plugins Set Plugin plugins new Hash Set for Execution Plan Item execution Plan Item plan Item final Mojo Execution mojo Execution execution Plan Item get Mojo Execution if mojo Execution get Mojo Descriptor is Thread Safe plugins add mojo Execution get Plugin return plugins Get set of mojos used but not marked thread Safe return the set of mojo descriptors public Set Mojo Descriptor get Non Thread Safe Mojos Set Mojo Descriptor mojos new Hash Set for Execution Plan Item execution Plan Item plan Item final Mojo Execution mojo Execution execution Plan Item get Mojo Execution if mojo Execution get Mojo Descriptor is Thread Safe mojos add mojo Execution get Mojo Descriptor return mojos Used by m e but will be removed really Deprecated public List Mojo Execution get Executions return get Mojo Executions public int size return plan Item size 
package org apache maven project artifact Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io File import java util Array List import java util Arrays import java util Collection import java util Collections import java util Hash Map import java util Linked Hash Map import java util Linked Hash Set import java util List import java util Map import java util Properties import java util Set import org apache maven artifact Artifact import org apache maven artifact factory Artifact Factory import org apache maven artifact metadata Artifact Metadata Retrieval Exception import org apache maven artifact metadata Artifact Metadata Source import org apache maven artifact metadata Resolution Group import org apache maven artifact repository Artifact Repository import org apache maven artifact repository metadata Artifact Repository Metadata import org apache maven artifact repository metadata Metadata import org apache maven artifact repository metadata Repository Metadata import org apache maven artifact repository metadata Repository Metadata Manager import org apache maven artifact repository metadata Repository Metadata Resolution Exception import org apache maven artifact resolver Artifact Resolution Exception import org apache maven artifact resolver Multiple Artifacts Not Found Exception import org apache maven artifact resolver filter And Artifact Filter import org apache maven artifact resolver filter Artifact Filter import org apache maven artifact resolver filter Excludes Artifact Filter import org apache maven artifact versioning Artifact Version import org apache maven artifact versioning Default Artifact Version import org apache maven artifact versioning Invalid Version Specification Exception import org apache maven artifact versioning Version Range import org apache maven model Dependency import org apache maven model Dependency Management import org apache maven model Distribution Management import org apache maven model Exclusion import org apache maven model Relocation import org apache maven model building Model Building Exception import org apache maven model building Model Building Request import org apache maven model building Model Problem import org apache maven model resolution Unresolvable Model Exception import org apache maven plugin Legacy Support import org apache maven project Default Project Building Request import org apache maven project Maven Project import org apache maven project Project Builder import org apache maven project Project Building Exception import org apache maven project Project Building Request import org apache maven properties internal Environment Utils import org apache maven properties internal System Properties import org apache maven repository legacy metadata Default Metadata Resolution Request import org apache maven repository legacy metadata Metadata Resolution Request import org codehaus plexus Plexus Container import org codehaus plexus component annotations Component import org codehaus plexus component annotations Requirement import org codehaus plexus component repository exception Component Lookup Exception import org codehaus plexus logging Logger import org eclipse aether Repository System Session import org eclipse aether repository Repository Policy import org eclipse aether transfer Artifact Not Found Exception author Jason van Zyl Component role Artifact Metadata Source class hint maven public class Maven Metadata Source implements Artifact Metadata Source Requirement private Repository Metadata Manager repository Metadata Manager Requirement private Artifact Factory repository System This prevents a cycle in the composition which shows us another problem we need to deal with Requirement private Project Builder project Builder Requirement private Plexus Container container Requirement private Logger logger Requirement private Maven Metadata Cache cache Requirement private Legacy Support legacy Support private void inject Session Metadata Resolution Request request Repository System Session session legacy Support get Repository Session if session null request set Offline session is Offline request set Force Update Repository Policy equals session get Update Policy public Resolution Group retrieve Artifact artifact Artifact Repository local Repository List Artifact Repository remote Repositories throws Artifact Metadata Retrieval Exception return retrieve artifact local Repository remote Repositories false public Resolution Group retrieve Artifact artifact Artifact Repository local Repository List Artifact Repository remote Repositories boolean resolve Managed Versions throws Artifact Metadata Retrieval Exception Metadata Resolution Request request new Default Metadata Resolution Request inject Session request request set Artifact artifact request set Local Repository local Repository request set Remote Repositories remote Repositories request set Resolve Managed Versions resolve Managed Versions return retrieve request public Resolution Group retrieve Metadata Resolution Request request throws Artifact Metadata Retrieval Exception Artifact artifact request get Artifact If we have a system scoped artifact then we do not want any searching in local or remote repositories and we want artifact resolution to only return the system scoped artifact itself if artifact get Scope null artifact get Scope equals Artifact return new Resolution Group null null null Resolution Group cached cache get artifact request is Resolve Managed Versions request get Local Repository request get Remote Repositories if cached null if the has no file we cached a missing artifact only return the cached data if no update forced request is Force Update has File cached get Pom Artifact return cached List Dependency dependencies List Dependency managed Dependencies null List Artifact Repository pom Repositories null Artifact pom Artifact Artifact relocated Artifact null Not even sure this is really required as the project will be cached in the builder we ll see this is currently the biggest hotspot if artifact instanceof Artifact With Dependencies pom Artifact artifact dependencies Artifact With Dependencies artifact get Dependencies managed Dependencies Artifact With Dependencies artifact get Managed Dependencies else Project Relocation rel retrieve Relocated Project artifact request if rel null return null pom Artifact rel pom Artifact relocated Artifact rel relocated Artifact if rel project null When this happens we have a Maven x or some invalid It should have never found its way into Maven x repository but it did dependencies Collections empty List else dependencies rel project get Dependencies Dependency Management dep Mgmt rel project get Dependency Management managed Dependencies dep Mgmt null dep Mgmt get Dependencies null pom Repositories rel project get Remote Artifact Repositories Set Artifact artifacts Collections empty Set if artifact get Artifact Handler is Includes Dependencies artifacts new Linked Hash Set for Dependency dependency dependencies Artifact dependency Artifact create Dependency Artifact dependency artifact pom Artifact if dependency Artifact null artifacts add dependency Artifact Map String Artifact managed Versions null if managed Dependencies null request is Resolve Managed Versions managed Versions new Hash Map for Dependency managed Dependency managed Dependencies Artifact managed Artifact create Dependency Artifact managed Dependency null pom Artifact managed Versions put managed Dependency get Management Key managed Artifact List Artifact Repository aggregated Repositories aggregate Repositories request get Remote Repositories pom Repositories Resolution Group result new Resolution Group pom Artifact relocated Artifact artifacts managed Versions aggregated Repositories cache put artifact request is Resolve Managed Versions request get Local Repository request get Remote Repositories result return result private boolean has File Artifact artifact return artifact null artifact get File null artifact get File exists private List Artifact Repository aggregate Repositories List Artifact Repository request Repositories List Artifact Repository pom Repositories List Artifact Repository repositories request Repositories if pom Repositories null pom Repositories is Empty Map String Artifact Repository repos new Linked Hash Map for Artifact Repository repo request Repositories if repos contains Key repo get Id repos put repo get Id repo for Artifact Repository repo pom Repositories if repos contains Key repo get Id repos put repo get Id repo repositories new Array List repos values return repositories private Artifact create Dependency Artifact Dependency dependency Artifact owner Artifact pom throws Artifact Metadata Retrieval Exception try String inherited Scope owner null owner get Scope null Artifact Filter inherited Filter owner null owner get Dependency Filter null return create Dependency Artifact repository System dependency inherited Scope inherited Filter catch Invalid Version Specification Exception e throw new Artifact Metadata Retrieval Exception Invalid version for dependency dependency get Management Key e get Message e pom private static Artifact create Dependency Artifact Artifact Factory factory Dependency dependency String inherited Scope Artifact Filter inherited Filter throws Invalid Version Specification Exception String effective Scope get Effective Scope dependency get Scope inherited Scope if effective Scope null return null Version Range version Range Version Range create From Version Spec dependency get Version Artifact dependency Artifact factory create Dependency Artifact dependency get Group Id dependency get Artifact Id version Range dependency get Type dependency get Classifier effective Scope dependency is Optional Artifact Filter dependency Filter inherited Filter if dependency Filter null dependency Filter include dependency Artifact return null if Artifact equals effective Scope dependency Artifact set File new File dependency get System Path dependency Artifact set Dependency Filter create Dependency Filter dependency dependency Filter return dependency Artifact private static String get Effective Scope String original Scope String inherited Scope String effective Scope Artifact if original Scope null original Scope Artifact if inherited Scope null direct dependency retains its scope effective Scope original Scope else if Artifact equals original Scope Artifact equals original Scope test and provided are not transitive so exclude them effective Scope null else if Artifact equals original Scope system scope come through unchanged effective Scope Artifact else if Artifact equals original Scope Artifact equals inherited Scope added to retain compile scope Remove if you want compile inherited as runtime effective Scope Artifact else if Artifact equals inherited Scope effective Scope Artifact else if Artifact equals inherited Scope effective Scope Artifact return effective Scope private static Artifact Filter create Dependency Filter Dependency dependency Artifact Filter inherited Filter Artifact Filter effective Filter inherited Filter if dependency get Exclusions is Empty List String exclusions new Array List for Exclusion e dependency get Exclusions exclusions add e get Group Id e get Artifact Id effective Filter new Excludes Artifact Filter exclusions if inherited Filter null effective Filter new And Artifact Filter Arrays as List inherited Filter effective Filter return effective Filter public List Artifact Version retrieve Available Versions Artifact artifact Artifact Repository local Repository List Artifact Repository remote Repositories throws Artifact Metadata Retrieval Exception Metadata Resolution Request request new Default Metadata Resolution Request inject Session request request set Artifact artifact request set Local Repository local Repository request set Remote Repositories remote Repositories return retrieve Available Versions request public List Artifact Version retrieve Available Versions Metadata Resolution Request request throws Artifact Metadata Retrieval Exception Repository Metadata metadata new Artifact Repository Metadata request get Artifact try repository Metadata Manager resolve metadata request catch Repository Metadata Resolution Exception e throw new Artifact Metadata Retrieval Exception e get Message e request get Artifact List String available Versions request get Local Repository find Versions request get Artifact return retrieve Available Versions From Metadata metadata get Metadata available Versions public List Artifact Version retrieve Available Versions From Deployment Repository Artifact artifact Artifact Repository local Repository Artifact Repository deployment Repository throws Artifact Metadata Retrieval Exception Repository Metadata metadata new Artifact Repository Metadata artifact try repository Metadata Manager resolve Always metadata local Repository deployment Repository catch Repository Metadata Resolution Exception e throw new Artifact Metadata Retrieval Exception e get Message e artifact List String available Versions local Repository find Versions artifact return retrieve Available Versions From Metadata metadata get Metadata available Versions private List Artifact Version retrieve Available Versions From Metadata Metadata repo Metadata List String available Versions Collection String versions new Linked Hash Set if repo Metadata null repo Metadata get Versioning null versions add All repo Metadata get Versioning get Versions versions add All available Versions List Artifact Version artifact Versions new Array List versions size for String version versions artifact Versions add new Default Artifact Version version return artifact Versions Deprecated public static Set Artifact create Artifacts Artifact Factory artifact Factory List Dependency dependencies String inherited Scope Artifact Filter dependency Filter Maven Project project throws Invalid Dependency Version Exception Set Artifact artifacts new Linked Hash Set for Dependency d dependencies Artifact dependency Artifact try dependency Artifact create Dependency Artifact artifact Factory d inherited Scope dependency Filter catch Invalid Version Specification Exception e throw new Invalid Dependency Version Exception project get Id d project get File e if dependency Artifact null artifacts add dependency Artifact return artifacts private Project Builder get Project Builder if project Builder null return project Builder try project Builder container lookup Project Builder class catch Component Lookup Exception e Wo n t happen return project Builder private Project Relocation retrieve Relocated Project Artifact artifact Metadata Resolution Request repository Request throws Artifact Metadata Retrieval Exception Maven Project project Artifact pom Artifact Artifact relocated Artifact null boolean done false do project null pom Artifact repository System create Project Artifact artifact get Group Id artifact get Artifact Id artifact get Version artifact get Scope if pom equals artifact get Type pom Artifact set File artifact get File if Artifact equals artifact get Scope done true else try Project Building Request configuration new Default Project Building Request configuration set Local Repository repository Request get Local Repository configuration set Remote Repositories repository Request get Remote Repositories configuration set Validation Level Model Building Request configuration set Process Plugins false configuration set Repository Merging Project Building Request Repository Merging configuration set System Properties get System Properties configuration set Repository Session legacy Support get Repository Session project get Project Builder build pom Artifact configuration get Project catch Project Building Exception e Model Problem missing Parent Pom has Missing Parent Pom e if missing Parent Pom null throw new Artifact Metadata Retrieval Exception Failed to process for artifact get Id missing Parent Pom get Message missing Parent Pom get Exception artifact String message if is Missing Pom e message Missing for artifact get Id else if is Non Transferrable Pom e throw new Artifact Metadata Retrieval Exception Failed to retrieve for artifact get Id e get Cause get Message e get Cause artifact else message Invalid for artifact get Id transitive dependencies if any will not be available enable debug logging for more details if logger is Debug Enabled message e get Message logger warn message if project null Relocation relocation null Distribution Management dist Mgmt project get Distribution Management if dist Mgmt null relocation dist Mgmt get Relocation artifact set Download Url dist Mgmt get Download Url pom Artifact set Download Url dist Mgmt get Download Url if relocation null if relocation get Group Id null artifact set Group Id relocation get Group Id relocated Artifact artifact project set Group Id relocation get Group Id if relocation get Artifact Id null artifact set Artifact Id relocation get Artifact Id relocated Artifact artifact project set Artifact Id relocation get Artifact Id if relocation get Version null note see This causes a problem but fixing it may break more artifact set Version Range Version Range create From Version relocation get Version relocated Artifact artifact project set Version relocation get Version if artifact get Dependency Filter null artifact get Dependency Filter include artifact return null the artifact data has changed If the available versions where previously retrieved we need to update it should n t the versions be merged across relocations List Artifact Version available artifact get Available Versions if available null available is Empty Metadata Resolution Request metadata Request new Default Metadata Resolution Request repository Request metadata Request set Artifact artifact available retrieve Available Versions metadata Request artifact set Available Versions available String message n This artifact has been relocated to artifact get Group Id artifact get Artifact Id artifact get Version n if relocation get Message null message relocation get Message n if artifact get Dependency Trail null artifact get Dependency Trail size logger warn While downloading pom Artifact get Group Id pom Artifact get Artifact Id pom Artifact get Version message n else logger debug While downloading pom Artifact get Group Id pom Artifact get Artifact Id pom Artifact get Version message n else done true else done true while done Project Relocation rel new Project Relocation rel project project rel pom Artifact pom Artifact rel relocated Artifact relocated Artifact return rel private Model Problem has Missing Parent Pom Project Building Exception e if e get Cause instanceof Model Building Exception Model Building Exception mbe Model Building Exception e get Cause for Model Problem problem mbe get Problems if problem get Exception instanceof Unresolvable Model Exception return problem return null private boolean is Missing Pom Exception e if e get Cause instanceof Multiple Artifacts Not Found Exception return true return e get Cause instanceof org eclipse aether resolution Artifact Resolution Exception e get Cause get Cause instanceof Artifact Not Found Exception private boolean is Non Transferrable Pom Exception e if e get Cause instanceof Artifact Resolution Exception return true return e get Cause instanceof org eclipse aether resolution Artifact Resolution Exception e get Cause get Cause instanceof Artifact Not Found Exception private Properties get System Properties Properties props new Properties Environment Utils add Env Vars props System Properties add System Properties props return props private static final class Project Relocation private Maven Project project private Artifact pom Artifact private Artifact relocated Artifact 
package org apache maven project Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io File import java io Exception import java io Writer import java util Array List import java util Collections import java util Hash Map import java util Linked Hash Map import java util Linked Hash Set import java util List import java util Map import java util Properties import java util Set import org apache maven Repository Utils import org apache maven artifact Artifact import org apache maven artifact Artifact Utils import org apache maven artifact Dependency Resolution Required Exception remove once create Artifacts is removed import org apache maven artifact factory Artifact Factory import org apache maven artifact repository Artifact Repository import org apache maven artifact resolver filter Artifact Filter import org apache maven model Build import org apache maven model Ci Management import org apache maven model Contributor import org apache maven model Dependency import org apache maven model Dependency Management import org apache maven model Developer import org apache maven model Distribution Management import org apache maven model Extension import org apache maven model Issue Management import org apache maven model License import org apache maven model Mailing List import org apache maven model Model import org apache maven model Organization import org apache maven model Plugin import org apache maven model Plugin Execution import org apache maven model Plugin Management import org apache maven model Prerequisites import org apache maven model Profile import org apache maven model Report Plugin import org apache maven model Report Set import org apache maven model Reporting import org apache maven model Repository import org apache maven model Resource import org apache maven model Scm import org apache maven model io xpp Maven Xpp Writer import org apache maven project artifact Invalid Dependency Version Exception import org apache maven project artifact Maven Metadata Source import org codehaus plexus classworlds realm Class Realm import org codehaus plexus util xml Xpp Dom import org eclipse aether graph Dependency Filter import org eclipse aether repository Remote Repository The concern of the project is provide runtime values based on the model p The values in the model remain untouched but during the process of building a project notions like inheritance and interpolation can be added This allows to have an entity which is useful in a runtime while preserving the model so that it can be marshalled and unmarshalled without being tainted by runtime requirements p p With changes during release Maven Project is closer to being immutable after construction with the removal of all components from this class and the upfront construction taken care of entirely by the Project Builder There is still the issue of having to run the lifecycle in order to find all the compile source roots and resource directories but hope to take care of this during the Maven release jvz p public class Maven Project implements Cloneable public static final String unknown public static final String empty project public static final String private Model model private Maven Project parent private File file private File basedir private Set Artifact resolved Artifacts private Artifact Filter artifact Filter private Set Artifact artifacts private Artifact parent Artifact private Set Artifact plugin Artifacts private List Artifact Repository remote Artifact Repositories private List Artifact Repository plugin Artifact Repositories private List Remote Repository remote Project Repositories private List Remote Repository remote Plugin Repositories private List Artifact attached Artifacts private Maven Project execution Project private List Maven Project collected Projects private List String compile Source Roots new Array List private List String test Compile Source Roots new Array List private List String script Source Roots new Array List private Artifact Repository release Artifact Repository private Artifact Repository snapshot Artifact Repository private List Profile active Profiles new Array List private Map String List String injected Profile Ids new Linked Hash Map private Set Artifact dependency Artifacts private Artifact artifact calculated private Map String Artifact artifact Map private Model original Model private Map String Artifact plugin Artifact Map private Set Artifact report Artifacts private Map String Artifact report Artifact Map private Set Artifact extension Artifacts private Map String Artifact extension Artifact Map private Map String Artifact managed Version Map private Map String Maven Project project References new Hash Map private boolean execution Root private File parent File private Map String Object context private Class Realm class Realm private Dependency Filter extension Dependency Filter private final Set String lifecycle Phases Collections synchronized Set new Linked Hash Set String public Maven Project Model model new Model model set Group Id model set Artifact Id model set Version set Model model public Maven Project Model model set Model model public Maven Project Maven Project project deep Copy project public File get Parent File return parent File public void set Parent File File parent File this parent File parent File Accessors public Artifact get Artifact return artifact public void set Artifact Artifact artifact this artifact artifact would like to get rid of this jvz public Model get Model return model Returns the project corresponding to a declared parent return the parent or null if no parent is declared or there was an error building it public Maven Project get Parent return parent public void set Parent Maven Project parent this parent parent public boolean has Parent return get Parent null public File get File return file public void set File File file this file file this basedir file null file get Parent File null Sets project code file without changing project code basedir since public void set Pom File File file this file file public File get Basedir return basedir public void set Dependencies List Dependency dependencies get Model set Dependencies dependencies public List Dependency get Dependencies return get Model get Dependencies public Dependency Management get Dependency Management return get Model get Dependency Management Test and compile sourceroots private void add Path List String paths String path if path null path path trim if path length File file new File path if file is Absolute path file get Absolute Path else path new File get Basedir path get Absolute Path if paths contains path paths add path public void add Compile Source Root String path add Path get Compile Source Roots path public void add Test Compile Source Root String path add Path get Test Compile Source Roots path public List String get Compile Source Roots return compile Source Roots public List String get Test Compile Source Roots return test Compile Source Roots public List String get Compile Classpath Elements throws Dependency Resolution Required Exception List String list new Array List get Artifacts size String d get Build get Output Directory if d null list add d for Artifact a get Artifacts if a get Artifact Handler is Added To Classpath let the scope handler deal with this if Artifact equals a get Scope Artifact equals a get Scope Artifact equals a get Scope add Artifact Path a list return list this checking for file null happens because the resolver has been confused about the root artifact or not things like the stupid dummy artifact coming from surefire public List String get Test Classpath Elements throws Dependency Resolution Required Exception List String list new Array List get Artifacts size String d get Build get Test Output Directory if d null list add d d get Build get Output Directory if d null list add d for Artifact a get Artifacts if a get Artifact Handler is Added To Classpath add Artifact Path a list return list public List String get Runtime Classpath Elements throws Dependency Resolution Required Exception List String list new Array List get Artifacts size String d get Build get Output Directory if d null list add d for Artifact a get Artifacts if a get Artifact Handler is Added To Classpath let the scope handler deal with this Artifact equals a get Scope Artifact equals a get Scope add Artifact Path a list return list Delegate to the model public void set Model Version String pom Version get Model set Model Version pom Version public String get Model Version return get Model get Model Version public String get Id return get Model get Id public void set Group Id String group Id get Model set Group Id group Id public String get Group Id String group Id get Model get Group Id if group Id null get Model get Parent null group Id get Model get Parent get Group Id return group Id public void set Artifact Id String artifact Id get Model set Artifact Id artifact Id public String get Artifact Id return get Model get Artifact Id public void set Name String name get Model set Name name public String get Name this should not be allowed to be null if get Model get Name null return get Model get Name else return get Artifact Id public void set Version String version get Model set Version version public String get Version String version get Model get Version if version null get Model get Parent null version get Model get Parent get Version return version public String get Packaging return get Model get Packaging public void set Packaging String packaging get Model set Packaging packaging public void set Inception Year String inception Year get Model set Inception Year inception Year public String get Inception Year return get Model get Inception Year public void set Url String url get Model set Url url public String get Url return get Model get Url public Prerequisites get Prerequisites return get Model get Prerequisites public void set Issue Management Issue Management issue Management get Model set Issue Management issue Management public Ci Management get Ci Management return get Model get Ci Management public void set Ci Management Ci Management ci Management get Model set Ci Management ci Management public Issue Management get Issue Management return get Model get Issue Management public void set Distribution Management Distribution Management distribution Management get Model set Distribution Management distribution Management public Distribution Management get Distribution Management return get Model get Distribution Management public void set Description String description get Model set Description description public String get Description return get Model get Description public void set Organization Organization organization get Model set Organization organization public Organization get Organization return get Model get Organization public void set Scm Scm scm get Model set Scm scm public Scm get Scm return get Model get Scm public void set Mailing Lists List Mailing List mailing Lists get Model set Mailing Lists mailing Lists public List Mailing List get Mailing Lists return get Model get Mailing Lists public void add Mailing List Mailing List mailing List get Model add Mailing List mailing List public void set Developers List Developer developers get Model set Developers developers public List Developer get Developers return get Model get Developers public void add Developer Developer developer get Model add Developer developer public void set Contributors List Contributor contributors get Model set Contributors contributors public List Contributor get Contributors return get Model get Contributors public void add Contributor Contributor contributor get Model add Contributor contributor public void set Build Build build get Model set Build build public Build get Build return get Model Build public List Resource get Resources return get Build get Resources public List Resource get Test Resources return get Build get Test Resources public void add Resource Resource resource get Build add Resource resource public void add Test Resource Resource test Resource get Build add Test Resource test Resource public void set Licenses List License licenses get Model set Licenses licenses public List License get Licenses return get Model get Licenses public void add License License license get Model add License license public void set Artifacts Set Artifact artifacts this artifacts artifacts flush the calculated artifact Map artifact Map null All dependencies that this project has including transitive ones Contents are lazily populated so depending on what phases have run dependencies in some scopes wo n t be included eg if only compile phase has run dependencies with scope test wo n t be included return link Set lt link Artifact gt see get Dependency Artifacts to get only direct dependencies public Set Artifact get Artifacts if artifacts null if artifact Filter null resolved Artifacts null artifacts new Linked Hash Set else artifacts new Linked Hash Set resolved Artifacts size for Artifact artifact resolved Artifacts if artifact Filter include artifact artifacts add artifact return artifacts public Map String Artifact get Artifact Map if artifact Map null artifact Map Artifact Utils artifact Map By Versionless Id get Artifacts return artifact Map public void set Plugin Artifacts Set Artifact plugin Artifacts this plugin Artifacts plugin Artifacts this plugin Artifact Map null public Set Artifact get Plugin Artifacts return plugin Artifacts public Map String Artifact get Plugin Artifact Map if plugin Artifact Map null plugin Artifact Map Artifact Utils artifact Map By Versionless Id get Plugin Artifacts return plugin Artifact Map public void set Parent Artifact Artifact parent Artifact this parent Artifact parent Artifact public Artifact get Parent Artifact return parent Artifact public List Repository get Repositories return get Model get Repositories Plugins public List Plugin get Build Plugins if get Model get Build null return Collections empty List return get Model get Build get Plugins public List String get Modules return get Model get Modules public Plugin Management get Plugin Management Plugin Management plugin Mgmt null Build build get Model get Build if build null plugin Mgmt build get Plugin Management return plugin Mgmt private Build get Model Build Build build get Model get Build if build null build new Build get Model set Build build return build public void set Remote Artifact Repositories List Artifact Repository remote Artifact Repositories this remote Artifact Repositories remote Artifact Repositories this remote Project Repositories Repository Utils to Repos get Remote Artifact Repositories public List Artifact Repository get Remote Artifact Repositories if remote Artifact Repositories null remote Artifact Repositories new Array List return remote Artifact Repositories public void set Plugin Artifact Repositories List Artifact Repository plugin Artifact Repositories this plugin Artifact Repositories plugin Artifact Repositories this remote Plugin Repositories Repository Utils to Repos get Plugin Artifact Repositories return a list of Artifact Repository objects constructed from the Repository objects returned by get Plugin Repositories public List Artifact Repository get Plugin Artifact Repositories if plugin Artifact Repositories null plugin Artifact Repositories new Array List return plugin Artifact Repositories public Artifact Repository get Distribution Management Artifact Repository return get Artifact is Snapshot get Snapshot Artifact Repository null get Snapshot Artifact Repository get Release Artifact Repository public List Repository get Plugin Repositories return get Model get Plugin Repositories public List Remote Repository get Remote Project Repositories return remote Project Repositories public List Remote Repository get Remote Plugin Repositories return remote Plugin Repositories public void set Active Profiles List Profile active Profiles this active Profiles active Profiles public List Profile get Active Profiles return active Profiles public void set Injected Profile Ids String source List String injected Profile Ids if injected Profile Ids null this injected Profile Ids put source new Array List injected Profile Ids else this injected Profile Ids remove source Gets the identifiers of all profiles that contributed to this project s effective model This includes active profiles from the project s and all its parent Ms as well as from external sources like the code settings xml The profile identifiers are grouped by the identifier of their source e g code group Id artifact Id version for a profile or code external for profiles from the code settings xml return The identifiers of all injected profiles indexed by the source from which the profiles originated never code null public Map String List String get Injected Profile Ids return this injected Profile Ids Add or replace an artifact This method is now deprecated Use the Maven Project Helper to attach artifacts to a project In spite of the throws declaration on this this method has never thrown an exception since Maven x Historically it logged and ignored a second addition of the same g a v c t Now it replaces the file for the artifact so that plugins e g shade can change the pathname of the file for a particular set of coordinates param artifact the artifact to add or replace throws Duplicate Artifact Attachment Exception public void add Attached Artifact Artifact artifact throws Duplicate Artifact Attachment Exception get Attached Artifacts add artifact public List Artifact get Attached Artifacts if attached Artifacts null attached Artifacts new Array List return attached Artifacts public Xpp Dom get Goal Configuration String plugin Group Id String plugin Artifact Id String execution Id String goal Id Xpp Dom dom null if get Build Plugins null for Plugin plugin get Build Plugins if plugin Group Id equals plugin get Group Id plugin Artifact Id equals plugin get Artifact Id dom Xpp Dom plugin get Configuration if execution Id null Plugin Execution execution plugin get Executions As Map get execution Id if execution null The Plugin Configuration Expander already merged the plugin level config in dom Xpp Dom execution get Configuration break if dom null make a copy so the original in the does n t get messed with dom new Xpp Dom dom return dom public Maven Project get Execution Project return execution Project null this execution Project public void set Execution Project Maven Project execution Project this execution Project execution Project public List Maven Project get Collected Projects return collected Projects public void set Collected Projects List Maven Project collected Projects this collected Projects collected Projects Direct dependencies that this project has return link Set lt link Artifact gt see get Artifacts to get all transitive dependencies Deprecated public Set Artifact get Dependency Artifacts return dependency Artifacts Deprecated public void set Dependency Artifacts Set Artifact dependency Artifacts this dependency Artifacts dependency Artifacts public void set Release Artifact Repository Artifact Repository release Artifact Repository this release Artifact Repository release Artifact Repository public void set Snapshot Artifact Repository Artifact Repository snapshot Artifact Repository this snapshot Artifact Repository snapshot Artifact Repository public void set Original Model Model original Model this original Model original Model public Model get Original Model return original Model public void set Managed Version Map Map String Artifact map managed Version Map map public Map String Artifact get Managed Version Map return managed Version Map Override public boolean equals Object other if other this return true else if other instanceof Maven Project return false Maven Project that Maven Project other return eq get Artifact Id that get Artifact Id eq get Group Id that get Group Id eq get Version that get Version private static boolean eq s s return s null s equals s s null Override public int hash Code int hash hash hash get Group Id hash Code hash hash get Artifact Id hash Code hash hash get Version hash Code return hash public List Extension get Build Extensions Build build get Build if build null build get Extensions null return Collections empty List else return build get Extensions public void add Project Reference Maven Project project project References put get Project Reference Id project get Group Id project get Artifact Id project get Version project public Properties get Properties return get Model get Properties public List String get Filters return get Build get Filters public Map String Maven Project get Project References return project References public boolean is Execution Root return execution Root public void set Execution Root boolean execution Root this execution Root execution Root public String get Default Goal return get Build null get Build get Default Goal null public Plugin get Plugin String plugin Key return get Build get Plugins As Map get plugin Key Default to String Override public String to String String Builder sb new String Builder sb append Maven Project sb append get Group Id sb append sb append get Artifact Id sb append sb append get Version sb append try sb append get File get Path catch Null Pointer Exception e do n t log it return sb to String since Override public Maven Project clone Maven Project clone try clone Maven Project super clone catch Clone Not Supported Exception e throw new Unsupported Operation Exception e clone deep Copy this return clone public void set Model Model model this model model protected void set Attached Artifacts List Artifact attached Artifacts this attached Artifacts attached Artifacts protected void set Compile Source Roots List String compile Source Roots this compile Source Roots compile Source Roots protected void set Test Compile Source Roots List String test Compile Source Roots this test Compile Source Roots test Compile Source Roots protected Artifact Repository get Release Artifact Repository return release Artifact Repository protected Artifact Repository get Snapshot Artifact Repository return snapshot Artifact Repository private void deep Copy Maven Project project disown the parent copy fields set File project get File do n t need a deep copy they do n t get modified or added removed to from but make them unmodifiable to be sure if project get Dependency Artifacts null set Dependency Artifacts Collections unmodifiable Set project get Dependency Artifacts if project get Artifacts null set Artifacts Collections unmodifiable Set project get Artifacts if project get Parent File null parent File new File project get Parent File get Absolute Path if project get Plugin Artifacts null set Plugin Artifacts Collections unmodifiable Set project get Plugin Artifacts if project get Report Artifacts null set Report Artifacts Collections unmodifiable Set project get Report Artifacts if project get Extension Artifacts null set Extension Artifacts Collections unmodifiable Set project get Extension Artifacts set Parent Artifact project get Parent Artifact if project get Remote Artifact Repositories null set Remote Artifact Repositories Collections unmodifiable List project get Remote Artifact Repositories if project get Plugin Artifact Repositories null set Plugin Artifact Repositories Collections unmodifiable List project get Plugin Artifact Repositories if project get Active Profiles null set Active Profiles Collections unmodifiable List project get Active Profiles if project get Attached Artifacts null clone properties modifyable by plugins in a forked lifecycle set Attached Artifacts new Array List project get Attached Artifacts if project get Compile Source Roots null clone source roots set Compile Source Roots new Array List project get Compile Source Roots if project get Test Compile Source Roots null set Test Compile Source Roots new Array List project get Test Compile Source Roots if project get Script Source Roots null set Script Source Roots new Array List project get Script Source Roots if project get Model null set Model project get Model clone if project get Original Model null set Original Model project get Original Model set Execution Root project is Execution Root if project get Artifact null set Artifact Artifact Utils copy Artifact project get Artifact if project get Managed Version Map null set Managed Version Map new Hash Map project get Managed Version Map lifecycle Phases add All project lifecycle Phases private void add Artifact Path Artifact artifact List String classpath File file artifact get File if file null classpath add file get Path private static String get Project Reference Id String group Id String artifact Id String version String Builder buffer new String Builder buffer append group Id append append artifact Id append append version return buffer to String Sets the value of the context value of this project identified by the given key If the supplied value is code null code the context value is removed from this project Context values are intended to allow core extensions to associate derived state with project instances public void set Context Value String key Object value if context null context new Hash Map if value null context put key value else context remove key Returns context value of this project associated with the given key or null if this project has no such value public Object get Context Value String key if context null return null return context get key Sets the project s class realm strong Warning strong This is an internal utility method that is only public for technical reasons it is not part of the public In particular this method can be changed or deleted without prior notice and must not be used by plugins param class Realm The class realm hosting the build extensions of this project may be code null public void set Class Realm Class Realm class Realm this class Realm class Realm Gets the project s class realm This class realm hosts the build extensions of the project strong Warning strong This is an internal utility method that is only public for technical reasons it is not part of the public In particular this method can be changed or deleted without prior notice and must not be used by plugins return The project s class realm or code null public Class Realm get Class Realm return class Realm Sets the artifact filter used to exclude shared extension artifacts from plugin realms strong Warning strong This is an internal utility method that is only public for technical reasons it is not part of the public In particular this method can be changed or deleted without prior notice and must not be used by plugins param extension Dependency Filter The dependency filter to apply to plugins may be code null public void set Extension Dependency Filter Dependency Filter extension Dependency Filter this extension Dependency Filter extension Dependency Filter Gets the dependency filter used to exclude shared extension artifacts from plugin realms strong Warning strong This is an internal utility method that is only public for technical reasons it is not part of the public In particular this method can be changed or deleted without prior notice and must not be used by plugins return The dependency filter or code null public Dependency Filter get Extension Dependency Filter return extension Dependency Filter Sets the transitive dependency artifacts that have been resolved collected for this project strong Warning strong This is an internal utility method that is only public for technical reasons it is not part of the public In particular this method can be changed or deleted without prior notice and must not be used by plugins param artifacts The set of artifacts may be code null public void set Resolved Artifacts Set Artifact artifacts this resolved Artifacts artifacts null artifacts Collections Artifact empty Set this artifacts null this artifact Map null Sets the scope filter to select the artifacts being exposed to the currently executed mojo strong Warning strong This is an internal utility method that is only public for technical reasons it is not part of the public In particular this method can be changed or deleted without prior notice and must not be used by plugins param artifact Filter The artifact filter may be code null to exclude all artifacts public void set Artifact Filter Artifact Filter artifact Filter this artifact Filter artifact Filter this artifacts null this artifact Map null strong Warning strong This is an internal utility method that is only public for technical reasons it is not part of the public In particular this method can be changed or deleted without prior notice and must not be used by plugins param phase The phase to check for must not be code null return code true if the phase has been seen public boolean has Lifecycle Phase String phase return lifecycle Phases contains phase strong Warning strong This is an internal utility method that is only public for technical reasons it is not part of the public In particular this method can be changed or deleted without prior notice and must not be used by plugins param lifecycle Phase The lifecycle phase to add must not be code null public void add Lifecycle Phase String lifecycle Phase lifecycle Phases add lifecycle Phase Everything below will be removed for Maven private Project Building Request project Builder Configuration private Map String String module Adjustments Deprecated This appears only to be used in test code public String get Module Path Adjustment Maven Project module Project throws Exception This is hacky What if module directory does n t match artifactid and parent is coming from the repository String module module Project get Artifact Id File module File module Project get File if module File null File module Dir module File get Canonical File get Parent File module module Dir get Name if module Adjustments null module Adjustments new Hash Map List String modules get Modules if modules null for String module Path modules String module Name module Path if module Name ends With module Name ends With module Name module Name substring module Name length int last Slash module Name last Index Of if last Slash last Slash module Name last Index Of String adjustment null if last Slash module Name module Name substring last Slash adjustment module Path substring last Slash module Adjustments put module Name adjustment return module Adjustments get module Deprecated public Set Artifact create Artifacts Artifact Factory artifact Factory String inherited Scope Artifact Filter filter throws Invalid Dependency Version Exception return Maven Metadata Source create Artifacts artifact Factory get Dependencies inherited Scope filter this Deprecated protected void set Script Source Roots List String script Source Roots this script Source Roots script Source Roots Deprecated public void add Script Source Root String path if path null path path trim if path length if get Script Source Roots contains path get Script Source Roots add path Deprecated public List String get Script Source Roots return script Source Roots Deprecated public List Artifact get Compile Artifacts List Artifact list new Array List get Artifacts size for Artifact a get Artifacts classpath check does n t belong here that s the other method if a get Artifact Handler is Added To Classpath let the scope handler deal with this if Artifact equals a get Scope Artifact equals a get Scope Artifact equals a get Scope list add a return list Deprecated public List Dependency get Compile Dependencies Set Artifact artifacts get Artifacts if artifacts null artifacts is Empty return Collections empty List List Dependency list new Array List artifacts size for Artifact a get Artifacts let the scope handler deal with this if Artifact equals a get Scope Artifact equals a get Scope Artifact equals a get Scope Dependency dependency new Dependency dependency set Artifact Id a get Artifact Id dependency set Group Id a get Group Id dependency set Version a get Version dependency set Scope a get Scope dependency set Type a get Type dependency set Classifier a get Classifier list add dependency return list Deprecated public List Artifact get Test Artifacts List Artifact list new Array List get Artifacts size for Artifact a get Artifacts classpath check does n t belong here that s the other method if a get Artifact Handler is Added To Classpath list add a return list Deprecated public List Dependency get Test Dependencies Set Artifact artifacts get Artifacts if artifacts null artifacts is Empty return Collections empty List List Dependency list new Array List artifacts size for Artifact a get Artifacts Dependency dependency new Dependency dependency set Artifact Id a get Artifact Id dependency set Group Id a get Group Id dependency set Version a get Version dependency set Scope a get Scope dependency set Type a get Type dependency set Classifier a get Classifier list add dependency return list Deprecated used by the Maven Ts public List Dependency get Runtime Dependencies Set Artifact artifacts get Artifacts if artifacts null artifacts is Empty return Collections empty List List Dependency list new Array List artifacts size for Artifact a get Artifacts let the scope handler deal with this if Artifact equals a get Scope Artifact equals a get Scope Dependency dependency new Dependency dependency set Artifact Id a get Artifact Id dependency set Group Id a get Group Id dependency set Version a get Version dependency set Scope a get Scope dependency set Type a get Type dependency set Classifier a get Classifier list add dependency return list Deprecated public List Artifact get Runtime Artifacts List Artifact list new Array List get Artifacts size for Artifact a get Artifacts classpath check does n t belong here that s the other method if a get Artifact Handler is Added To Classpath let the scope handler deal with this Artifact equals a get Scope Artifact equals a get Scope list add a return list Deprecated public List String get System Classpath Elements throws Dependency Resolution Required Exception List String list new Array List get Artifacts size String d get Build get Output Directory if d null list add d for Artifact a get Artifacts if a get Artifact Handler is Added To Classpath let the scope handler deal with this if Artifact equals a get Scope add Artifact Path a list return list Deprecated public List Artifact get System Artifacts List Artifact list new Array List get Artifacts size for Artifact a get Artifacts classpath check does n t belong here that s the other method if a get Artifact Handler is Added To Classpath let the scope handler deal with this if Artifact equals a get Scope list add a return list Deprecated public List Dependency get System Dependencies Set Artifact artifacts get Artifacts if artifacts null artifacts is Empty return Collections empty List List Dependency list new Array List artifacts size for Artifact a get Artifacts let the scope handler deal with this if Artifact equals a get Scope Dependency dependency new Dependency dependency set Artifact Id a get Artifact Id dependency set Group Id a get Group Id dependency set Version a get Version dependency set Scope a get Scope dependency set Type a get Type dependency set Classifier a get Classifier list add dependency return list Deprecated public void set Reporting Reporting reporting get Model set Reporting reporting Deprecated public Reporting get Reporting return get Model get Reporting Deprecated public void set Report Artifacts Set Artifact report Artifacts this report Artifacts report Artifacts report Artifact Map null Deprecated public Set Artifact get Report Artifacts return report Artifacts Deprecated public Map String Artifact get Report Artifact Map if report Artifact Map null report Artifact Map Artifact Utils artifact Map By Versionless Id get Report Artifacts return report Artifact Map Deprecated public void set Extension Artifacts Set Artifact extension Artifacts this extension Artifacts extension Artifacts extension Artifact Map null Deprecated public Set Artifact get Extension Artifacts return extension Artifacts Deprecated public Map String Artifact get Extension Artifact Map if extension Artifact Map null extension Artifact Map Artifact Utils artifact Map By Versionless Id get Extension Artifacts return extension Artifact Map Deprecated public List Report Plugin get Report Plugins if get Model get Reporting null return Collections empty List return get Model get Reporting get Plugins Deprecated public Xpp Dom get Report Configuration String plugin Group Id String plugin Artifact Id String report Set Id Xpp Dom dom null would like to be able to lookup the Mojo object using a key but we have a limitation in modello that will be remedied shortly So for now have to iterate through and see what we have if get Report Plugins null for Report Plugin plugin get Report Plugins if plugin Group Id equals plugin get Group Id plugin Artifact Id equals plugin get Artifact Id dom Xpp Dom plugin get Configuration if report Set Id null Report Set report Set plugin get Report Sets As Map get report Set Id if report Set null Xpp Dom execution Configuration Xpp Dom report Set get Configuration if execution Configuration null Xpp Dom new Dom new Xpp Dom execution Configuration dom Xpp Dom merge Xpp Dom new Dom dom break if dom null make a copy so the original in the does n t get messed with dom new Xpp Dom dom return dom deprecated Use Maven Project Helper attach Artifact instead Deprecated public void attach Artifact String type String classifier File file deprecated Use link org apache maven model io Model Writer Deprecated public void write Model Writer writer throws Exception Maven Xpp Writer pom Writer new Maven Xpp Writer pom Writer write writer get Model deprecated Use link org apache maven model io Model Writer Deprecated public void write Original Model Writer writer throws Exception Maven Xpp Writer pom Writer new Maven Xpp Writer pom Writer write writer get Original Model Deprecated public Artifact replace With Active Artifact Artifact plugin Artifact return plugin Artifact Gets the project building request from which this project instance was created strong Warning strong This is an utility method that is meant to assist integrators of Maven it must not be used by Maven plugins return The project building request or code null since Deprecated public Project Building Request get Project Building Request return project Builder Configuration Sets the project building request from which this project instance was created strong Warning strong This is an utility method that is meant to assist integrators of Maven it must not be used by Maven plugins param project Building Request The project building request may be code null since used by maven dependency tree Deprecated public void set Project Building Request Project Building Request project Building Request this project Builder Configuration project Building Request 
package org apache maven bridge Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io File import java net Malformed Exception import java net import java util Array List import java util Collections import java util Hash Set import java util List import java util Map import java util Set import org apache maven Repository Utils import org apache maven artifact Artifact import org apache maven artifact Default Artifact import org apache maven artifact Invalid Repository Exception import org apache maven artifact handler Artifact Handler import org apache maven artifact handler manager Artifact Handler Manager import org apache maven artifact repository Artifact Repository import org apache maven artifact repository Artifact Repository Policy import org apache maven artifact repository Authentication import org apache maven artifact repository Maven Artifact Repository import org apache maven artifact repository layout Artifact Repository Layout import org apache maven artifact repository layout Artifact Repository Layout import org apache maven artifact repository layout Default Repository Layout import org apache maven artifact resolver filter Excludes Artifact Filter import org apache maven artifact versioning Invalid Version Specification Exception import org apache maven artifact versioning Version Range import org apache maven execution Maven Execution Request import org apache maven model Dependency import org apache maven model Exclusion import org apache maven model Plugin import org apache maven repository Proxy import org apache maven repository Repository System import org apache maven settings Mirror import org codehaus plexus component annotations Component import org codehaus plexus component annotations Requirement import org codehaus plexus util String Utils import org eclipse aether Repository System Session import org eclipse aether repository Authentication Context import org eclipse aether repository Authentication Selector import org eclipse aether repository Proxy Selector import org eclipse aether repository Remote Repository author Jason van Zyl Component role Maven Repository System class hint default public class Maven Repository System Requirement private Artifact Handler Manager artifact Handler Manager Requirement role Artifact Repository Layout class private Map String Artifact Repository Layout layouts Default Project Builder public Artifact create Artifact String group Id String artifact Id String version String scope String type return Xcreate Artifact group Id artifact Id version scope type Default Project Builder public Artifact create Project Artifact String group Id String artifact Id String meta Version Id return Xcreate Project Artifact group Id artifact Id meta Version Id Default Project Builder public Artifact create Dependency Artifact Dependency d if d get Version null return null Version Range version Range try version Range Version Range create From Version Spec d get Version catch Invalid Version Specification Exception e return null Artifact artifact Xcreate Dependency Artifact d get Group Id d get Artifact Id version Range d get Type d get Classifier d get Scope d is Optional if Artifact equals d get Scope d get System Path null artifact set File new File d get System Path if d get Exclusions is Empty List String exclusions new Array List for Exclusion exclusion d get Exclusions exclusions add exclusion get Group Id exclusion get Artifact Id artifact set Dependency Filter new Excludes Artifact Filter exclusions return artifact Default Project Builder public Artifact create Extension Artifact String group Id String artifact Id String version Version Range version Range try version Range Version Range create From Version Spec version catch Invalid Version Specification Exception e return null return Xcreate Extension Artifact group Id artifact Id version Range Default Project Builder public Artifact create Parent Artifact String group Id String artifact Id String version return Xcreate Parent Artifact group Id artifact Id version Default Project Builder public Artifact create Plugin Artifact Plugin plugin Version Range version Range try String version plugin get Version if String Utils is Empty version version version Range Version Range create From Version Spec version catch Invalid Version Specification Exception e return null return Xcreate Plugin Artifact plugin get Group Id plugin get Artifact Id version Range public void inject Mirror List Artifact Repository repositories List Mirror mirrors if repositories null mirrors null for Artifact Repository repository repositories Mirror mirror get Mirror repository mirrors inject Mirror repository mirror private Mirror get Mirror Repository System Session session Artifact Repository repository if session null org eclipse aether repository Mirror Selector selector session get Mirror Selector if selector null Remote Repository repo selector get Mirror Repository Utils to Repo repository if repo null Mirror mirror new Mirror mirror set Id repo get Id mirror set Url repo get Url mirror set Layout repo get Content Type return mirror return null public void inject Mirror Repository System Session session List Artifact Repository repositories if repositories null session null for Artifact Repository repository repositories Mirror mirror get Mirror session repository inject Mirror repository mirror private void inject Mirror Artifact Repository repository Mirror mirror if mirror null Artifact Repository original create Artifact Repository repository get Id repository get Url repository get Layout repository get Snapshots repository get Releases repository set Mirrored Repositories Collections singleton List original repository set Id mirror get Id repository set Url mirror get Url if String Utils is Not Empty mirror get Layout repository set Layout get Layout mirror get Layout private Authentication get Authentication Repository System Session session Artifact Repository repository if session null Authentication Selector selector session get Authentication Selector if selector null Remote Repository repo Repository Utils to Repo repository org eclipse aether repository Authentication auth selector get Authentication repo if auth null repo new Remote Repository Builder repo set Authentication auth build Authentication Context auth Ctx Authentication Context for Repository session repo Authentication result new Authentication auth Ctx get Authentication Context auth Ctx get Authentication Context result set Private Key auth Ctx get Authentication Context result set Passphrase auth Ctx get Authentication Context auth Ctx close return result return null public void inject Authentication Repository System Session session List Artifact Repository repositories if repositories null session null for Artifact Repository repository repositories repository set Authentication get Authentication session repository private Proxy get Proxy Repository System Session session Artifact Repository repository if session null Proxy Selector selector session get Proxy Selector if selector null Remote Repository repo Repository Utils to Repo repository org eclipse aether repository Proxy proxy selector get Proxy repo if proxy null Proxy p new Proxy p set Host proxy get Host p set Protocol proxy get Type p set Port proxy get Port if proxy get Authentication null repo new Remote Repository Builder repo set Proxy proxy build Authentication Context auth Ctx Authentication Context for Proxy session repo p set User Name auth Ctx get Authentication Context p set Password auth Ctx get Authentication Context p set Ntlm Domain auth Ctx get Authentication Context p set Ntlm Host auth Ctx get Authentication Context auth Ctx close return p return null public void inject Proxy Repository System Session session List Artifact Repository repositories if repositories null session null for Artifact Repository repository repositories repository set Proxy get Proxy session repository private Artifact Repository Layout get Layout String id Artifact Repository Layout layout layouts get id return layout Taken from Legacy Repository System public static org apache maven model Repository from Settings Repository org apache maven settings Repository settings Repository org apache maven model Repository model Repository new org apache maven model Repository model Repository set Id settings Repository get Id model Repository set Layout settings Repository get Layout model Repository set Name settings Repository get Name model Repository set Url settings Repository get Url model Repository set Releases from Settings Repository Policy settings Repository get Releases model Repository set Snapshots from Settings Repository Policy settings Repository get Snapshots return model Repository public static org apache maven model Repository Policy from Settings Repository Policy org apache maven settings Repository Policy settings Repository Policy org apache maven model Repository Policy model Repository Policy new org apache maven model Repository Policy if settings Repository Policy null model Repository Policy set Enabled settings Repository Policy is Enabled model Repository Policy set Update Policy settings Repository Policy get Update Policy model Repository Policy set Checksum Policy settings Repository Policy get Checksum Policy return model Repository Policy public static Artifact Repository build Artifact Repository org apache maven settings Repository repo throws Invalid Repository Exception return build Artifact Repository from Settings Repository repo public static Artifact Repository build Artifact Repository org apache maven model Repository repo throws Invalid Repository Exception if repo null String id repo get Id if String Utils is Empty id throw new Invalid Repository Exception Repository identifier missing String url repo get Url if String Utils is Empty url throw new Invalid Repository Exception missing for repository id id Artifact Repository Policy snapshots build Artifact Repository Policy repo get Snapshots Artifact Repository Policy releases build Artifact Repository Policy repo get Releases Artifact Repository Layout layout new Default Repository Layout return create Artifact Repository id url layout snapshots releases else return null public static Artifact Repository Policy build Artifact Repository Policy org apache maven model Repository Policy policy boolean enabled true String update Policy null String checksum Policy null if policy null enabled policy is Enabled if policy get Update Policy null update Policy policy get Update Policy if policy get Checksum Policy null checksum Policy policy get Checksum Policy return new Artifact Repository Policy enabled update Policy checksum Policy public Artifact Repository create Artifact Repository String id String url String layout Id Artifact Repository Policy snapshots Artifact Repository Policy releases throws Exception Artifact Repository Layout layout layouts get layout Id check Layout id layout Id layout return create Artifact Repository id url layout snapshots releases private void check Layout String repository Id String layout Id Artifact Repository Layout layout throws Exception if layout null throw new Exception String format Can not find Artifact Repository Layout instance for s s layout Id repository Id public static Artifact Repository create Artifact Repository String id String url Artifact Repository Layout repository Layout Artifact Repository Policy snapshots Artifact Repository Policy releases if snapshots null snapshots new Artifact Repository Policy if releases null releases new Artifact Repository Policy Artifact Repository repository if repository Layout instanceof Artifact Repository Layout repository Artifact Repository Layout repository Layout new Maven Artifact Repository id url snapshots releases else repository new Maven Artifact Repository id url repository Layout snapshots releases return repository Artifact Factory private Artifact Xcreate Artifact String group Id String artifact Id String version String scope String type return Xcreate Artifact group Id artifact Id version scope type null null private Artifact Xcreate Dependency Artifact String group Id String artifact Id Version Range version Range String type String classifier String scope boolean optional return Xcreate Artifact group Id artifact Id version Range type classifier scope null optional private Artifact Xcreate Project Artifact String group Id String artifact Id String version return Xcreate Project Artifact group Id artifact Id version null private Artifact Xcreate Parent Artifact String group Id String artifact Id String version return Xcreate Project Artifact group Id artifact Id version private Artifact Xcreate Plugin Artifact String group Id String artifact Id Version Range version Range return Xcreate Artifact group Id artifact Id version Range maven plugin null Artifact null private Artifact Xcreate Project Artifact String group Id String artifact Id String version String scope return Xcreate Artifact group Id artifact Id version scope pom private Artifact Xcreate Extension Artifact String group Id String artifact Id Version Range version Range return Xcreate Artifact group Id artifact Id version Range jar null Artifact null private Artifact Xcreate Artifact String group Id String artifact Id String version String scope String type String classifier String inherited Scope Version Range version Range null if version null version Range Version Range create From Version version return Xcreate Artifact group Id artifact Id version Range type classifier scope inherited Scope private Artifact Xcreate Artifact String group Id String artifact Id Version Range version Range String type String classifier String scope String inherited Scope return Xcreate Artifact group Id artifact Id version Range type classifier scope inherited Scope false private Artifact Xcreate Artifact String group Id String artifact Id Version Range version Range String type String classifier String scope String inherited Scope boolean optional String desired Scope Artifact if inherited Scope null desired Scope scope else if Artifact equals scope Artifact equals scope return null else if Artifact equals scope Artifact equals inherited Scope added to retain compile artifact Scope Remove if you want compile inherited as runtime desired Scope Artifact if Artifact equals inherited Scope desired Scope Artifact if Artifact equals inherited Scope desired Scope Artifact if Artifact equals scope system scopes come through unchanged desired Scope Artifact Artifact Handler handler artifact Handler Manager get Artifact Handler type return new Default Artifact group Id artifact Id version Range desired Scope type classifier handler optional Code taken from Legacy Repository System public Artifact Repository create Default Remote Repository Maven Execution Request request throws Exception return create Repository Repository System Repository System true Artifact Repository Policy false Artifact Repository Policy Artifact Repository Policy public Artifact Repository create Repository String url String repository Id boolean releases String release Updates boolean snapshots String snapshot Updates String checksum Policy throws Exception Artifact Repository Policy snapshots Policy new Artifact Repository Policy snapshots snapshot Updates checksum Policy Artifact Repository Policy releases Policy new Artifact Repository Policy releases release Updates checksum Policy return create Artifact Repository repository Id url default snapshots Policy releases Policy public Set String get Repo Ids List Artifact Repository repositories Set String repo Ids new Hash Set if repositories null for Artifact Repository repository repositories repo Ids add repository get Id return repo Ids public Artifact Repository create Local Repository Maven Execution Request request File local Repository throws Exception return create Repository file local Repository to get Raw Path Repository System true Artifact Repository Policy true Artifact Repository Policy Artifact Repository Policy private static final String private static final String external public static Mirror get Mirror Artifact Repository repository List Mirror mirrors String repo Id repository get Id if repo Id null mirrors null for Mirror mirror mirrors if repo Id equals mirror get Mirror Of matches Layout repository mirror return mirror for Mirror mirror mirrors if match Pattern repository mirror get Mirror Of matches Layout repository mirror return mirror return null This method checks if the pattern matches the original Repository Valid patterns everything external everything not on the localhost and not file based repo repo repo or repo repo everything except repo param original Repository to compare for a match param pattern used for match Currently only is supported return true if the repository is a match to this pattern static boolean match Pattern Artifact Repository original Repository String pattern boolean result false String original Id original Repository get Id simple checks first to short circuit processing below if equals pattern pattern equals original Id result true else process the list String repos pattern split for String repo repos see if this is a negative match if repo length repo starts With if repo substring equals original Id explicitly exclude Set result and stop processing result false break check for exact match else if repo equals original Id result true break check for external else if equals repo is External Repo original Repository result true do n t stop processing in case a future segment explicitly excludes this repo else if equals repo result true do n t stop processing in case a future segment explicitly excludes this repo return result Checks the to see if this repository refers to an external repository param original Repository return true if external static boolean is External Repo Artifact Repository original Repository try url new original Repository get Url return url get Host equals localhost url get Host equals url get Protocol equals file catch Malformed Exception e bad url just skip it here It should have been validated already but the wagon lookup will deal with it return false static boolean matches Layout Artifact Repository repository Mirror mirror return matches Layout Repository Utils get Layout repository mirror get Mirror Of Layouts Checks whether the layouts configured for a mirror match with the layout of the repository param repo Layout The layout of the repository may be code null param mirror Layout The layouts supported by the mirror may be code null return code true if the layouts associated with the mirror match the layout of the original repository code false otherwise static boolean matches Layout String repo Layout String mirror Layout boolean result false simple checks first to short circuit processing below if String Utils is Empty mirror Layout equals mirror Layout result true else if mirror Layout equals repo Layout result true else process the list String layouts mirror Layout split for String layout layouts see if this is a negative match if layout length layout starts With if layout substring equals repo Layout explicitly exclude Set result and stop processing result false break check for exact match else if layout equals repo Layout result true break else if equals layout result true do n t stop processing in case a future segment explicitly excludes this repo return result 
package org apache maven execution Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io File import java util Arrays import java util Date import java util List import java util Map import java util Properties import java util concurrent Concurrent Hash Map import org apache maven artifact repository Artifact Repository import org apache maven artifact repository Repository Cache import org apache maven monitor event Event Dispatcher import org apache maven plugin descriptor Plugin Descriptor import org apache maven project Maven Project import org apache maven project Project Building Request import org apache maven settings Settings import org codehaus plexus Plexus Container import org codehaus plexus component repository exception Component Lookup Exception import org eclipse aether Repository System Session Maven execution session author Jason van Zyl public class Maven Session implements Cloneable private Maven Execution Request request private Maven Execution Result result private Repository System Session repository Session private Properties execution Properties private Maven Project current Project These projects have already been topologically sorted in the link org apache maven Maven component before being passed into the session This is also the potentially constrained set of projects by using projects on the command line private List Maven Project projects The full set of projects before any potential constraining by projects Useful in the case where you want to build a smaller set of projects but perform other operations in the context of your reactor private List Maven Project all Projects private Maven Project top Level Project private Project Dependency Graph project Dependency Graph private boolean parallel private final Map String Map String Map String Object plugin Contexts By Project And Plugin Key new Concurrent Hash Map public void set Projects List Maven Project projects if projects is Empty this current Project projects get this top Level Project current Project for Maven Project project projects if project is Execution Root top Level Project project break else this current Project null this top Level Project null this projects projects public Artifact Repository get Local Repository return request get Local Repository public List String get Goals return request get Goals Gets the user properties to use for interpolation and profile activation The user properties have been configured directly by the user on his discretion e g via the code Dkey value parameter on the command line return The user properties never code null public Properties get User Properties return request get User Properties Gets the system properties to use for interpolation and profile activation The system properties are collected from the runtime environment like link System get Properties and environment variables return The system properties never code null public Properties get System Properties return request get System Properties public Settings get Settings return settings public List Maven Project get Projects return projects public String get Execution Root Directory return request get Base Directory public Maven Execution Request get Request return request public void set Current Project Maven Project current Project this current Project current Project public Maven Project get Current Project return current Project public Project Building Request get Project Building Request return request get Project Building Request set Repository Session get Repository Session public List String get Plugin Groups return request get Plugin Groups public boolean is Offline return request is Offline public Maven Project get Top Level Project return top Level Project public Maven Execution Result get Result return result Backward compat public Map String Object get Plugin Context Plugin Descriptor plugin Maven Project project String project Key project get Id Map String Map String Object plugin Contexts By Key plugin Contexts By Project And Plugin Key get project Key if plugin Contexts By Key null plugin Contexts By Key new Concurrent Hash Map plugin Contexts By Project And Plugin Key put project Key plugin Contexts By Key String plugin Key plugin get Plugin Lookup Key Map String Object plugin Context plugin Contexts By Key get plugin Key if plugin Context null plugin Context new Concurrent Hash Map plugin Contexts By Key put plugin Key plugin Context return plugin Context public Project Dependency Graph get Project Dependency Graph return project Dependency Graph public void set Project Dependency Graph Project Dependency Graph project Dependency Graph this project Dependency Graph project Dependency Graph public String get Reactor Failure Behavior return request get Reactor Failure Behavior Override public Maven Session clone try return Maven Session super clone catch Clone Not Supported Exception e throw new Runtime Exception Bug e public Date get Start Time return request get Start Time public boolean is Parallel return parallel public void set Parallel boolean parallel this parallel parallel public Repository System Session get Repository Session return repository Session private Map String Maven Project project Map public void set Project Map Map String Maven Project project Map this project Map project Map This is a provisional method and may be removed public List Maven Project get All Projects return all Projects This is a provisional method and may be removed public void set All Projects List Maven Project all Projects this all Projects all Projects if not Deprecated private Plexus Container container private final Settings settings Deprecated deprecated This appears to only be used in the Reactor Reader and we can do any processing required there public Map String Maven Project get Project Map return project Map Deprecated public Maven Session Plexus Container container Repository System Session repository Session Maven Execution Request request Maven Execution Result result this container container this request request this result result this settings new Settings Adapter request this repository Session repository Session Deprecated public Maven Session Plexus Container container Maven Execution Request request Maven Execution Result result Maven Project project this container request result Arrays as List new Maven Project project Deprecated public Maven Session Plexus Container container Settings settings Artifact Repository local Repository Event Dispatcher event Dispatcher Reactor Manager unused List String goals String execution Root Dir Properties execution Properties Date start Time this container settings local Repository event Dispatcher unused goals execution Root Dir execution Properties null start Time Deprecated public Maven Session Plexus Container container Settings settings Artifact Repository local Repository Event Dispatcher event Dispatcher Reactor Manager unused List String goals String execution Root Dir Properties execution Properties Properties user Properties Date start Time this container container this settings settings this execution Properties execution Properties this request new Default Maven Execution Request this request set User Properties user Properties this request set Local Repository local Repository this request set Goals goals this request set Base Directory execution Root Dir null new File execution Root Dir null this request set Start Time start Time Deprecated public Maven Session Plexus Container container Maven Execution Request request Maven Execution Result result List Maven Project projects this container container this request request this result result this settings new Settings Adapter request set Projects projects Deprecated public List Maven Project get Sorted Projects return get Projects Deprecated Used by Tycho and will break users and force them to upgrade to Maven so we should really leave this here possibly indefinitely public Repository Cache get Repository Cache return null Deprecated public Event Dispatcher get Event Dispatcher return null Deprecated public boolean is Using Ms From Filesystem return request is Project Present deprecated Use either link get User Properties or link get System Properties Deprecated public Properties get Execution Properties if execution Properties null execution Properties new Properties execution Properties put All request get System Properties execution Properties put All request get User Properties return execution Properties Deprecated public Plexus Container get Container return container Deprecated public Object lookup String role throws Component Lookup Exception return container lookup role Deprecated public Object lookup String role String role Hint throws Component Lookup Exception return container lookup role role Hint Deprecated public List Object lookup List String role throws Component Lookup Exception return container lookup List role Deprecated public Map String Object lookup Map String role throws Component Lookup Exception return container lookup Map role end 
package org apache maven model building Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License Describes a problem that was encountered during model building problem can either be an exception that was thrown or a simple string message In addition a problem carries a hint about its source e g the file that exhibits the problem author Benjamin Bentmann public interface Model Problem The different severity levels for a problem in decreasing order enum Severity enum Version based on Mode Building Result validation Level Gets the hint about the source of the problem While the syntax of this hint is unspecified and depends on the creator of the problem the general expectation is that the hint provides sufficient information to the user to track the problem back to its origin concrete example for such a source hint can be the file path or from which a was read return The hint about the source of the problem or an empty string if unknown never code null String get Source Gets the one based index of the line containing the problem The line number should refer to some text file that is given by link get Source return The one based index of the line containing the problem or a non positive value if unknown int get Line Number Gets the one based index of the column containing the problem The column number should refer to some text file that is given by link get Source return The one based index of the column containing the problem or non positive value if unknown int get Column Number Gets the identifier of the model from which the problem originated While the general form of this identifier is code group Id artifact Id version code the returned identifier need not be complete The identifier is derived from the information that is available at the point the problem occurs and as such merely serves as a best effort to provide information to the user to track the problem back to its origin return The identifier of the model from which the problem originated or an empty string if unknown never code null String get Model Id Gets the exception that caused this problem if any return The exception that caused this problem or code null if not applicable Exception get Exception Gets the message that describes this problem return The message describing this problem never code null String get Message Gets the severity level of this problem return The severity level of this problem never code null Severity get Severity Gets the applicable maven version validation level of this problem return The version never code null Version get Version 
package org apache maven plugin descriptor Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util Hash Map import java util Linked List import java util List import java util Map import org apache maven plugin Mojo import org codehaus plexus component repository Component Descriptor import org codehaus plexus configuration Plexus Configuration import org codehaus plexus configuration xml Xml Plexus Configuration The bean containing the Mojo descriptor br For more information about the usage tag have a look to a href https maven apache org developers mojo api specification html https maven apache org developers mojo api specification html a is there a need for the delegation of Maven Mojo Descriptor to this Why not just extend Component Descriptor here public class Mojo Descriptor extends Component Descriptor Mojo implements Cloneable The Plexus component type public static final String maven plugin once per session execution strategy public static final String once per session always execution strategy public static final String always private static final String per lookup private static final String java private List Parameter parameters private Map String Parameter parameter Map By default the execution strategy is once per session private String execution Strategy The goal name for the Mojo that users will reference from the command line to execute the Mojo directly or inside a in order to provide Mojo specific configuration private String goal Defines a default phase to bind a mojo execution to if the user does not explicitly set a phase in the i Note i This will not automagically make a mojo run when the plugin declaration is added to the It merely enables the user to omit the code lt phase gt code element from the surrounding code lt execution gt code element private String phase Specify the version when the Mojo was added to the Similar to Javadoc since private String since Reference the invocation phase of the Mojo private String execute Phase Reference the invocation goal of the Mojo private String execute Goal Reference the invocation lifecycle of the Mojo private String execute Lifecycle Specify the version when the Mojo was deprecated to the Similar to Javadoc deprecated This will trigger a warning when a user tries to configure a parameter marked as deprecated private String deprecated Flags this Mojo to run it in a multi module way i e aggregate the build with the set of projects listed as modules By default no need to aggregate the Maven project and its child modules private boolean aggregator false Specify the required dependencies in a specified scope private String dependency Resolution Required null The scope of transitive dependencies that should be collected but not resolved since alpha private String dependency Collection Required By default the Mojo needs a Maven project to be executed private boolean project Required true By default the Mojo is assumed to work offline as well private boolean online Required false Plugin configuration private Plexus Configuration mojo Configuration Plugin descriptor private Plugin Descriptor plugin Descriptor By default the Mojo is inherited private boolean inherited By Default true By default the Mojo can not be invoked directly private boolean direct Invocation Only false By default the Mojo do n t need reports to run private boolean requires Reports false By default mojos are not threadsafe since beta private boolean thread Safe false Default constructor public Mojo Descriptor set Instantiation Strategy set Component Factory return the language of this Mojo i e code java code public String get Language return get Component Factory param language the new language public void set Language String language set Component Factory language return code true code if the Mojo is deprecated code false code otherwise public String get Deprecated return deprecated param deprecated code true code to deprecate the Mojo code false code otherwise public void set Deprecated String deprecated this deprecated deprecated return the list of parameters public List Parameter get Parameters return parameters param parameters the new list of parameters throws Duplicate Parameter Exception if any public void set Parameters List Parameter parameters throws Duplicate Parameter Exception for Parameter parameter parameters add Parameter parameter param parameter add a new parameter throws Duplicate Parameter Exception if any public void add Parameter Parameter parameter throws Duplicate Parameter Exception if parameters null parameters contains parameter throw new Duplicate Parameter Exception parameter get Name has been declared multiple times in mojo with goal get Goal implementation get Implementation if parameters null parameters new Linked List parameters add parameter return the list parameters as a Map public Map String Parameter get Parameter Map if parameter Map null parameter Map new Hash Map if parameters null for Parameter pd parameters parameter Map put pd get Name pd return parameter Map Dependency requirement param requires Dependency Resolution the new required dependencies in a specified scope public void set Dependency Resolution Required String requires Dependency Resolution this dependency Resolution Required requires Dependency Resolution public String get Dependency Resolution Required return dependency Resolution Required return the required dependencies in a specified scope the name is not intelligible Deprecated public String is Dependency Resolution Required return dependency Resolution Required since alpha public void set Dependency Collection Required String requires Dependency Collection this dependency Collection Required requires Dependency Collection Gets the scope of transitive dependencies that should be collected Dependency collection refers to the process of calculating the complete dependency tree in terms of artifact coordinates In contrast to dependency resolution this does not include the download of the files for the dependency artifacts It is meant for mojos that only want to analyze the set of transitive dependencies in particular during early lifecycle phases where full dependency resolution might fail due to projects which have n t been built yet return The scope of transitive dependencies that should be collected or code null if none since alpha public String get Dependency Collection Required return dependency Collection Required Project requirement param requires Project code true code if the Mojo needs a Maven project to be executed code false code otherwise public void set Project Required boolean requires Project this project Required requires Project return code true code if the Mojo needs a Maven project to be executed code false code otherwise public boolean is Project Required return project Required Online vs Offline requirement param requires Online code true code if the Mojo is online code false code otherwise public void set Online Required boolean requires Online this online Required requires Online return code true code if the Mojo is online code false code otherwise blech this is n t even intelligible as a method name provided for consistency public boolean is Online Required return online Required return code true code if the Mojo is online code false code otherwise more english friendly method keep the code clean public boolean requires Online return online Required return the binded phase name of the Mojo public String get Phase return phase param phase the new binded phase name of the Mojo public void set Phase String phase this phase phase return the version when the Mojo was added to the public String get Since return since param since the new version when the Mojo was added to the public void set Since String since this since since return The goal name of the Mojo public String get Goal return goal param goal The new goal name of the Mojo public void set Goal String goal this goal goal return the invocation phase of the Mojo public String get Execute Phase return execute Phase param execute Phase the new invocation phase of the Mojo public void set Execute Phase String execute Phase this execute Phase execute Phase return code true code if the Mojo uses code always code for the code execution Strategy code public boolean always Execute return equals execution Strategy return the execution strategy public String get Execution Strategy return execution Strategy param execution Strategy the new execution strategy public void set Execution Strategy String execution Strategy this execution Strategy execution Strategy return the mojo configuration public Plexus Configuration get Mojo Configuration if mojo Configuration null mojo Configuration new Xml Plexus Configuration configuration return mojo Configuration param mojo Configuration a new mojo configuration public void set Mojo Configuration Plexus Configuration mojo Configuration this mojo Configuration mojo Configuration inherit Doc public String get Role return Mojo inherit Doc public String get Role Hint return get Id return the id of the mojo based on the goal name public String get Id return get Plugin Descriptor get Id get Goal return the full goal name see Plugin Descriptor get Goal Prefix see get Goal public String get Full Goal Name return get Plugin Descriptor get Goal Prefix get Goal inherit Doc public String get Component Type return return the plugin descriptor public Plugin Descriptor get Plugin Descriptor return plugin Descriptor param plugin Descriptor the new plugin descriptor public void set Plugin Descriptor Plugin Descriptor plugin Descriptor this plugin Descriptor plugin Descriptor return code true code if the Mojo is inherited code false code otherwise public boolean is Inherited By Default return inherited By Default param inherited By Default code true code if the Mojo is inherited code false code otherwise public void set Inherited By Default boolean inherited By Default this inherited By Default inherited By Default inherit Doc public boolean equals Object object if this object return true if object instanceof Mojo Descriptor Mojo Descriptor other Mojo Descriptor object if compare Objects get Plugin Descriptor other get Plugin Descriptor return false return compare Objects get Goal other get Goal return false private boolean compare Objects Object first Object second if first second return true if first null second null return false return first equals second inherit Doc public int hash Code int result String goal get Goal if goal null result goal hash Code Plugin Descriptor pd get Plugin Descriptor if pd null result pd hash Code return result return the invocation lifecycle of the Mojo public String get Execute Lifecycle return execute Lifecycle param execute Lifecycle the new invocation lifecycle of the Mojo public void set Execute Lifecycle String execute Lifecycle this execute Lifecycle execute Lifecycle param aggregator code true code if the Mojo uses the Maven project and its child modules code false code otherwise public void set Aggregator boolean aggregator this aggregator aggregator return code true code if the Mojo uses the Maven project and its child modules code false code otherwise public boolean is Aggregator return aggregator return code true code if the Mojo can not be invoked directly code false code otherwise public boolean is Direct Invocation Only return direct Invocation Only param direct Invocation Only code true code if the Mojo can not be invoked directly code false code otherwise public void set Direct Invocation Only boolean direct Invocation Only this direct Invocation Only direct Invocation Only return code true code if the Mojo needs reports to run code false code otherwise public boolean is Requires Reports return requires Reports param requires Reports code true code if the Mojo needs reports to run code false code otherwise public void set Requires Reports boolean requires Reports this requires Reports requires Reports param execute Goal the new invocation goal of the Mojo public void set Execute Goal String execute Goal this execute Goal execute Goal return the invocation goal of the Mojo public String get Execute Goal return execute Goal return True if the code Mojo code is thread safe and can be run safely in parallel since beta public boolean is Thread Safe return thread Safe param thread Safe indicates that the mojo is thread safe and can be run safely in parallel since beta public void set Thread Safe boolean thread Safe this thread Safe thread Safe return code true if this mojo forks either a goal or the lifecycle code false otherwise public boolean is Forking return get Execute Goal null get Execute Goal length get Execute Phase null get Execute Phase length Creates a shallow copy of this mojo descriptor Override public Mojo Descriptor clone try return Mojo Descriptor super clone catch Clone Not Supported Exception e throw new Unsupported Operation Exception e 
package org apache maven plugin Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util Linked Hash Map import java util List import java util Map import org apache maven model Plugin import org apache maven plugin descriptor Mojo Descriptor import org codehaus plexus util xml Xpp Dom public class Mojo Execution private Plugin plugin private String goal private String execution Id private Mojo Descriptor mojo Descriptor private Xpp Dom configuration Describes the source of an execution public enum Source An execution that originates from the direct invocation of a goal from the An execution that originates from a goal bound to a lifecycle phase private Source source Source The phase may or may not have been bound to a phase but once the plan has been calculated we know what phase this mojo execution is going to run in private String lifecycle Phase The executions to fork before this execution indexed by the group Id artifact Id version of the project on which the forked execution are to be run and in reactor build order private Map String List Mojo Execution forked Executions new Linked Hash Map public Mojo Execution Plugin plugin String goal String execution Id this plugin plugin this goal goal this execution Id execution Id public Mojo Execution Mojo Descriptor mojo Descriptor this mojo Descriptor mojo Descriptor this execution Id null this configuration null public Mojo Execution Mojo Descriptor mojo Descriptor String execution Id Source source this mojo Descriptor mojo Descriptor this execution Id execution Id this configuration null this source source public Mojo Execution Mojo Descriptor mojo Descriptor String execution Id this mojo Descriptor mojo Descriptor this execution Id execution Id this configuration null public Mojo Execution Mojo Descriptor mojo Descriptor Xpp Dom configuration this mojo Descriptor mojo Descriptor this configuration configuration this execution Id null Gets the source of this execution return The source of this execution or code null if unknown public Source get Source return source public String get Execution Id return execution Id public Plugin get Plugin if mojo Descriptor null return mojo Descriptor get Plugin Descriptor get Plugin return plugin public Mojo Descriptor get Mojo Descriptor return mojo Descriptor public Xpp Dom get Configuration return configuration public void set Configuration Xpp Dom configuration this configuration configuration public String identify String Builder sb new String Builder sb append execution Id sb append configuration to String return sb to String public String get Lifecycle Phase return lifecycle Phase public void set Lifecycle Phase String lifecycle Phase this lifecycle Phase lifecycle Phase Override public String to String String Builder buffer new String Builder if mojo Descriptor null buffer append mojo Descriptor get Id buffer append execution append execution Id append return buffer to String public String get Group Id if mojo Descriptor null return mojo Descriptor get Plugin Descriptor get Group Id return plugin get Group Id public String get Artifact Id if mojo Descriptor null return mojo Descriptor get Plugin Descriptor get Artifact Id return plugin get Artifact Id public String get Version if mojo Descriptor null return mojo Descriptor get Plugin Descriptor get Version return plugin get Version public String get Goal if mojo Descriptor null return mojo Descriptor get Goal return goal public void set Mojo Descriptor Mojo Descriptor mojo Descriptor this mojo Descriptor mojo Descriptor public Map String List Mojo Execution get Forked Executions return forked Executions public void set Forked Executions String project Key List Mojo Execution forked Executions this forked Executions put project Key forked Executions 
package org apache maven plugin descriptor Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License author Jason van Zyl public class Parameter implements Cloneable private String alias private String name private String type private boolean required private boolean editable true private String description private String expression private String deprecated private String default Value private String implementation private Requirement requirement private String since public String get Name return name public void set Name String name this name name public String get Type return type public void set Type String type this type type public boolean is Required return required public void set Required boolean required this required required public String get Description return description public void set Description String description this description description public String get Expression return expression public void set Expression String expression this expression expression public String get Deprecated return deprecated public void set Deprecated String deprecated this deprecated deprecated public int hash Code return name hash Code public boolean equals Object other return other instanceof Parameter get Name equals Parameter other get Name public String get Alias return alias public void set Alias String alias this alias alias public boolean is Editable return editable public void set Editable boolean editable this editable editable public void set Default Value String default Value this default Value default Value public String get Default Value return default Value public String to String return Mojo parameter name get Name alias get Alias public Requirement get Requirement return requirement public void set Requirement Requirement requirement this requirement requirement public String get Implementation return implementation public void set Implementation String implementation this implementation implementation public String get Since return since public void set Since String since this since since Creates a shallow copy of this parameter Override public Parameter clone try return Parameter super clone catch Clone Not Supported Exception e throw new Unsupported Operation Exception e 
package org apache maven plugin descriptor Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import org apache maven artifact Artifact import org apache maven artifact Artifact Utils import org apache maven model Plugin import org apache maven plugin lifecycle Lifecycle import org apache maven plugin lifecycle Lifecycle Configuration import org apache maven plugin lifecycle io xpp Lifecycle Mappings Xpp Reader import org codehaus plexus classworlds realm Class Realm import org codehaus plexus component repository Component Set Descriptor import org codehaus plexus util Reader Factory import org codehaus plexus util xml pull Xml Pull Parser Exception import java io File import java io File Input Stream import java io Exception import java io Input Stream import java io Reader import java net Malformed Exception import java net import java util Collections import java util Hash Map import java util List import java util Map import java util Set author Jason van Zyl public class Plugin Descriptor extends Component Set Descriptor implements Cloneable private static final String maven lifecycle xml private String group Id private String artifact Id private String version private String goal Prefix private String source private boolean inherited By Default true private List Artifact artifacts private Class Realm class Realm calculated on demand private Map String Artifact artifact Map private Set Artifact introduced Dependency Artifacts private String name private String description private String required Maven Version private Plugin plugin private Artifact plugin Artifact private Map String Lifecycle lifecycle Mappings Suppress Warnings unchecked rawtypes public List Mojo Descriptor get Mojos return List get Components public void add Mojo Mojo Descriptor mojo Descriptor throws Duplicate Mojo Descriptor Exception Mojo Descriptor existing null this relies heavily on the equals and hash Code for Component Descriptor which uses role role Hint for identity and role Hint goal Prefix goal role does not vary for Mojos List Mojo Descriptor mojos get Mojos if mojos null mojos contains mojo Descriptor int index Of mojos index Of mojo Descriptor existing mojos get index Of if existing null throw new Duplicate Mojo Descriptor Exception get Goal Prefix mojo Descriptor get Goal existing get Implementation mojo Descriptor get Implementation else add Component Descriptor mojo Descriptor public String get Group Id return group Id public void set Group Id String group Id this group Id group Id public String get Artifact Id return artifact Id public void set Artifact Id String artifact Id this artifact Id artifact Id Dependencies public static String construct Plugin Key String group Id String artifact Id String version return group Id artifact Id version public String get Plugin Lookup Key return group Id artifact Id public String get Id return construct Plugin Key group Id artifact Id version public static String get Default Plugin Artifact Id String id return maven id plugin public static String get Default Plugin Group Id return org apache maven plugins Parse maven plugin move to plugin tools api as a default only public static String get Goal Prefix From Artifact Id String artifact Id if maven plugin plugin equals artifact Id return plugin else return artifact Id replace All maven replace All plugin public String get Goal Prefix return goal Prefix public void set Goal Prefix String goal Prefix this goal Prefix goal Prefix public void set Version String version this version version public String get Version return version public void set Source String source this source source public String get Source return source public boolean is Inherited By Default return inherited By Default public void set Inherited By Default boolean inherited By Default this inherited By Default inherited By Default Gets the artifacts that make up the plugin s class realm excluding artifacts shadowed by the Maven core realm like code maven project return The plugin artifacts never code null public List Artifact get Artifacts return artifacts public void set Artifacts List Artifact artifacts this artifacts artifacts clear the calculated artifact Map artifact Map null The map of artifacts accessible by the versionless Key i e group Id artifact Id return a Map of artifacts never code null see get Artifacts public Map String Artifact get Artifact Map if artifact Map null artifact Map Artifact Utils artifact Map By Versionless Id get Artifacts return artifact Map public boolean equals Object object if this object return true return object instanceof Plugin Descriptor get Id equals Plugin Descriptor object get Id public int hash Code return get Id hash Code public Mojo Descriptor get Mojo String goal if get Mojos null return null no mojo in this could we use a map Maybe if the parent did that for components too as this is too vulnerable to changes above not being propagated to the map for Mojo Descriptor desc get Mojos if goal equals desc get Goal return desc return null public void set Class Realm Class Realm class Realm this class Realm class Realm public Class Realm get Class Realm return class Realm public void set Introduced Dependency Artifacts Set Artifact introduced Dependency Artifacts this introduced Dependency Artifacts introduced Dependency Artifacts public Set Artifact get Introduced Dependency Artifacts return introduced Dependency Artifacts null introduced Dependency Artifacts Collections Artifact empty Set public void set Name String name this name name public String get Name return name public void set Description String description this description description public String get Description return description public void set Required Maven Version String required Maven Version this required Maven Version required Maven Version public String get Required Maven Version return required Maven Version public void set Plugin Plugin plugin this plugin plugin public Plugin get Plugin return plugin public Artifact get Plugin Artifact return plugin Artifact public void set Plugin Artifact Artifact plugin Artifact this plugin Artifact plugin Artifact public Lifecycle get Lifecycle Mapping String lifecycle Id throws Exception Xml Pull Parser Exception if lifecycle Mappings null Lifecycle Configuration lifecycle Configuration try Reader reader Reader Factory new Xml Reader get Descriptor Stream lifecycle Configuration new Lifecycle Mappings Xpp Reader read reader lifecycle Mappings new Hash Map for Lifecycle lifecycle lifecycle Configuration get Lifecycles lifecycle Mappings put lifecycle get Id lifecycle return lifecycle Mappings get lifecycle Id private Input Stream get Descriptor Stream String descriptor throws Exception File plugin File plugin Artifact null plugin Artifact get File null if plugin File null throw new Illegal State Exception plugin main artifact has not been resolved for get Id if plugin File is File try return new jar plugin File to descriptor open Stream catch Malformed Exception e throw new Illegal State Exception e else return new File Input Stream new File plugin File descriptor Creates a shallow copy of this plugin descriptor Override public Plugin Descriptor clone try return Plugin Descriptor super clone catch Clone Not Supported Exception e throw new Unsupported Operation Exception e 
package org apache maven plugin descriptor Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io Exception import java io Reader import java util Array List import java util List import org codehaus plexus component repository Component Dependency import org codehaus plexus component repository Component Requirement import org codehaus plexus configuration Plexus Configuration import org codehaus plexus configuration Plexus Configuration Exception import org codehaus plexus configuration xml Xml Plexus Configuration import org codehaus plexus util xml Xpp Dom Builder import org codehaus plexus util xml pull Xml Pull Parser Exception author Jason van Zyl public class Plugin Descriptor Builder public Plugin Descriptor build Reader reader throws Plexus Configuration Exception return build reader null public Plugin Descriptor build Reader reader String source throws Plexus Configuration Exception Plexus Configuration c build Configuration reader Plugin Descriptor plugin Descriptor new Plugin Descriptor plugin Descriptor set Source source plugin Descriptor set Group Id c get Child group Id get Value plugin Descriptor set Artifact Id c get Child artifact Id get Value plugin Descriptor set Version c get Child version get Value plugin Descriptor set Goal Prefix c get Child goal Prefix get Value plugin Descriptor set Name c get Child name get Value plugin Descriptor set Description c get Child description get Value String isolated Realm c get Child isolated Realm get Value if isolated Realm null plugin Descriptor set Isolated Realm Boolean parse Boolean isolated Realm String inherited By Default c get Child inherited By Default get Value if inherited By Default null plugin Descriptor set Inherited By Default Boolean parse Boolean inherited By Default Components Plexus Configuration mojo Configurations c get Child mojos get Children mojo for Plexus Configuration component mojo Configurations Mojo Descriptor mojo Descriptor build Component Descriptor component plugin Descriptor plugin Descriptor add Mojo mojo Descriptor Dependencies Plexus Configuration dependency Configurations c get Child dependencies get Children dependency List Component Dependency dependencies new Array List for Plexus Configuration d dependency Configurations Component Dependency cd new Component Dependency cd set Artifact Id d get Child artifact Id get Value cd set Group Id d get Child group Id get Value cd set Type d get Child type get Value cd set Version d get Child version get Value dependencies add cd plugin Descriptor set Dependencies dependencies return plugin Descriptor public Mojo Descriptor build Component Descriptor Plexus Configuration c Plugin Descriptor plugin Descriptor throws Plexus Configuration Exception Mojo Descriptor mojo new Mojo Descriptor mojo set Plugin Descriptor plugin Descriptor mojo set Goal c get Child goal get Value mojo set Implementation c get Child implementation get Value Plexus Configuration lang Config c get Child language if lang Config null mojo set Language lang Config get Value Plexus Configuration configurator Config c get Child configurator if configurator Config null mojo set Component Configurator configurator Config get Value Plexus Configuration composer Config c get Child composer if composer Config null mojo set Component Composer composer Config get Value String since c get Child since get Value if since null mojo set Since since Plexus Configuration deprecated c get Child deprecated false if deprecated null mojo set Deprecated deprecated get Value String phase c get Child phase get Value if phase null mojo set Phase phase String execute Phase c get Child execute Phase get Value if execute Phase null mojo set Execute Phase execute Phase String execute Mojo c get Child execute Goal get Value if execute Mojo null mojo set Execute Goal execute Mojo String execute Lifecycle c get Child execute Lifecycle get Value if execute Lifecycle null mojo set Execute Lifecycle execute Lifecycle mojo set Instantiation Strategy c get Child instantiation Strategy get Value mojo set Description c get Child description get Value Plexus Configuration dependency Resolution c get Child requires Dependency Resolution false if dependency Resolution null mojo set Dependency Resolution Required dependency Resolution get Value Plexus Configuration dependency Collection c get Child requires Dependency Collection false if dependency Collection null mojo set Dependency Collection Required dependency Collection get Value String direct Invocation Only c get Child requires Direct Invocation get Value if direct Invocation Only null mojo set Direct Invocation Only Boolean parse Boolean direct Invocation Only String requires Project c get Child requires Project get Value if requires Project null mojo set Project Required Boolean parse Boolean requires Project String requires Reports c get Child requires Reports get Value if requires Reports null mojo set Requires Reports Boolean parse Boolean requires Reports String aggregator c get Child aggregator get Value if aggregator null mojo set Aggregator Boolean parse Boolean aggregator String requires Online c get Child requires Online get Value if requires Online null mojo set Online Required Boolean parse Boolean requires Online String inherited By Default c get Child inherited By Default get Value if inherited By Default null mojo set Inherited By Default Boolean parse Boolean inherited By Default String thread Safe c get Child thread Safe get Value if thread Safe null mojo set Thread Safe Boolean parse Boolean thread Safe Configuration Plexus Configuration mojo Config c get Child configuration mojo set Mojo Configuration mojo Config Parameters Plexus Configuration parameter Configurations c get Child parameters get Children parameter List Parameter parameters new Array List for Plexus Configuration d parameter Configurations Parameter parameter new Parameter parameter set Name d get Child name get Value parameter set Alias d get Child alias get Value parameter set Type d get Child type get Value String required d get Child required get Value parameter set Required Boolean parse Boolean required Plexus Configuration editable Config d get Child editable we need the null check for pre build legacy plugins if editable Config null String editable d get Child editable get Value parameter set Editable editable null Boolean parse Boolean editable parameter set Description d get Child description get Value parameter set Deprecated d get Child deprecated get Value parameter set Implementation d get Child implementation get Value parameter set Since d get Child since get Value Plexus Configuration param Config mojo Config get Child parameter get Name false if param Config null parameter set Expression param Config get Value null parameter set Default Value param Config get Attribute default value parameters add parameter mojo set Parameters parameters this should not need to be handed off Requirements Plexus Configuration requirements c get Child requirements get Children requirement for Plexus Configuration requirement requirements Component Requirement cr new Component Requirement cr set Role requirement get Child role get Value cr set Role Hint requirement get Child role hint get Value cr set Field Name requirement get Child field name get Value mojo add Requirement cr return mojo public Plexus Configuration build Configuration Reader configuration throws Plexus Configuration Exception try return new Xml Plexus Configuration Xpp Dom Builder build configuration catch Exception Xml Pull Parser Exception e throw new Plexus Configuration Exception e get Message e 
package org apache maven plugin Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io File import java util Properties import org apache maven execution Maven Session import org apache maven plugin descriptor Mojo Descriptor import org apache maven plugin descriptor Plugin Descriptor import org apache maven project Maven Project import org apache maven project path Path Translator import org codehaus plexus component configurator expression Expression Evaluation Exception import org codehaus plexus component configurator expression Type Aware Expression Evaluator import org codehaus plexus logging Logger import org codehaus plexus util introspection Reflection Value Extractor Evaluator for plugin parameters expressions Content surrounded by code code and code code is evaluated Recognized values are table border summary Expression matrix tr th expression th th th th evaluation result th tr tr td code session code td td td td the actual link Maven Session td tr tr td code session code td td since Maven td td td tr tr td code local Repository code td td td td link Maven Session get Local Repository td tr tr td code reactor Projects code td td td td link Maven Session get Projects td tr tr td code repository System Session code td td since Maven td td link Maven Session get Repository Session td tr tr td code project code td td td td link Maven Session get Current Project td tr tr td code project code td td td td td tr tr td code pom code td td since Maven td td same as code project code td tr tr td code executed Project code td td td td link Maven Project get Execution Project td tr tr td code settings code td td td td link Maven Session get Settings td tr tr td code settings code td td td td td tr tr td code basedir code td td td td link Maven Session get Execution Root Directory or code System get Property user dir code if null td tr tr td code mojo Execution code td td td td the actual link Mojo Execution td tr tr td code mojo code td td since Maven td td same as code mojo Execution code td tr tr td code mojo code td td since Maven td td td tr tr td code plugin code td td since Maven td td link Mojo Execution get Mojo Descriptor link Mojo Descriptor get Plugin Descriptor get Plugin Descriptor td tr tr td code plugin code td td td td td tr tr td code code td td td td system properties td tr tr td code code td td td td project properties td tr table i Notice i code reports code was supported in Maven x but was removed in Maven author Jason van Zyl see Maven Session see Mojo Execution public class Plugin Parameter Expression Evaluator implements Type Aware Expression Evaluator private Maven Session session private Mojo Execution mojo Execution private Maven Project project private String basedir private Properties properties Deprecated used by the Enforcer plugin public Plugin Parameter Expression Evaluator Maven Session session Mojo Execution mojo Execution Path Translator path Translator Logger logger Maven Project project Properties properties this session mojo Execution public Plugin Parameter Expression Evaluator Maven Session session this session null public Plugin Parameter Expression Evaluator Maven Session session Mojo Execution mojo Execution this session session this mojo Execution mojo Execution this properties new Properties this project session get Current Project Maven We may want to evaluate how this is used but we add these separate as the get Execution Properties is deprecated in Maven Session this properties put All session get User Properties this properties put All session get System Properties String basedir null if project null File project File project get Basedir this should always be the case for non super instances if project File null basedir project File get Absolute Path if basedir null basedir session get Execution Root Directory if basedir null basedir System get Property user dir this basedir basedir Override public Object evaluate String expr throws Expression Evaluation Exception return evaluate expr null Override public Object evaluate String expr Class type throws Expression Evaluation Exception Object value null if expr null return null String expression strip Tokens expr if expression equals expr int index expr index Of if index int last Index expr index Of index if last Index String ret Val expr substring index if index expr char At index ret Val expr substring index last Index else Object sub Result evaluate expr substring index last Index if sub Result null ret Val sub Result else ret Val expr substring index last Index ret Val evaluate expr substring last Index return ret Val Was not an expression if expression contains return expression replace All else return expression Mojo Descriptor mojo Descriptor mojo Execution get Mojo Descriptor if local Repository equals expression value session get Local Repository else if session equals expression value session else if expression starts With session try int path Separator expression index Of if path Separator String path Expression expression substring path Separator value Reflection Value Extractor evaluate path Expression session value value expression substring path Separator else value Reflection Value Extractor evaluate expression substring session catch Exception e do n t catch exception throw new Expression Evaluation Exception Error evaluating plugin parameter expression expression e else if reactor Projects equals expression value session get Projects else if mojo Execution equals expression value mojo Execution else if project equals expression value project else if executed Project equals expression value project get Execution Project else if expression starts With project expression starts With pom try int path Separator expression index Of if path Separator String path Expression expression substring path Separator value Reflection Value Extractor evaluate path Expression project value value expression substring path Separator else value Reflection Value Extractor evaluate expression substring project catch Exception e do n t catch exception throw new Expression Evaluation Exception Error evaluating plugin parameter expression expression e else if expression equals repository System Session value session get Repository Session else if expression equals mojo value mojo Execution else if expression starts With mojo try int path Separator expression index Of if path Separator String path Expression expression substring path Separator value Reflection Value Extractor evaluate path Expression mojo Execution value value expression substring path Separator else value Reflection Value Extractor evaluate expression substring mojo Execution catch Exception e do n t catch exception throw new Expression Evaluation Exception Error evaluating plugin parameter expression expression e else if expression equals plugin value mojo Descriptor get Plugin Descriptor else if expression starts With plugin try int path Separator expression index Of Plugin Descriptor plugin Descriptor mojo Descriptor get Plugin Descriptor if path Separator String path Expression expression substring path Separator value Reflection Value Extractor evaluate path Expression plugin Descriptor value value expression substring path Separator else value Reflection Value Extractor evaluate expression substring plugin Descriptor catch Exception e throw new Expression Evaluation Exception Error evaluating plugin parameter expression expression e else if settings equals expression value session get Settings else if expression starts With settings try int path Separator expression index Of if path Separator String path Expression expression substring path Separator value Reflection Value Extractor evaluate path Expression session get Settings value value expression substring path Separator else value Reflection Value Extractor evaluate expression substring session get Settings catch Exception e do n t catch exception throw new Expression Evaluation Exception Error evaluating plugin parameter expression expression e else if basedir equals expression value basedir else if expression starts With basedir int path Separator expression index Of if path Separator value basedir expression substring path Separator We neither have reserved all of the above magic expressions nor is their set fixed well known it gets occasionally extended by newer Maven versions This imposes the risk for existing plugins to unintentionally use such a magic expression for an ordinary system property So here we check whether we ended up with a magic value that is not compatible with the type of the configured mojo parameter a string could still be converted by the configurator so we leave those alone If so back off to evaluating the expression from properties only if value null type null value instanceof String is Type Compatible type value value null if value null The should win for defining properties if properties null We will attempt to get nab a system property as a way to specify a parameter to a plugins My particular case here is allowing the surefire plugin to run a single test so want to specify that class on the cli as a parameter value properties get Property expression if value null project null project get Properties null value project get Properties get Property expression if value instanceof String without this could just be an evaluate call String val String value int expr Start Delimiter val index Of if expr Start Delimiter if expr Start Delimiter value val substring expr Start Delimiter evaluate val substring expr Start Delimiter else value evaluate val substring expr Start Delimiter return value private static boolean is Type Compatible Class type Object value if type is Instance value return true likely Boolean boolean Short int etc conversions it s not the problem case we try to avoid return type is Primitive type get Name starts With java lang value get Class get Name starts With java lang private String strip Tokens String expr if expr starts With expr index Of expr length expr expr substring expr length return expr Override public File align To Base Directory File file Copied from the Default Interpolator We likely want to resurrect the Path Translator or at least a similar component for re usage if file null if file is Absolute path was already absolute just normalize file separator and we re done else if file get Path starts With File separator drive relative Windows path do n t align with project directory but with drive root file file get Absolute File else an ordinary relative path align with project directory file new File new File basedir file get Path to normalize get Absolute File return file 
package org apache maven model interpolation Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util List import org apache maven model building Model Problem Collector import org apache maven model building Model Problem Severity import org apache maven model building Model Problem Version import org apache maven model building Model Problem Collector Request import org codehaus plexus interpolation Value Source Wraps another value source and intercepts interpolated expressions checking for problems author Benjamin Bentmann class Problem Detecting Value Source implements Value Source private final Value Source value Source private final String banned Prefix private final String new Prefix private final Model Problem Collector problems public Problem Detecting Value Source Value Source value Source String banned Prefix String new Prefix Model Problem Collector problems this value Source value Source this banned Prefix banned Prefix this new Prefix new Prefix this problems problems Override public Object get Value String expression Object value value Source get Value expression if value null expression starts With banned Prefix String msg The expression expression is deprecated if new Prefix null new Prefix length msg Please use new Prefix expression substring banned Prefix length instead problems add new Model Problem Collector Request Severity Version set Message msg return value Override Suppress Warnings unchecked public List get Feedback return value Source get Feedback Override public void clear Feedback value Source clear Feedback 
package org apache maven project Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util Date import java util List import java util Properties import org apache maven artifact repository Artifact Repository import org apache maven model Profile import org eclipse aether Repository System Session public interface Project Building Request Project Building Request set Local Repository Artifact Repository local Repository Artifact Repository get Local Repository Project Building Request set Remote Repositories List Artifact Repository remote Repositories List Artifact Repository get Remote Repositories Project Building Request set Plugin Artifact Repositories List Artifact Repository plugin Artifact Repositories List Artifact Repository get Plugin Artifact Repositories Sets the system properties to use for interpolation and profile activation The system properties are collected from the runtime environment like link System get Properties and environment variables param system Properties The system properties may be code null return This request never code null Project Building Request set System Properties Properties system Properties Gets the system properties to use for interpolation and profile activation The system properties are collected from the runtime environment like link System get Properties and environment variables return The system properties never code null Properties get System Properties Sets the user properties to use for interpolation and profile activation The user properties have been configured directly by the user on his discretion e g via the code Dkey value parameter on the command line param user Properties The user properties may be code null return This request never code null Project Building Request set User Properties Properties user Properties Gets the user properties to use for interpolation and profile activation The user properties have been configured directly by the user on his discretion e g via the code Dkey value parameter on the command line return The user properties never code null Properties get User Properties void set Project Maven Project maven Project Maven Project get Project Project Building Request set Process Plugins boolean process Plugins boolean is Process Plugins Project Building Request set Resolve Dependencies boolean resolve Dependencies boolean is Resolve Dependencies Controls the level of validation to perform on processed models By default models are validated in strict mode param validation Level The level of validation to perform on processed models e g link org apache maven model building Model Building Request return This configuration never code null Project Building Request set Validation Level int validation Level Gets the level of validation to perform on processed models return The level of validation to perform on processed models int get Validation Level Profiles Set any active profiles that the link Project Builder should consider while constructing a link Maven Project void set Active Profile Ids List String active Profile Ids List String get Active Profile Ids void set Inactive Profile Ids List String inactive Profile Ids List String get Inactive Profile Ids Add a link org apache maven model Profile that has come from an external source This may be from a custom configuration like the Maven settings xml file or from a custom dialog in an integration like Eclipse param profile void add Profile Profile profile void set Profiles List Profile profiles List Profile get Profiles Gets the start time of the build return The start time of the build or code null if unknown Date get Build Start Time Sets the start time of the build param build Start Time The start time of the build may be code null void set Build Start Time Date build Start Time Repository System Session get Repository Session Project Building Request set Repository Session Repository System Session repository Session Sets the merge mode used to combine repositories declared in the with the repositories specified in this request param mode The repository merge mode must not be code null return This request for chaining never code null see set Remote Repositories List Project Building Request set Repository Merging Repository Merging mode Gets the merge mode used to combine repositories declared in the with the repositories specified in this request return The merge mode never code null Repository Merging get Repository Merging since deprecated This got added when implementing and is no longer used Commit cf c bc ab b ace ba updated the way Maven Project objects are initialized Deprecated boolean is Resolve Version Ranges since deprecated This got added when implementing and is no longer used Commit cf c bc ab b ace ba updated the way Maven Project objects are initialized Deprecated Project Building Request set Resolve Version Ranges boolean value The possible merge modes for combining remote repositories enum Repository Merging The repositories declared in the have precedence over the repositories specified in the request The repositories specified in the request have precedence over the repositories declared in the 
package org apache maven project Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util List import org codehaus plexus classworlds realm Class Realm import org eclipse aether graph Dependency Filter Caches project class realms strong Warning strong This is an internal utility interface that is only public for technical reasons it is not part of the public In particular this interface can be changed or deleted without prior notice author Igor Fedorenko author Benjamin Bentmann public interface Project Realm Cache cache key interface Key marker interface for cache keys static class Cache Record public final Class Realm realm public final Dependency Filter extension Artifact Filter public Cache Record Class Realm realm Dependency Filter extension Artifact Filter this realm realm this extension Artifact Filter extension Artifact Filter Key create Key List extends Class Realm extension Realms Cache Record get Key key Cache Record put Key key Class Realm project Realm Dependency Filter extension Artifact Filter void flush Registers the specified cache record for usage with the given project Integrators can use the information collected from this method in combination with a custom cache implementation to dispose unused records from the cache param project The project that employs the plugin realm must not be code null param record The cache record being used for the project must not be code null void register Maven Project project Key key Cache Record record 
package org apache maven project Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util Array List import java util Collection import java util Collections import java util Hash Map import java util Iterator import java util List import java util Map import org apache maven artifact Artifact Utils import org apache maven model Dependency import org apache maven model Extension import org apache maven model Parent import org apache maven model Plugin import org codehaus plexus util String Utils import org codehaus plexus util dag Cycle Detected Exception import org codehaus plexus util dag import org codehaus plexus util dag Topological Sorter import org codehaus plexus util dag Vertex public class Project Sorter private dag private List Maven Project sorted Projects private Map String Maven Project project Map private Maven Project top Level Project Sort a list of projects ul li collect all the vertices for the projects that we want to build li li iterate through the deps of each project and if that dep is within the set of projects we want to build then add an edge otherwise throw the edge away because that dependency is not within the set of projects we are trying to build we assume a closed set li li do a topo sort on the graph that remains li ul throws Duplicate Project Exception if any projects are duplicated by id the used is only used to represent the dependency relation but also for parent build plugin reports We need multiple s since a can only handle type of relationship properly Usecase This is detected as a cycle org apache maven maven plugin api org apache maven maven inherited org apache maven plugins maven checkstyle plugin org apache maven maven plugin api In this case both the verify and the report goals are called in a different lifecycle Though the compiler plugin has a valid usecase although that seems to work fine We need to take versions and lifecycle into account public Project Sorter Collection Maven Project projects throws Cycle Detected Exception Duplicate Project Exception dag new group Id artifact Id version project project Map new Hash Map projects size group Id artifact Id version vertex Map String Map String Vertex vertex Map new Hash Map projects size for Maven Project project projects String project Id get Id project Maven Project conflicting Project project Map put project Id project if conflicting Project null throw new Duplicate Project Exception project Id conflicting Project get File project get File Project project Id is duplicated in the reactor String project Key Artifact Utils versionless Key project get Group Id project get Artifact Id Map String Vertex vertices vertex Map get project Key if vertices null vertices new Hash Map vertex Map put project Key vertices vertices put project get Version dag add Vertex project Id for Vertex project Vertex dag get Verticies String project Id project Vertex get Label Maven Project project project Map get project Id for Dependency dependency project get Dependencies add Edge project Map vertex Map project project Vertex dependency get Group Id dependency get Artifact Id dependency get Version false false Parent parent project get Model get Parent if parent null Parent is added as an edge but must not cause a cycle so we remove any other edges it has in conflict add Edge project Map vertex Map null project Vertex parent get Group Id parent get Artifact Id parent get Version true false List Plugin build Plugins project get Build Plugins if build Plugins null for Plugin plugin build Plugins add Edge project Map vertex Map project project Vertex plugin get Group Id plugin get Artifact Id plugin get Version false true for Dependency dependency plugin get Dependencies add Edge project Map vertex Map project project Vertex dependency get Group Id dependency get Artifact Id dependency get Version false true List Extension build Extensions project get Build Extensions if build Extensions null for Extension extension build Extensions add Edge project Map vertex Map project project Vertex extension get Group Id extension get Artifact Id extension get Version false true List Maven Project sorted Projects new Array List projects size List String sorted Project Labels Topological Sorter sort dag for String id sorted Project Labels sorted Projects add project Map get id this sorted Projects Collections unmodifiable List sorted Projects private void add Edge Map String Maven Project project Map Map String Map String Vertex vertex Map Maven Project project Vertex project Vertex String group Id String artifact Id String version boolean force boolean safe throws Cycle Detected Exception String project Key Artifact Utils versionless Key group Id artifact Id Map String Vertex vertices vertex Map get project Key if vertices null if is Specific Version version Vertex vertex vertices get version if vertex null add Edge project Vertex vertex project project Map force safe else for Vertex vertex vertices values add Edge project Vertex vertex project project Map force safe private void add Edge Vertex from Vertex Vertex to Vertex Maven Project from Project Map String Maven Project project Map boolean force boolean safe throws Cycle Detected Exception if from Vertex equals to Vertex return if from Project null Maven Project to Project project Map get to Vertex get Label from Project add Project Reference to Project if force to Vertex get Children contains from Vertex dag remove Edge to Vertex from Vertex try dag add Edge from Vertex to Vertex catch Cycle Detected Exception e if safe throw e private boolean is Specific Version String version return String Utils is Empty version version starts With version starts With jc jul check this if we re using r and there are aggregator tasks this will result in weirdness public Maven Project get Top Level Project if top Level Project null for Iterator Maven Project i sorted Projects iterator i has Next top Level Project null Maven Project project i next if project is Execution Root top Level Project project return top Level Project public List Maven Project get Sorted Projects return sorted Projects public boolean has Multiple Projects return sorted Projects size public List String get Dependents String id return dag get Parent Labels id public List String get Dependencies String id return dag get Child Labels id public static String get Id Maven Project project return Artifact Utils key project get Group Id project get Artifact Id project get Version public get return dag public Map String Maven Project get Project Map return project Map 
package org apache maven model profile activation Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import org apache maven model Activation import org apache maven model Activation Property import org apache maven model Profile import org apache maven model building Model Problem Collector import org apache maven model building Model Problem Severity import org apache maven model building Model Problem Version import org apache maven model building Model Problem Collector Request import org apache maven model profile Profile Activation Context import org codehaus plexus component annotations Component import org codehaus plexus util String Utils Determines profile activation based on the existence or value of some execution property author Benjamin Bentmann see Activation Property Component role Profile Activator class hint property public class Property Profile Activator implements Profile Activator Override public boolean is Active Profile profile Profile Activation Context context Model Problem Collector problems Activation activation profile get Activation if activation null return false Activation Property property activation get Property if property null return false String name property get Name boolean reverse Name false if name null name starts With reverse Name true name name substring if name null name length problems add new Model Problem Collector Request Severity Version set Message The property name is required to activate the profile profile get Id set Location property get Location return false String sys Value context get User Properties get name if sys Value null sys Value context get System Properties get name String prop Value property get Value if String Utils is Not Empty prop Value boolean reverse Value false if prop Value starts With reverse Value true prop Value prop Value substring we have a value so it has to match the system value boolean result prop Value equals sys Value return reverse Value result result else boolean result String Utils is Not Empty sys Value return reverse Name result result Override public boolean present In Config Profile profile Profile Activation Context context Model Problem Collector problems Activation activation profile get Activation if activation null return false Activation Property property activation get Property if property null return false return true 
package org apache maven artifact resolver Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util Array List import java util Collections import java util Iterator import java util Linked List import java util List import java util Set import org apache maven artifact Artifact import org apache maven artifact repository Artifact Repository import org apache maven artifact resolver filter Artifact Filter import org apache maven artifact versioning Artifact Version import org apache maven artifact versioning Over Constrained Version Exception public class Resolution Node private Artifact artifact private List Resolution Node children private final List Object parents private final int depth private final Resolution Node parent private final List Artifact Repository remote Repositories private boolean active true private List Artifact trail public Resolution Node Artifact artifact List Artifact Repository remote Repositories this artifact artifact this remote Repositories remote Repositories depth parents Collections empty List parent null public Resolution Node Artifact artifact List Artifact Repository remote Repositories Resolution Node parent this artifact artifact this remote Repositories remote Repositories depth parent depth parents new Array List parents add All parent parents parents add parent get Key this parent parent public Artifact get Artifact return artifact public Object get Key return artifact get Dependency Conflict Id public void add Dependencies Set Artifact artifacts List Artifact Repository remote Repositories Artifact Filter filter throws Cyclic Dependency Exception Over Constrained Version Exception if artifacts null artifacts is Empty children new Array List artifacts size for Artifact a artifacts if parents contains a get Dependency Conflict Id a set Dependency Trail get Dependency Trail throw new Cyclic Dependency Exception dependency has introduced a cycle a children add new Resolution Node a remote Repositories this else children Collections empty List trail null return link List lt link String gt with artifact ids throws Over Constrained Version Exception public List String get Dependency Trail throws Over Constrained Version Exception List Artifact trial get Trail List String ret new Array List trial size for Artifact artifact trial ret add artifact get Id return ret private List Artifact get Trail throws Over Constrained Version Exception if trail null List Artifact ids new Linked List Resolution Node node this while node null Artifact artifact node get Artifact if artifact get Version null set the recommended version Artifact Version selected artifact get Selected Version null is a valid response to get Selected Version do n t assume it wo n t ever be if selected null artifact select Version selected to String else throw new Over Constrained Version Exception Unable to get a selected Version for artifact get Artifact Id artifact ids add artifact node node parent trail ids return trail public boolean is Resolved return children null Test whether the node is direct or transitive dependency public boolean is Child Of Root Node return parent null parent parent null public Iterator Resolution Node get Children Iterator return children iterator public int get Depth return depth public List Artifact Repository get Remote Repositories return remote Repositories public boolean is Active return active public void enable active true if it was null we really need to go find them now or is this taken care of by the ordering if children null for Resolution Node node children node enable public void disable active false if children null for Resolution Node node children node disable public boolean filter Trail Artifact Filter filter throws Over Constrained Version Exception boolean success true if filter null for Artifact artifact get Trail if filter include artifact success false return success Override public String to String return artifact to String depth active enabled disabled public void set Artifact Artifact artifact this artifact artifact 
package org apache maven artifact versioning Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License Describes a restriction in versioning author a href mailto brett apache org Brett Porter a public class Restriction private final Artifact Version lower Bound private final boolean lower Bound Inclusive private final Artifact Version upper Bound private final boolean upper Bound Inclusive public static final Restriction new Restriction null false null false public Restriction Artifact Version lower Bound boolean lower Bound Inclusive Artifact Version upper Bound boolean upper Bound Inclusive this lower Bound lower Bound this lower Bound Inclusive lower Bound Inclusive this upper Bound upper Bound this upper Bound Inclusive upper Bound Inclusive public Artifact Version get Lower Bound return lower Bound public boolean is Lower Bound Inclusive return lower Bound Inclusive public Artifact Version get Upper Bound return upper Bound public boolean is Upper Bound Inclusive return upper Bound Inclusive public boolean contains Version Artifact Version version if lower Bound null int comparison lower Bound compare To version if comparison lower Bound Inclusive return false if comparison return false if upper Bound null int comparison upper Bound compare To version if comparison upper Bound Inclusive return false if comparison return false return true Override public int hash Code int result if lower Bound null result else result lower Bound hash Code result lower Bound Inclusive if upper Bound null result else result upper Bound hash Code result upper Bound Inclusive return result Override public boolean equals Object other if this other return true if other instanceof Restriction return false Restriction restriction Restriction other if lower Bound null if lower Bound equals restriction lower Bound return false else if restriction lower Bound null return false if lower Bound Inclusive restriction lower Bound Inclusive return false if upper Bound null if upper Bound equals restriction upper Bound return false else if restriction upper Bound null return false return upper Bound Inclusive restriction upper Bound Inclusive public String to String String Builder buf new String Builder buf append is Lower Bound Inclusive if get Lower Bound null buf append get Lower Bound to String buf append if get Upper Bound null buf append get Upper Bound to String buf append is Upper Bound Inclusive return buf to String 
package org apache maven artifact resolver filter Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License Filter to only retain objects in the given artifact Scope or better author a href mailto brett apache org Brett Porter a public class Scope Artifact Filter extends Abstract Scope Artifact Filter private final String scope public Scope Artifact Filter String scope this scope scope add Scope Internal scope public String get Scope return scope Override public int hash Code int hash hash hash scope null scope hash Code return hash Override public boolean equals Object obj if this obj return true if obj instanceof Scope Artifact Filter return false Scope Artifact Filter other Scope Artifact Filter obj return equals scope other scope private static boolean equals str str return str null str equals str str null 
package org apache maven cli configuration Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java io File import java io File Not Found Exception import java util List import org apache commons cli Command Line import org apache maven artifact Invalid Repository Exception import org apache maven bridge Maven Repository System import org apache maven building Source import org apache maven cli Manager import org apache maven cli Cli Request import org apache maven execution Maven Execution Request import org apache maven execution Maven Execution Request Population Exception import org apache maven settings Mirror import org apache maven settings Proxy import org apache maven settings Repository import org apache maven settings Server import org apache maven settings Settings import org apache maven settings Settings Utils import org apache maven settings building Default Settings Building Request import org apache maven settings building Settings Builder import org apache maven settings building Settings Building Request import org apache maven settings building Settings Building Result import org apache maven settings building Settings Problem import org apache maven settings crypto Settings Decrypter import org codehaus plexus component annotations Component import org codehaus plexus component annotations Requirement import org slf j Logger Component role Configuration Processor class hint Settings Xml Configuration Processor public class Settings Xml Configuration Processor implements Configuration Processor public static final String settings public static final String System get Property user home public static final File new File m public static final File new File settings xml public static final File new File System get Property maven conf settings xml Requirement private Logger logger Requirement private Settings Builder settings Builder Requirement private Settings Decrypter settings Decrypter Override public void process Cli Request cli Request throws Exception Command Line command Line cli Request get Command Line String working Directory cli Request get Working Directory Maven Execution Request request cli Request get Request File user Settings File if command Line has Option Manager user Settings File new File command Line get Option Value Manager user Settings File resolve File user Settings File working Directory if user Settings File is File throw new File Not Found Exception The specified user settings file does not exist user Settings File else user Settings File File global Settings File if command Line has Option Manager global Settings File new File command Line get Option Value Manager global Settings File resolve File global Settings File working Directory if global Settings File is File throw new File Not Found Exception The specified global settings file does not exist global Settings File else global Settings File request set Global Settings File global Settings File request set User Settings File user Settings File Settings Building Request settings Request new Default Settings Building Request settings Request set Global Settings File global Settings File settings Request set User Settings File user Settings File settings Request set System Properties cli Request get System Properties settings Request set User Properties cli Request get User Properties if request get Event Spy Dispatcher null request get Event Spy Dispatcher on Event settings Request logger debug Reading global settings from get Location settings Request get Global Settings Source settings Request get Global Settings File logger debug Reading user settings from get Location settings Request get User Settings Source settings Request get User Settings File Settings Building Result settings Result settings Builder build settings Request if request get Event Spy Dispatcher null request get Event Spy Dispatcher on Event settings Result populate From Settings request settings Result get Effective Settings if settings Result get Problems is Empty logger is Warn Enabled logger warn logger warn Some problems were encountered while building the effective settings for Settings Problem problem settings Result get Problems logger warn problem get Message problem get Location logger warn private Maven Execution Request populate From Settings Maven Execution Request request Settings settings throws Maven Execution Request Population Exception if settings null return request request set Offline settings is Offline request set Interactive Mode settings is Interactive Mode request set Plugin Groups settings get Plugin Groups request set Local Repository Path settings get Local Repository for Server server settings get Servers server server clone request add Server server proxies proxy active true active protocol http protocol host proxy somewhere com host port port username proxyuser username password somepassword password non Proxy Hosts www google com somewhere com non Proxy Hosts proxy proxies for Proxy proxy settings get Proxies if proxy is Active continue proxy proxy clone request add Proxy proxy mirrors mirror id nexus id mirror Of mirror Of url http repository sonatype org content groups public url mirror mirrors for Mirror mirror settings get Mirrors mirror mirror clone request add Mirror mirror request set Active Profiles settings get Active Profiles for org apache maven settings Profile raw Profile settings get Profiles request add Profile Settings Utils convert From Settings Profile raw Profile if settings get Active Profiles contains raw Profile get Id List Repository remote Repositories raw Profile get Repositories for Repository remote Repository remote Repositories try request add Remote Repository Maven Repository System build Artifact Repository remote Repository catch Invalid Repository Exception e do nothing for now List Repository plugin Repositories raw Profile get Plugin Repositories for Repository plugin Repository plugin Repositories try request add Plugin Artifact Repository Maven Repository System build Artifact Repository plugin Repository catch Invalid Repository Exception e do nothing for now return request private Object get Location Source source File default Location if source null return source get Location return default Location static File resolve File File file String working Directory if file null return null else if file is Absolute return file else if file get Path starts With File separator drive relative Windows path return file get Absolute File else return new File working Directory file get Path get Absolute File 
package org apache maven model interpolation Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import org apache maven model Model import org apache maven model building Model Building Request import org apache maven model building Model Problem Severity import org apache maven model building Model Problem Version import org apache maven model building Model Problem Collector import org apache maven model building Model Problem Collector Request import org codehaus plexus component annotations Component import org codehaus plexus interpolation Interpolation Post Processor import org codehaus plexus interpolation Interpolator import org codehaus plexus interpolation String Search Interpolator import org codehaus plexus interpolation Value Source import java io File import java lang reflect Array import java lang reflect Field import java lang reflect Modifier import java security Access Controller import java security Privileged Action import java util Array List import java util Collection import java util Linked List import java util List import java util Map import java util concurrent Concurrent Hash Map Component role Model Interpolator class public class String Search Model Interpolator extends Abstract String Based Model Interpolator private static final Map Class Interpolate Object Action Cache Item new Concurrent Hash Map f Empirical data from x actual Override public Model interpolate Model Model model File project Dir Model Building Request config Model Problem Collector problems interpolate Object model model project Dir config problems return model protected void interpolate Object Object obj Model model File project Dir Model Building Request config Model Problem Collector problems try List extends Value Source value Sources create Value Sources model project Dir config problems List extends Interpolation Post Processor post Processors create Post Processors model project Dir config Interpolate Object Action action new Interpolate Object Action obj value Sources post Processors this problems Access Controller do Privileged action finally get Interpolator clear Answers Override protected Interpolator create Interpolator String Search Interpolator interpolator new String Search Interpolator interpolator set Cache Answers true return interpolator private static final class Interpolate Object Action implements Privileged Action Object private final Linked List Object interpolation Targets private final String Search Model Interpolator model Interpolator private final List extends Value Source value Sources private final List extends Interpolation Post Processor post Processors private final Model Problem Collector problems public Interpolate Object Action Object target List extends Value Source value Sources List extends Interpolation Post Processor post Processors String Search Model Interpolator model Interpolator Model Problem Collector problems this value Sources value Sources this post Processors post Processors this interpolation Targets new Linked List interpolation Targets add target this model Interpolator model Interpolator this problems problems Override public Object run while interpolation Targets is Empty Object obj interpolation Targets remove First traverse Object With Parents obj get Class obj return null private String interpolate String value return model Interpolator interpolate Internal value value Sources post Processors problems private void traverse Object With Parents Class cls Object target if cls null return Cache Item cache Entry get Cache Entry cls if cache Entry is Array evaluate Array target this else if cache Entry is Qualified For Interpolation cache Entry interpolate target this traverse Object With Parents cls get Superclass target private Cache Item get Cache Entry Class cls Cache Item cache Item get cls if cache Item null cache Item new Cache Item cls put cls cache Item return cache Item private static void evaluate Array Object target Interpolate Object Action ctx int len Array get Length target for int i i len i Object value Array get target i if value null if String class value get Class String interpolated ctx interpolate String value if interpolated equals value Array set target i interpolated else ctx interpolation Targets add value private static class Cache Item private final boolean is Array private final boolean is Qualified For Interpolation private final Cache Field fields private boolean is Qualified For Interpolation Class cls return cls get Name starts With java private boolean is Qualified For Interpolation Field field Class field Type if Map class equals field Type locations equals field get Name return false noinspection Simplifiable If Statement if field Type is Primitive return false return parent equals field get Name Cache Item Class clazz this is Qualified For Interpolation is Qualified For Interpolation clazz this is Array clazz is Array List Cache Field fields new Array List for Field current Field clazz get Declared Fields Class type current Field get Type if is Qualified For Interpolation current Field type if String class type if Modifier is Final current Field get Modifiers fields add new String Field current Field else if List class is Assignable From type fields add new List Field current Field else if Collection class is Assignable From type throw new Runtime Exception We dont interpolate into collections use a list instead else if Map class is Assignable From type fields add new Map Field current Field else fields add new Object Field current Field this fields fields to Array new Cache Field fields size public void interpolate Object target Interpolate Object Action interpolate Object Action for Cache Field field fields field interpolate target interpolate Object Action public boolean is Array return is Array abstract static class Cache Field protected final Field field Cache Field Field field this field field void interpolate Object target Interpolate Object Action interpolate Object Action synchronized field boolean is Accessible field is Accessible field set Accessible true try do Interpolate target interpolate Object Action catch Illegal Argument Exception e interpolate Object Action problems add new Model Problem Collector Request Severity Version set Message Failed to interpolate field field on class field get Type get Name set Exception e Not entirely the same message catch Illegal Access Exception e interpolate Object Action problems add new Model Problem Collector Request Severity Version set Message Failed to interpolate field field on class field get Type get Name set Exception e finally field set Accessible is Accessible abstract void do Interpolate Object target Interpolate Object Action ctx throws Illegal Access Exception static final class String Field extends Cache Field String Field Field field super field Override void do Interpolate Object target Interpolate Object Action ctx throws Illegal Access Exception String value String field get target if value null return String interpolated ctx interpolate value if interpolated equals value field set target interpolated static final class List Field extends Cache Field List Field Field field super field Override void do Interpolate Object target Interpolate Object Action ctx throws Illegal Access Exception Suppress Warnings unchecked List Object c List Object field get target if c null return int size c size Object value for int i i size i value c get i if value null if String class value get Class String interpolated ctx interpolate String value if interpolated equals value try c set i interpolated catch Unsupported Operation Exception e return else if value get Class is Array evaluate Array value ctx else ctx interpolation Targets add value static final class Map Field extends Cache Field Map Field Field field super field Override void do Interpolate Object target Interpolate Object Action ctx throws Illegal Access Exception Suppress Warnings unchecked Map Object Object m Map Object Object field get target if m null m is Empty return for Map Entry Object Object entry m entry Set Object value entry get Value if value null continue if String class value get Class String interpolated ctx interpolate String value if interpolated equals value try entry set Value interpolated catch Unsupported Operation Exception ignore nop else if value get Class is Array evaluate Array value ctx else ctx interpolation Targets add value static final class Object Field extends Cache Field private final boolean is Array Object Field Field field super field this is Array field get Type is Array Override void do Interpolate Object target Interpolate Object Action ctx throws Illegal Access Exception Object value field get target if value null if is Array evaluate Array value ctx else ctx interpolation Targets add value 
package org apache maven artifact versioning Licensed to the Apache Software Foundation under one or more contributor license agreements See the file distributed with this work for additional information regarding copyright ownership The licenses this file to you under the Apache License Version the License you may not use this file except in compliance with the License You may obtain a copy of the License at http www apache org licenses Unless required by applicable law or agreed to in writing software distributed under the License is distributed on an either express or implied See the License for the specific language governing permissions and limitations under the License import java util Array List import java util Collections import java util Iterator import java util List import org apache maven artifact Artifact Construct a version range from a specification author a href mailto brett apache org Brett Porter a public class Version Range private final Artifact Version recommended Version private final List Restriction restrictions private Version Range Artifact Version recommended Version List Restriction restrictions this recommended Version recommended Version this restrictions restrictions public Artifact Version get Recommended Version return recommended Version public List Restriction get Restrictions return restrictions public Version Range clone Of List Restriction copied Restrictions null if restrictions null copied Restrictions new Array List if restrictions is Empty copied Restrictions add All restrictions return new Version Range recommended Version copied Restrictions p Create a version range from a string representation p Some spec examples are ul li code code Version li li code code Versions included to not included li li code code Versions to both included li li code code Versions and higher li li code code Versions up to included and or higher li ul param spec string representation of a version or version range return a new link Version Range object that represents the spec throws Invalid Version Specification Exception public static Version Range create From Version Spec String spec throws Invalid Version Specification Exception if spec null return null List Restriction restrictions new Array List String process spec Artifact Version version null Artifact Version upper Bound null Artifact Version lower Bound null while process starts With process starts With int index process index Of int index process index Of int index index if index index index if index index index if index throw new Invalid Version Specification Exception Unbounded range spec Restriction restriction parse Restriction process substring index if lower Bound null lower Bound restriction get Lower Bound if upper Bound null if restriction get Lower Bound null restriction get Lower Bound compare To upper Bound throw new Invalid Version Specification Exception Ranges overlap spec restrictions add restriction upper Bound restriction get Upper Bound process process substring index trim if process length process starts With process process substring trim if process length if restrictions size throw new Invalid Version Specification Exception Only fully qualified sets allowed in multiple set scenario spec else version new Default Artifact Version process restrictions add Restriction return new Version Range version restrictions private static Restriction parse Restriction String spec throws Invalid Version Specification Exception boolean lower Bound Inclusive spec starts With boolean upper Bound Inclusive spec ends With String process spec substring spec length trim Restriction restriction int index process index Of if index if lower Bound Inclusive upper Bound Inclusive throw new Invalid Version Specification Exception Single version must be surrounded by spec Artifact Version version new Default Artifact Version process restriction new Restriction version lower Bound Inclusive version upper Bound Inclusive else String lower Bound process substring index trim String upper Bound process substring index trim if lower Bound equals upper Bound throw new Invalid Version Specification Exception Range can not have identical boundaries spec Artifact Version lower Version null if lower Bound length lower Version new Default Artifact Version lower Bound Artifact Version upper Version null if upper Bound length upper Version new Default Artifact Version upper Bound if upper Version null lower Version null upper Version compare To lower Version throw new Invalid Version Specification Exception Range defies version ordering spec restriction new Restriction lower Version lower Bound Inclusive upper Version upper Bound Inclusive return restriction public static Version Range create From Version String version List Restriction restrictions Collections empty List return new Version Range new Default Artifact Version version restrictions Creates and returns a new code Version Range code that is a restriction of this version range and the specified version range p Note Precedence is given to the recommended version from this version range over the recommended version from the specified version range p param restriction the code Version Range code that will be used to restrict this version range return the code Version Range code that is a restriction of this version range and the specified version range p The restrictions of the returned version range will be an intersection of the restrictions of this version range and the specified version range if both version ranges have restrictions Otherwise the restrictions on the returned range will be empty p p The recommended version of the returned version range will be the recommended version of this version range provided that ranges falls within the intersected restrictions If the restrictions are empty this version range s recommended version is used if it is not code null code If it is code null code the specified version range s recommended version is used provided it is non code null code If no recommended version can be obtained the returned version range s recommended version is set to code null code p throws Null Pointer Exception if the specified code Version Range code is code null code public Version Range restrict Version Range restriction List Restriction r this restrictions List Restriction r restriction restrictions List Restriction restrictions if r is Empty r is Empty restrictions Collections empty List else restrictions intersection r r Artifact Version version null if restrictions size for Restriction r restrictions if recommended Version null r contains Version recommended Version if we find the original use that version recommended Version break else if version null restriction get Recommended Version null r contains Version restriction get Recommended Version use this if we can but prefer the original if possible version restriction get Recommended Version Either the original or the specified version ranges have no restrictions else if recommended Version null Use the original recommended version since it exists version recommended Version else if restriction recommended Version null Use the recommended version from the specified Version Range since there is no original recommended version version restriction recommended Version should throw this immediately but need artifact else throw new Over Constrained Version Exception Restricting incompatible version ranges return new Version Range version restrictions private List Restriction intersection List Restriction r List Restriction r List Restriction restrictions new Array List r size r size Iterator Restriction i r iterator Iterator Restriction i r iterator Restriction res i next Restriction res i next boolean done false while done if res get Lower Bound null res get Upper Bound null res get Lower Bound compare To res get Upper Bound if res get Upper Bound null res get Lower Bound null res get Upper Bound compare To res get Lower Bound Artifact Version lower Artifact Version upper boolean lower Inclusive boolean upper Inclusive overlaps if res get Lower Bound null lower res get Lower Bound lower Inclusive res is Lower Bound Inclusive else if res get Lower Bound null lower res get Lower Bound lower Inclusive res is Lower Bound Inclusive else int comparison res get Lower Bound compare To res get Lower Bound if comparison lower res get Lower Bound lower Inclusive res is Lower Bound Inclusive else if comparison lower res get Lower Bound lower Inclusive res is Lower Bound Inclusive res is Lower Bound Inclusive else lower res get Lower Bound lower Inclusive res is Lower Bound Inclusive if res get Upper Bound null upper res get Upper Bound upper Inclusive res is Upper Bound Inclusive else if res get Upper Bound null upper res get Upper Bound upper Inclusive res is Upper Bound Inclusive else int comparison res get Upper Bound compare To res get Upper Bound if comparison upper res get Upper Bound upper Inclusive res is Upper Bound Inclusive else if comparison upper res get Upper Bound upper Inclusive res is Upper Bound Inclusive res is Upper Bound Inclusive else upper res get Upper Bound upper Inclusive res is Upper Bound Inclusive do n t add if they are equal and one is not inclusive if lower null upper null lower compare To upper restrictions add new Restriction lower lower Inclusive upper upper Inclusive else if lower Inclusive upper Inclusive restrictions add new Restriction lower lower Inclusive upper upper Inclusive noinspection Object Equality if upper res get Upper Bound advance res if i has Next res i next else done true else advance res if i has Next res i next else done true else move on to next in r if i has Next res i next else done true else move on to next in r if i has Next res i next else done true return restrictions public Artifact Version get Selected Version Artifact artifact throws Over Constrained Version Exception Artifact Version version if recommended Version null version recommended Version else if restrictions size throw new Over Constrained Version Exception The artifact has no valid ranges artifact version null return version public boolean is Selected Version Known Artifact artifact throws Over Constrained Version Exception boolean value false if recommended Version null value true else if restrictions size throw new Over Constrained Version Exception The artifact has no valid ranges artifact return value public String to String if recommended Version null return recommended Version to String else String Builder buf new String Builder for Iterator Restriction i restrictions iterator i has Next Restriction r i next buf append r to String if i has Next buf append return buf to String public Artifact Version match Version List Artifact Version versions could be more efficient by sorting the list and then moving along the restrictions in order Artifact Version matched null for Artifact Version version versions if contains Version version valid check if it is greater than the currently matched version if matched null version compare To matched matched version return matched public boolean contains Version Artifact Version version for Restriction restriction restrictions if restriction contains Version version return true return false public boolean has Restrictions return restrictions is Empty recommended Version null public boolean equals Object obj if this obj return true if obj instanceof Version Range return false Version Range other Version Range obj boolean equals recommended Version other recommended Version recommended Version null recommended Version equals other recommended Version equals restrictions other restrictions restrictions null restrictions equals other restrictions return equals public int hash Code int hash hash hash recommended Version null recommended Version hash Code hash hash restrictions null restrictions hash Code return hash 
